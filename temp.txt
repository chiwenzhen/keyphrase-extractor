第1/m 章/q   绪/ng     论/v 
    自/p 1946年/t 第一/m 台/q 计算机/n 问世/vi 以来/f ，/wd 计算机/n 产业/n 的/ude1 飞速/d 发展/v 已/d 远远/d 超出/v 人们/n 对/p 它/rr 的/ude1 预料/vn ，/wd 在/p 某些/rz 生产线/n 上/f ，/wd 甚至/c 几/m 秒/qt 钟/n 就/d 能/v 生产/v 出/vf 一/m 台/q 微型/b 计算机/n ，/wd 产量/n 猛增/v ，/wd 价格低廉/n ，/wd 这/rzv 就/d 使得/vi 它/rr 的/ude1 应用/vn 范围/n 迅速/ad 扩展/v 。/wj 如今/t ，/wd 计算机/n 已/d 深入/ad 到/v 人类/n 社会/n 的/ude1 各个/rz 领域/n 。/wj 计算机/n 的/ude1 应用/vn 已/d 不再/d 局限/vi 于/p 科学计算/n ，/wd 而/cc 更/d 多/a 地/ude2 用于/v 控制/v 、/wn 管理/vn 及/cc 数据/n 处理/v 等/udeng 非/b 数值/n 计算/v 的/ude1 处理工作/n 。/wj 与/p 此/rzs 相应/vi ，/wd 计算机/n 加工/vn 处理/vn 的/ude1 对象/n 由/p 纯粹/b 的/ude1 数值/n 发展/v 到/v 字符/n 、/wn 表格/n 和/cc 图/n 象/ng 等/udeng 各种/rz 具有/v 一定/b 结构/n 的/ude1 数据/n ，/wd 这/rzv 就/d 给/p 程序设计/n 带来/v 一些/mq 新/a 的/ude1 问题/n 。/wj 为了/p 编写/v 出/vf 一个/mq “/wyz 好/a ”/wyy 的/ude1 程序/n ，/wd 必须/d 分析/v 待处理/n 的/ude1 对象/n 的/ude1 特性/n 以及/cc 各/rz 处理/vn 对象/n 之间/f 存在/v 的/ude1 关系/n 。/wj 这/rzv 就是/v “/wyz 数据/n 结构/n ”/wyy 这/rzv 门/q 学科/n 形成/v 和/cc 发展/vn 的/ude1 背景/n 。/wj 
1．1/m 什么/ry 是/vshi 数据/n 结构/n 
    一般来说/vl ，/wd 用/p 计算机/n 解决/v 一个/mq 具体/a 问题/n 时/ng ，/wd 大致/d 需要/v 经过/p 下列/b 几/m 个/q 步骤/n ：/wp 首先/d 要/v 从/p 具体/a 问题/n 抽象/a 出/vf 一个/mq 适当/a 的/ude1 数学/n 模型/n ，/wd 然后/c 设计/v 一个/mq 解/v 此/rzs 数学/n 模型/n 的/ude1 算法/n ，/wd 最后/f 编/v 出/vf 程序/n 、/wn 进行/vx 测试/vn 、/wn 调整/v 直至/v 得到/v 最终/d 解答/v 。/wj 寻求/v 数学/n 模型/n 的/ude1 实质/n 是/vshi 分析/v 问题/n ，/wd 从/p 中/f 提取/v 操作/v 的/ude1 对象/n ，/wd 并/cc 找/v 出/vf 这些/rz 操作对象/n 之间/f 含有/v 的/ude1 关系/n ，/wd 然后/c 用/p 数学/n 的/ude1 语言/n 加以/vx 描述/vn 。/wj 例如/v ，/wd 求解/vi 梁/n 架结构/n 中/b 应力/n 的/ude1 数学/n 模型/n 为/p 线性/n 方程组/n ；/wf 预报/vn 人口/n 增长/vn 情况/n 的/ude1 数学/n 模型/n 为/p 微分/n 方程/n 。/wj 然而/c ，/wd 更/d 多/a 的/ude1 非/b 数值/n 计算/vn 问题/n 无法/v 用/p 数学/n 方程/n 加以/vx 描述/vn 。/wj 下面/f 请/v 看/v 三/m 个/q 例子/n 。/wj 
    例/n l/x ～/ws 1/m 图书馆/n 的/ude1 书目/n 检索系统/n 自动化/vn 问题/n 。/wj 当/p 你/rr 想/v 借阅/v 一/m 本/q 参考书/n 但/c 不/d 知道/v 书库/n 中/f 是否/v 有/vyou 的/ude1 时候/n ；/wf 或者/c ，/wd 当/p 你/rr 想/v 找/v 某/rz 一/m 方面/n 的/ude1 参考书/n 而/cc 不/d 知/v 图书馆/n 内/f 有/vyou 哪些/ry 这/rzv 方面/n 的/ude1 书/n 时/ng ，/wd 你/rr 都/d 需要/v 到/v 图书馆/n 去/vf 查阅/v 图书/n 目录/n 卡片/n 。/wj 在/p 图书馆/n 内/f 有/vyou 各种/rz 名目/n 的/ude1 卡片/n ：/wp 有/vyou 按/p 书名/n 编排/v 的/ude1 、/wn 有/vyou 按/p 作者/n 编排/v 的/ude1 、/wn 还有/v 按/p 分类/vd 编排/v 的/ude1 ，/wd 等等/udeng 。/wj 若/c 利用计算机/n 实现/v 自动/b 检索/vn ，/wd 则/c 计算机处理/n 的/ude1 对象/n 便/d 是/vshi 这些/rz 目录/n 卡片/n 上/f 的/ude1 书目/n 信息/n 。/wj 列/v 在/p 一/m 张/q 卡片/n 上/f 的/ude1 一/m 本/q 书/n 的/ude1 书目/n 信息/n 可/v 由/p 登录/v 号/n 、/wn 书名/n 、/wn 作者/n 名/q 、/wn 分类/vn 号/n 、/wn 出版/v 单位/n 和/cc 出版/vn 时间/n 等/udeng 若干/m 项/q 组成/v ，/wd 每/rz 一/m 本/q 书/n 都/d 有/vyou 唯一/b 的/ude1 一个/mq 登录/v 号/q ，/wd 但/c 不同/a 的/ude1 书目/n 之间/f 可能/v 有/vyou 相同/a 的/ude1 书名/n 、/wn 或者/c 有/vyou 相同/a 的/ude1 作者/n 名/q 或者/c 有/vyou 相同/a 的/ude1 分类/vn 号/n 。/wj 由此/d ，/wd 在/p 书目/n 自动/b 检索系统/n 中/f 可以/v 建立/v 一/m 张/q 按/p 登录/v 号/q 顺序/n 排列/v 的/ude1 书目/n 文件/n 和/cc 三/m 张/q 分别/d 按/p 书名/n 、/wn 作者/n 名/q 和/cc 分类/vn 号/q 顺序/n 排列/v 的/ude1 索引/n 表/n ，/wd 如/v 图/n 1．1/m 所/usuo 示/vg 。/wj 由/p 这/rzv 四/m 张/q 表/n 构成/v 的/ude1 文件/n 便是/v 书目/n 自动/d 检索/v 的/ude1 数学/n 模型/n ，/wd 计算机/n 的/ude1 主要/b 操作/vn 便/d 是/vshi 按照/p 某个/rz 特定/b 要求/n (/wkz 如/v 给定/vn 书名/n )/wky 对/p 书目/n 文件/n 进行/vx 查询/vn 。/wj 诸如此类/bl 的/ude1 还有/v 查号系统/n 自动化/vn 、/wn 仓库/n 账目/n 管理/vn 等/udeng 。/wj 在/p 这/rzv 类/q 文档/n 管理/vn 的/ude1 数学/n 模型/n 中/f ，/wd 计算机处理/n 的/ude1 对象/n 之间/f 通常/d 存在/v 着/uzhe 的/ude1 是/vshi 一/m 种/q 最/d 简单/a 的/ude1 线性/n 关系/n ，/wd 这/rzv 类/q 数学/n 模型/n 可/v 称谓/n 线性/n 的/ude1 数据/n 结构/n 。/wj 
    例/n 1/m 。/wj 2/m 计算机/n 和/cc 人/n 对/p 奕/ng 问题/n 。/wj 计算机/n 之所以/c 能/v 和/cc 人/n 对/p 奕/ng 是/vshi 因为/p 有人/r 将/d 对/p 奕/ng 的/ude1 策略/n 事先/d 已/d 存入/v 计算机/n 。/wj 由于/c 对/p 奕/ng 的/ude1 过程/n 是/vshi 在/p 一定/b 规则/n 下/f 随机/d 进行/vx 的/ude1 ，/wd 所以/c ，/wd 为/p 使/v 计算机/n 能/v 灵活/ad 对/p 奕/ng 就/d 必须/d 对/p 对/p 奕/ng 过程/n 中/f 所/usuo 有/vyou 可能/n 发生/v 的/ude1 情况/n 以及/cc 相应/vi 的/ude1 对策/n 都/d 考虑/v 周全/a ，/wd 并且/c ，/wd 一个/mq “/wyz 好/a ”/wyy 的/ude1 棋手/n 在/p 对/p 奕时/nr2 不仅/c 要/v 看/v 棋盘/n 当时/t 的/ude1 状态/n ，/wd 还/d 应/v 能/v 预测/vn 棋局/n 发展/vn 的/ude1 趋势/n ，/wd 甚至/d 最后/f 结局/n 。/wj 因此/c ，/wd 在/p 对/p 奕/ng 问题/n 中/f ，/wd 计算机操作/n 的/ude1 对象/n 是/vshi 对/p 奕/ng 过程/n 中/f 可能/v 出现/v 的/ude1 棋盘/n 状态/n ――/wp 称为/v 格局/n 。/wj 例如/v 图/n 1．2/m (/wkz a/x )/wky 所/usuo 示/vg 为/p 井/n 字/n 棋/n ①/m 的/ude1 一个/mq 格局/n ，/wd 而/cc 格局/n 之间/f 的/ude1 关系/n 是/vshi 由/p 比赛/vn 规则/n 决定/v 的/ude1 。/wj 通常/d ，/wd 这个/rz 关系/n 不/d 是/vshi 线性/n 的/ude1 ，/wd 因为/c 从/p 一个/mq 棋盘/n 格局/n 可以/v 派生/v 出/vf 几/m 个/q 格局/n ，/wd 例如/v 从/p 图/n 1．2/m (/wkz a/x )/wky 所/usuo 示/vg 的/ude1 格局/n 可以/v 派生/v 出/vf 五/m 个/q 格局/n ，/wd 如/v 图/n 1．2/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 而/cc 从/p 每/rz 一个/mq 新/a 的/ude1 格局/n 又/d 可/v 派生/v 出/vf 四/m 个/q 可能/n 出现/v 的/ude1 格局/n 。/wj 因此/c ，/wd 若/c 将/d 从/p 对/p 奕/ng 开始/v 到/v 结束/v 的/ude1 过程/n 中/f 所/usuo 有/vyou 可能/n 出现/v 的/ude1 格局/n 都/d 画/v 在/p 一/m 张/q 图/n 上/f ，/wd 则/c 可/v 得到/v 一/m 棵/q 倒/d 长/a 的/ude1 “/wyz 树/n ”/wyy 。/wj “/wyz 树/n 根/n ”/wyy 是/vshi 对/p 奕/ng 开始/v 之前/f 的/ude1 棋盘/n 格局/n ，/wd 而/cc 所有/b 的/ude1 “/wyz 叶子/n ”/wyy 就/d 是/vshi 可能/v 出现/v 的/ude1 结局/n ，/wd 对/p 奕/ng 的/ude1 过程/n 就/d 是/vshi 从/p 树根/n 沿/p 树/n 叉/v 到/v 某个/rz 叶子/n 的/ude1 过程/n 。/wj “/wyz 树/n ”/wyy 可以/v 是/vshi 某些/rz 非/b 数值/n 计算/vn 问题/n 的/ude1 数学/n 模型/n ，/wd 它/rr 也/d 是/vshi 一/m 种/q 数据/n 结构/n 。/wj 
    例/n 1―3/m 多/m 叉/n 路口/n 交通灯/n 的/ude1 管理问题/n 。/wj 通常/d ，/wd 在/p 十字/b 交叉路口/n 只/d 需/v 设/v 红/a 、/wn 绿/a 两/m 色/ng 的/ude1 交通灯/n 便/d 可/v 保持正常/n 的/ude1 交通/n 秩序/n ，/wd 而/cc 在/p 多/m 又/c 路口/n 需/v 设/v 几/m 种/q 颜色/n 的/ude1 交通灯/n 才/d 能/v 既/c 使/v 车辆/n 相互/d 之间/f 不/d 碰撞/v ，/wd 又/d 能/v 达到/v 车辆/n 的/ude1 最/d 大/a 流通/vn 。/wj 假/ad 设有/v 一个/mq 如/v 图/n 1．3/m (/wkz a/x )/wky 所/usuo 示/vg 的/ude1 五/m 叉/n 路口/n ，/wd 其中/rz c/x ①/m   并/cc 字/n 棋/n 由/p 两/m 人/n 对/p 奕/ng 。/wj 棋盘/n 为/p 3×3/m 的/ude1 方格/n ，/wd 当/p 一/m 方/q 的/ude1 三/m 个/q 棋子/n 占/v 同/p 一/m 行/q 、/wn 或/c 同/p 一/m 列/q 、/wn 或/c 同/p 一/m 对角线/n 时/ng 便/d 为/v 胜/v 和/cc E/x 为/p 单行道/n 。/wj 在/p 路口/n 有/vyou 13/m 条/q 可行/a 的/ude1 通/a 路/n ，/wd 其中/rz 有的/rz 可以/v 同时/c 通行/vi ，/wd 如/v A―B/x 和/cc E―C/x ，/wd 
而/cc 有的/rz 不/d 能/v 同时/c 通行/vi ，/wd 如/v E―B/x 和/cc A―D/x 。/wj 那末/c ，/wd 在/p 路口/n 应/v 如何/ryv 设置/v 交通灯/n 进行/vx 车辆/n 的/ude1 管/v 
理/n 呢/y ?/ww 
图/n 1．3/m 五/m 叉/n 路口/n 交通管理/n 示意图/n 
(/wkz a/x )/wky 五/m 叉/n 路口/n ；/wf (/wkz b/x )/wky 表示/v 通/v 路/n 的/ude1 图/n 。/wj 
    通常/d ，/wd 这/rzv 类/q 交通/n 、/wn 道路/n 问题/n 的/ude1 数学/n 模型/n 是/vshi 一/m 种/q 称谓/n “/wyz 图/n ”/wyy 的/ude1 数据/n 结构/n 。/wj 例如/v 在/p 此/rzs 例/n 的/ude1 问题/n 中/f ，/wd 可以/v 图/n 中/f 一个/mq 顶点/n 表示/v 一/m 条/q 通/a 路/n ，/wd 而/cc 通路/n 之间/f 互相/d 矛盾/an 的/ude1 关系/n 以/p 两/m 个/q 顶点/n 之间/f 的/ude1 连线/n 表示/v 。/wj 如/c 在/p 图/n 1．3/m (/wkz b/x )/wky 中/f ，/wd 每个/r 圆圈/n 表示/v 图/n 1．3/m (/wkz a/x )/wky 所/usuo 示/vg 五/m 叉/n 路口/n 上/f 的/ude1 一/m 条/q 通/a 路/n ，/wd 两/m 个/q 圆圈/n 之间/f 的/ude1 连线/n 表示/v 这/rzv 两/m 个/q 圆圈/n 表示/v 的/ude1 两/m 条/q 通/a 路/n 不/d 能/v 同时/c 通行/vi 。/wj 设置/v 交通灯/n 的/ude1 问题/n 等价/vn 为/v 对/p 图/n 的/ude1 顶点/n 的/ude1 染色/vn 问题/n ，/wd 要求/v 对/p 图/n 上/f 的/ude1 每个/r 顶/v 点染/v 一/m 种/q 颜色/n ，/wd 并且/c 要求/v 有线/b 相连/vi 的/ude1 两/m 个/q 顶点/n 不/d 能/v 具有/v 相同/a 颜色/n ，/wd 而/cc 总/b 的/ude1 颜色/n 种类/n 应/v 尽可能/d 地/ude2 少/v 。/wj 图/n 1．3/m (/wkz b/x )/wky 所/usuo 示/vg 为/p 一/m 种/q 染色/vn 结果/n ，/wd 圆圈/n 中/f 的/ude1 数字/n 表示/v 交通灯/n 的/ude1 不同/a 颜色/n ，/wd 例如/v 3/m 号/q 色/n 灯/n 亮/vi 时/ng 只/d 有/vyou I/x 卜/vg A/x 和/cc pB/x 两/m 条/q 路/n 可/v 通行/vi 。/wj 
    综/ng 上/f 三/m 个/q 例子/n 可见/c ，/wd 描述/v 这/rzv 类/q 非/b 数值/n 计算/vn 问题/n 的/ude1 数学/n 模型/n 不再/d 是/vshi 数学/n 方程/n ，/wd 而是/c 诸如/v 表/n 、/wn 树/n 和/cc 图/n 之类/rz 的/ude1 数据/n 结构/n 。/wj 因此/c ，/wd 简单/a 说来/uls ，/wd 数据/n 结构/n 是/vshi 一/m 门/q 研究/v 非/b 数值/n 计算/v 的/ude1 程序设计/n 问题/n 中/b 计算机/n 的/ude1 操作对象/n 以及/cc 它们/rr 之间/f 的/ude1 关系/n 和/cc 操作/vn 等等/udeng 的/ude1 学科/n 。/wj 
　　</n 数据/n 结构/n >/n 作为/v 一/m 门/q 独立/a 的/ude1 课程/n 在/p 国外/s 是/vshi 从/p 1968年/t 才/d 开始/v 设立/v 的/ude1 。/wj 在/p 这/rzv 之前/f ，/wd 它/rr 的/ude1 某些/rz 内容/n 曾/d 在/p 其它/rz 课程/n ，/wd 如/v 表处理/n 语言/n 中/f 有/vyou 所/usuo 阐述/v 。/wj 1968年/t 在/p 美国/nsf 一些/mq 大学/n 的/ude1 计算机/n 系/v 的/ude1 教学/vn 计划/n 中/f ，/wd 虽然/c 把/pba </n 数据/n 结构/n >/n 规定/n 为/p 一/m 门/q 课程/n ，/wd 但/c 对/p 课程/n 的/ude1 范围/n 仍/d 没有/d 作/v 明确/ad 规定/v 。/wj 当时/t ，/wd 数据/n 结构/n 几乎/d 和/cc 图/n 论/ng ，/wd 特别/d 是/vshi 和/cc 表/n 、/wn 树/n 的/ude1 理论/n 为/p 同义语/n 。/wj 随后/f ，/wd 数据/n 结构/n 这个/rz 概念/n 被/pbei 扩充/v 到/v 包括/v 网络/n 、/wn 集合/v 代数/n 论/ng 、/wn 格/b 、/wn 关系/n 等/udeng 方面/n ，/wd 从而/c 变成/v 了/ule 现在/t 称之为/v 《/wkz 离散/b 结构/n >/n 的/ude1 内容/n 。/wj 然而/c ，/wd 由于/c 数据/n 必须/d 在/p 计算机/n 中/f 进行/vx 处理/vn ，/wd 因此/c ，/wd 不仅/c 考虑/v 数据/n 本身/rz 的/ude1 数学/n 性质/n ，/wd 而且/c 还/d 必须/d 考虑/v 数据/n 的/ude1 存储/vn 结构/n ，/wd 这/rzv 就/d 进一步/d 扩大/v 了/ule 数据/n 结构/n 的/ude1 内容/n 。/wj 近年来/dl ，/wd 随着/p 数据库/n 系统/n 的/ude1 不断/d 发展/v ，/wd 在/p 数据/n 结构/n 课程/n 中/f 又/d 增加/v 了/ule 文件/n 管理/vn (/wkz 特别/d 是/vshi 大型/b 文件/n 的/ude1 组织/n 等/udeng )/wky 的/ude1 内容/n 。/wj 
　　1968年/t 美国/nsf 唐・欧・克努特/nrf 教授/n 开创/v 了/ule 数据/n 结构/n 的/ude1 最初/b 体系/n ，/wd 他/rr 所/usuo 著/vg 的/ude1 </n 计算机程序/n 设计/vn 技巧/n >/n 第一/m 卷/q (/wkz 基本算法/n >/n 是/vshi 第一/m 本/q 较/d 系统/a 地/ude2 阐述/v 数据/n 的/ude1 逻辑/n 结构/n 和/cc 存储/vn 结构/n 及其/cc 操作/vn 的/ude1 著作/n 。/wj 从/p 60/m 年代/n 末/f 到/v 70/m 年代/n 初/f ，/wd 出现/v 了/ule 大型/b 程序/n ，/wd 软件/n 也/d 相对/d 独立/a ，/wd 结构/n 程序设计/n 成为/v 程序设计/n 方法/n 学/v 的/ude1 主要/b 内容/n ，/wd 人们/n 就/d 越来越/d 重视/v 数据/n 结构/n ，/wd 认为/v 程序设计/n 的/ude1 实质/n 是/vshi 对/p 确定/v 的/ude1 问题/n 选择/v 一/m 种/q 好/a 的/ude1 结构/n ，/wd 加上/v 设计/v 一/m 种/q 好/a 的/ude1 算法/n 。/wj 从/p 70/m 年代/n 中期/f 到/v 80/m 年代/n 初/f ，/wd 各种/rz 版本/n 的/ude1 数据/n 结构/n 著作/n 就/d 相继/d 出现/v 。/wj 
    目前/t 在/p 我国/n ，/wd </n 数据/n 结构/n >/n 也/d 已经/d 不仅仅/d 是/vshi 计算机专业/n 的/ude1 教学/vn 计划/n 中/f 的/ude1 核心/n 课程/n 之一/rz ，/wd 而且/c 是/vshi 其它/rz 非/b 计算机专业/n 的/ude1 主要/d 选修/v 课程/n 之一/rz 。/wj 
    《/wkz 数据/n 结构/n 》/wky 在/p 计算机科学/n 中/f 是/vshi 一/m 门/q 综合性/n 的/ude1 专业/n 基础/n 课/n 。/wj 数据/n 结构/n 的/ude1 研究/vn 不仅/c 涉及/v 到/v 计算机硬件/n (/wkz 特别/d 是/vshi 编码理论/n 、/wn 存储装置/n 和/cc 存取方法/n 等/udeng )/wky 的/ude1 研究/vn 范围/n ，/wd 而且/c 和/cc 计算机软件/n 的/ude1 研究/vn 有着/v 更/d 密切/a 的/ude1 关系/n ，/wd 无论是/c 编译程序/n 还是/c 操作系统/nl ，/wd 都/d 涉及/v 到/v 数据/n 元素/n 在/p 存储器数据/n 类型/n 中/f 的/ude1 分配问题/n 。/wj 在/p 研究/vn 信息/n 检索/vn 时/ng 也/d 必须/d 考虑/v 如何/ryv 组织/v 数据/n ，/wd 以便/d 查找/v 和/cc 存取数据/n 元素/n 更/d 为/v 方便/an 。/wj 因此/c ，/wd 可以/v 认为/v 数据/n 结构/n 是/vshi 介于/v 数学/n 、/wn 计算机硬件/n 和/cc 计算机软件/n 三者/r 之间/f 的/ude1 一/m 门/q 核心/n 课程/n (/wkz 如/v 图/n 1．4/m 所/usuo 示/vg )/wky 。/wj 在/p 计算机科学/n 中/f ，/wd 数据/n 结构/n 不仅/c 是/vshi 一般/a 程序设计/n (/wkz 特别/a 是非/n 数值/n 计算/v 的/ude1 程序设计/n )/wky 的/ude1 基础/n ，/wd 而且/c 是/vshi 设计/v 和/cc 实现/v 编译程序/n 、/wn 操作系统/nl 、/wn 数据库/n 系统/n 及/cc 其它/rz 系统/n 程序/n 和/cc 大型/b 应用/vn 程序/n 的/ude1 重要/a 基础/n 。/wj 
    值得/v 注意/v 的/ude1 是/vshi ，/wd 数据/n 结构/n 的/ude1 发展/vn 并/cc 未/d 终结/vi ，/wd 一方面/c ，/wd 面向/v 各/rz 专门/b 领域/n 中/f 特殊/a 问题/n 的/ude1 数据/n 结构/n 得到/v 研究/vn 和/cc 发展/vn ，/wd 如/v 多维/n 图形/n 数据/n 结构/n 等/udeng ；/wf 另一方面/c ，/wd 从/p 抽象数据/n 类型/n 的/ude1 观点/n 来/vf 讨论/v 数据/n 结构/n ，/wd 已/d 成为/v 一/m 种/q 新/a 的/ude1 趋势/n ，/wd 越来越/d 被/pbei 人们/n 所/usuo 重视/v 。/wj 
1．2/m 基本/a 概念/n 和/cc 术语/n 
    在/p 本/rz 节/n 中/f ，/wd 我们/rr 将/d 对/p 一些/mq 概念/n 和/cc 术语/n 赋/ng 以/p 确定/v 的/ude1 含义/n ，/wd 以便/d 与/p 读者/n 取得/v “/wyz 共同/b 的/ude1 语言/n ”/wyy 。/wj 这些/rz 概念/n 和/cc 术语/n 将/d 在/p 以后/f 的/ude1 章节/n 中/f 多次/mq 出现/v 。/wj 
    数据/n (/wkz Data/x )/wky   是/vshi 对/p 客观/a 事物/n 的/ude1 符号/n 表示/v ，/wd 在/p 计算机科学/n 中/f 是/vshi 指/v 所有/b 能/v 输入/v 到/v 计算机/n 中/f 并/d 被/pbei 计算机程序/n 处理/v 的/ude1 符号/n 的/ude1 总称/n 。/wj 它/rr 是/vshi 计算机程序/n 加工/vn 的/ude1 “/wyz 原料/n ”/wyy 。/wj 例如/v ，/wd 一个/mq 利用/v 数值/n 分析方法/n 解/v 代数方程/n 的/ude1 程序/n ，/wd 其/rz 处理/vn 对象/n 是/vshi 整数/n 和/cc 实数/n ；/wf 一个/mq 编译程序/n 或/c 文字/n 处理程序/n 的/ude1 处理/vn 对象/n 是/vshi 字符串/n 。/wj 因此/c ，/wd 对/p 计算机科学/n 而言/uls ，/wd 数据/n 的/ude1 含义/n 极为/d 广泛/a ，/wd 如/v 图/n 象/ng 、/wn 声音/n 等/udeng 都/d 可以/v 通过/p 编码/n 而/cc 归/v 之/uzhi 于/p 数据/n 的/ude1 范畴/n 。/wj 
    数据/n 元素/n (/wkz Data/x  Element/x )/wky   是/vshi 数据/n 的/ude1 基本单位/n ，/wd 在/p 计算机程序/n 中/f 通常/d 作为/v 一个/mq 整体/n 进行/vx 考虑/vn 和/cc 处理/vn 。/wj 例如/v ，/wd 例/n 1―2/m 中/f 的/ude1 “/wyz 树/n ”/wyy 中/f 的/ude1 一个/mq 棋盘/n 格局/n ，/wd 例/n 1―3/m 中/f 的/ude1 “/wyz 图/n ”/wyy 中/f 的/ude1 一个/mq 圆圈/n 都/d 被/pbei 称为/v 一个/mq 数据/n 元素/n 。/wj 有时/d ．/w 一个/mq 数据/n 元素/n 可/v 由/p 若干/m 个/q 数据项/n (/wkz Data/x  Item/x )/wky 组成/v ，/wd 例如/v ，/wd 例/n l―l/x 中/f 一/m 本/q 书/n 的/ude1 书目/n 信息/n 为/v 一个/mq 数据/n 元素/n ，/wd 而/cc 书目/n 信息/n 中/f 的/ude1 每/rz 一/m 项/q (/wkz 如/v 书名/n 、/wn 作者/n 名/q 等/udeng )/wky 为/p 一个/mq 数据项/n 。/wj 数据/n 项/q 是/vshi 数据/n 的/ude1 不可分割/vl 的/ude1 最/d 小/a 单位/n 。/wj 
    数据/n 对象/n (/wkz Data/x  Object/x )/wky 是/vshi 性质/n 相同/a 的/ude1 数据/n 元素/n 的/ude1 集合/n ，/wd 是/vshi 数据/n 的/ude1 一个/mq 子集/n 。/wj 例如/v ，/wd 整数/n 数据/n 对象/n 是/vshi 集合/v N=/x {/n 0/m ，/wd ±1/m ，/wd ±2/m ，/wd …/ws }/n ，/wd 字母/n 字符/n 数据/n 对象/n 是/vshi 集合/v C=/x {/n ‘/wyz A/x ’/wyy ，/wd ‘/wyz B/x ’/wyy ，/wd …/ws ，/wd ‘/wyz Z/x ’/wyy }/n 。/wj 
    数据/n 结构/n (/wkz Data/x  structure/x )/wky 是/vshi 相互/b 之间/f 存在/v 一/m 种/q 或/c 多/m 种/q 特定/b 关系/n 的/ude1 数据/n 元素/n 的/ude1 集合/n 。/wj 这/rzv 是/vshi 本/rz 书/n 对/p 数据/n 结构/n 的/ude1 一/m 种/q 简单/ad 解释/v ①/m 。/wj 从/p 1．1/m 节/q 中/f 三/m 个/q 例子/n 可以/v 看到/v ，/wd 在/p 任何/rz 问题/n 中/f ，/wd 数据/n 元素/n 都/d 不/d 是/vshi 孤立/v 存在/v 的/ude1 ，/wd 而是/c 在/p 它们/rr 之间/f 存在/v 着/uzhe 某种/rz 关系/n ，/wd 这种/r 数据/n 元素/n 相互之间/bl 的/ude1 关系/n 称为/v 结构/n (/wkz structure/x )/wky 。/wj 根据/p 数据/n 元素/n 之间/f 关系/n 的/ude1 不同/a 特性/n ，/wd 通常/d 有/vyou 下列/b 四/m 类/q 基本/a 结构/n ：/wp (/wkz 1/m )/wky 集合/v 结构/n 中/f 的/ude1 数据/n 元素/n 之间/f 除了/p “/wyz 同/p 属/v 于/p 一个/mq 集合/n ”/wyy 的/ude1 关系/n 外/f ，/wd 别/d 无/v 其它/rz 关系/n ②/m ；/wf (/wkz 2/m )/wky 线性/n 结构/n 结构/n 中/f 的/ude1 数据/n 元素/n 之间/f 存在/v 一个/mq 对/p 一个/mq 的/ude1 关系/n ；/wf (/wkz 3/m )/wky 树形/n 结构/n 结构/n 中/f 的/ude1 数据/n 元素/n 之间/f 存在/v 一个/mq 对/p 多/m 个/q 的/ude1 关系/n ；/wf (/wkz 4/m )/wky 图/n 状/ng 结构/n 或/c 网状结构/n 结构/n 中/f 的/ude1 数据/n 元素/n 之间/f 存在/v 多/m 个/q 对/p 多/m 个/q 的/ude1 关系/n 。/wj 图/n 1．5/m 为/p 上述/b 四/m 类/q 基本/a 结构/n 的/ude1 关系图/n 。/wj 由于/p “/wyz 集合/v ”/wyy 是/vshi 数据/n 元素/n 之间/f 关系/n 极为/d 松散/a 的/ude1 一/m 种/q 结构/n ，/wd 因此/c 也/d 可/v 用/p 其它/rz 结构/n 来/vf 表示/v 它/rr 。/wj 
    数据/n 结构/n 的/ude1 形式/n 定义/n 为/v ：/wp 数据/n 结构/n 是/vshi 一个/mq 二元/b 组/n 
    Data―Structure=/x (/wkz D/x ，/wd 5/m )/wky     (/wkz 1―1/m )/wky 
其中/rz ：/wp D/x 是/vshi 数据/n 元素/n 的/ude1 有限/a 集/ng ，/wd s/x 是/vshi D/x 上/f 关系/n 的/ude1 有限/a 集/vg 。/wj 下面/f 举/v 两/m 个/q 简单/a 例子/n 说明/v 之/uzhi 。/wj 
    例/n 1．4/m   在/p 计算机科学/n 中/f ，/wd 复数/n 可取/a 如下/vn 定义/n ：/wp 复数/n 是/vshi 一/m 种/q 数据/n 结构/n 
    Complex=/x (/wkz C/x ，/wd R/x )/wky     (/wkz 1―2/m )/wky 
其中/rz ：/wp c/x 是/vshi 含/v 两/m 个/q 实数/n 的/ude1 集合/n {/n c1/x ，/wd c2/x }/n ；/wf R=/x {/n P/x }/n ，/wd 而/cc P/x 是/vshi 定义/n 在/p 集合/v C/x 上/f 的/ude1 一/m 种/q 关系/n {/n (/wkz c1/x ，/wd c2/x )/wky }/n ，/wd 其中/rz 有序/a 偶/n (/wkz c1/x ，/wd c2/x )/wky 表示/v c1/x 是/vshi 复数/n 的/ude1 实/a 部/q ，/wd c2/x 是/vshi 复数/n 的/ude1 虚/a 部/q 。/wj 
    例/n 1．5/m 假设/n 我们/rr 需要/v 编制/n 一个/mq 事务/n 管理/vn 的/ude1 程序/n ，/wd 管理/vn 学校/n 科学研究/n 课题/n 小组/n 的/ude1 各项/r 事务/n ，/wd 则/c 首先/d 要/v 为/p 程序/n 的/ude1 操作对象/n ――/wp 课题/n 小组/n 设计/v 一个/mq 数据/n 结构/n 。/wj 假设/v 每/rz 个/q 小组/n 由/p 一/m 位/q 教师/n 、/wn 一/m 至/p 三/m 名/q 研究生/n 及/cc 一/m 至/p 六/m 名/q 本科生/n 组成/v ，/wd 小组/n 成员/n 之间/f 的/ude1 关系/n 是/vshi ：/wp 教师/n 指导/vn 研究生/n ，/wd 而/cc 由/p 每/rz 位/q 研究生/n 指导/v 一/m 至/p 两/m 名/q 本科生/n 。/wj 则/c 可以/v 如下/vi 定义数据/n 结构/n ：/wp 
    Group=/x (/wkz P/x ，/wd R/x )/wky     (/wkz 1―3/m )/wky 
其中/rz ：/wp P=/x {/n T/x ，/wd G1/x ，/wd …/ws ，/wd G/x 。/wj ，/wd S11/x …/ws S/x 。/wj 。/wj }/n ③/m 1≤/m 。/wj ≤3/m 。/wj 1≤/m 。/wj ≤2．/m 
    R=/x {/n R1/x ，/wd R2/x }/n 
    Rl=/x {/n (/wkz T/x ，/wd G/x ，/wd )/wky 11≤：≤/m 。/wj 。/wj 1≤/m 。/wj ≤3/m }/n 
    R2=/x {/n (/wkz Gi/x ，/wd S/x 巧/a )/wky f1≤i≤/x 。/wj 。/wj 1≤J≤/x 。/wj ，/wd 1≤/m 。/wj ≤3/m ，/wd 1≤/m 。/wj ≤2l/x }/n 
①/m   对于/p 数据/n 结构/n 这个/rz 概念/n ，/wd 至今/d 尚未/d 有/vyou 一个/mq 被/pbei 一致/ad 公认/v 的/ude1 定义/n ，/wd 不同/a 的/ude1 人/n 在/p 使用/v 这个/rz 词/n 时/ng 所/usuo 表达/v 的/ude1 意思/n 有所不同/vl 。/wj 
②/m   这/rzv 和/cc 数学/n 中/f 的/ude1 集合/n 概念/n 是/vshi 一致/a 的/ude1 。/wj 
③/m   T/x 表示/v 导师/n ，/wd G/x 表示/v 研究生/n ，/wd S/x 表示/v 大学生/n 。/wj 
    上述/b 数据/n 结构/n 的/ude1 定义/n 仅/d 是/vshi 对/p 操作对象/n 的/ude1 一/m 种/q 数学/n 描述/vn ，/wd 换句话说/c ，/wd 是/vshi 从/p 操作对象/n 抽象/a 出来/vf 的/ude1 数学/n 模型/n 。/wj 结构/n 定义/n 中/f 的/ude1 “/wyz 关系/n ”/wyy 描述/v 的/ude1 是/vshi 数据/n 元素/n 之间/f 的/ude1 逻辑关系/n ，/wd 因此/c 又/d 称/v 为/p 数据/n 的/ude1 逻辑/n 结构/n 。/wj 然而/c ，/wd 讨论/v 数据/n 结构/n 的/ude1 目的/n 是/vshi 为了/p 在/p 计算机/n 中/f 实现/v 对/p 它/rr 的/ude1 操作/vn ，/wd 因此/c 还/d 需/v 研究/v 如何/ryv 在/p 计算机/n 中/f 表示/v 它/rr 。/wj 
    数据/n 结构/n 在/p 计算机/n 中/f 的/ude1 表示/v (/wkz 又/d 称/v 映象/n )/wky 称为/v 数据/n 的/ude1 物理/n 结构/n ，/wd 又/d 称/v 存储/vn 结构/n 。/wj 它/rr 包括/v 数据/n 元素/n 的/ude1 表示/vn 和/cc 关系/n 的/ude1 表示/vn 。/wj 在/p 计算机/n 中/f 表示信息/n 的/ude1 最/d 小/a 单位/n 是/vshi 二进制/n 数/n 的/ude1 一/m 位/q ，/wd 叫做/v 位/q (/wkz bit/x )/wky 。/wj 在/p 计算机/n 中/f ，/wd 我们/rr 可以/v 用/p 一个/mq 由/p 若干/m 位/q 组合/n 起来/vf 形成/v 的/ude1 一个/mq 位/q 串/v 表示/v 一个/mq 数据/n 元素/n (/wkz 如/v 用/p 一个/mq 字/n 长/a 的/ude1 位/q 串/v 表示/v 一个/mq 整数/n ，/wd 用/p 八/m 位/q 二进制/n 数/n 表示/v 一个/mq 字符/n 等/udeng )/wky ，/wd 通常/d 称/v 这个/rz 位/q 串/v 为/p 元素/n ①/m (/wkz Element/x )/wky 或/c 结点/n (/wkz Node/x )/wky 。/wj 当/p 数据/n 元素/n 由/p 若干/m 数据项/n 组成/v 时/ng ，/wd 位/q 串/n 中/f 对/p 应/v 于/p 各个/rz 数据项/n 的/ude1 子/ng 位/ng 串/v 称为/v 数据/n 域/ng (/wkz Data/x  Field/x )/wky 。/wj 因此/c ，/wd 元素/n 或/c 结点/n 可/v 看成/v 是/vshi 数据/n 元素/n 在/p 计算机/n 中/f 的/ude1 映象/n 。/wj 
    数据/n 元素/n 之间/f 的/ude1 关系/n 在/p 计算机/n 中/f 有/vyou 两/m 种/q 不同/a 的/ude1 表示方法/n ：/wp 顺序/n 映象/n 和/cc 非/b 顺序/n 映象/n ，/wd 并/cc 由此/d 得/ude3 到/v 两/m 种/q 不同/a 的/ude1 存储/vn 结构/n ：/wp 顺序/n 存储/vn 结构/n 和/cc 链式/n 存储/v 结构/n 。/wj 顺序/n 映象/n 的/ude1 特点/n 是/vshi 借助/v 元素/n 在/p 存储器/n 中/f 的/ude1 相对/b 位置/n 来/vf 表示数据/n 元素/n 之间/f 的/ude1 逻辑关系/n 。/wj 例如/v ，/wd 假设/v 用/p 两/m 个/q 字/n 长/a 的/ude1 位/q 串/v 表示/v 一个/mq 实数/n ，/wd 则/c 可以/v 用/p 地址/n 相邻/vi 的/ude1 四/m 个/q 字/n 长/a 的/ude1 位/q 串/v 表示/v 一个/mq 复数/n ，/wd 如/v 图/n 1．6/m (/wkz a/x )/wky 为/p 表示/v 复数/n z1=3．O/x 一/m 2．3i/x 和/cc z2=/x 一/m 0．7+4．8i/x 的/ude1 顺序/n 存储/vn 结构/n ；/wf 非/b 顺序/n 映象/n 的/ude1 特点/n 是/vshi 借助/v 指示/n 元素/n 存储/vn 地址/n 的/ude1 指针/n (/wkz Pointer/x )/wky 表示数据/n 元素/n 之间/f 的/ude1 逻辑关系/n ，/wd 如/v 图/n 1．6/m (/wkz b/x )/wky 为/p 表示/v 复数/n z1/x 的/ude1 链式/n 存储/v 结构/n ，/wd 其中/rz 实/a 部/n 和/cc 虚/a 部/n 之间/f 的/ude1 关系/n 用/p 值/n 为/v “/wyz 0415/m ”/wyy 的/ude1 指针/n 来/vf 表示/v (/wkz 0415/m 是/vshi 虚/a 部/n 的/ude1 存储/vn 地址/n )/wky ②/m 。/wj 数据/n 的/ude1 逻辑/n 结构/n 和/cc 物理/n 结构/n 是/vshi 密切相关/n 的/ude1 两/m 个/q 方面/n ，/wd 以后/f 读者/n 会/v 看到/v ，/wd 任何/rz 一个/mq 算法/n 的/ude1 设计/vn 取决于/v 选定/v 的/ude1 数据/n (/wkz 逻辑/n )/wky 结构/n ，/wd 而/cc 算法/n 的/ude1 实现/v 依赖/v 于/p 采用/v 的/ude1 存储/vn 结构/n 。/wj 
  图/n 1．6/m 复数/n 存储/vn 结构/n 示意图/n 
(/wkz a/x )/wky 顺序/n 存储/vn 结构/n ；/wf   (/wkz b/x )/wky 链式/n 存储/v 结构/n 。/wj 
①/m 本/q 书/n 中/f 有时/d 也/d 把/pba 数据/n 元素/n 简称/v 为/p 元素/n ，/wd 读者/n 应/v 从/p 上下文/n 去/vf 理解/v 分辨/v 之/uzhi 。/wj 
②/m   在/p 实际/n 应用/vn 中/f ，/wd 像/p 复数/n 这/rzv 类/q 极/d 简单/a 的/ude1 结构/n 不/d 需要/v 采用/v 链式/n 存储/v 结构/n ，/wd 在/p 此/rzs 仅/d 为/v 了/ule 简化/v 讨论/vn 而/cc 作为/v 假/a 例/n 引用/v 之/uzhi 。/wj 
    如何/ryv 描述/v 存储/vn 结构/n 呢/y 。/wj 虽则/c 存储/v 结构/n 涉及/v 数据/n 元素/n 及其/cc 关系/n 在/p 存储器/n 中/f 的/ude1 物理/n 位置/n ，/wd 但/c 由于/p 本书/r 是/vshi 在/p 高级/a 程序/n 语言/n 的/ude1 层次/n 上/f 讨论/v 数据/n 结构/n 的/ude1 操作/vn ，/wd 因此/c 不/d 能/v 如上/d 那样/rzv 直接/ad 以/p 内存/n 地址/n 来/vf 描述/v 存储/vn 结构/n ，/wd 但/c 我们/rr 可以/v 借用/v 高级/a 程序/n 语言/n 中/f 提供/v 的/ude1 “/wyz 数据/n 类型/n ”/wyy 来/f 描述/v 它/rr ，/wd 例如/v 可以/v 用/v 所/usuo 有/vyou 高级/a 程序/n 语言/n 中/f 都/d 有/vyou 的/ude1 “/wyz 一/m 维/q 数组/n ”/wyy 类型/n 来/vf 描述/v 顺序/n 存储/vn 结构/n ，/wd 以/p C/x 语言/n 提供/v 的/ude1 “/wyz 指针/n ”/wyy 来/f 描述/v 链式/n 存储/v 结构/n 。/wj 假如/c 我们/rr 把/pba C/x 语言/n 看成/v 是/vshi 一个/mq 执行/v C/x 指令/n 和/cc C/x 数据/n 类型/n 的/ude1 虚拟/vn 处理器/n ，/wd 那末/c 本/rz 书/n 中/f 讨论/v 的/ude1 存储/vn 结构/n 是/vshi 数据/n 结构/n 在/p C/x 虚拟/vn 处理器/n 中/f 的/ude1 表示/vn ，/wd 不妨/d 称/v 它/rr 为/v 虚拟/vn 存储/vn 结构/n 。/wj 
    数据/n 类型/n (/wkz Data/x  Type/x )/wky   是/vshi 和/cc 数据/n 结构/n 密切相关/n 的/ude1 一个/mq 概念/n ，/wd 它/rr 最/d 早/ad 出现/v 在/p 高级/a 程序/n 语言/n 中/f ，/wd 用以/d 刻画/v (/wkz 程序/n )/wky 操作对象/n 的/ude1 特性/n 。/wj 在/p 用/v 高级/a 程序/n 语言/n 编写/v 的/ude1 程序/n 中/f ，/wd 每个/r 变量/n 、/wn 常量/n 或/c 表达式/n 都/d 有/vyou 一个/mq 它/rr 所属/v 的/ude1 确定/a 的/ude1 数据/n 类型/n 。/wj 类型/n 明显/a 或/c 隐含/v 地/ude2 规定/v 了/ule 在/p 程序执行/n 期间/f 变量/n 或/c 表达式/n 所/usuo 有/vyou 可能/n 取值/v 的/ude1 范围/n ，/wd 以及/cc 在/p 这些/rz 值/n 上/f 允许/v 进行/vx 的/ude1 操作/vn 。/wj 因此/c 数据/n 类型/n 是/vshi 一个/mq 值/n 的/ude1 集合/n 和/cc 定义/n 在/p 这个/rz 值/n 集/vg 上/f 的/ude1 一/m 组/q 操作/vn 的/ude1 总称/n 。/wj 例如/v ，/wd c/x 语言/n 中/f 的/ude1 整/m 型/k 变量/n ，/wd 其/rz 值/n 集/vg 为/p 某个/rz 区间/n 上/f 的/ude1 整数/n (/wkz 区/n 间/f 大/d 小/a 依赖/v 于/p 不同/a 的/ude1 机器/n )/wky ，/wd 定义/v 在/p 其/rz 上/f 的/ude1 操作/vn 为/v ：/wp 加/v 、/wn 减/v 、/wn 乘/v 、/wn 除/p 和取模/nr 等/udeng 算术/n 运算/vn 。/wj 
    按/p “/wyz 值/n ”/wyy 的/ude1 不同/a 特性/n ，/wd 高级/a 程序/n 语言/n 中/f 的/ude1 数据/n 类型/n 可/v 分为/v 两/m 类/q ：/wp 一/m 类/q 是非/n 结构/n 的/ude1 原子/n 类型/n 。/wj 原子/n 类型/n 的/ude1 值/n 是/vshi 不可/v 分解/v 的/ude1 。/wj 如/v ：/wp C/x 语言/n 中/f 的/ude1 基本/a 类型/n (/wkz 整/m 型/k 、/wn 实/a 型/k 、/wn 字符/n 型/k 和/cc 枚/q 举/v 类型/n )/wky 、/wn 指针/n 类型/n 和/cc 空/a 类型/n 。/wj 另/rz 一/m 类/q 是/vshi 结构/n 类型/n 。/wj 结构/n 类型/n 的/ude1 值/n 是/vshi 由/p 若干/m 成分/n 按/p 某种/rz 结构/n 组成/v 的/ude1 ，/wd 因此/c 是/vshi 可以/v 分解/v 的/ude1 ，/wd 并且/c 它/rr 的/ude1 成分/n 可以/v 是非/n 结构/n 的/ude1 ，/wd 也/d 可以/v 是/vshi 结构/n 的/ude1 。/wj 例如/v 数组/n 的/ude1 值/n 由/p 若干/m 分量/n 组成/v ，/wd 每个/r 分量/n 可以/v 是/vshi 整数/n ，/wd 也/d 可以/v 是/vshi 数组/n 等/udeng 。/wj 在/p 某种/rz 意义/n 上/f ，/wd 数据/n 结构/n 可以/v 看成/v 是/vshi “/wyz 一/m 组/q 具有/v 相同/a 结/v 梅/ng 的/ude1 值/n ”/wyy ，/wd 则/c 结构/n 类型/n 可以/v 看成/v 由/p 一/m 种/q 数据/n 结构/n 和/cc 定义/n 在/p 其/rz 上/f 的/ude1 一/m 组/q 操作/vn 组成/vn 。/wj 
    实际上/d ，/wd 在/p 计算机/n 中/f ，/wd 数据/n 类型/n 的/ude1 概念/n 并非/v 局限/vi 于/p 高级语言/n 中/f ，/wd 每个/r 处理器/n ①/m (/wkz 包括/v 计算机硬件/n 系统/n 、/wn 操作系统/nl 、/wn 高级语言/n 、/wn 数据库/n 等/udeng )/wky 都/d 提供/v 了/ule 一/m 组/q 原子/n 类型/n 或/c 结构/n 类型/n 。/wj 例如/v ，/wd 一个/mq 计算机硬件/n 系统/n 通常/d 含有/v “/wyz 位/ng ”/wyy 、/wn “/wyz 字节/n ”/wyy 、/wn “/wyz 字/n ”/wyy 等/udeng 原子/n 类型/n ，/wd 它们/rr 的/ude1 操作/vn 通过/p 计算机设计/n 的/ude1 一/m 套/q 指令/n 系统/n 直接/ad 由/p 电路系统/n 完成/v ，/wd 而/cc 高级/a 程序/n 语言/n 提供/v 的/ude1 数据/n 类型/n ，/wd 其/rz 操作/v 需/v 通过/p 编译器/n 或/c 解释器/n 转化/v 成/v 低/a 层/qv 即/v 汇编语言/n 或机器/n 语言/n 的/ude1 数据/n 类型/n 来/vf 实现/v 。/wj 引入/v “/wyz 数据/n 类型/n ”/wyy 的/ude1 目的/n ，/wd 从/p 硬件/n 的/ude1 角度看/n ，/wd 是/vshi 作为/p 解释/v 计算机内存/n 中/b 信息/n 含义/n 的/ude1 一/m 种/q 手段/n ，/wd 而/cc 对/p 使用/v 数据/n 类型/n 的/ude1 用户/n 来说/uls ，/wd 实现/v 了/ule 信息/n 的/ude1 隐蔽/a ，/wd 即将/d 一切/rz 用户/n 不必/d 了解/v 的/ude1 细节/n 都/d 封装/v 在/p 类型/n 中/f 。/wj 
例如/v ，/wd 用户/n 在/p 使用/v “/wyz 整数/n ”/wyy 类型/n 时/ng ，/wd 既/c 不/d 需要/v 了解/v “/wyz 整数/n ”/wyy 在/p 计算机内部/n 是/vshi 如何/ryv 表示/v 的/ude1 ，/wd 也/d 不/d 需要/v 知道/v 其/rz 操作/vn 是/vshi 如何/ryv 实现/v 的/ude1 。/wj 如/v “/wyz 两/m 整数/n 求和/vi ”/wyy ，/wd 程序/n 设计者/n 注重/v 的/ude1 仅仅/d 是/vshi 其/rz “/wyz 数学/n 上/f 求/v 和/cc ”/wyy 的/ude1 抽象/a 特性/n ，/wd 而/cc 不/d 是/vshi 其/rz 硬件/n 的/ude1 “/wyz 位/ng ”/wyy 操作/v 如何/ryv 进行/vx 。/wj 
    抽象数据/n 类型/n (/wkz Abstract/x  Data/x ’/wyy rype/x 简称/n ADT/x )/wky   是/vshi 指/v 一个/mq 数学/n 模型/n 以及/cc 定义/n 在/p 该/rz 模型/n 上/f 的/ude1 一/m 组/q 操作/vn 。/wj 抽象数据/n 类型/n 的/ude1 定义/n 仅/d 取决于/v 它/rr 的/ude1 一/m 组/q 逻辑/n 特性/n ，/wd 而/cc 与/p 其/rz 在/p 计算机内部/n 如何/ryv 表示/v 和/cc 实现/v 无关/v ，/wd 即/d 不/d 论/v 其/rz 内部/f 结构/n 如何/ryv 变化/v ，/wd 只要/c 它/rr 的/ude1 数学/n 特性/n 不/d 变/v ，/wd 都/d 不/d 影响/v 其/rz 外部/f 的/ude1 使用/vn 。/wj 
　　抽象数据/n 类型/n 和/cc 数据/n 类型/n 实质/n 上/f 是/vshi 一个/mq 概念/n 。/wj 例如/v ，/wd 各个/rz 计算机/n 都/d 拥有/v 的/ude1 “/wyz 整数/n ”/wyy 类型/n 是/vshi 一个/mq 抽象数据/n 类型/n ，/wd 尽管/c 它们/rr 在/p 不同/a 处理器/n 上/f 实现/v 的/ude1 方法/n 可以/v 不同/a ，/wd 但/c 由于/p 其/rz 定义/n 的/ude1 数学/n 特性/n 相同/a ，/wd 在/p 用户/n 看来/v 都/d 是/vshi 相同/a 的/ude1 。/wj 因此/c ，/wd “/wyz 抽象/a ”/wyy 的/ude1 意义/n 在于/v 数据/n 类型/n 的/ude1 数学/n 抽象/a 特性/n 。/wj 
    另一方面/c ，/wd 抽象数据/n 类型/n 的/ude1 范畴/n 更/d 广/a ，/wd 它/rr 不再/d 局限/vi 于/p 前述/b 各/rz 处理器/n 中/f 已/d 定义/v 并/cc 实现/v 的/ude1 数据/n 类型/n (/wkz 也/d 可/v 称/v 这/rzv 类/q 数据/n 类型/n 为/p 固有数据/n 类型/n )/wky ，/wd 还/d 包括/v 用户/n 在/p 设计/vn 软件/n 系统/n 时/ng 自己/rr 定义/v 的/ude1 数据/n 类型/n 。/wj 为了/p 提高/v 软件/n 的/ude1 复用/vn 率/v ，/wd 在/p 近代/t 程序设计/n 方法/n 学/v 中/f 指出/v ，/wd 一个/mq 软件/n 系统/n 的/ude1 框架/n 应/v 建立/v 在/p 数据/n 之上/f ，/wd 而/cc 不/d 是/vshi 建立/v 在/p 操作/vn 之上/f (/wkz 后者/rzv 是/vshi 传统/n 的/ude1 软件/n 设计/vn 方法/n 所/usuo 为/v )/wky 。/wj 即/v 在/p 构成/v 软件/n 系统/n 的/ude1 每个/r 相对/d 独立/a 的/ude1 模块/n 上/f ，/wd 定义/v 一/m 组/q 数据/n 和/cc 施/v 于/p 这些/rz 数据/n 上/f 的/ude1 一/m 组/q 操作/vn ，/wd 并/cc 在/p 模块/n 内部/f 给/v 出/vf 这些/rz 数据/n 的/ude1 表示/vn 及其/cc 操作/vn 的/ude1 细节/n ，/wd 而/cc 在/p 模块/n 外部/f 使用/v 的/ude1 只/d 是/vshi 抽象/a 的/ude1 数据/n 和/cc 抽象/a 的/ude1 操作/vn 。/wj 显然/a ，/wd 所/usuo 定义/v 的/ude1 数据/n 类型/n 的/ude1 抽象/a 层次/n 越/d 高/a ，/wd 含有/v 该/rz 抽象数据/n 类型/n 的/ude1 软件/n 模块/n 的/ude1 复用/vn 程度/n 也/d 就/d 越/d 高/a 。/wj 
    一个/mq 含/v 抽象数据/n 类型/n 的/ude1 软件/n 模块/n 通常/d 应/v 包含定义/n 、/wn 表示/v 和/cc 实现/v 三/m 个/q 部分/n 。/wj 
    如前所述/vl ，/wd 抽象数据/n 类型/n 的/ude1 定义/n 由/p 一个/mq 值域/n 和/cc 定义/n 在/p 该/rz 值域/n 上/f 的/ude1 一/m 组/q 操作/vn 组成/vn 。/wj 若/c 按/p 其/rz 值/n 的/ude1 不同/a 特性/n ，/wd 可/c 细分/v 为/p 下列/b 三/m 种/q 类型/n ：/wp 
    原子/n 类型/n (/wkz Atomic/x  Data/x  Type/x )/wky 属/v 原子/n 类型/n 的/ude1 变量/n 的/ude1 值/n 是/vshi 不可/v 分解/v 的/ude1 。/wj 这/rzv 类/q 抽象数据/n 类型/n 较/d 少/a ，/wd 因为/c 一般/a 情况/n 下/f ，/wd 已/d 有/vyou 的/ude1 固有数据/n 类型/n 足以/d 满足/v 需求/n 。/wj 但/c 有时/d 也/d 有/vyou 必要/a 定义新/n 的/ude1 原子/n 数据/n 类型/n ，/wd 例如/v 数位/n 为/p 100/m 的/ude1 整数/n 。/wj 
    固定/a 聚合/vn 类型/n (/wkz Fixed-aggregate/x  Data/x  Type/x )/wky 属/v 该/rz 类型/n 的/ude1 变量/n ，/wd 其/rz 值/n 由/p 确定/v 数目/n 的/ude1 成分/n 按/p 某种/rz 结构/n 组成/v 。/wj 例如/v ，/wd 复数/n 是/vshi 由/p 两/m 个/q 实数/n 依/v 确定/v 的/ude1 次序/n 关系/n 构成/v 。/wj 
    可变/vn 聚合/vn 类型/n (/wkz Variable―Aggregate/x  Data/x  Type/x )/wky   和/cc 固定/a 聚合/vn 类型/n 相/d 比较/v ，/wd 构成/v 可变/vn 聚合/vn 类型/n “/wyz 值/n ”/wyy 的/ude1 成分/n 的/ude1 数目/n 不/d 确定/v 。/wj 例如/v ，/wd 可/v 定义/n 一个/mq “/wyz 有序/a 整数/n 序列/n ”/wyy 的/ude1 抽象数据/n 类型/n ，/wd 其中/rz 序列/n 的/ude1 长度/n 是/vshi 可/v 变/v 的/ude1 。/wj 
    显然/a ，/wd 后/f 两/m 种/q 类型/n 可/v 统称/v 为/p 结构/n 类型/n 。/wj 
    和/cc 数据/n 结构/n 的/ude1 形式/n 定义/n 相/d 对应/vi ，/wd 抽象数据/n 类型/n 可用/v 以下/f 三/m 元/q 组/n 表示/v 
    (/wkz D/x ，/wd S/x ，/wd P/x )/wky     (/wkz 1―4/m )/wky 
其中/rz ，/wd D/x 是/vshi 数据/n 对象/n ，/wd s/x 是/vshi D/x 上/f 的/ude1 关系/n 集/vg ，/wd P/x 是/vshi 对/p D/x 的/ude1 基本/ad 操作/v 集/vg 。/wj 本书/r 采用/v 以下/f 格式定义/n 抽象数据/n 类型/n ：/wp 
    ADT/x 抽象数据/n 类型/n 名/q {/n 
    数据/n 对象/n ：/wp </n 数据/n 对象/n 的/ude1 定义/n >/n 
    数据/n 关系/n ：/wp </n 数据/n 关系/n 的/ude1 定义/n >/n 
    基本/ad 操作/v ：/wp (/wkz 基本/ad 操作/v 的/ude1 定义/n )/wky 
    }/n ADT/x 抽象数据/n 类型/n 名/q 
其中/rz ，/wd 数据/n 对象/n 和/cc 数据/n 关系/n 的/ude1 定义/n 用/v 伪/ag 码/v 描述/vn ，/wd 基本/ad 操作/v 的/ude1 定义/n 格式/n 为/v 
    基本/ad 操作/v 名/q (/wkz 参数表/n )/wky 
    初始条件/n ：/wp (/wkz 初始条件/n 描述/v )/wky 
    操作/v 结果/n ：/wp (/wkz 操作/v 结果/n 描述/v )/wky 
基本/ad 操作/v 有/vyou 两/m 种/q 参数/n ：/wp 赋值/v 参数/n 只/d 为/v 操作/v 提供/v 输入/vn 值/n ；/wf 引用/v 参数/n 以/p &/n 打头/vi ，/wd 除/p 可/v 提供/v 输入/vn 值/n 外/f ，/wd 还/d 将/d 返回操作/n 结果/n 。/wj “/wyz 初始条件/n ”/wyy 描述/v 了/ule 操作执行/n 之前/f 数据/n 结构/n 和/cc 参数/n 应/v 满足/v 的/ude1 条件/n ，/wd 若/c 不/d 满足/v ，/wd 则/c 操作失败/n ，/wd 并/cc 返回/v 相应/vd 出错/vi 信息/n 。/wj “/wyz 操作/vn 结果/n ”/wyy 说明/v 了/ule 操作/vn 正常/ad 完成/v 之后/f ，/wd 数据/n 结构/n 的/ude1 变化/vn 状况/n 和/cc 应/v 返回/v 的/ude1 结果/n 。/wj 若/c 初始条件/n 为/v 空/ng ，/wd 则/c 省略/v 之/uzhi 。/wj 
    例/n l/x 一/m 6/m 抽象数据/n 类型/n 三元/b 组/n 的/ude1 定义/n ：/wp 
ADT/x  Triplet/x {/n 
    数据/n 对象/n ：/wp D=/x {/n e1/x ，/wd e2/x ，/wd e3l/x  el/x 。/wj e2/x ，/wd e3∈EleraSer：/x (/wkz 定义/n 了/ule 关系/n 运算/vn 的/ude1 某个/rz 集合/n )/wky }/n 
    数据/n 关系/n ：/wp R1=/x {/n </n e1/x ，/wd e2/x >/n ，/wd </n e2/x ，/wd e3/x >/n }/n 
    基本/ad 操作/v ：/wp 
    InitTriplet/x (/wkz &/n T/x ，/wd vl/x ，/wd 、/wn r2/x ，/wd v3/x )/wky 
    操作/v 结果/n ：/wp 构造/v 了/ule 三/m 元/q 组/n T/x ，/wd 元素/n el/x ，/wd e2/x 和/cc e3/x 分别/d 被/pbei 赋/v 以/p 参数/n v1/x ，/wd v2/x 和/cc v3/x 的/ude1 值/n 。/wj 
    DestroyTriplet/x (/wkz &/n T/x )/wky     ．/w 
    操作/v 结果/n ：/wp 三/m 元/q 组/n T/x 被/pbei 销毁/v 。/wj 
    Get：/x (/wkz T/x ，/wd i/x ，/wd &/n e/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v ，/wd l≤i≤3/x 。/wj 
    操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 。/wj 
    Put/x (/wkz &/n T/x ，/wd i/x ，/wd e/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v ，/wd 1≤i≤3/x 。/wj 
    操作/v 结果/n ：/wp 改变/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 为/v e/x 。/wj 
    IsAscending/x (/wkz T/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 升序/n 排列/v ，/wd 则/c 返回/v 1/m ，/wd 否则/c 返回/v 0/m 。/wj 
    IsDescending/x (/wkz T/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 降序/n 排列/v ，/wd 则/c 返回/v 1/m ，/wd 否则/c 返回/v O/x 。/wj 
    Max/x (/wkz T/x ，/wd &/n e/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 三/m 个/q 元素/n 中/f 的/ude1 最/d 大值/n 。/wj 
    Min/x (/wkz T/x ，/wd &/n e/x )/wky 
    初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 三/m 个/q 元素/n 中/f 的/ude1 最/d 小/a 值/n 。/wj 
I/x  ADT/x  Triplet/x 
    多/m 形/ng 数据/n 类型/n (/wkz Polymorphic/x  Data/x 。/wj Type/x )/wky   是/vshi 指/v 其/rz 值/n 的/ude1 成分/n 不/d 确定/v 的/ude1 数据/n 类型/n 。/wj 例如/v ，/wd 例/n 1―6/m 中/b 定义/n 的/ude1 抽象数据/n 类型/n Triplet/x ，/wd 其/rz 元素/n e1/x 、/wn e2/x 和/cc e3/x 可以/v 是/vshi 整数/n 或/c 字符/n 或/c 字符串/n ，/wd 甚至/c 更/d 复杂/a 地/ude2 由/p 多/m 种/q 成分/n 构成/v (/wkz 只要/c 能/v 进行/vx 关系/n 运算/vn 即可/v )/wky 。/wj 然而/c ，/wd 不论/c 其/rz 元素/n 具有/v 何种/r 特性/n ，/wd 元素/n 之间/f 的/ude1 关系/n 相同/a ，/wd 基本/ad 操作/v 亦/d 相同/a 。/wj 从/p 抽象数据/n 类型/n 的/ude1 角度看/n ，/wd 具有/v 相同/a 的/ude1 数学/n 抽象/a 特性/n ，/wd 故/c 称之为/v 多/m 形/ng 数据/n 类型/n 。/wj 显然/a ，/wd 需/v 借助/v 面向对象/n 的/ude1 程序设计/n 语言/n 如/v C++/x 等/udeng 实现/v 之/uzhi 。/wj 本/rz 书/n 中/f 讨论/v 的/ude1 各种/rz 数据/n 类型/n 大多/d 是/vshi 多/m 形/ng 数据/n 类型/n ，/wd 限于/v 本书/r 采用/v 类/n C/x 语言/n 作为/v 描述/vn 工具/n ，/wd 故/c 只/d 讨论/v 含有/v 确定/v 成分/n 的/ude1 数据/n 元素/n 的/ude1 情况/n 。/wj 如/v 例/n 1―6/m 中/f 的/ude1 ElemSet/x 是/vshi 某个/rz 确定/v 的/ude1 、/wn 将/d 由/p 用户/n 自行/d 定义/v 的/ude1 、/wn 含/v 某个/rz 关系/n 运算/vn 的/ude1 数据/n 对象/n 。/wj 
1．3/m 抽象数据/n 类型/n 的/ude1 表示/vn 与/cc 实现/v 
    抽象数据/n 类型/n 可/v 通过/p 固有数据/n 类型/n 来/vf 表示/v 和/cc 实现/v ，/wd 即/d 利用/v 处理器/n 中/f 已/d 存在/v 的/ude1 数据/n 类型/n 来/vf 说明/v 新/a 的/ude1 结构/n ，/wd 用/p 已经/d 实现/v 的/ude1 操作/vn 来/f 组合/vi 新/a 的/ude1 操作/vn 。/wj 由于/p 本书/r 在/p 高级/a 程序设计/n 语言/n 的/ude1 虚拟/vn 层次/n 上/f 讨论/v 抽象数据/n 类型/n 的/ude1 表示/vn 和/cc 实现/v ，/wd 并且/c 讨论/v 的/ude1 数据/n 结构/n 及其/cc 算法/n 主要/d 是/vshi 面向/v 读者/n ，/wd 故/c 采用/v 介于/v 伪/ag 码/v 和/cc c/x 语言/n 之间/f 的/ude1 类/n C/x 语言/n 作为/v 描述/vn 工具/n ，/wd 有时/d 也/d 用/v 伪/ag 码/v 描述/v 一些/mq 只/d 含/v 抽象/a 操作/vn 的/ude1 抽象/a 算法/n 。/wj 这/rzv 使得/vi 数据/n 结构/n 和/cc 算法/n 的/ude1 描述/vn 和/cc 讨论/v 简明/a 清晰/a ，/wd 不/d 拘泥/vi 于/p C/x 语言/n 的/ude1 细节/n ，/wd 又/d 能/v 容易/ad 转换/v 成/v C/x 或者/c c++/x 程序/n 。/wj 
    本书/r 采用/v 的/ude1 类/n C/x 语言/n 精选/v 了/ule C/x 语言/n 的/ude1 一个/mq 核心/n 子集/n ，/wd 同时/c 作/v 了/ule 若干/m 扩充/v 修改/v ，/wd 增强/v 了/ule 语言/n 的/ude1 描述/vn 功能/n 。/wj 以下/f 对/p 其/rz 作/v 简要/ad 说明/v 。/wj 
    (/wkz 1/m )/wky 预定/v 义/ng 常量/n 和/cc 类型/n ：/wp 
    ／／/m 函数/n 结果/n 状态/n 代码/n 
    #/n define/x  TRUE/x     1/m 
    #/n define/x  FALSE/x     0/m 
    #/n define/x  0K/x     1/m 
    #/n define/x  ERROR/x     O/x 
    #/n define/x  INFEASIBLE/x   -/wp l/x 
    #/n defiae/x  OVERFLOW/x   -/wp 2/m 
    ∥/w Status/x 是/vshi 函数/n 的/ude1 类型/n ，/wd 其/rz 值/n 是/vshi 函数/n 结果/n 状态/n 代码/n 
    typedef/x   int/x   Status/x ；/wf 
    (/wkz 2/m )/wky 数据/n 结构/n 的/ude1 表示/v (/wkz 存储/vn 结构/n )/wky 用/p 类型定义/n (/wkz typedef/x )/wky 描述/v 。/wj 数据/n 元素/n 类型/n 约定/vd 为/v ElemType/x ，/wd 由/p 用户/n 在/p 使用/v 该/rz 数据/n 类型/n 时/ng 自行/d 定义/v 。/wj 
    (/wkz 3/m )/wky 基本/ad 操作/v 的/ude1 算法/n 都/d 用/v 以下/f 形式/n 的/ude1 函数/n 描述/v ：/wp 
函数/n 类型/n 函数/n 名/q (/wkz 函数参数/n 表/vg )/wky 
  ∥/w 算法/n 说明/v 
  语句/n 序列/n 
I/x ∥/w 函数/n 名/q 
除了/p 函数/n 的/ude1 参数/n 需要/v 说明/v 类型/n 外/f ，/wd 算/v 法/n 中/f 使用/v 的/ude1 辅助变量/n 可以/v 不/d 作/v 变量/n 说明/v ，/wd 必要/a 时/ng 对/p 其/rz 作用/n 给予/vx 注释/vn 。/wj 一般而言/vl ，/wd a/x 、/wn b/x 、/wn c/x 、/wn d/x 、/wn e/x 等/udeng 用作/v 数据/n 元素/n 名/q '/n i/x 、/wn j/x 、/wn k/x 、/wn l/x 、/wn m/x 、/wn n/x 等/udeng 用作/v 整/m 型/k 变量名/n ，/wd p/x 、/wn q/x 、/wn r/x 等/udeng 用作/v 指针/n 变量名/n 。/wj 当/p 函数/n 返回/v 值/v 为/p 函数/n 结果/n 状态/n 代码/n 时/ng ，/wd 函数定义/n 为/v Status/x 类型/n 。/wj 为了/p 便于/v 算法/n 描述/vn ，/wd 除了/p 值/n 调用/v 方式/n 外/f ，/wd 增添/v 了/ule c++/x 语言/n 的/ude1 引用/v 调用/v 的/ude1 参数传递/n 方式/n 。/wj 在/p 形/ng 参/vg 表/n 中/f ，/wd 以/p &/n 打头/vi 的/ude1 参数/n 即/d 为/v 引用/v 参数/n 。/wj 
  (/wkz 4/m )/wky 赋值/v 语句/n 有/vyou 
简单/ad 赋值/v 变量名/n =/m 表达式/n ；/wf 
串联/v 赋值/v 变量名/n 1=/m 变量名/n 2/m ～/ws 一/m 变量名/n k=/x 表达式/n ；/wf 
成/v 组/n 赋值/v (/wkz 变量名/n 1/m ，/wd …/ws ，/wd 变量名/n k/x )/wky =/m (/wkz 表达式/n 1/m ，/wd …/ws ，/wd 表达式/n k/x )/wky ；/wf 
    结构/n 名/q =/m 结构/n 名/q ；/wf 
    结构/n 名/q =/m (/wkz 值/v 1/m ，/wd …/ws ，/wd 值/v k/x )/wky ；/wf 
    变量名/n [/wkz ]/wky =/m 表达式/n ；/wf 
    变量名/n [/wkz 起始/vn 下标/n ．/w ．/w 终止/v 下标/n ]/wky =/m 变量名/n [/wkz 起始/vn 下标/n ．/w ．/w 终止/v 下标/n ]/wky ；/wf 
交换/v 赋值/v 变量名/n --/wp 变量名/n ；/wf 
条件/n 赋值/v 变量名/n ：/wp 条件/n 表达式/n ?/ww 表达式/n T：/x 表达式/n F/x ；/wf 
(/wkz 5/m )/wky 选择/v 语句/n 有/vyou 
条件/n 语句/n l/x  if/x (/wkz 表达式/n )/wky 语句/n ；/wf 
条件/n 语句/n 2/m  if/x (/wkz 表达式/n )/wky 语句/n ；/wf 
    else/x 语句/n ；/wf 
开关/n 语句/n 1/m 蹦/v itch/x (/wkz 表达式/n )/wky {/n 
case/x 值/n 1：/m 语句/n 序列/n 1/m ；/wf break/x ；/wf 
    case/x 值/n n：/x 语句/n 序列/n n/x ；/wf break/x ；/wf 
    default：/x 语句/n 序列/n n+1/x ；/wf 
    }/n 
开关/n 语句/n 2/m  switch/x {/n 
    case/x 条件/n 1：/m 语句/n 1/m ；/wf break/x ；/wf 
case/x 条件/n n：/x 语句/n n/x ；/wf break/x ；/wf 
default：/x 语句/n n+1/x ；/wf 
(/wkz 6/m )/wky 循环/vn 语句/n 有/vyou 
for/x 语句/n     for/x (/wkz 赋/v 初值/n 表达式/n 序列/n j/x 条件/n ；/wf 修改/v 表达式/n 序列/n )/wky 语句/n ；/wf 
while/x 语句/n     while/x (/wkz 条件/n )/wky 语句/n ；/wf 
do/x  while/x 语句/n do/x {/n 
    语句/n 序列/n ；/wf 
    }/n while/x (/wkz 条件/n )/wky ；/wf 
(/wkz 7/m )/wky 结束语/n 句/q 有/vyou 
函数/n 结束语/n 句/q     return/x 表达式/n ；/wf 
    return/x ；/wf 
case/x 结束语/n 句/q     break/x ；/wf 
异常/a 结束语/n 句/q     exit/x (/wkz 异常/a 代码/n )/wky ；/wf 
(/wkz 8/m )/wky 输入/v 和/cc 输出/vn 语句/n 有/vyou 
输入/v 语句/n  scanf/x (/wkz [/wkz 格式串/n ]/wky ，/wd 变量/n 1/m …/ws ．/w ，/wd 变量/n n/x )/wky ；/wf 
输出/v 语句/n  printf/x (/wkz [/wkz 格式串/n ]/wky ，/wd 表达式/n 1/m …/ws ．/w ，/wd 表达式/n n/x )/wky ；/wf 
通常/d 省略/v 格式串/n 。/wj 
    (/wkz 9/m )/wky 注释/n 
    单行/b 注释/n ∥/w 文字/n 序列/n 
    (/wkz 10/m )/wky 基本/a 函数/n 有/vyou 
求/v 最/d 大值/n   max/x (/wkz 表达式/n 1/m ，/wd …/ws ，/wd 表达式/n n/x )/wky 
求/v 最/d 小/a 值/n  min/x (/wkz 表达式/n l/x ，/wd …/ws ，/wd 表达式/n n/x )/wky 
求/v 绝对值/n  abs/x (/wkz 表达式/n )/wky 
求/v 不足/v 整/m 数值/n  floor/x (/wkz 表达式/n )/wky 
求/v 进位/v 整数/n 值/n   ceil/x (/wkz 表达式/n )/wky 
判定/v 文件/n 结束/v   eof/x (/wkz 文件/n 变量/n )/wky 或/c eof/x 
判定/v 行/ng 结束/v  eoln/x (/wkz 文件/n 变量/n )/wky 或/c eoln/x 
(/wkz 11/m )/wky 逻辑运算/n 约定/vn 
与/p 运算/vn &/n &/n ：/wp 对于/p A/x ＆/n ＆/n B/x ，/wd 当/v A/x 的/ude1 值/n 为/p 0时/t ，/wd 不再/d 对/p B/x 求/v 值/n 。/wj 
或/c 运算/vn Il：/x 对于/p A/x  lIB/x ，/wd 当/v A/x 的/ude1 值/n 为/p 非/b 0时/t ，/wd 不再/d 对/p B/x 求/v 值/n 。/wj 
例/n 1―7/m 抽象数据/n 类型/n Triplet/x 的/ude1 表示/vn 和/cc 实现/v 。/wj 
∥/w ---/wp 采用/v 动态分配/n 的/ude1 顺序/n 存储/vn 结构/n ---/wp 
typedef/x  ElemType/x */n Triplet/x ；/wf ∥/w 由/p InitTriplet/x 分配/v 三/m 个/q 元素/n 存储空间/n 
∥/w ---/wp 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v ---/wp 
Status/x  InitTriplet/x (/wkz Triplet/x ＆/n T/x ，/wd ElemType/x  vl/x ，/wd ElemType/x  v2/x ，/wd ElemType/x  v3/x )/wky ；/wf 
  ∥/w 操作/v 结果/n ：/wp 构造/v 了/ule 三/m 元/q 组/n T/x ，/wd 元素/n e1/x ，/wd e2/x 和/cc e3/x 分别/d 被/pbei 赋/v 以/p 参数/n v1/x ，/wd v2/x 和/cc v3/x 的/ude1 值/n 。/wj 
Status/x  DestroyTriplet/x (/wkz Triplet/x &/n T/x )/wky ；/wf 
  ∥/w 操作/v 结果/n ：/wp 二元/b 组/n T/x 被/pbei 销毁/v 。/wj 
Status/x  Get/x (/wkz Triplet/x  T/x ，/wd int/x  i/x ，/wd ElemType/x &/n e/x )/wky ；/wf 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v ，/wd l≤i≤3/x 。/wj 
  ∥/w 操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 。/wj 
Status/x  Put/x (/wkz Triplet/x ＆/n T/x ，/wd int/x  i/x ，/wd ElemType/x  e/x )/wky ；/wf 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v ，/wd 1≤i≤3/x 。/wj 
  ∥/w 操作/v 结果/n ：/wp 改变/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 为/v e/x 。/wj 
Status/x  IsAscending/x (/wkz Triplet/x  T/x )/wky ；/wf 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
  ∥/w 操作/v 结果/n ：/wp 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 升序/n 排列/v ，/wd 则/c 返回/v 1/m ，/wd 否则/c 返回/v 0/m 。/wj 
Status/x  IsDescending/x (/wkz Triplet/x  T/x )/wky ；/wf 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
  ∥/w 操作/v 结果/n ：/wp 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 降序/n 排列/v ，/wd 则/c 返回/v 1/m ，/wd 否则/c 返回/v 0/m 。/wj 
Status/x  Max/x (/wkz Triplet/x  T．ElemType/x &/n e/x )/wky ；/wf ，/wd 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
  ∥/w 操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 三/m 个/q 元素/n 中/f 的/ude1 最/d 大值/n 。/wj 
Status/x  Min/x (/wkz Triplet/x  T/x ，/wd ElemType/x &/n e/x )/wky ；/wf 
  ∥/w 初始条件/n ：/wp 三/m 元/q 组/n T/x 已/d 存在/v 。/wj 
  ∥/w 操作/v 结果/n ：/wp 用/v e/x 返回/v T/x 的/ude1 三/m 个/q 元素/n 中/f 的/ude1 最/d 小/a 值/n 。/wj 
∥/w 基本/ad 操作/v 的/ude1 实现/vn 
Status/x  InitTriplet/x (/wkz Triplet/x ＆/n T/x ，/wd ElemType/x  vl/x ，/wd ElemType/x  v2/x ，/wd ElemType/x  v3/x )/wky {/n 
  ∥/w 构造/n 三元/b 组/n T/x ，/wd 依次/d 置/v T/x 的/ude1 三/m 个/q 元素/n 的/ude1 初值/n 为/v vl/x ，/wd v2/x 和/cc v3/x 。/wj 
  T=/x (/wkz ElemType/x */n )/wky malloc/x (/wkz 3/m */n sizeof/x (/wkz ElemType/x )/wky )/wky ；/wf   ∥/w 分配/v 3/m 个/q 元素/n 的/ude1 存储空间/n 
  if/x (/wkz !/wt T/x )/wky exit/x (/wkz OVFaFUO/x ~/n )/wky ；/wf   ∥/w 分配存储/n 空间/n 失败/vi 
  T/x [/wkz 0/m ]/wky ：/wp vl/x ；/wf T/x [/wkz 1/m ]/wky ：/wp v2/x ；/wf T/x [/wkz 2/m ]/wky =v3/x ；/wf 
  return/x  OK/x ；/wf 
}/n ∥/w InitTriplet/x 
 Status/x  DestroyTriplet/x (/wkz Triplet/x &/n T/x )/wky {/n 
  ∥/w 销毁/v 三元/b 组/n T0/x 
  free/x (/wkz T/x )/wky ；/wf T=NULL/x ；/wf 
  return/x  OK/x ；/wf 
}/n //n //n DestroFTriplet/x 
 Status/x  Get/x (/wkz Triplet/x  T/x ，/wd int/x  i/x ，/wd ElemType/x &/n e/x )/wky {/n 
  ∥/w 1≤i≤3/x ，/wd 用/v e/x 返回/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 。/wj 
  if/x (/wkz i/x </n 1/m  ll/x  i/x >/n 3/m )/wky return/x  ERROR/x ；/wf 
  e=Tli―I/x  J/x ；/wf 
  return/x  OK/x ；/wf 
}/n ∥/w Get/x 
 Status/x  Put/x (/wkz Triplet/x ＆/n T/x ，/wd int/x  i/x ，/wd ElemType/x  e/x )/wky {/n 
  ∥/w l≤i≤3/x ，/wd 置/v T/x 的/ude1 第/m i/x 元/q 的/ude1 值/n 为/v e/x 。/wj 
  if/x (/wkz i/x </n 1/m  |/n |/n  i/x >/n 3/m )/wky return/x  ERROR/x ；/wf 
  T/x [/wkz i-1/x ]/wky =e/x ；/wf 
  return/x  OK/x ；/wf 
}/n //n //n Put/x 
 Status/x  IsAscending/x (/wkz Triplet/x  T/x )/wky {/n 
  ∥/w 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 升序/n 排列/v ，/wd 则/c 返回/v 1/m ，/wd 否则/c 返回/v 0/m 。/wj 
  return/x (/wkz T/x [/wkz 0/m ]/wky </n =T/x [/wkz 1/m ]/wky )/wky &/n &/n (/wkz T/x [/wkz 1/m ]/wky </n =T/x [/wkz 2/m ]/wky )/wky ；/wf 
}/n   ∥/w IsAscending/x 
Status/x  IsDescending/x (/wkz Triplet/x  T/x )/wky {/n 
  ∥/w 如果/c T/x 的/ude1 三/m 个/q 元素/n 按/p 降序/n 排列/v ，/wd 则/c 返回/v l/x ，/wd 否则/c 返回/v 0/m 。/wj 
  return/x (/wkz T/x [/wkz 0/m ]/wky >/n =T/x [/wkz 1/m ]/wky )/wky &/n &/n (/wkz T/x [/wkz 1/m ]/wky >/n =T/x [/wkz 2/m ]/wky )/wky ；/wf 
}/n ∥/w IsDescendlng/x 
Status/x  Max/x (/wkz Triplet/x  T/x ，/wd ElemType/x &/n e/x )/wky {/n 
  ∥/w 用/v e/x 返回/v 指向/v T/x 的/ude1 最/d 大/a 元素/n 的/ude1 值/n 。/wj 
  e=/x (/wkz T/x [/wkz 0/m ]/wky >/n ：/wp T/x [/wkz 1/m ]/wky )/wky ?/ww (/wkz (/wkz T/x [/wkz 0/m ]/wky >/n =T/x [/wkz 2/m ]/wky )/wky ?/ww T/x [/wkz 0/m ]/wky ：/wp T/x [/wkz 2/m ]/wky )/wky 
    ：/wp (/wkz (/wkz T/x [/wkz 1/m ]/wky >/n =T/x [/wkz 2/m ]/wky )/wky ?/ww T/x [/wkz 1/m ]/wky ：/wp T/x [/wkz 2/m ]/wky )/wky ；/wf 
  return/x  OK：/x 
}/n ∥/w Max/x 
Status/x  Min/x (/wkz Triplet/x  T/x ，/wd ElemType/x &/n e/x )/wky {/n 
  ∥/w 用/v e/x 返回/v 指向/v T/x 的/ude1 最/d 小/a 元素/n 的/ude1 值/n 。/wj 
  e=/x (/wkz T/x [/wkz 0/m ]/wky </n =T/x [/wkz 1/m ]/wky )/wky ?/ww (/wkz (/wkz T/x [/wkz 0/m ]/wky </n ：/wp T/x [/wkz 2/m ]/wky )/wky ?/ww T/x [/wkz 0/m ]/wky ：/wp T/x [/wkz 2/m ]/wky )/wky 
    ：/wp (/wkz (/wkz T/x [/wkz 1/m ]/wky </n =T/x [/wkz 2/m ]/wky )/wky ?/ww T/x [/wkz 1/m ]/wky ：/wp T/x [/wkz 2/m ]/wky )/wky ；/wf 
  rettrm/x  OK/x ；/wf 
}/n ∥/w Min/x 
    1．4/m 算法/n 和/cc 算法/n 分析/vn 
    1．4．1/m 算法/n 
    算法/n (/wkz Algorithm/x )/wky   是/vshi 对/p 特定/b 问题/n 求解/vi 步骤/n 的/ude1 一/m 种/q 描述/vn ，/wd 它/rr 是/vshi 指令/n 的/ude1 有限/a 序列/n ，/wd 其中/rz 每/rz 一/m 条/q 指令/n 表示/v 一个/mq 或/c 多/m 个/q 操作/vn ；/wf 此外/c ，/wd 一个/mq 算法/n 还/d 具有/v 下列/b 五/m 个/q 重要/a 特性/n ：/wp 
    (/wkz 1/m )/wky 有/vyou 穷/a 性/n 一个/mq 算法/n 必须/d 总是/d (/wkz 对/p 任何/rz 合法/a 的/ude1 输入/vn 值/n )/wky 在/p 执行/v 有/vyou 穷/a 步/qv 之后/f 结束/v ，/wd 且/c 每/rz 一/m 步/qv 都/d 可/v 在/p 有/vyou 穷/a 时间/n ①/m 内/f 完成/v ；/wf 
    (/wkz 2/m )/wky 确定性/n 算法/n 中/f 每/rz 一/m 条/q 指令/n 必须/d 有/vyou 确切/a 的/ude1 含义/n ，/wd 读者/n 理解/v 时/ng 不/d 会/v 产生/v 二义性/n 。/wj 并且/c ，/wd 在/p 任何/rz 条件/n 下/f ，/wd 算法/n 只有/c 唯一/b 的/ude1 一/m 条/q 执行/vn 路径/n ，/wd 即/d 对于/p 相同/a 的/ude1 输入/vn 只能/v 得出/v 相同/a 的/ude1 输出/vn 。/wj 
    (/wkz 3/m )/wky 可行性/n 一个/mq 算法/n 是/vshi 能/v 行/vi 的/ude1 ，/wd 即/v 算法/n 中/f 描述/v 的/ude1 操作/vn 都/d 是/vshi 可以/v 通过/p 已经/d 实现/v 的/ude1 基本/a 运算/vn 执行/v 有限/a 次/qv 来/vf 实现/v 的/ude1 。/wj 
    (/wkz 4/m )/wky 输/v 人/n   一个/mq 算法/n 有/vyou 零/m 个/q 或/c 多/m 个/q 的/ude1 输入/vn ，/wd 这些/rz 输入/v 取/v 自/rr 于/p 某个/rz 特定/b 的/ude1 对象/n 的/ude1 集合/n 。/wj 
    (/wkz 5/m )/wky 输出/v   一个/mq 算法/n 有/vyou 一个/mq 或/c 多/m 个/q 的/ude1 输出/vn 。/wj 这些/rz 输出/v 是/vshi 同/p 输入/v 有着/v 某些/rz 特定/b 关系/n 的/ude1 量/n 。/wj 
  1．4．2/m 算法/n 设计/vn 的/ude1 要求/n 
  通常/d 设计/v 一个/mq “/wyz 好/a ”/wyy 的/ude1 算法/n 应/v 考虑/v 达到/v 以下/f 目标/n ：/wp 
  (/wkz 1/m )/wky 正确性/n ②/m (/wkz correct／less/x )/wky 算法/n 应当/v 满足/v 具体/a 问题/n 的/ude1 需求/n 。/wj 通常/d 一个/mq 大型/b 问题/n 的/ude1 需求/n ，/wd 要/v 以/p 特定/b 的/ude1 规格说明/n 方式/n 给/v 出/vf ，/wd 而/cc 一个/mq 实习/vn 问题/n 或/c 练习题/n ，/wd 往往/d 就/d 不/d 那么/rz 严格/a ，/wd 目前/t 多数/m 是/vshi 用/p 自然/n 语言/n 描述/vn 需求/n ，/wd 它/rr 至少/d 应当/v 包括/v 对于/p 输入/v 、/wn 输出/vn 和/cc 加工/vn 处理/vn 等/udeng 的/ude1 明确/a 的/ude1 无/v 歧义/n 性/k 的/ude1 描述/vn 。/wj 设计/v 或/c 选择/v 的/ude1 算法/n 应当/v 能/v 正确/a 地/ude2 反映/v 这种/r 需求/n ，/wd 否则/c ，/wd 算法/n 的/ude1 正确/a 与否/u 的/ude1 衡量/vn 准则/n 就/d 不/d 存在/v 了/y 。/wj 
    “/wyz 正确/a ”/wyy 一/m 词/n 的/ude1 含义/n 在/p 通常/b 的/ude1 用/p 法/n 中/f 有/vyou 很/d 大/a 差别/n ，/wd 大体/d 可/v 分为/v 以下/f 四/m 个/q 层次/n ：/wp a．/x 程序/n 不/d 含/v 语法/n 错误/n ；/wf b．/x 程序/n 对于/p 几/m 组/q 输入/vn 数据/n 能够/v 得出/v 满足/v 规格说明/n 要求/n 的/ude1 结果/n ；/wf c．/x 程序/n 对于/p 精心/ad 选择/v 的/ude1 典型/n 、/wn 苛刻/a 而/cc 带有/v 刁难/v 性/ng 的/ude1 几/m 组/q 输入/vn 数据/n 能够/v 得出/v 满足/v 规格说明/n 要求/n 的/ude1 结果/n ；/wf d．/x 程序/n 对于/p 一切/rz 合法/a 的/ude1 输入/vn 数据/n 都/d 能/v 产生/v 满足/v 规格说明/n 要求/n 的/ude1 结果/n 。/wj 显然/a ，/wd 达到/v 第/m d/x 层/qv 意义/n 下/f 的/ude1 正确/a 是/vshi 极为/d 困难/a 的/ude1 ，/wd 所有/b 不同/a 输入/vn 数据/n 的/ude1 数量/n 大/a 得/ude3 惊人/a ，/wd 逐一/d 验证/v 的/ude1 方法/n 是/vshi 不/d 现实/a 的/ude1 。/wj 对于/p 大型软件/n 需要/v 进行/vx 专业/n 测试/vn ，/wd 而/cc 一般/a 情况/n 下/f ，/wd 通常/d 以/p 第/m c/x 层/qv 意义/n 的/ude1 正确性/n 作为/v 衡量/v 一个/mq 程序/n 是否/v 合格/vi 的/ude1 标准/n 。/wj 
    (/wkz 2/m )/wky 可读性/n (/wkz Readability/x )/wky   算法/n 主要/d 是/vshi 为了/p 人/n 的/ude1 阅读/vn 与/cc 交流/vn ，/wd 其次/c 才/d 是/vshi 机器执行/n 。/wj 可读性/n 好/a 有助于/v 人/n 对/p 算法/n 的/ude1 理解/vn ；/wf 晦涩/a 难懂/a 的/ude1 程序/n 易于/vd 隐藏/v 较/d 多/a 错误/n 难以/d 调试/v 和/cc 修改/vn 。/wj 
    (/wkz 3/m )/wky 健壮性/n (/wkz Robust．ness/x )/wky   当/p 输入/v 数据/n 非法/b 时/ng ，/wd 算法/n 也/d 能/v 适当/a 地/ude2 作出/v 反应/vn 或/c 进行/vx 处理/vn ，/wd 而/cc 不/d 会/v 产生/v 莫明其妙/al 的/ude1 输出/vn 结果/n 。/wj 例如/v ，/wd 一个/mq 求/v 凸多边形/n 面积/n 的/ude1 算法/n ，/wd 是/vshi 采用/v 求/v 各/rz 三角形/n 面积/n 之和/n 的/ude1 策略/n 来/vf 解决问题/n 的/ude1 。/wj 当/p 输入/v 的/ude1 坐标/n 集合/v 表示/v 的/ude1 是/vshi 一个/mq 凹/a 多边形/a 时/ng ，/wd 不/d 应/v 继续/v 计算/v ，/wd 而/cc 应/v 报告/n 输入/v 出错/vi 。/wj 并且/c ，/wd 处理/v 出错/vi 的/ude1 方法/n 应/v 是/vshi 返回/v 一个/mq 表示/v 错误/n 或/c 错误/a 性质/n 的/ude1 值/n ，/wd 而/cc 不/d 是/vshi 打印错误/n 信息/n 或/c 异常/a ，/wd 并/cc 中止/v 程序/n 的/ude1 执行/vn ，/wd 以便/d 在/p 更/d 高/a 的/ude1 抽象/a 层次/n 上/f 进行/vx 处理/vn 。/wj 
    (/wkz 4/m )/wky 效率/n 与/cc 低/a 存储量/n 需求/n 通俗/a 地/ude2 说/v ，/wd 效率/n 指/v 的/ude1 是/vshi 算法/n 执行/vn 时间/n 。/wj 对于/p 同/p 一个/mq 问题/n 如果/c 有/vyou 多/m 个/q 算法/n 可以/v 解决/v ，/wd 执行/v 时间/n 短/a 的/ude1 算法/n 效率/n 高/a 。/wj 存储量/n 需求/n 指/v 算法/n 执行/vn 过程/n 中/f 所/usuo 需要/v 的/ude1 最/d 大/a 存储空间/n 。/wj 效率/n 与/cc 低/a 存储量/n 需求/n 这/rzv 两者/rzv 都/d 与/p 问题/n 的/ude1 规模/n 有关/vn 。/wj 求/v 100/m 个/q 人/n 的/ude1 平均/a 分/qt 与/p 求/v 1000/m 个/q 人/n 的/ude1 平均/ad 分/v 所/usuo 花/v 的/ude1 执行/vn 时间/n 或/c 运行/vn 空间/n 显然/ad 有/vyou 一定/b 的/ude1 差别/n 。/wj 
1．4．3/m 算法/n 效率/n 的/ude1 度量/n 
    算法/n 执行/vn 时间/n 需/v 通过/p 依据/n 该/rz 算法/n 编制/n 的/ude1 程序/n 在/p 计算机上运行/n 时/ng 所/usuo 消耗/v 的/ude1 时间/n 来/vf 度量/v 。/wj 而/cc 度量/v 一个/mq 程序/n 的/ude1 执行/vn 时间/n 通常/d 有/vyou 两/m 种/q 方法/n ：/wp 
    (/wkz 1/m )/wky 事后/t 统计/v 的/ude1 方法/n 。/wj 因为/p 很多/m 计算机内部/n 都/d 有/vyou 计时/vn 功能/n ，/wd 有的/rz 甚至/d 可/v 精确/ad 到/v 毫秒级/n ，/wd 不同/a 算法/n 的/ude1 程序/n 可/v 通过/p 一/m 组/q 或/c 若干/m 组/q 相同/a 的/ude1 统计/vn 数据/n 以/p 分辨/v 优劣/n 。/wj 但/c 这种/r 方法/n 有/vyou 两/m 个/q 缺陷/n ：/wp 一/m 是/vshi 必须/d 先/d 运行/vi 依据/p 算法/n 编制/n 的/ude1 程序/n ；/wf 二/m 是/vshi 所得/n 时间/n 的/ude1 统计/vn 量/n 依赖/v 于/p 计算机/n 的/ude1 硬件/n 、/wn 软件/n 等/udeng 环境因素/n ，/wd 有时/d 容易/ad 掩盖/v 算法/n 本身/rz 的/ude1 优劣/n 。/wj 因此/c 人们/n 常常/d 采用/v 另/rz 一/m 种/q 事前/t 分析/v 估算/v 的/ude1 方法/n 。/wj 
    (/wkz 2/m )/wky 事前/t 分析/v 估算/v 的/ude1 方法/n 。/wj 一个/mq 用/v 高级/a 程序/n 语言/n 编写/v 的/ude1 程序/n 在/p 计算机上运行/n 时/ng 所/usuo 消耗/v 的/ude1 时间/n 取决于/v 下列/b 因素/n ：/wp 
  a．/x 依据/n 的/ude1 算法/n 选用/v 何种/r 策略/n ；/wf 
  b．/x 问题/n 的/ude1 规模/n ，/wd 例如/v 求/v 100/m 以内/f 还是/v 1000/m 以内/f 的/ude1 素数/n ；/wf 
  c．/x 书写/v 程序/n 的/ude1 语言/n ，/wd 对于/p 同一个/b 算法/n ，/wd 实现/v 语言/n 的/ude1 级别/n 越/d 高/a ，/wd 执行/v 效率/n 就/d 越/d 低/a ；/wf 
  d．/x 编译程序/n 所/usuo 产生/v 的/ude1 机器代码/n 的/ude1 质量/n ；/wf 
  e．/x 机器执行/n 指令/n 的/ude1 速度/n 。/wj 
显然/a ，/wd 同一个/b 算法/n 用/p 不同/a 的/ude1 语言/n 实现/v ，/wd 或者/c 用/p 不同/a 的/ude1 编译程序/n 进行/vx 编译/vn ，/wd 或者/c 在/p 不同/a 的/ude1 计算机上运行/n 时/ng ，/wd 效率/n 均/d 不/d 相同/a 。/wj 这/rzv 表明/v 使用/v 绝对/a 的/ude1 时间/n 单位/n 衡量/v 算法/n 的/ude1 效率/n 是/vshi 不/d 合适/a 的/ude1 。/wj 撇开/v 这些/rz 与/p 计算机硬件/n 、/wn 软件/n 有关/vn 的/ude1 因素/n ，/wd 可以/v 认为/v 一个/mq 特定/b 算法/n “/wyz 运行/vn 工作量/n ”/wyy 的/ude1 大小/n ，/wd 只/d 依赖/v 于/p 问题/n 的/ude1 规模/n (/wkz 通常/d 用/v 整/m 数量/n 咒/ng 表示/v )/wky ，/wd 或者/c 说/v ，/wd 它/rr 是/vshi 问题/n 规模/n 的/ude1 函数/n 。/wj 
    一个/mq 算法/n 是/vshi 由/p 控制/v 结构/n (/wkz 顺序/n 、/wn 分支/n 和/cc 循环/vn 三/m 种/q )/wky 和/cc 原/b 操作/vn (/wkz 指/v 固有数据/n 类型/n 的/ude1 操作/vn )/wky 构成/v 的/ude1 ，/wd 则/c 算法/n 时间/n 取决于/v 两者/rzv 的/ude1 综合/vn 效果/n 。/wj 为了/p 便于/v 比较/d 同一/b 问题/n 的/ude1 不同/a 算法/n ，/wd 通常/d 的/ude1 做法/n 是/vshi ，/wd 从/p 算法/n 中选/vi 取/v 一/m 种/q 对于/p 所/usuo 研究/v 的/ude1 问题/n (/wkz 或/c 算法/n 类型/n )/wky 来说/uls 是/vshi 基本/ad 操作/v 的/ude1 原/b 操作/vn ，/wd 以/p 该/rz 基本/ad 操作/v 重复/vd 执行/v 的/ude1 次数/n 作为/p 算法/n 的/ude1 时间/n 量度/n 。/wj 
    例如/v ，/wd 在/p 如下/vi 所/usuo 示/vg 的/ude1 两/m 个/q N×N/x 矩阵/n 相乘/v 的/ude1 算法/n 中/f ，/wd “/wyz 乘法/n ”/wyy 运算/vn 是/vshi “/wyz 矩阵/n 相乘/v 问题/n ”/wyy 的/ude1 基本/a 操作/vn 。/wj 整个/b 算法/n 的/ude1 执行/vn 时间/n 与/p 该/rz 基本/ad 操作/v (/wkz 乘法/n )/wky 重复/vd 执行/v 的/ude1 次数/n N3/x 成/v 正比/n ，/wd 记/v 作/v T/x (/wkz n/x )/wky =O/x (/wkz n3/x )/wky 。/wj 
for/x (/wkz i=1/x ；/wf i/x </n =/m  n/x ；/wf ++i/x )/wky 
  for/x (/wkz j=l/x ；/wf j/x </n =n/x ；/wf ++j/x )/wky {/n 
    c/x [/wkz i/x ，/wd j/x ]/wky =0/m ；/wf 
    for/x (/wkz k=1/x ；/wf k/x </n |/n _/n n/x ；/wf ++k/x )/wky 
    c/x [/wkz i/x ，/wd j/x ]/wky +=a/x [/wkz i/x ，/wd k/x ]/wky */n b/x [/wkz k/x ，/wd j/x ]/wky ；/wf 
    }/n 
    一般/a 情况/n 下/f ，/wd 算/v 法/n 中/f 基本/ad 操作/v 重复/vd 执行/v 的/ude1 次数/n 是/vshi 问题/n 规模/n n/x 的/ude1 某个/rz 函数/n f/x (/wkz n/x )/wky ，/wd 算法/n 的/ude1 时间/n 量度/n 记/ng 作/v 
    T/x (/wkz n/x )/wky =O/x (/wkz f/x (/wkz n/x )/wky )/wky     (/wkz 1―5/m )/wky 
它/rr 表示/v 随/p 问题/n 规模/n 规/ng 的/ude1 增大/vn ，/wd 算法/n 执行/vn 时间/n 的/ude1 增长率/n 和/cc f/x (/wkz n/x )/wky 的/ude1 增长率/n 相同/a ，/wd 称作/v 算法/n 的/ude1 渐/d 近/a 时间/n 复杂度/n (/wkz Asymptotic/x  Time/x  Complexity/x )/wky ，/wd 简称/v 时间/n 复杂度/n 。/wj 
　　显然/a ，/wd 被/pbei 称作/v 问题/n 的/ude1 基本/a 操作/vn 的/ude1 原/b 操作/vn 应/v 是/vshi 其/rz 重复/vd 执行/v 次数/n 和/cc 算法/n 的/ude1 执行/vn 时间/n 成/v 正比/n 的/ude1 原/b 操作/vn ，/wd 多数/m 情况/n 下/f 它/rr 是/vshi 最/d 深层/b 循环/vn 内/f 的/ude1 语句/n 中/f 的/ude1 原/b 操作/vn ，/wd 它/rr 的/ude1 执行/vn 次数/n 和/cc 包含/v 它/rr 的/ude1 语句/n 的/ude1 频度/n 相同/a 。/wj 语句/n 的/ude1 频度/n (/wkz frequency/x  Count/x )/wky 指/v 的/ude1 是/vshi 该/rz 语句/n 重复/vd 执行/v 的/ude1 次数/n ，/wd 例如/v ：/wp 在/p 下列/b 三/m 个/q 程序段/n 中/f ，/wd 
(/wkz a/x )/wky {/n ++x/x ；/wf s=0/x ；/wf }/n 
(/wkz b/x )/wky for/x (/wkz i=l/x ；/wf i/x </n =n/x ；/wf ++i/x )/wky {/n ++x/x ；/wf s+=x/x ；/wf }/n 
(/wkz c/x )/wky for/x (/wkz j=1/x ；/wf j/x </n =n/x ；/wf ++j/x )/wky 
    for/x (/wkz k=1/x ；/wf k/x </n =n/x ；/wf ++k/x )/wky  {/n  ++x/x ；/wf s+=x/x ；/wf }/n 
含/v 基本/ad 操作/v “/wyz z/x 增/v 1/m ”/wyy 的/ude1 语句/n 的/ude1 频度/n 分别/d 为/v 1/m ，/wd n/x 和/cc n2/x 。/wj ，/wd 则/c 这/rzv 三/m 个/q 程序段/n 的/ude1 时间/n 复杂度/n 分别/d 为/v O/x (/wkz 1/m )/wky ，/wd 0/m (/wkz n/x )/wky 和/cc o/x (/wkz n2/x )/wky ，/wd 分别/d 称为/v 常量/n 阶/ng 、/wn 线性/n 阶/ng 和/cc 平方/n 阶/ng 。/wj 算法/n 还/d 可能/v 呈现/v 的/ude1 时间/n 复杂度/n 有/vyou ：/wp 对数/n 阶/ng O/x (/wkz log/x  n/x )/wky ，/wd 指数/n 阶/ng O/x (/wkz 2n/x )/wky 等/udeng 。/wj 不同/a 数量级/n 时间/n 复杂度/n 的/ude1 性状/n 如/v 图/n 1．7/m 所/usuo 示/vg 。/wj 从/p 图/n 中/f 可见/v ，/wd 我们/rr 应该/v 尽可能/d 选用/v 多项式/n 阶/ng O/x (/wkz nk/x )/wky 的/ude1 算法/n ，/wd 而/cc 不/d 希望/v 用/p 指数/n 阶/ng 的/ude1 算法/n 。/wj 
    一般/a 情况/n 下/f ，/wd 对/p 一个/mq 问题/n (/wkz 或/c 一/m 类/q 算法/n )/wky 只/d 需/v 选择/v 一/m 种/q 基本/ad 操作/v 来/vf 讨论/v 算法/n 的/ude1 时间/n 复杂度/n 即可/v ，/wd 有时/d 也/d 需要/v 同时/c 考虑/v 几/m 种/q 基本/a 操作/vn ，/wd 甚至/d 可以/v 对/p 不同/a 的/ude1 操作/vn 赋/ng 以/p 不同/a 权/n 值/n ，/wd 以/p 反映/v 执行/v 不同/a 操作/vn 所/usuo 需/v 的/ude1 相对/b 时间/n ，/wd 这种/r 做法/n 便于/v 综合/vd 比较/d 解决/v 同一/b 问题/n 的/ude1 两/m 种/q 完全/a 不同/a 的/ude1 算法/n 。/wj 
    由于/p 算法/n 的/ude1 时间/n 复杂度/n 考虑/v 的/ude1 只/d 是/vshi 对于/p 问题/n 规模/n n/x 的/ude1 增长率/n ，/wd 则/c 在/p 难以/d 精确/ad 计算/v 基本/ad 操作执行/n 次数/n (/wkz 或/c 语句/n 频度/n )/wky 的/ude1 情况/n 下/f ，/wd 只/q 需求/n 出/vf 它/rr 关于/p n/x 的/ude1 增长率/n 或/c 阶/ng 即可/v 。/wj 例如/v ，/wd 
在/p 下列/b 程序段/n 中/f ，/wd 
for/x (/wkz i=2/x ；/wf i/x </n =n/x ；/wf ++i/x )/wky 
  for/x (/wkz j=2/x ；/wf j/x </n =i-1/x ；/wf ++j/x )/wky {/n ++x/x ；/wf a/x [/wkz i/x ，/wd j/x ]/wky =x/x ；/wf }/n 
语句/n ++x/x 的/ude1 执行/vn 次数/n 关于/p n/x 的/ude1 增长率/n 为/v n2/x 。/wj ，/wd 它/rr 是/vshi 语句/n 频度/n 表达式/n (/wkz n-1/x )/wky (/wkz n-2/x )/wky //n 2/m 中/f 增长/v 最/d 快/a 的/ude1 项/q 。/wj 
    有/vyou 的/ude1 情况/n 下/f ，/wd 算/v 法/n 中/f 基本/ad 操作/v 重复/vd 执行/v 的/ude1 次数/n 还/d 随/v 问题/n 的/ude1 输入/vn 数据/n 集/vg 不同/a 而/cc 不同/a 。/wj 例如/v 在/p 下列/b 起泡/vi 排序/vi 的/ude1 算法/n 中/f ，/wd 
    void/x  bubble―sort/x (/wkz int/x  a/x [/wkz ]/wky ，/wd int/x  n/x )/wky {/n 
    ∥/w 将/d a/x 中/b 整数/n 序列/n 重新/d 排列/v 成/v 自/p 小/a 至/p 大/a 有序/a 的/ude1 整数/n 序列/n 。/wj 
    for/x (/wkz i=n-1/x ，/wd change=TRUE/x ；/wf i/x >/n l/x &/n &/n change/x ；/wf --/wp i/x )/wky  {/n 
    change=FALSE/x ；/wf 
    for/x (/wkz j=0/x ；/wf j/x </n i/x ；/wf ++j/x )/wky 
    if/x (/wkz a/x [/wkz j/x ]/wky >/n a/x [/wkz j+1/x ]/wky )/wky {/n a/x [/wkz j/x ]/wky </n =/m >/n ++a/x [/wkz j+1/x ]/wky ；/wf change=TRUE/x ;/wf }/n 
    }/n ∥/w bubble-sort/x 
“/wyz 交换/v 序列/n 中/f 相邻/vi 两/m 个/q 整数/n ”/wyy 为/v 基本/a 操作/vn 。/wj 当/p 口中/s 初始序列/n 为/v 自/p 小/a 至/p 大/a 有序/a ，/wd 基本/ad 操作/v 的/ude1 执行/vn 次数/n 为/p 0/m ；/wf 当/p 初始序列/n 为/p 自大/a 至/p 小/a 有序/a 时/ng ，/wd 基本/ad 操作/v 的/ude1 执行/vn 次数/n 为/v n/x (/wkz n-1/x )/wky //n 2/m 。/wj 对/p 这/rzv 类/q 算法/n 的/ude1 分析/vn ，/wd 一/m 种/q 解决/v 的/ude1 办法/n 是/vshi 计算/v 它/rr 的/ude1 平均值/n ，/wd 即/d 考虑/v 它/rr 对/p 所/usuo 有/vyou 可能/n 的/ude1 输入/vn 数据/n 集/vg 的/ude1 期望值/n ，/wd 此时/r 相应/vi 的/ude1 时间/n 复杂度/n 为/p 算法/n 的/ude1 平均/a 时间/n 复杂度/n 。/wj 如/v 假设/n n/x 中/b 初始/b 输入/vn 数据/n 可能/v 出现/v ，/wd n/x !/wt 种/v 的/ude1 排列/vn 情况/n 的/ude1 概率/n 相等/vi ，/wd 则/d 起泡/vi 排序/vi 的/ude1 平均/a 时间/n 复杂度/n Targ/x (/wkz n/x )/wky =O/x (/wkz n2/x )/wky ，/wd 然而/c ，/wd 在/p 很多/m 情况/n 下/f ，/wd 各种/rz 输入/vn 数据/n 集/vg 出现/v 的/ude1 概率/n 难以/d 确定/v ，/wd 算法/n 的/ude1 平均/a 时间/n 复杂度/n 也/d 就/d 难以/d 确定/v 。/wj 因此/c ，/wd 另/rz 一/m 种/q 更/d 可行/a 也/d 更/d 常用/a 的/ude1 办法/n 是/vshi 讨论/v 算法/n 在/p 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂度/n ，/wd 即/d 分析/v 最/d 坏/a 情况/n 以/p 估算/v 算法/n 执行/vn 时间/n 的/ude1 一个/mq 上/f 界/n 。/wj 例如/v ，/wd 上述/b 起泡/vi 排序/vi 的/ude1 最/d 坏/a 情况/n 为/v a/x 中/b 初始序列/n 为/p 自大/a 至/p 小/a 有序/a ，/wd 则/d 起泡/vi 排序/vi 算法/n 在/p 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂度/n 为/v T/x (/wkz n/x )/wky =O/x (/wkz n2/x )/wky 。/wj 在/p 本书/r 以/p 后/f 各/rz 章/n 中/f 讨论/v 的/ude1 时间/n 复杂度/n ，/wd 除/p 特别/d 指明/v 外/f ，/wd 均/d 指/v 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂度/n 。/wj 
    实践/v 中/f 我们/rr 可以/v 把/pba 事前/t 估算/v 和/cc 事/n 后/f 统计/v 两/m 种/q 办法/n 结合/v 起来/vf 使用/v 。/wj 以/p 两/m 个/q 矩阵/n 相乘/v 为/p 例/n ，/wd 若/c 上机/vi 运行/vi 两/m 个/q 10×10/m 的/ude1 矩阵/n 相乘/v ，/wd 执行/v 时间/n 为/v 12ms/x ，/wd 则/c 由/p 算法/n 的/ude1 时间/n 复杂度/n T/x (/wkz n/x )/wky =O/x (/wkz n3/x )/wky 可/v 估算/v 两/m 个/q 31×31/m 的/ude1 矩阵/n 相乘/v 所/usuo 需/v 时间/n 大致/d 为/v (/wkz 31／10/m )/wky 3/m */n 12ms≈358ms/x 。/wj 
  1．4．4/m 算法/n 的/ude1 存储空间/n 需求/n 
  类似/v 于/p 算法/n 的/ude1 时间/n 复杂度/n ，/wd 本/rz 书/n 中/f 以/p 空间/n 复杂度/n (/wkz Space/x  Complexity/x )/wky 作为/p 算法/n 所/usuo 需/v 存储空间/n 的/ude1 量度/n ，/wd 记/v 作/v    S/x (/wkz n/x )/wky =O/x (/wkz f/x (/wkz n/x )/wky )/wky     (/wkz 1―6/m )/wky 
其中/rz ，/wd z/x 为/p 问题/n 的/ude1 规模/n (/wkz 或/c 大/d 小/a )/wky 。/wj 一个/mq 上机/vi 执行/v 的/ude1 程序/n 除了/p 需要/n 存储空间/n 来/vf 寄存/v 本身/rz 所/usuo 用/v 指令/n 、/wn 常数/n 、/wn 变量/n 和/cc 输入/vn 数据/n 外/f ，/wd 也/d 需要/v 一些/mq 对/p 数据/n 进行/vx 操作/vn 的/ude1 工作单元/n 和/cc 存储/vn 一些/mq 为/v 实现/v 计算所需/n 信息/n 的/ude1 辅助/vn 空间/n 。/wj 若/c 输入/v 数据/n 所/usuo 占/v 空间/n 只/d 取决于/v 问题/n 本身/rz ，/wd 和/cc 算法/n 无关/v ，/wd 则/c 只/d 需要/v 分析/v 除/p 输入/vn 和/cc 程序/n 之外/f 的/ude1 额外/b 空间/n ，/wd 否则/c 应/v 同时/c 考虑/v 输入/v 本身/rz 所/usuo 需/v 空间/n (/wkz 和/cc 输入/vn 数据/n 的/ude1 表示形式/n 有关/vn )/wky 。/wj 若/c 额外/b 空间/n 相对/d 于/p 输入/v 数据/n 量/n 来说/uls 是/vshi 常/d 数/v ，/wd 则/c 称/v 此/rzs 算法/n 为/p 原/b 地/n 工作/vn ，/wd 第10/m 章/q 讨论/vn 的/ude1 有些/rz 排序/vn 算法/n 就/d 属于/v 这/rzv 类/q 。/wj 又/c 如果/c 所/usuo 占/v 空间量/n 依赖/v 于/p 特定/b 的/ude1 输入/vn ，/wd 则/c 除/p 特别/d 指明/v 外/f ，/wd 均/d 按/p 最/d 坏/a 情况/n 来/vf 分析/v 。/wj 


第2/m 章/q 线性/n 表/n 
　　从/p 第2/m 章/q 至/p 第4/m 章/q 将/d 讨论/v 线性/n 结构/n 。/wj 线性/n 结构/n 的/ude1 特点/n 是/vshi ：/wp 在/p 数据/n 元素/n 的/ude1 非空/n 有限/a 集中/a ，/wd (/wkz 1/m )/wky 存在/v 唯一/b 的/ude1 一个/mq 被/pbei 称/v 做/v “/wyz 第一/m 个/q ”/wyy 的/ude1 数据/n 元素/n ；/wf (/wkz 2/m )/wky 存在/v 唯一/b 的/ude1 一个/mq 被/pbei 称/v 做/v “/wyz 最后/f 一个/mq ”/wyy 的/ude1 数据/n 元素/n ；/wf (/wkz 3/m )/wky 除/p 第一/m 个/q 之外/f ，/wd 集合/v 中/f 的/ude1 每个/r 数据/n 元素/n 均/d 只/d 有/vyou 一个/mq 前驱/n ；/wf (/wkz 4/m )/wky 除/p 最后/f 一个/mq 之外/f ，/wd 集合/v 中/f 每个/r 数据/n 元素/n 均/d 只/d 有/vyou 一个/mq 后/f 继/vg 。/wj 
　　2．1/m 线性/n 表/n 的/ude1 类型定义/n 
    线性/n 表/n (/wkz Linear―List/x )/wky 是/vshi 最/d 常用/a 且/c 最/d 简单/a 的/ude1 一/m 种/q 数据/n 结构/n 。/wj 简言之/vl ，/wd 一个/mq 线性/n 表/n 是/vshi 个/q 数据/n 元素/n 的/ude1 有限/a 序列/n 。/wj 至于/p 每个/r 数据/n 元素/n 的/ude1 具体/a 含义/n ，/wd 在/p 不同/a 的/ude1 情况/n 下/f 各/rz 不/d 相同/a ，/wd 它/rr 可以/v 是/vshi 一个/mq 数/n 、/wn 或/c 一个/mq 符号/n ，/wd 也/d 可以/v 是/vshi 一/m 页/q 书/n ，/wd 甚至/c 其它/rz 更/d 复杂/a 的/ude1 信息/n 。/wj 例如/v ，/wd 26/m 个/q 英文/nz 字母/n 的/ude1 字母表/n ：/wp 
    (/wkz A/x ，/wd B/x ，/wd C/x ，/wd ．/w ．/w ．/w …/ws ，/wd Z/x )/wky 
是/vshi 一个/mq 线性/n 表/n ，/wd 表/n 中/f 的/ude1 数据/n 元素/n 是/vshi 单个/b 字母/n 字符/n 。/wj 又/d 如/v ，/wd 某/rz 校/ng 从/p 1978年/t 到/p 1983年/t 各种/rz 型号/n 的/ude1 计算机/n 拥有量/n 的/ude1 变化情况/n ，/wd 可以/v 用/p 线性/n 表/n 的/ude1 形式/n 给/v 出/vf ：/wp 
    (/wkz 6/m ，/wd 17/m ，/wd 28/m ，/wd 50/m ，/wd 92/m ，/wd 188/m )/wky 
表/n 中/f 的/ude1 数据/n 元素/n 是/vshi 整数/n 。/wj 
    在/p 稍/d 复杂/a 的/ude1 线性/n 表/n 中/f ，/wd 一个/mq 数据/n 元素/n 可以/v 由/p 若干/m 个/q 数据项/n (/wkz Item/x )/wky 组成/v 。/wj 在/p 这种/r 情况/n 下/f ，/wd 常/d 把/pba 数据/n 元素/n 称为/v 记录/v (/wkz Record/x )/wky ，/wd 含有/v 大量/m 记录/n 的/ude1 线性/n 表/n 又/d 称/v 文件/n (/wkz File/x )/wky 。/wj 
    例如/v ，/wd 一个/mq 学校/n 的/ude1 学生/n 健康/an 情况/n 登记表/n 如/v 图/n 2．1/m 所/usuo 示/vg ，/wd 表/n 中/f 每个/r 学生/n 的/ude1 情况/n 为/v 一个/mq 记录/n ，/wd 它/rr 由/p 姓名/n 、/wn 学/v 号/n 、/wn 性别/n 、/wn 年龄/n 、/wn 班级/n 和/cc 健康状况/n 等/udeng 六/m 个/q 数据项/n 组成/v 。/wj 
图/n 2．1/m 学生/n 健康/an 情况/n 登记表/n 
    综合/v 上述/b 三/m 个/q 例子/n 可见/c ，/wd 线性/n 表/n 中/f 的/ude1 数据/n 元素/n 可以/v 是/vshi 各种各样/bl 的/ude1 ，/wd 但/c 同/p 一/m 线性/n 表/n 中/f 的/ude1 元素/n 必定/d 具有/v 相同/a 特性/n ，/wd 即/d 属/v 同一/b 数据/n 对象/n ，/wd 相邻/vi 数据/n 元素/n 之间/f 存在/v 着/uzhe 序/n 偶/b 关系/n 。/wj 若/c 将/p 线性/n 表记/n 为/v 
    (/wkz a1/x ,/wd a2/x ,/wd …/ws ,/wd ai/x ,/wd …/ws ,/wd an/x )/wky     (/wkz 2―1/m )/wky 
则/c 表/n 中/f ai-1/x 领先/vi 于/p ai/x ，/wd ai/x 领先/vi 于/p ai+1/x 。/wj ，/wd 称/v ai-1/x 是/vshi ai/x 的/ude1 直接/a 前驱/n 元素/n ，/wd ai+1/x 是/vshi ai/x 的/ude1 直接/a 后/f 继/vg 元素/n 。/wj 当/p i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x 一/m 1时/t ，/wd ni/x 有/vyou 且/c 仅/d 有/vyou 一个/mq 直接/a 后/f 继/vg ，/wd 当/v i=2/x ，/wd 3/m ，/wd …/ws ，/wd n/x 时/ng ，/wd ai/x 有/vyou 且/c 仅/d 有/vyou 一个/mq 直接/a 前驱/n 。/wj 
    线性/n 表/vg 中/b 元素/n 的/ude1 个数/n n/x (/wkz n≥0/x )/wky 定义/n 为/p 线性/n 表/n 的/ude1 长度/n ，/wd n=0/x 时/ng 称/v 为/p 空/a 表/n 。/wj 在/p 非空/n 表/n 中/f 的/ude1 每个/r 数据/n 元素/n 都/d 有/vyou 一个/mq 确定/v 的/ude1 位置/n ，/wd 如/v a1/x 是/vshi 第一/m 个/q 数据/n 元素/n ，/wd an/x 是/vshi 最后/f 一个/mq 数据/n 元素/n ,/wd ai/x 是/vshi 第/m i/x 个/q 数据/n 元素/n ，/wd 称/v i/x 为/p 数据/n 元素/n ai/x 在/p 线性/n 表/n 中/f 的/ude1 位/q 序/n 。/wj 
    线性/n 表/n 是/vshi 一个/mq 相当/d 灵活/a 的/ude1 数据/n 结构/n ，/wd 它/rr 的/ude1 长度/n 可/v 根据/p 需要/v 增长/v 或/c 缩短/v ，/wd 即/d 对/p 线性/n 表/n 的/ude1 数据/n 元素/n 不仅/c 可以/v 进行/vx 访问/vn ，/wd 还/d 可/v 进行/vx 插入/v 和/cc 删除/v 等/udeng 。/wj 
    抽象数据/n 类型/n 线性/n 表/n 的/ude1 定义/n 如下/vi ：/wp 
ADT/x  List/x  j/x 
  数据/n 对象/n ：/wp D=/x {/n ail/x  ai∈ElemSet/x ，/wd i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x ，/wd n≥0/x }/n 
  数据/n 关系/n ：/wp R1=/x {/n </n ai/x 一/m 1/m ，/wd ai/x >/n lai/x 一/m 1/m ，/wd ai∈D/x ，/wd i=2/x …/ws ．/w ，/wd n/x }/n 
  基本/ad 操作/v ：/wp 
    InitList/x (/wkz &/n L/x )/wky 
    操作/v 结果/n ：/wp 构造/v 一个/mq 空/a 的/ude1 线性/n 表/n L/x 。/wj 
    DestroyList/x (/wkz ＆/n L/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 线性/n 表/n L/x 。/wj 
    CIearList/x (/wkz &/n L/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 将/d L/x 重/d 置/v 为/p 空/a 表/n 。/wj 
    ListEmpty/x (/wkz L/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v L/x 为/p 空/a 表/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c 返回/v FALSE/x 。/wj 
    ListLength/x (/wkz L/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v L/x 中/b 数据/n 元素/n 个数/n 。/wj 
    GetElem/x (/wkz L/x ，/wd i/x ，/wd ＆/n e/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v ，/wd 1≤i≤ListLength/x (/wkz L/x )/wky 。/wj 
    操作/v 结果/n ：/wp 用/v e/x 返回/v L/x 中/f 第/m i/x 数据/n 个/q 元素/n 的/ude1 值/n 。/wj 
    LocateElem/x (/wkz L/x ，/wd e/x ，/wd compare/x (/wkz )/wky )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v ，/wd compare/x (/wkz )/wky 是/vshi 数据/n 元素/n 判定/v 函数/n 。/wj 
    操作/v 结果/n ：/wp 返回/v L/x 中/f 第1/m 个/q 与/p e/x 满足/v 关系/n compare/x (/wkz )/wky 的/ude1 数据/n 元素/n 的/ude1 位/q 序/n 。/wj 若/c 这样/rzv 的/ude1 数据/n 元素/n 不/d 存在/v ，/wd 则/c 返回/v 值/v 为/p 0/m 。/wj 
    PriorElem/x (/wkz L/x ，/wd cur/x _/n e/x ，/wd &/n pre/x _/n e/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v cur/x _/n e/x 是/vshi L/x 的/ude1 数据/n 元素/n ，/wd 且/c 不/d 是/vshi 第一/m 个/q ，/wd 则/c 用/v pre/x _/n e/x 返回/v 它/rr 的/ude1 前驱/n ，/wd 否则/c 操作失败/n ，/wd pre/x _/n e/x 无/v 定义/n 。/wj 
    NextElem/x (/wkz L/x ，/wd cur/x _/n e/x ，/wd next/x _/n e/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v cur/x _/n e/x 是/vshi L/x 的/ude1 数据/n 元素/n ，/wd 且/c 不/d 是/vshi 最后/f 一个/mq ，/wd 则/c 用/v next/x _/n e/x 返回/v 它/rr 的/ude1 后/f 继/vg ，/wd 否则/c 操作失败/n ，/wd next/x _/n e/x 无/v 定义/n 。/wj 
    ListInsert/x (/wkz ＆/n L/x ，/wd I/x ,/wd  e/x )/wky 
    初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v ，/wd l≤i≤ListLength/x (/wkz L/x )/wky +1/m 。/wj 
    操作/v 结果/n ：/wp 在/p L/x 中/f 第/m i/x 个/q 位置/n 之前/f 插入/v 新/a 的/ude1 数据/n 元素/n e/x ，/wd L/x 的/ude1 长度/n 加/v 1/m 。/wj 
    ListDelete/x (/wkz ＆/n L/x ，/wd i/x ，/wd &/n e/x )/wky 
  初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 且/c 非空/n ，/wd 1≤i≤ListLengtb/x (/wkz L/x )/wky 。/wj 
  操作/v 结果/n ：/wp 删除/v L/x 的/ude1 第/m i/x 个/q 数据/n 元素/n ，/wd 并/cc 用/v e/x 返回/v 其/rz 值/n ，/wd L/x 的/ude1 长度/n 减/v 1/m 。/wj 
  ListTravel/x (/wkz L/x ，/wd visit/x (/wkz )/wky )/wky 
  初始条件/n ：/wp 线性/n 表/n L/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 依次/d 对/p L/x 的/ude1 每个/r 数据/n 元素/n 调用函数/n visit/x (/wkz )/wky 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
}/n ADTList/x 
    对/p 上述/b 定义/n 的/ude1 抽象数据/n 类型/n 线性/n 表/n ，/wd 还/d 可/v 进行/vx 一些/mq 更/d 复杂/a 的/ude1 操作/vn 。/wj 如/v ：/wp 将/p 两/m 个/q 或/c 两/m 个/q 以上/f 的/ude1 线性/n 表/vg 合并/v 成/v 一个/mq 线性/n 表/n ；/wf 把/pba 一个/mq 线性/n 表/vg 拆开/v 成/v 两/m 个/q 或/c 两/m 个/q 以上/f 的/ude1 线性/n 表/n ；/wf 重新/d 复制/v 一个/mq 线性/n 表/n 等等/udeng 。/wj 
    例/n 2―1/m 假设/n 利用/v 两/m 个/q 线性/n 表/n LA/x 和/cc LB/x 分别/d 表示/v 两/m 个/q 集合/n A/x 和/cc B/x (/wkz 即/v ：/wp 线性/n 表/n 中/f 的/ude1 数据/n 元素/n 即/d 为/v 集合/v 中/f 的/ude1 成员/n )/wky ，/wd 现/tg 要求/v 一个/mq 新/a 的/ude1 集合/n A=A/x  U/x  B/x 。/wj 这/rzv 就/d 要求/v 对/p 线性/n 表/vg 作/v 如下/vi 操作/v ：/wp 扩大/v 线性/n 表/n LA/x ，/wd 将/d 存在/v 于/p 线性/n 表/n LB/x 中/f 而/cc 不/d 存在/v 于/p 线性/n 表/n LA/x 中/f 的/ude1 数据/n 元素/n 插入/v 到/v 线性/n 表/n ．/w LA/x 中/f 去/vf 。/wj 只要/c 从/p 线性/n 表/n LB/x 中/f 依次/d 取得/v 每个/r 数据/n 元素/n ，/wd 并/cc 依/v 值/v 在/p 线性/n 表/n LA/x 中/f 进行/vx 查访/vn ，/wd 若/c 不/d 存在/v ，/wd 则/c 插入/v 之/uzhi 。/wj 上述/b 操作过程/n 可用/v 下列/b 算法/n 描述/v 之/uzhi 。/wj 
void/x  union/x (/wkz List/x &/n La/x ，/wd List/x  Lb/x )/wky l/x 
  ∥/w 将/p 所有/b 在/p 线性/n 表/n Lb/x 中/f 但/c 不/d 在/p La/x 中/f 的/ude1 数据/n 元素/n 插入/v 到/v La/x 中/f 
  La―len=ListLength/x (/wkz La/x )/wky ；/wf Lb―lea=ListLength/x (/wkz Lb/x )/wky ；/wf ∥/w 求/v 线性/n 表/n 的/ude1 长度/n 
  for/x (/wkz i：1/x ；/wf i/x </n =Lb―len/x ；/wf i++/x )/wky {/n 
  GetElem/x (/wkz Lb/x ，/wd i/x ，/wd e/x )/wky ；/wf     ∥/w 取/v Lb/x 中/f 第/m i/x 个/q 数据/n 元素/n 赋/ng 给/v e/x 
  if/x (/wkz !/wt LocateElem/x (/wkz La/x ，/wd e/x ，/wd equa/x ]/wky ．/w )/wky )/wky ListInsert/x (/wkz La/x ，/wd   ++La―lend/x 。/wj e/x )/wky ；/wf 
    ∥/w La/x 中/f 不/d 存在/v 和/cc e/x 相同/a 的/ude1 数据/n 元素/n ，/wd 则/c 插入/v 之/rz 
}/n 
}/n //n //n union/x 
算法/n 2．1/m 
    例/n 2．2/m   已/d 知/v 线性/n 表/n LA/x 和/cc LB/x 中/f 的/ude1 数据/n 元素/n 按/p 值/n 非/b 递减/vn 有序/ad 排列/v ，/wd 现/tg 要求/v 将/d LA/x 和/cc 
LB/x 归并/vi 为/v 一个/mq 新/a 的/ude1 线性/n 表/n Lc/x ，/wd 且/c Lc/x 中/f 的/ude1 数据/n 元素/n 仍/d 按/p 值/n 非/b 递减/vn 有序/ad 排列/v 。/wj 例如/v ，/wd 设/v 
    LA=/x (/wkz 3/m ，/wd 5/m ，/wd 8/m ，/wd 11/m )/wky 
    LB=/x (/wkz 2/m ，/wd 6/m ，/wd 8/m ，/wd 9/m ，/wd 11/m ，/wd 15/m ，/wd 20/m )/wky 
则/d 
    LC=/x (/wkz 2/m ，/wd 3/m ，/wd 5/m ，/wd 6/m ，/wd 8/m ，/wd 8/m ，/wd 9/m ，/wd 11/m ，/wd 11/m ，/wd 15/m ，/wd 20/m )/wky 
    从/p 上述/b 问题/n 要求/v 可知/v ，/wd LC/x 中/f 的/ude1 数据/n 元素/n 或是/c LA/x 中/f 的/ude1 数据/n 元素/n ，/wd 或是/c LB/x 中/f 的/ude1 数据/n 元素/n ，/wd 则/c 只/d 要/v 先/d 设/v Lc/x 为/p 空/a 表/n ，/wd 然后/c 将/d LA/x 或/c LB/x 中/f 的/ude1 元素/n 逐个/d 插入/v 到/v Lc/x 中/f 即可/v 。/wj 为/p 使/v Lc/x 中/b 元素/n 按/p 值/n 非/b 递减/vn 有序/ad 排列/v ，/wd 可/c 设/v 两/m 个/q 指针/n i/x 和/cc J/x 分别/d 指向/v LA/x 和/cc LB/x 中/f 某个/rz 元素/n ，/wd 若/c 设/v i/x 当前/t 所/usuo 指/v 的/ude1 元素/n 为/v a/x ，/wd j/x 当前/t 所/usuo 指/v 的/ude1 元素/n 为/v b/x ，/wd 则/c 当前/t 应/v 插入/v 到/v LC/x 中/f 的/ude1 元素/n c/x 为/v 。/wj 
显然/a ，/wd 指针/n i/x 和/cc J/x 的/ude1 初值/n 均/d 为/v 1/m ，/wd 在/p 所/usuo 指/v 元素/n 插入/v LC/x 之后/f ，/wd 在/p LA/x 或/c LB/x 中/b 顺序/n 后移/vn 。/wj 上述/b 归并/vi 算法/n 如/v 算法/n 2．2/m 所/usuo 示/vg 。/wj 
void/x  MergeList/x (/wkz List/x  La/x ，/wd List/x  Lb/x ，/wd List/x &/n Lc/x )/wky {/n 
    ∥/w 已/d 知/v 线性/n 表/n La/x 和/cc Lb/x 中/f 的/ude1 数据/n 元素/n 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
    ∥/w 归并/vi La/x 和/cc Lb/x 得到/v 新/a 的/ude1 线性/n 表/n Lc/x ，/wd Lc/x 的/ude1 数据/n 元素/n 也/d 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
    InitList/x (/wkz Lc/x )/wky ；/wf 
    i=J=1/x ；/wf k=0/x ；/wf 
    La―len=ListLength/x (/wkz La/x )/wky ；/wf Lb―len=ListLength/x (/wkz Lb/x )/wky ；/wf 
    ．/w bile/x (/wkz (/wkz i/x </n =La―fen/x )/wky &/n ＆/n (/wkz J/x </n =Lb―len/x )/wky )/wky {/n ∥/w La/x 和/cc Lb/x 均/d 非空/n 
    GetElem/x (/wkz La/x ，/wd i/x ，/wd ai/x )/wky ；/wf GetElem/x (/wkz Lb/x ，/wd J/x ，/wd bj/x )/wky ；/wf 
    if/x (/wkz ai/x </n ：/wp bj/x )/wky   lListlnsert/x (/wkz Lc/x ，/wd ++k/x ，/wd a1/x )/wky ；/wf ++i/x ；/wf }/n 
    else/x {/n ListInsert/x (/wkz Lc/x ，/wd ++k/x ，/wd bj/x )/wky ；/wf ++j/x ；/wf }/n 
    }/n 
    while/x (/wkz i/x </n =La―len/x )/wky I/x 
    GetElem/x (/wkz La/x ，/wd i++/x ，/wd ai/x )/wky ；/wf Listlnsert/x (/wkz Lc/x ，/wd ++k/x ，/wd ai/x )/wky ；/wf 
    }/n 
    while/x (/wkz J/x </n =Lb―fen/x )/wky l/x 
    GetElem/x (/wkz Lb/x ，/wd j++/x ，/wd bj/x )/wky ；/wf ListInsert/x (/wkz Lc/x ，/wd ++k/x ，/wd bj/x )/wky ；/wf 
    }/n 
}/n ∥/w MergeList/x 
算法/n 2．2/m 
    上述/b 两/m 个/q 算法/n 的/ude1 时间/n 复杂度/n 取决于/v 抽象数据/n 类型/n List/x 定义/n 中/f 基本/ad 操作/v 的/ude1 执行/vn 时间/n 。/wj 假如/c GetElem/x 和/cc Listlnsert/x 这/rzv 两/m 个/q 操作/vn 的/ude1 执行/vn 时间/n 和/cc 表/n 长/ad 无关/v ，/wd LocateElem/x 的/ude1 执行/vn 时间/n 和/cc 表/n 长/ad 成/v 正比/n ，/wd 则/c 算法/n 2．1/m 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz ListLength/x (/wkz LA/x )/wky ×ListLength/x (/wkz LB/x )/wky )/wky ，/wd 算法/n 2．2/m 的/ude1 时间/n 复杂度/n 则/d 为/v O/x (/wkz ListLength/x (/wkz LA/x )/wky +ListLength/x (/wkz LB/x )/wky )/wky 。/wj 虽然/c 算法/n 2．2/m 中/f 含/v 三/m 个/q (/wkz while/x )/wky 循环/vn 语句/n ，/wd 但/c 只有/c 当/v i/x 和/cc j/x 均/d 指向/v 表/n 中/f 实际/ad 存在/v 的/ude1 数据/n 元素/n 时/ng ，/wd 才/d 能/v 取得/v 数据/n 元素/n 的/ude1 值/n 并/cc 进行/vx 相互/d 比较/d ；/wf 并且/c 当/p 其中/rz 一个/mq 线性/n 表/n 的/ude1 数据/n 元素/n 均/d 已/d 插入/v 到/v 线性/n 表/n LC/x 中/b 后/f ，/wd 只要/c 将/p 另外/rz 一个/mq 线性/n 表/n 中/f 的/ude1 剩余/vn 元素/n 依次/d 插入/v 即可/v 。/wj 因此/c ，/wd 对于/p 每/rz 一/m 组/q 具体/a 的/ude1 输入/vn (/wkz LA/x 和/cc LB/x )/wky ，/wd 后/f 两/m 个/q (/wkz while/x )/wky 循环/vn 语句/n 只/d 执行/v 一个/mq 循环体/n 。/wj 
2．2/m 线性/n 表/n 的/ude1 顺序/n 表示/v 和/cc 实现/v 
    线性/n 表/n 的/ude1 顺序/n 表示/v 指/v 的/ude1 是/vshi 用/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 依次/d 存储/v 线性/n 表/n 的/ude1 数据/n 元素/n 。/wj     假设/v 线性/n 表/n 的/ude1 每个/r 元素/n 需/v 占用/v z/x 个/q 存储单元/n ，/wd 并/cc 以/p 所/usuo 占/v 的/ude1 第一/m 个/q 单元/n 的/ude1 存储/vn 地址/n 作为/p 数据/n 元素/n 的/ude1 存储位置/n 。/wj 则/c 线性/n 表/n 中/f 第/m i+1/x 个/q 数据/n 元素/n 的/ude1 存储位置/n LOC/x (/wkz ai+1/x )/wky 和/cc 第/m i/x 个/q 数据/n 元素/n 的/ude1 存储位置/n LOC/x (/wkz ai/x )/wky 之间/f 满足/v 下列/b 关系/n ：/wp 
    LOC/x (/wkz ai+1/x )/wky =LOC/x (/wkz ai/x )/wky +l/x 
一般来说/vl ，/wd 线性/n 表/n 的/ude1 第/m i/x 个/q 数据/n 元素/n ai/x 的/ude1 存储位置/n 为/v 
    LOC/x (/wkz ai/x )/wky =LOC/x (/wkz a1/x )/wky +/m (/wkz i/x 一/m 1/m )/wky */n Z/x     (/wkz 2―2/m )/wky 
式/ng 中/f LOC/x (/wkz a1/x )/wky 是/vshi 线性/n 表/n 的/ude1 第一/m 个/q 数据/n 元素/n a1/x 的/ude1 存储位置/n ，/wd 通常/d 称做/v 线性/n 表/n 的/ude1 起始/vn 位置/n 或/c 基/ng 地址/n 。/wj 
    线性/n 表/n 的/ude1 这种/r 机/n 内/f 表示/v 称做/v 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 或/c 顺序/n 映象/n (/wkz Sequential/x  Maping/x )/wky ，/wd 通常/d ，/wd 称/v 这种/r 存储/vn 结构/n 的/ude1 线性/n 表/vg 为/p 顺序/n 表/n 。/wj 它/rr 的/ude1 特点/n 是/vshi ，/wd 为/p 表/n 中/f 相邻/vi 的/ude1 元/q 索/vg ai/x 和/cc ai+1/x 赋/ng 以/p 相邻/vi 的/ude1 存储位置/n LOC/x (/wkz ai/x )/wky 和/cc LOC/x (/wkz ai+1/x )/wky 。/wj 换句话说/c ，/wd 以/p 元素/n 在/p 计算机/n 内/f “/wyz 物理/n 位置/n 相邻/vi ”/wyy 来/f 表示/v 线性/n 表/vg 中/b 数据/n 元素/n 之间/f 的/ude1 逻辑关系/n 。/wj 每/rz 一个/mq 数据/n 元素/n 的/ude1 存储位置/n 都/d 和/cc 线性/n 表/n 的/ude1 起始/vn 位置/n 相差/v 一个/mq 和/cc 数据/n 元素/n 在/p 线性/n 表/n 中/f 的/ude1 位/q 序/n 成/v 正比/n 的/ude1 常数/n （/wkz 见/v 图/n 2.2/m ）/wky 。/wj 由此/d ，/wd 只要/c 确定/v 了/ule 存储/vn 线性/n 表/n 的/ude1 起始/vn 位置/n ，/wd 线性/n 表/n 中/f 任/v 一/m 数据/n 元素/n 都/d 可/v 随机/b 存取/vn ，/wd 所以/c 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 是/vshi 一/m 种/q 随机/b 存取/vn 的/ude1 存储/vn 结构/n 。/wj 
    由于/p 高级/a 程序设计/n 语言/n 中/f 的/ude1 数组/n 类型/n 也/d 有/vyou 随机/d 存取/v 的/ude1 特性/n ，/wd 因此/c ，/wd 通常/d 都/d 用/p 数组/n 来/vf 描述/v 数据/n 结构/n 中/f 的/ude1 顺序/n 存储/vn 结构/n 。/wj 在/p 此/rzs ，/wd 由于/c 线性/n 表/n 的/ude1 长度可变/n ，/wd 且/c 所/usuo 需/v 最/d 大/a 存储空间/n 随/p 问题/n 不同/an 而/cc 不同/a ，/wd 则/c 在/p C/x 语言/n 中/f 可/v 用/p 动态分配/n 的/ude1 一/m 维/q 数组/n ，/wd 如/v 下/vf 描述/v 。/wj 
    ∥/w   …/ws     线性/n 表/n 的/ude1 动态分配/n 顺序/n 存储/vn 结构/n ～/ws …/ws 
    #/n define/x  LIST/x 、/wn INIT/x  SIZE/x  100/m   //n //n 线性/n 表存储/n 空间/n 的/ude1 初始/b 分配量/n }/n 
    #/n define/x  LISTIN/x ~/n     10/m       //n //n 线性/n 表存储/n 空间/n 的/ude1 分配/vn 增量/n 
typedef/x  struct/x  {/n 
ElemType/x   */n elem/x ;/wf  ∥/w 存储空间/n 基址/n 
Int/x   length/x ；/wf ∥/w 当前/t 长度/n 
Int/x  listsize/x ;/wf  ∥/w 当前/t 分配/v 的/ude1 存储容量/n 
}/n SqList/x ；/wf 
    在/p 上述/b 定义/n 中/f ．/w 数组/n 指针/n elem/x 指示/n 线性/n 表/n 的/ude1 基/ng 地址/n ，/wd length/x 指示/n 线性/n 表/n 的/ude1 当前/t 长度/n 。/wj 
顺序/n 表/n 的/ude1 初始化操作/n 就/d 是/vshi 为/p 顺序/n 表/vg 分配/v 一个/mq 予/vg 定义/n 大小/n 的/ude1 数组/n 空/ng 问/v ，/wd 并/cc 将/p 线性/n 表/n 的/ude1 当前/t 长度/n 设/v 为/v ”/wyy 0/m ”/wyy (/wkz 参见/v 算法/n 2/m  3/m )/wky 。/wj Listsize/x 指示/n 顺序/n 表/vg 当前/t 分配/v 的/ude1 存储空间/n 大/a 小/a ，/wd 一旦/d 因/p 插入/v 元素/n 而/cc 空间/n 不足/v 时/ng ，/wd 可/v 进行/vx 再/d 分配/v ，/wd 即/d 为/v 顺序/n 表/vg 增加/v 一个/mq 大/a 小/a 为/p 存储/v LISTINCREMENT/x 个/q 数据/n 元素/n 的/ude1 空间/n 。/wj 
    在/p 这种/r 存储/vn 结构/n 中/f ，/wd 容易/ad 实现/v 线性/n 表/n 的/ude1 某些/rz 操作/vn ，/wd 入/v 随机/d 存取/v 第/m i/x 个/q 数据/n 元素/n 等/udeng 。/wj 只/d 是/vshi 要/v 特别/d 注意/v 的/ude1 是/vshi ，/wd C/x 语言/n 中/f 数/m 组/q 的/ude1 下标/n 从/p ”/wyy 0/m ”/wyy 开始/v ，/wd 因此/c ，/wd 若/c L/x 是/vshi SqList/x 类型/n 的/ude1 顺序/n 表/n ，/wd 则/c 表/n 中/f 第/m i/x 个/q 数据/n 元素/n 是/vshi L.elem/x [/wkz i-1/x ]/wky 。/wj 下面/f 重点/d 讨论/v 线性/n 表/n 的/ude1 插入/v 和/cc 删除/v 两/m 种/q 操作/v 在/p 顺序/n 存储表示/n 时/ng 的/ude1 实现/vn 方法/n 。/wj 
　　如/v 2.1/m 节/q 中/f 所/usuo 述/vg ，/wd 线性/n 表/n 的/ude1 插入/v 操作/v 时/ng 指/v 在/p 线性/n 表/n 的/ude1 第/m i-1/x 个/q 数据/n 元素/n 和/cc 第/m i/x 个/q 数据/n 元素/n 之间/f 插入/v 一个/mq 新/a 的/ude1 数据/n 元素/n ，/wd 就是/d 要/v 使/v 长度/n 为/v n/x 的/ude1 线性/n 表/n 
　　(/wkz a1/x ,/wd …/ws ai-1/x ,/wd ai/x ,/wd …/ws ,/wd an/x )/wky 
变为/v 长度/n 为/v n+1/x 的/ude1 线性/n 表/n 
　　(/wkz a1/x ,/wd …/ws ai-1/x ,/wd b/x ,/wd ai/x ,/wd …/ws ,/wd an/x )/wky 
数据/n 元素/n ai-1/x 和/cc ai/x 之间/f 的/ude1 逻辑关系/n 发生/v 了/ule 变化/vn 。/wj 在/p 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 中/f ，/wd 由于/c 逻辑/n 上/f 相邻/vi 的/ude1 数据/n 元素/n 在/p 物理/n 位置/n 上/f 也/d 是/vshi 相邻/vi 的/ude1 ，/wd 因此/c ，/wd 除非/c i=n+1/x ，/wd 否则/c 必须/d 移动/v 元素/n 才/d 能/v 反映/v 这个/rz 逻辑关系/n 的/ude1 变化/vn 。/wj 
    例如/v ，/wd 图/n 2．3/m 表示/v 一个/mq 线性/n 表/vg 在/p 进行/vx 插入/v 操作/v 的/ude1 前/f 、/wn 后/f ，/wd 其/rz 数据/n 元素/n 在/p 存储空间/n 中/f 的/ude1 位置/n 变化/vn 。/wj 为了/p 在/p 线性/n 表/n 的/ude1 第4/m 和/cc 第5/m 个/q 元素/n 之间/f 插入/v 一个/mq 值/n 为/p 25/m 的/ude1 数据/n 元素/n ，/wd 则/c 需/v 将/p 第5/m 个/q 至/p 第8/m 个/q 数据/n 元素/n 依次/d 往后/t 移动/v 一个/mq 位置/n 。/wj 
    一般/a 情况/n 下/f ，/wd 在/p 第/m i/x (/wkz 1≤i≤n/x )/wky 个/q 元素/n 之前/f 插入/v 一个/mq 元素/n 时/ng ，/wd 需/v 将/p 第/m n/x 至/p 第/m i/x (/wkz 共/d n-i+1/x )/wky 个/q 元素/n 向/p 后/f 移动/v 一个/mq 位置/n ，/wd 如/v 算法/n 2．4/m 所/usuo 示/vg 。/wj 
Status/x  Listlnsert/x  Sq/x (/wkz SqList/x ＆/n L/x ，/wd Jut/x  i/x ，/wd ElemType/x  e/x )/wky {/n 
    ∥/w 在/p 顺序/n 线性/n 表/n L/x 中/f 第/m i/x 个/q 位置/n 之前/f 插入/v 新/a 的/ude1 元素/n e/x ，/wd 
    ∥/w i/x 的/ude1 合法/a 值/n 为/v 1≤i≤ListLength―Sq/x (/wkz L/x )/wky +1/m 
    if/x (/wkz i/x </n 1/m  0/m  i/x >/n L．1ength/x 十/m 1/m )/wky return/x  ERROR/x ；/wf   ∥/w i/x 值/n 不/d 合法/a 
    if/x (/wkz L．1ength/x >/n =L．1istsize/x )/wky {/n     ∥/w 当前/t 存储空间/n 已/d 满/a ，/wd 增加/v 分配/v 
    newbase=/x (/wkz ElemType/x */n )/wky realloc/x (/wkz L．elem/x ，/wd 
    (/wkz L．1istsize+LISTINCREMENT/x )/wky */n sizeof/x (/wkz ElemType/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt newbase/x )/wky exit/x (/wkz 0VERFLOW/x )/wky ；/wf     ∥/w 存储分配/n 失败/vi 
    L．elem：newbase/x ；/wf     ∥/w 新/a 基址/n 
    L．1istsize+=LISTINCREMENT/x ；/wf   ∥/w 增加/v 存储容量/n 
    }/n   
    q：/x &/n (/wkz L．elem/x [/wkz i/x 一/m 1/m ]/wky )/wky ；/wf     ∥/w q/x 为/p 插入/v 位置/n 
    for/x (/wkz p：/x ＆/n (/wkz L．elem/x [/wkz L．1ength―1/x ]/wky )/wky ；/wf P/x >/n =q/x ；/wf --/wp P/x )/wky */n (/wkz P+1/x )/wky ：/wp 。/wj p/x ；/wf 
    ∥/w 插入/v 位置/n 及/cc 之后/f 的/ude1 元素/n 右/f 移/v 
    */n q=e/x ；/wf     ∥/w 插入/v e/x 
    ++L．1ength/x ；/wf     ∥/w 表/n 长/ad 增/v l/x 
    return/x  OK/x ；/wf 
}/n ∥/w Listlnsert―Sq/x 
算法/n 2．4/m 
    反之/c ，/wd 线性/n 表/n 的/ude1 删除/v 操作/v 是/vshi 使/v 长度/n 为/v n/x 的/ude1 线性/n 表/n 
    (/wkz a1/x ，/wd …/ws ，/wd ai-/x  1/m ，/wd ai/x ，/wd ai+l/x ，/wd …/ws ，/wd an/x )/wky 
变成/v 长度/n 为/v n-1/x 的/ude1 线性/n 表/n 
    (/wkz a1/x ，/wd …/ws ，/wd ai-1/x ，/wd ai+1/x ，/wd …/ws ，/wd an/x )/wky 
数据/n 元素/n ai-1/x 。/wj ai/x 和/cc ai+l/x 之间/f 的/ude1 逻辑关系/n 发生变化/n ，/wd 为了/p 在/p 存储/vn 结构/n 上/f 反映/v 这个/rz 变化/vn ，/wd 同样/d 需要/v 移动/vn 元素/n 。/wj 如/v 图/n 2．4/m 所/usuo 示/vg ，/wd 为了/p 删除/v 第4/m 个/q 数据/n 元素/n ，/wd 必须/d 将/d 从/p 第5/m 个/q 至/p 第8/m 个/q 元素/n 都/d 依次/d 往/p 前/f 移动/v 一个/mq 位置/n 。/wj 
    一般/a 情况/n 下/f ，/wd 删除/v 第/m i/x (/wkz 1≤i≤n/x )/wky 个/q 元素/n 时/ng 需/v 将/d 从/p 第/m i+1/x 至/p 第/m n/x 个/q 元素/n 依次/d 向前/vi 移动/v 一个/mq 位置/n ，/wd 如/v 算法/n 2．5/m 所/usuo 示/vg 。/wj 
  Status/x  ListDelete―sq/x (/wkz SqList/x &/n L/x ，/wd int/x  i/x ，/wd ElemType/x ＆/n e/x )/wky {/n 
    ∥/w 在/p 顺序/n 线性/n 表/n L/x 中/f 删除/v 第/m i/x 个/q 元素/n ，/wd 并/cc 用/v e/x 返回/v 其/rz 值/n 
    ∥/w i/x 的/ude1 合法/a 值/n 为/v 1≤i≤ListLength―Sq/x (/wkz L/x )/wky 
    if/x (/wkz (/wkz i/x </n 1/m )/wky j/x  J/x (/wkz i/x >/n L．1ength/x )/wky )/wky return/x  ERROR/x ；/wf   ∥/w i/x 值/n 不/d 合法/a 
    P/x 。/wj &/n (/wkz L．elem/x [/wkz i/x 一/m 1/m ]/wky )/wky ；/wf     ∥/w P/x 为/v 被/pbei 删除/v 元素/n 的/ude1 位置/n 
    e/x 。/wj */n p/x ；/wf     ∥/w 被/pbei 删除/v 元素/n 的/ude1 值/n 赋/ng 给/v e/x 
    q/x 。/wj L．elem+L．1ength/x 一/m 1/m ；/wf     ∥/w 表/vg 尾/ng 元素/n 的/ude1 位置/n 
    for/x (/wkz +/m ’/wyy p/x ；/wf P/x </n 。/wj q/x ；/wf +/m ’/wyy p/x )/wky */n (/wkz P/x 一/m 1/m )/wky =/m */n p/x ；/wf     ∥/w 被/pbei 删除/v 元素/n 之后/f 的/ude1 元素/n 左/f 移/v 
・/w 24・/m 
    --/wp L．1ength：/x 
    return/x  OK/x ；/wf 
}/n ∥/w ListDelete―sq/x 
∥/w 表/n 长/ad 减/v 1/m 
算法/n 2．5/m     ．/w 
    从/p 算法/n 2．4/m 和/cc 2．5/m 可见/c ，/wd 当/v 在/p 顺序/n 存储/vn 结构/n 的/ude1 线性/n 表/n 中/f 某个/rz 位置/n 上/f 插入/v 或/c 删除/v 一个/mq 数据/n 元素/n 时/ng ，/wd 其/rz 时间/n 主要/d 耗费/v 在/p 移动/vn 元素/n 上/f (/wkz 换句话说/c ，/wd 移动/vn 元素/n 的/ude1 操作/vn 为/v 预估/v 算法/n 时间/n 复杂度/n 的/ude1 基本/ad 操作/v )/wky ，/wd 而/cc 移动/vn 元素/n 的/ude1 个数/n 取决于/v 插入/v 或/c 删除/v 元素/n 的/ude1 位置/n 。/wj 
    假设/n A/x 是/vshi 在/p 第/m i/x 个/q 元素/n 之前/f 插入/v 一个/mq 元素/n 的/ude1 概率/n ，/wd 则/c 在/p 长度/n 为/v n/x 的/ude1 线性/n 表/n 中/f 插入/v 一个/mq 元素/n 时/ng 所/usuo 需/v 移动/vn 元素/n 次数/n 的/ude1 期望值/n (/wkz 平均/a 次数/n )/wky 为/v 
    Eis=∑pi/x (/wkz n-i+1/x )/wky     (/wkz 2―3/m )/wky 
    假设/n qi/x 是/vshi 删除/v 第/m i/x 个/q 元素/n 的/ude1 概率/n ，/wd 则/c 在/p 长度/n 为/v n/x 的/ude1 线性/n 表/n 中/f 删除/v 一个/mq 元素/n 时/ng 所/usuo 需/v 移动/vn 元素/n 次数/n 的/ude1 期望值/n (/wkz 平均/a 次数/n )/wky 为/v 
    EdI=∑qi/x (/wkz n-i/x )/wky     (/wkz 2―4/m )/wky 
不/d 失/v 一般性/n ，/wd 我们/rr 可以/v 假定/n 在/p 线性/n 表/n 的/ude1 任何/rz 位置/n 上/f 插入/v 或/c 删除/v 元素/n 都/d 是/vshi 等/v 概率/n 的/ude1 ，/wd 即/v 
则/d 式/k (/wkz 2―3/m )/wky 和/cc (/wkz 2―4/m )/wky 可/v 分别/d 简化/v 为/v 式/k (/wkz 2．5/m )/wky 和/cc (/wkz 2―6/m )/wky ：/wp 
    由/p 式/k (/wkz 2．5/m )/wky 和/cc (/wkz 2-6/m )/wky 可见/v ，/wd 在/p 顺序/n 存储/vn 结构/n 的/ude1 线性/n 表/n 中/f 插入/v 或/c 删除/v 一个/mq 数据/n 元素/n ，/wd 平均/ad 约/v 移动/vn 表/n 中/f 一半/m 元素/n 。/wj 若/c 表/n 长/ad 为/v n/x ，/wd 则/c 算法/n L/x ,/wd istInserlt/x _/n sq/x 和/cc ListDelete―Sq/x 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n/x )/wky 。/wj 
    现在/t 我们/rr 来/vf 讨论/v 2．1/m 节/q 中/b 例/n 2―1/m 和/cc 例/n 2―2/m 的/ude1 操作/vn 在/p 顺序/n 存储/vn 结构/n 的/ude1 线性/n 表/n 中/f 的/ude1 实现/vn 方法/n 和/cc 时间/n 复杂度/n 的/ude1 分析/vn 。/wj 容易/ad 看出/v ，/wd 顺序/n 表/n 的/ude1 “/wyz 求/v 表/vg 长/ng ”/wyy 和/cc “/wyz 取/v 第/m i/x 个/q 数据/n 元素/n 的/ude1 时间/n 复杂度/n 均/d 为/v 0/m (/wkz 1/m )/wky ，/wd 又/c 这/rzv 两/m 个/q 例子/n 中/f 进行/vx 的/ude1 “/wyz 插入/v ”/wyy 操作均/n 在/p 表/n 尾/ng 进行/vx ，/wd 则/c 不/d 需要/v 移动/vn 元素/n 。/wj 因此/c ，/wd 算法/n 2．1/m 的/ude1 执行/vn 时间/n 主要/d 取决于/v 查找/v 函数/n Lx/x ~/n cateElem/x 的/ude1 执行/vn 时间/n 。/wj 在/p 顺序/n 表/n L/x 中/f 查访/v 是否/v 存在/v 和/cc e/x 相同/a 的/ude1 数据/n 元素/n 的/ude1 最/d 简便/a 的/ude1 方法/n 是/vshi ，/wd 令/v e/x 和/cc L/x 中/f 的/ude1 数据/n 元素/n 逐个/d 比较/d 之/uzhi ，/wd 如/v 算法/n 2．6/m 所/usuo 示/vg 。/wj 从/p 算法/n 2．6/m 中/f 可见/v 。/wj 基本/ad 操作/v 是/vshi “/wyz 进行/vx 两/m 个/q 元素/n 之间/f 的/ude1 比较/vn ”/wyy ，/wd 若/c L/x 中/f 存在/v 和/cc e/x 相同/a 的/ude1 元素/n ni/x ，/wd 则/c 比较/v 次数/n 为/v i/x (/wkz 1≤i≤L．1ength/x )/wky ，/wd 否则/c 为/v L．1ength/x ，/wd 即/v 算法/n LocateElem-Sq/x 的/ude1 时间/n 复杂度/n 为/v o/x (/wkz L．1ength/x )/wky 。/wj 由此/d ，/wd 对于/p 顺序/n 表/n k/x 和/cc L6/x 而言/uls ，/wd union/x 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz La．1ength×Lb．1ength/x )/wky 。/wj 
    int/x  LocateElem―Sq/x (/wkz SqLJ．st/x  L/x ，/wd ElemType/x 
    St：/x ~/n ttg/x (/wkz */n compare/x )/wky (/wkz ElemType/x ，/wd ElemType/x )/wky )/wky {/n 
    ∥/w 在/p 顺序/n 线性/n 表/n L/x 中/f 查找/v 第1/m 个/q 值/n 与/p e/x 满足/v compare/x (/wkz )/wky 的/ude1 元素/n 的/ude1 位/q 序/n 
    ∥/w 若/c 找到/v ，/wd 则/c 返回/v 其/rz 在/p L/x 中/f 的/ude1 位/q 序/n ，/wd 否则/c 返回/v 0/m 
    i=I/x ；/wf     ∥/w i/x 的/ude1 初值/n 为/p 第1/m 个/q 元素/n 的/ude1 位/q 序/n 
    P=L．elem/x ；/wf     ∥/w p/x 的/ude1 初值/n 为/p 第1/m 个/q 元素/n 的/ude1 存储位置/n 
    while/x (/wkz i/x </n ：/wp L．1ength/x ＆/n &/n !/wt (/wkz */n compare/x )/wky (/wkz ’/wyy p++/x ，/wd e/x )/wky )/wky ++i/x ；/wf 
    if/x (/wkz i/x </n =L．1ength/x )/wky return/x  i/x ；/wf 
    else/x  return/x  0/m ；/wf 
算法/n 2．6/m 
　　对于/p “/wyz 顺序/n 表/n 的/ude1 合并/vn ”/wyy ，/wd 则/c 从/p 算法/n 2．2/m 可/v 直接/ad 写/v 出/vf 形式/n 上/f 极其/d 相似/a 的/ude1 算法/n 2．7/m 。/wj 显然/a ，/wd 算法/n 2．7/m 中/f 的/ude1 基本/ad 操作/v 为/v “/wyz 元素/n 赋值/v ”/wyy ，/wd 算法/n 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz La．1ength/x 十/m Lb．1ength/x )/wky 。/wj 
　　void/x  Merge/x _/n List―Sq/x (/wkz SqList/x  La/x ，/wd SqList/x  Lb/x ，/wd SqList/x ＆/n Lc/x )/wky {/n 
    ∥/w 已/d 知/v 顺序/n 线性/n 表/n La/x 和/cc Lb/x 的/ude1 元素/n 按/p 值/n 非/b 递减/vi 排列/v 
    ∥/w 归并/vi La/x 和/cc Lb/x 得到/v 新/a 的/ude1 顺序/n 线性/n 表/n Lc/x ，/wd Lc/x 的/ude1 元素/n 也/d 按/p 值/n 非/b 递减/vi 排列/v 
    pa=La．elem/x ；/wf pb=Lb．elem/x ；/wf 
    Lc．1istsize：Lc．1ength：La．1ength+Lb．1ength：/x 
    pc：Lc．elem：/x (/wkz ElemType/x */n )/wky ulloc/x (/wkz nc．1istsize/x */n sizeof/x (/wkz ElemType/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt Lc．elem/x )/wky exit/x (/wkz OVERFLOW/x )/wky ；/wf ∥/w 存储分配/n 失败/vi 
    pa―last：La．elem+La．1ength/x 一/m 1：/m 
    pb―last=Lb．elem+Lb．1ength/x 一/m 1：/m 
    while/x (/wkz pa/x </n =pa―last/x ＆/n ＆/n pb/x </n =pb―last/x )/wky {/n     ∥/w 归并/vi 
    if/x (/wkz */n pa/x </n =/m   */n pb/x )/wky */n pc/x 十/m +：/m */n pa/x 十/m +/m ；/wf 
    else/x */n pc++=/x */n pb++/x ；/wf 
    1/m 
    while/x (/wkz pa/x </n =pa―last/x )/wky 。/wj pc++=/x ”/wyy pa+/x ’/wyy ；/wf     ∥/w 插入/v La/x 的/ude1 剩余/vn 元素/n 
    while/x (/wkz pb/x </n =pb―last/x )/wky 。/wj pc++=/x */n pb+/x ’/wyy ；/wf     ∥/w 插入/v Lb/x 的/ude1 剩余/vn 元素/n 
＼/m   ?/ww {/n MergeList/x ，/wd Sq/x 
算法/n 2．7/m 
　　若/c 对/p 算法/n 2．7/m 中/f 第一/m 个/q 循环/vn 语句/n 的/ude1 循环体/n 作/v 如下/vi 修改/v ：/wp 以/p “/wyz 开关/n 语句/n ”/wyy 代替/v “/wyz 条件/n 语句/n ”/wyy ，/wd 即/d 分/v 出/vf 元素/n 比较/vn 的/ude1 第三/m 种/q 情况/n ，/wd 当/p */n pa=/x */n pb/x 时/ng ，/wd 只/d 将/p 两者/rzv 中/f 之一/rz 插入/v Lc/x ，/wd 则/c 该/rz 算法/n 完成/v 的/ude1 操作/vn 和/cc 算法/n union/x 完全/ad 相同/a ，/wd 而/cc 时间/n 复杂度/n 却/d 不同/a 。/wj 算法/n 2．7/m 之所以/c 有/vyou 线性/n 的/ude1 时间/n 复杂度/n ，/wd 其/rz 原因/n 有/vyou 二：/m 1/m )/wky 由于/p La/x 和/cc Lb/x 中/b 元素/n 依/nr1 值/n 递增/vi (/wkz 同一/b 集合/n 中/b 元素/n 不等/vi )/wky ，/wd 则/c 对/p Lb/x 中/f 每个/r 元素/n ，/wd 不/d 需要/v 在/p La/x 中/f 从/p 表头/n 至/p 表/n 尾/ng 进行/vx 全程/n 搜索/vn ；/wf 2/m )/wky 由于/c 用/p 新/a 表/n Lc/x 表示/v “/wyz 并/d 集/vg ”/wyy ，/wd 则/c 插入/v 操作/v 实际上/d 是/vshi 借助/v “/wyz 复制/v ”/wyy 操作/v 来/vf 完成/v 的/ude1 ①/m 。/wj 为/p 得到/v 元素/n 依/nr1 值/n 递增/vi (/wkz 或/c 递减/vi )/wky 的/ude1 有序/a 表/n ，/wd 可/c 利用/v 10．3/m 节/q 讨论/vn 的/ude1 快速/b 排序/vn ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz nlogn/x )/wky (/wkz 其中/rz n/x 为/v 待/vi 排序/vi 的/ude1 元素/n 个数/n )/wky 。/wj 由此可见/c ，/wd 若/c 以/p 线性/n 表表示/n 集合/v 并/cc 进行/vx 集合/vn 的/ude1 各种/rz 运算/vn ，/wd 应/v 先/d 对/p 表/n 中/b 元素/n 进行/vx 排序/vn 。/wj 
2．3/m 线性/n 表/n 的/ude1 链式/n 表示/v 和/cc 实现/v 
    从/p 上/f 一/m 节/q 的/ude1 讨论/vn 中/f 可见/v ，/wd 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 的/ude1 特点/n 是/vshi 逻辑关系/n 上/f 相邻/vi 的/ude1 两/m 个/q 元素/n 在/p 物理/n 位置/n 上/f 也/d 相邻/vi ，/wd 因此/c 可以/v 随机/b 存取/vn 表/n 中/f 任/v 一/m 元素/n ，/wd 它/rr 的/ude1 存储位置/n 可/v 用/p 一个/mq 简单/a 、/wn 直观/a 的/ude1 公式/n 来/vf 表示/v 。/wj 然而/c ，/wd 从/p 另一方面/c 来看/v ，/wd 这个/rz 特点/n 也/d 铸成/v 了/ule 这种/r 存储/vn 结构/n 的/ude1 弱点/n ：/wp 在/p 作/v 插入/v 或/c 删除/v 操作/v 时/ng ，/wd 需/v 移动/v 大量/m 元素/n 。/wj 本/rz 节/n 我们/rr 将/d 讨论/v 线性/n 表/n 的/ude1 另/rz 一/m 种/q 表示方法/n ――/wp 链式/n 存储/v 结构/n ，/wd 由于/c 它/rr 不/d 要求/v 逻辑/n 上/f 相邻/vi 的/ude1 元素/n 在/p 物理/n 位置/n 上/f 也/d 相邻/vi ，/wd 因此/c 它/rr 没有/v 顺序/n 存储/vn 结构/n 所/usuo 具有/v 的/ude1 弱点/n ，/wd 但/c 同时/c 也/d 失去/v 了/ule 顺序/n 表/vg 可/v 随机/d 存取/v 的/ude1 优点/n 。/wj 
    2．3．1/m 线性/n 链/ng 表/n 
    线性/n 表/n 的/ude1 链式/n 存储/v 结构/n 的/ude1 特点/n 是/vshi 用/p 一/m 组/q 任意/b 的/ude1 存储单元存储/n 线性/n 表/n 的/ude1 数据/n 元素/n (/wkz 这/rzv 组/q 存储单元/n 可以/v 是/vshi 连续/a 的/ude1 ，/wd 也/d 可以/v 是/vshi 不/d 连续/a 的/ude1 )/wky 。/wj 因此/c ，/wd 为了/p 表示/v 每个/r 数据/n 元素/n 。/wj i/x 与/p 其/rz 直接/a 后/f 继/vg 数据/n 元素/n ai+/x ，/wd 之间/f 的/ude1 逻辑关系/n ，/wd 对/p 数据/n 元素/n ai/x 来说/uls ，/wd 除了/p 存储/v 其/rz 本身/rz 的/ude1 信息/n 之外/f ，/wd 还/d 需/v 存储/v 一个/mq 指示/n 其/rz 直接/a 后/f 继/vg 的/ude1 信息/n (/wkz 即/v 直接/a 后/f 继/vg 的/ude1 存储位置/n )/wky 。/wj 这/rzv 两/m 部分/m 信息/n 组成/v 数据/n 元素/n ai/x 的/ude1 存储/vn 映象/n ，/wd 称为/v 结点/n (/wkz Node/x )/wky 。/wj 它/rr 包括/v 两/m 个/q 域/n ：/wp 其中/rz 存储数据/n 元素/n 信息/n 的/ude1 域/ng 称为/v 数据/n 域/ng ；/wf 存储/v 直接/a 后/f 继/vg 存储位置/n 的/ude1 域/ng 称/v 为/p 指针/n 域/ng 。/wj 指针/n 域/ng 中/f 存储/v 的/ude1 信息/n 称做/v 指针/n 或/c 链/ng 。/wj n/x 个/q 结点/n (/wkz ai/x (/wkz 1≤i≤n/x )/wky 的/ude1 存储/vn 映象/n )/wky 链/ng 结成/v 一个/mq 链/ng 表/n ，/wd 即/d 为/v 线性/n 表/n 
　　(/wkz a1/x ，/wd a2/x ，/wd …/ws ，/wd an/x )/wky     
　　的/ude1 链式/n 存储/v 结构/n 。/wj 又/d 由于/p 此/rzs 链/ng 表/n 的/ude1 每个/r 结点/n 中/f 只/d 包含/v 一个/mq 指针/n 域/ng ，/wd 故/c 又/d 称/v 线性/n 链/ng 表/n 或/c 单链/n 表/n 。/wj 
    例如/v ，/wd 图/n 2．5/m 所/usuo 示/vg 为/p 线性/n 表/n 
    (/wkz ZHAO/x ，/wd QIAN/x ，/wd SUN/x ，/wd LI/x ，/wd ZHOU/x ，/wd WU/x ，/wd ZHENG/x ，/wd WANG/x )/wky 
的/ude1 线性/n 链/ng 表存储/n 结构/n ，/wd 整个/b 链/ng 表/n 的/ude1 存取/vn 必须/d 从/p 头/n 指针/n 开始/v 进行/vx ，/wd 头/q 指针/n 指示/n 链/ng 表/n 中/f 第一/m 个/q 结点/n (/wkz 即/v 第一/m 个/q 数据/n 元素/n 的/ude1 存储/vn 映象/n )/wky 的/ude1 存储位置/n 。/wj 同时/c ，/wd 由于/p 最后/f 一个/mq 数据/n 元素/n 没有/d 直接/a 后/f 继/vg ，/wd 则/c 线性/n 链/ng 表/n 中/f 最后/f 一个/mq 结点/n 的/ude1 指针/n 为/v “/wyz 空/ng ”/wyy (/wkz NULL/x )/wky 。/wj 
    存储/vn 地址/n     数据/n 域/ng     指针/n 域/ng 
    l/x     LI/x     43/m 
    7/m     QIAN/x     13/m 
头/m 指针/n H/x     13/m     SUN/x     1/m 
19WANG/x     NuLL/x 
25/m     WU/x     37/m 
    3l/x     ZHAo/x     7/m 
    37/m     ZHENG/x     19/m 
    43/m     ZH/x (/wkz )/wky U/x     25/m 
    图/n 2/m  5/m 线性/n 链/ng 表示/v 例/n 
    用/p 线性/n 链/ng 表表示/n 线性/n 表/vg 时/ng ，/wd 数据/n 元素/n 之间/f 的/ude1 逻辑关系/n 是/vshi 由/p 结点/n 中/f 的/ude1 指针/n 指示/n 的/ude1 。/wj 换句话说/c ，/wd 指针/n 为/p 数据/n 元素/n 之间/f 的/ude1 逻辑关系/n 的/ude1 映象/n ，/wd 则/c 逻辑/n 上/f 相邻/vi 的/ude1 两/m 个/q 数据/n 元素/n 其/rz 存储/vn 的/ude1 物理/n 位置/n 不/d 要求/v 紧邻/n ，/wd 由此/d ，/wd 这种/r 存储/vn 结构/n 为/p 非/b 顺序/n 映象/n 或/c 链式/n 映象/n 。/wj 
    通常/d 我们/rr 把/pba 链/ng 表/vg 画/n 成/v 用/p 箭头/n 相/d 链接/n 的/ude1 结点/n 的/ude1 序列/n ，/wd 结点/n 之间/f 的/ude1 箭头/n 表示/v 链/ng 域/ng 中/f 的/ude1 指针/n 。/wj 如/v 图/n 2．5/m 的/ude1 线性/n 链/ng 表/n 可/v 画/v 成/v 如/v 图/n 2．6/m 所/usuo 示/vg 的/ude1 形式/n ，/wd 这/rzv 是/vshi 因为/p 在/p 使用/v 链/ng 表/vg 时/ng ，/wd 关心/v 的/ude1 只/d 是/vshi 它/rr 所/usuo 表示/v 的/ude1 线性/n 表/vg 中/b 数据/n 元素/n 之间/f 的/ude1 逻辑/n 顺序/n ，/wd 而/cc 不/d 是/vshi 每个/r 数据/n 元素/n 在/p 存储器/n 中/f 的/ude1 实际/a 位置/n 。/wj 
    图/n 2．6/m 线性/n 链/ng 表/n 的/ude1 逻辑状态/n 
由/p 上述/b 可见/c ，/wd 单链/n 表/n 可/v 由头/n 指针/n 唯一/d 确定/v ，/wd 在/p c/x 语言/n 中/f 可/v 用/p “/wyz 结构/n 指针/n ”/wyy 来/f 描述/v 。/wj 
    ∥/w --/wp 线性/n 表/n 的/ude1 单链/n 表存储/n 结构/n ---/wp 
typedef/x  struct/x  Node/x {/n 
    ElemType/x  data：/x 
    struct/x  LNode/x     */n next：/x 
}/n IA/x ~/n ode/x ，/wd */n LinkLlst/x ；/wf 
    假设/n L/x 是/vshi LinkIist/x 型/k 的/ude1 变量/n ，/wd 则/d L/x 为/p 单链/n 表/n 的/ude1 头/n 指针/n ，/wd 它/rr 指向/v 表/n 中/f 第一/m 个/q 结点/n 。/wj 若/v L/x 为/v “/wyz 空/ng ”/wyy (/wkz L=NuLL/x )/wky ，/wd 则/d 所/usuo 表示/v 的/ude1 线性/n 表/vg 为/p “/wyz 空/ng ”/wyy 表/n ，/wd 其/rz 长度/n n/x 为/v “/wyz 零/m ”/wyy 。/wj 有时/d ．/w 我们/rr 在/p 单链/n 表/n 的/ude1 第一/m 个/q 结点/n 之前/f 附设/v 一个/mq 结点/n ，/wd 称之为/v 头/n 结点/n 。/wj 头/n 结点/n 的/ude1 数据/n 域/ng 可以/v 不/d 存储/v 任何/rz 信息/n ，/wd 也/d 可/v 存储/v 如/v 线性/n 表/n 的/ude1 长度/n 等/udeng 类/n 的/ude1 附加/vn 信息/n ，/wd 头/n 结点/n 的/ude1 指针/n 域/ng 存储/v 指向/v 第一/m 个/q 结点/n 的/ude1 指针/n (/wkz 即/v 第一/m 个/q 元素/n 结点/n 的/ude1 存储位置/n )/wky 。/wj 如/v 图/n 2．7/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 此时/r ，/wd 单链/n 表/n 的/ude1 头/n 指针/n 指向/v 头/n 结点/n 。/wj 若/c 线性/n 表/vg 为/p 空/a 表/n ，/wd 则/c 头/n 结点/n 的/ude1 指针/n 域/ng 为/v “/wyz 空/ng ”/wyy ，/wd 如/v 图/n 2．7/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
图/n 2．7/m 带头/vd 结点/n 的/ude1 单链/n 表/n 
  (/wkz a/x )/wky 非空/n 表/n ；/wf (/wkz b/x )/wky 空/v 表/n 。/wj 
　　在/p 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 中/f ，/wd 由于/c 逻辑/n 上/f 相邻/vi 的/ude1 两/m 个/q 元素/n 在/p 物理/n 位置/n 上/f 紧邻/v ，/wd 则/c 每个/r 元素/n 的/ude1 存储位置/n 都/d 可/v 从/p 线性/n 表/n 的/ude1 起始/vn 位置/n 计算/v 得到/v 。/wj 而/cc 在/p 单链/n 表/n 中/f ，/wd 任何/rz 两/m 个/q 元素/n 的/ude1 存储位置/n 之间/f 没有/d 固定/a 的/ude1 联系/vn 。/wj 然而/c ，/wd 每个/r 元素/n 的/ude1 存储位置/n 都/d 包含/v 在/p 其/rz 直接/a 前驱/n 结点/n 的/ude1 信息/n 之中/f 。/wj 假设/n p/x 是/vshi 指向/v 线性/n 表/n 中/f 第/m i/x 个/q 数据/n 元素/n (/wkz 结点/n ai/x )/wky 
　　①/m 的/ude1 指针/n ，/wd 则/d p-/x >/n next/x 是/vshi 指/v     ①/m 结点/n ai/x 指/v 其/rz 数据/n 域/ng 为/v ai/x 的/ude1 结点/n ，/wd 而/cc p/x 结点/n 则/d 指/v 指针/n p/x 所/usuo 指向/v 的/ude1 结点/n (/wkz 即/v 其/rz 存储位置/n 存放/v 在/p p/x 中/f 的/ude1 结点/n )/wky 。/wj 以后/f 均/d 类同/v 。/wj 
向/p 第/m i+1/x 个/q 数据/n 元素/n (/wkz 结点/n ai+1/x )/wky 的/ude1 指针/n 。/wj 换句话说/c ，/wd 若/c p-/x >/n data=ai/x ，/wd 则/d p-/x >/n next-/x >/n data=ai+1/x 。/wj 由此/d ，/wd 在/p 单链/n 表/n 中/f ，/wd 取得/v 第/m i/x 个/q 数据/n 元素/n 必须/d 从/p 头/n 指针/n 出发/vi 寻找/v ，/wd 因此/c ，/wd 单链/n 表/vg 是非/n 随机/d 存取/v 的/ude1 存储/vn 结构/n 。/wj 下面/f 我们/rr 看/v 函数/n GetElem/x 在/p 单链/n 表/n 中/f 的/ude1 实现/vn 。/wj 
Staru8/x  GetElem―L/x (/wkz LinkList/x  L/x ，/wd int/x  i/x ，/wd ElemType/x ＆/n e/x )/wky l/x 
    ∥/w L/x 为/v 带头/vd 结点/n 的/ude1 单链/n 表/n 的/ude1 头/n 指针/n 。/wj 
    ∥/w 当/p 第/m i/x 个/q 元素/n 存在/v 时/ng ，/wd 其/rz 值/n 赋/ng 给/v e/x 并/cc 返回/v 0K/x ，/wd 否则/c 返回/v ERROR/x 
    p=L-/x >/n next/x ；/wf j=1/x ；/wf     ∥/w 初始化/v ，/wd p/x 指向/v 第一/m 个/q 结点/n ，/wd j/x 为/p 计数器/n 
    while/x (/wkz p/x &/n &/n j/x </n i/x )/wky {/n     ∥/w 顺/v 指针/n 向/p 后/f 查找/v ，/wd 直到/v p/x 指向/v 第/m i/x 个/q 元素/n 或/c p/x 为/v 空/ng 
    p=p-/x >/n next/x ；/wf ++j/x ；/wf 
    }/n 
    if/x (/wkz !/wt p/x ¨/n >/n i/x )/wky return/x  ERROR/x ；/wf   ∥/w 第/m i/x 个/q 元素/n 不/d 存在/v 
    e=p-/x >/n data/x ；/wf     ∥/w 取/v 第/m i/x 个/q 元素/n 
    return/x  OK：/x 
I/x ∥/w GetElem/x  L/x 
算法/n 2．8/m 
    算法/n 2．8/m 的/ude1 基本/a 操作/vn 是/vshi 比较/d i/x 和/cc i/x 并/cc 后移/vn 指针/n ，/wd while/x 循环体/n 中/f 的/ude1 语句/n 频度/n 与/cc 被/pbei 查/v 元素/n 在/p 表/n 中/b 位置/n 有关/vn ，/wd 若/c 1≤i≤/x 表/n 长/ad 挖/v ，/wd 则/c 频度/n 为/v i/x 一/m 1/m ，/wd 否则/c 频度/n 为/v n/x ，/wd 因此/c 算法/n 2．8/m 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n/x )/wky 。/wj 
　　在/p 单链/n 表/n 中/f ，/wd 又/d 如何/ryv 实现/v “/wyz 插入/v ”/wyy 和/cc “/wyz 删除/v ”/wyy 操作/v 呢/y ?/ww 
    假设/v 我们/rr 要/v 在/p 线性/n 表/n 的/ude1 两/m 个/q 数据/n 元素/n a/x 和/cc b/x 之间/f 插入/v 一个/mq 数据/n 元素/n x/x ，/wd 已/d 知/v p/x 为/p 其/rz 单链/n 表存储/n 结构/n 中/f 指向/v 结点/n 。/wj     图/n 2．8/m 在/p 单链/n 表/n 中/f 插入/v 结点/n 时/ng 指针/n 变化/vn 状况/n 的/ude1 指针/n 。/wj 如/v 图/n 2．8/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj     (/wkz a/x )/wky 插入/v 前/f ；/wf (/wkz b/x )/wky 插入/v 后/f 。/wj 
    为/p 插入/v 数据/n 元素/n x/x ，/wd 首先/d 要/v 生成/v 一个/mq 数据/n 域/ng 为/v x/x 的/ude1 结点/n ，/wd 然后/c 插入/v 在/p 单链/n 表/n 中/f 。/wj 根据/p 插入/v 操作/v 的/ude1 逻辑/n 定义/n ，/wd 还/d 需要/v 修改/v 结点/n a/x 中/f 的/ude1 指针/n 域/ng ，/wd 令/v 其/rz 指向/v 结点/n x/x ，/wd 而/cc 结点/n x/x 中/f 的/ude1 指针/n 域/ng 应/v 指向/v 结点/n b/x ，/wd 从而/c 实现/v 三/m 个/q 元素/n a/x ，/wd b/x 和/cc x/x 之间/f 逻辑关系/n 的/ude1 变化/vn 。/wj 插入/v 后/f 的/ude1 单链/n 表/n 如/v 图/n 2．8/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 假设/n s/x 为/p 指向/v 结点/n x/x 的/ude1 指针/n ，/wd 则/c 上述/b 指针/n 修改/v 用/p 语句/n 描述/vn 即/d 为/v ：/wp 
    s-/x >/n next=p-/x >/n next/x ；/wf   p-/x >/n next=s/x ；/wf 
    反之/c ，/wd 如/v 图/n 2．9/m 所/usuo 示/vg 在/p 线性/n 表/n 中/f 删除/v 元素/n b/x 时/ng ，/wd 为/v 在/p 单链/n 表/n 中/f 实现/v 元素/n a/x 、/wn b/x 和/cc c/x 之间/f     逻辑关系/n 的/ude1 变化/vn ，/wd 仅/d 需/v 修改/v 结点/n a/x 中/f 的/ude1 指针/n 域/ng 即可/v 。/wj 假设/n p/x 为/p 指向/v 结点/n a/x 的/ude1 指针/n ，/wd 则/c 修改/v 指针/n 的/ude1 语句/n 为/v ：/wp 
    p-/x >/n next：=p-/x >/n next-/x >/n next/x ；/wf 
　　图/n 2．9/m 在/p 单链/n 表/n 中/f 删除/v 结点/n 时/ng 指针/n     
　　可见/c ，/wd 在/p 已/d 知/v 链/ng 表/vg 中/b 元素/n 插入/v 或/c 删除/v 的/ude1 确切/a 位置/n 变化/vn 状况/n 的/ude1 情况/n 下/f ，/wd 在/p 单链/n 表/n 中/f 插入/v 或/c 删除/v 一个/mq 结点/n 时/ng ，/wd 仅/d 需/v 修改/v 指针/n 而/cc 不/d 需要/v 移动/vn 元素/n 。/wj 算法/n 2．9/m 和/cc 算法/n 2．10/m 分别/d 为/v ListInsert/x 和/cc ListDelete/x 在/p 单链/n 表/n 中/f 的/ude1 实现/vn 。/wj 
    starus/x  ListInsert―L/x (/wkz LinkList/x &/n L/x ，/wd int/x  i/x ，/wd ElemType/x  e/x )/wky {/n 
    ∥/w 在/p 带头/vd 结点/n 的/ude1 单链/n 线性/n 表/n L/x 中/f 第/m i/x 个/q 位置/n 之前/f 插入/v 元素/n e/x 
    P=L/x ；/wf   J：0/x ；/wf 
    while/x (/wkz p/x &/n &/n J/x </n i/x 一/m 1/m )/wky {/n P=P-/x >/n next/x ；/wf 十/m +J/x ；/wf }/n   ∥/w 寻找/v 第/m i/x 一/m 1/m 个/q 结点/n 
    if/x (/wkz !/wt P/x  ll/x  J/x >/n i/x 一/m 1/m )/wky return/x  ERROR/x ；/wf     ∥/w i/x 小于/v 1/m 或者/c 大于/v 表/vg 长/a 
    s=/x (/wkz LinkList/x )/wky mallo=/x (/wkz sizeof/x (/wkz LNode/x )/wky )/wky ；/wf     ∥/w 生成/v 新/a 结点/n 
    S-/x >/n data=e/x ；/wf s-/x >/n next=P-/x >/n next/x ；/wf     ∥/w 插入/v L/x 中/f 
    P-/x >/n next=s：/x 
    return/x  OK/x ；/wf 
    }/n ∥/w I．instlnsert―L/x 
算法/n 2．9/m 
Status/x  ListDelete―L/x (/wkz LinkList/x ＆/n L/x ，/wd int/x  i/x ，/wd ElemType/x ＆/n e/x )/wky {/n 
    ∥/w 在/p 带头/vd 结点/n 的/ude1 单链/n 线性/n 表/n L/x 中/f ，/wd 删除/v 第/m i/x 个/q 元素/n ，/wd 并/cc 由/p e/x 返回/v 其/rz 值/n 
    P=L/x ；/wf j=0/x ；/wf 
    while/x (/wkz P-/x >/n next/x ＆/n ＆/n J/x </n i/x 一/m 1/m )/wky {/n   ∥/w 寻找/v 第/m i/x 个/q 结点/n ，/wd 并/cc 令/v P/x 指向/v 其/rz 前/f 趋/v 
    P=P-/x >/n next/x ；/wf   ++J/x ；/wf 
    }/n 
    if/x (/wkz !/wt (/wkz p-/x >/n next/x )/wky f1/x  j/x >/n i/x 一/m 1/m )/wky return/x  ERROR/x ；/wf ∥/w 删除/v 位置/n 不/d 合理/a 
    q=P-/x >/n next/x ；/wf P-/x >/n next=q-/x >/n next/x ；/wf     ∥/w 删除/v 并/cc 释放/v 结点/n 
    e=q-/x >/n data/x ；/wf free/x (/wkz q/x )/wky ；/wf 
    return/x  OK：/x   ‘/wyz 
l/x ∥/w ListDelete-L/x 
    算法/n 2．10/m 
    容易/ad 看出/v ，/wd 算法/n 2．9/m 和/cc 算法/n 2．10/m 的/ude1 时间/n 复杂度/n 均/d 为/v o/x (/wkz n/x )/wky 。/wj 这/rzv 是/vshi 因为/c ，/wd 为/v 在/p 第/m i/x 个/q 结点/n 之前/f 插入/v 一个/mq 新/a 结点/n 或/c 删除/v 第/m i/x 个/q 结点/n ，/wd 都/d 必须/d 首先/d 找到/v 第/m i/x 一/m 1/m 个/q 结点/n ，/wd 即/d 需/v 修改/v 指针/n 的/ude1 结点/n ，/wd 从/p 算法/n 2．8/m 的/ude1 讨论/vn 中/f ，/wd 我们/rr 已经/d 得知/v ，/wd 它/rr 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz n/x )/wky 。/wj 
    在/p 算法/n 2．9/m 和/cc 2．10/m 中/f ，/wd 我们/rr 还/d 分别/d 引用/v 了/ule C/x 语言/n 中/f 的/ude1 两/m 个/q 标准函数/n malloc/x 和/cc free/x 。/wj 通常/d ，/wd 在/p 设有/v “/wyz 指针/n ”/wyy 数据/n 类型/n 的/ude1 高级语言/n 中/f 均/d 存在/v 与/p 其/rz 相应/vi 的/ude1 过程/n 或/c 函数/n 。/wj 假设/n P/x 和/cc q/x 是/vshi LinkList/x 型/k 的/ude1 变量/n ，/wd 则/c 执行/v P=/x (/wkz LinkList/x )/wky malloe/x (/wkz sizeof/x (/wkz LNode/x )/wky )/wky 的/ude1 作用/n 是/vshi 由/p 系统/n 生成/v 一个/mq LNode/x 型/k 的/ude1 结点/n ，/wd 同时/c 将/d 该/v 结点/n 的/ude1 起始/vn 位置/n 赋/ng 给/p 指针/n 变量/n p/x ；/wf 反之/c ，/wd 执行/v fr/x ~/n (/wkz q/x )/wky 的/ude1 作用/n 是/vshi 由/p 系统/n 回收/v 一个/mq LNode/x 型/k 的/ude1 结点/n ，/wd 回收/v 后/f 的/ude1 空间/n 可/v 以/p 备/v 作/v 再次/d 生成/v 结点/n 时/ng 用/v 。/wj 因此/c ，/wd 单链/n 表/n 和/cc 顺序/n 存储/vn 结构/n 不同/a ，/wd 它/rr 是/vshi 一/m 种/q 动态/n 结构/n 。/wj 整个/b 可用/a 存储空间/n 可/v 为/p 多/m 个/q 链/ng 表/n 共同/d 享用/v ，/wd 每个/r 链/ng 表/n 占用/v 的/ude1 空间/n 不/d 需/v 预先/d 分配/v 划定/v ，/wd 而是/c 可以/v 由/p 系统/n 应/v 需求/n 即时/d 生成/v 。/wj 因此/c ，/wd 建立/v 线性/n 表/n 的/ude1 链式/n 存储/v 结构/n 的/ude1 过程/n 就/d 是/vshi 一个/mq 动态/n 生成/v 链/ng 表/n 的/ude1 过程/n 。/wj 即/v 从/p “/wyz 空/a 表/n ”/wyy 的/ude1 初始状态/n 起/vf ，/wd 依次/d 建立/v 各/rz 元素/n 结点/n ，/wd 并/cc 逐个/d 插入/v 链/ng 表/n 。/wj 算法/n 2．11/m 是/vshi 一个/mq 从/p 表/n 尾/ng 到/v 表头/n 逆向/d 建立/v 单链/n 表/n 的/ude1 算法/n ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz n/x )/wky 。/wj 
void/x  CreateList―L/x (/wkz LinkList/x &/n L/x ，/wd imt/x  n/x )/wky {/n 
    ∥/w 逆/vg 位/q 序/n 输入/v n/x 个/q 元素/n 的/ude1 值/n ，/wd 建立/v 带/v 表头/n 结点/n 的/ude1 单链/n 线性/n 表/n L/x 。/wj 
    L：/x (/wkz LinkList/x )/wky malloc/x (/wkz slzeof/x (/wkz LNode/x )/wky )/wky ；/wf 
・/w   30・/m 
  L-/x >/n ，/wd aext=NULL/x ；/wf     ∥/w 先/d 建立/v 一个/mq 带头/vd 结点/n 的/ude1 单链/n 表/n 
  for/x (/wkz i=n/x ；/wf i/x >/n 0/m ；/wf --/wp i/x )/wky {/n 
    p=/x (/wkz LinkList/x )/wky malfoe/x (/wkz sizeof/x (/wkz LNode/x )/wky )/wky ；/wf   ∥/w 生成/v 新/a 结点/n 
    8canf/x (/wkz &/n p-/x >/n data/x )/wky ；/wf     ∥/w 输入/v 元素/n 值/n 
    p-/x >/n next=L-/x >/n next/x ；/wf L-/x >/n next=p/x ；/wf     ∥/w 插入/v 到/v 表头/n 
  I/x 
}/n ∥/w CreateList―L/x 
算法/n 2．1l/x 
    下面/f 讨论/v 如何/ryv 将/d 两/m 个/q 有序/a 链/ng 表/n 并/cc 为/v 一个/mq 有序/a 链/ng 表/n ?/ww 
　　假设/n 头/q 指针/n 为/v La/x 和/cc Lb/x 的/ude1 单链/n 表/n 分别/d 为/v 线性/n 表/n LA/x 和/cc LB/x 的/ude1 存储/vn 结构/n ，/wd 现/tg 要/v 归并/vi La/x 和/cc Lb/x 得到/v 单链/n 表/n Lc/x ，/wd 按照/p 2．1/m 节/q 中/b 算法/n MergeI．ist/x 的/ude1 思想/n ，/wd 需/v 设立/v 三/m 个/q 指针/n pa/x 、/wn pb/x 和/cc pc/x ，/wd 其中/rz pa/x 和/cc pb/x 分别/d 指向/v La/x 表/n 和/cc Lb/x 表/n 中/f 当前/t 待/vi 比较/d 插入/v 的/ude1 结点/n ，/wd 而/cc pc/x 指向/v Lc/x 表/n 中/f 当前/t 最后/f 一个/mq 结点/n ，/wd 若/c pa-/x >/n data≤pb-/x >/n data/x ，/wd 则/c 将/d pa/x 所/usuo 指/v 结点/n 链/ng 接到/v pc/x 所/usuo 指/v 结点/n 之后/f ，/wd 否则/c 将/d pb/x 所/usuo 指/v 结点/n 链/ng 接到/v pc/x 所/usuo 指/v 结点/n 之后/f 。/wj 显然/a ，/wd 指针/n 的/ude1 初始状态/n 为/v ：/wp 当/v LA/x 和/cc LB/x 为/p 非空/n 表/n 时/ng ，/wd pa/x 和/cc pb/x 分别/d 指向/v La/x 和/cc Lb/x 表/n 中/f 第一/m 个/q 结点/n ，/wd 否则/c 为/v 空/a ；/wf pc/x 指向/v 空/a 表/n Lc/x 中/f 的/ude1 头/n 结点/n 。/wj 由于/p 链/ng 表/n 的/ude1 长度/n 为/p 隐含/v 的/ude1 ，/wd 则/c 第一/m 个/q 循环/vn 执行/vn 的/ude1 条件/n 是/vshi pa/x 和/cc pb/x 皆/d 非空/n ，/wd 当/p 其中/rz 一个/mq 为/v 空/ng 时/ng ，/wd 说明/v 有/vyou 一个/mq 表/n 的/ude1 元素/n 已/d 归并/vi 完/vi ，/wd 则/c 只/d 要/v 将/p 另/rz 一个/mq 表/n 的/ude1 剩余/vn 段链/n 接/v 在/p pc/x 所/usuo 指/v 结点/n 之/uzhi 后/f 即可/v 。/wj 由此/d 得/ude3 到/v 归并/vi 两/m 个/q 单链/n 表/n 的/ude1 算法/n ，/wd 如/v 算法/n 2．12/m 所/usuo 示/vg 。/wj 
　　void/x  MergeList―L/x (/wkz LinkList/x &/n La/x ，/wd LinkList/x &/n Lb/x ，/wd LinkList/x ＆/n Lc/x )/wky {/n 
    ∥/w 已/d 知/v 单链/n 线性/n 表/n La/x 和/cc Lb/x 的/ude1 元素/n 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
    ∥/w 归并/vi La/x 和/cc Lb/x 得到/v 新/a 的/ude1 单链/n 线性/n 表/n 【/wkz Jc/x ，/wd k/x 的/ude1 元素/n 也/d 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
　　pa=La-/x >/n next/x ；/wf   pb=I．b-/x >/n next/x ；/wf 
　　Lc=pc=La/x ；/wf     ∥/w 用/v La/x 的/ude1 头/n 结点/n 作为/v Lc/x 的/ude1 头/n 结点/n 
    while/x (/wkz pa/x ＆/n &/n pb/x )/wky {/n 
    if/x (/wkz pa-/x >/n data/x </n =pb-/x >/n data/x )/wky j/x 
    pc-/x >/n next/x 。/wj pa/x ；/wf pc/x 。/wj pa/x ；/wf pa=pa-/x >/n next/x ；/wf 
    }/n 
    else/x {/n pc-/x >/n NeAt=pb/x ；/wf pc=pb：pb=pb-/x >/n next/x ；/wf }/n   ．/w 
    I/x 
    pc-/x >/n next=pa/x ?/ww pa：pb/x 
    free/x (/wkz Lb/x )/wky ；/wf 
}/n ∥/w MergeLi8t―L/x 
∥/w 插入/v 剩余/v 段/q 
∥/w 释放/v Lb/x 的/ude1 头/n 结点/n 
    算法/n 2．12/m 
    读者/n 容易/ad 看出/v ，/wd 算法/n 2．12/m 的/ude1 时间/n 复杂度/n 和/cc 算法/n 2．7/m 相同/a ，/wd 但/c 空间/n 复杂度/n 不同/a 。/wj 在/p 归并/vi 两/m 个/q 链/ng 表/n 为/v 一个/mq 链/ng 表/vg 时/ng ，/wd 不/d 需要/v 另/rz 建/v 新/a 表/n 的/ude1 结点/n 空间/n ，/wd 而/cc 只/d 需/v 将/d 原来/d 两/m 个/q 链/ng 表/n 中/f 结点/n 之间/f 的/ude1 关系/n 解除/v ，/wd 重新/d 按/p 元素/n 值/v 非/b 递减/vi 的/ude1 关系/n 将/p 所有/b 结点/n 链接/n 成/v 一个/mq 链/ng 表/n 即可/v 。/wj 
    有时/d ，/wd 也/d 可/v 借用/v 一/m 维/q 数组/n 来/vf 描述/v 线性/n 链/ng 表/n ，/wd 其/rz 类型/n 说明/v ，/wd 如/v 下/f 所/usuo 示/vg ：/wp 
    ∥/w --/wp …/ws 线性/n 表/n 的/ude1 静态/n 单链/n 表存储/n 结构/n -/wp …/ws -/wp 
    #/n defi∞MAXSIZE/x  1000/m   ∥/w 链/ng 表/n 的/ude1 最/d 大/a 长度/n 
    typ/x |/n def/x  struct/x {/n 
    ElemType/x  data/x ;/wf 
    int/x     cur/x ；/wf 
    }/n component/x ，/wd SLinklist/x [/wkz MAXSIZE/x ]/wky ；/wf 
这种/r 描述/vn 方法/n 便于/v 在/p 不/d 设/v “/wyz 指针/n ”/wyy 类型/n 的/ude1 高级/a 程序设计/n 语言/n 中/f 使用/v 链/ng 表/vg 结构/n 。/wj 在/p 如上/d 描述/v 的/ude1 链/ng 表/n 中/f ，/wd 数/m 组/q 的/ude1 一个/mq 分量/n 表示/v 一个/mq 结点/n ，/wd 同时/c 用/p 游标/n (/wkz 指示器/n cur/x )/wky 代替/v 指针/n 指示/n 结点/n 在/p 数/m 组/q 中/f 的/ude1 相对/b 位置/n 。/wj 数/m 组/q 的/ude1 第零/m 分量/n 可/v 看成/v 头/n 结点/n ，/wd 其/rz 指针/n 域/ng 指示/n 链/ng 表/n 的/ude1 第一/m 个/q 结点/n 。/wj 例如/v 图/n 2．10/m (/wkz a/x )/wky 中/f 所/usuo 示/vg 为/v 和/cc 图/n 2．6/m 相同/a 的/ude1 线性/n 表/n 。/wj 这种/r 存储/vn 结构/n 仍/d 需要/v 预先/d 分配/v 一个/mq 较/d 大/a 的/ude1 空间/n ，/wd 但/c 在/p 作/v 线性/n 表/n 的/ude1 插入/v 和/cc 删除/v 操作/v 时/ng 不/d 需/v 移动/vn 元素/n ，/wd 仅/d 需/v 修改/v 指针/n ，/wd 故/c 仍/d 具有/v 链式/n 存储/v 结构/n 的/ude1 主要/b 优点/n 。/wj 例如/v ，/wd 图/n 2．10/m (/wkz b/x )/wky 展示/v 了/ule 图/n 2．10/m (/wkz a/x )/wky 所/usuo 示/vg 线性/n 表/vg 在/p 插入/v 数据/n 元素/n “/wyz SHI/x ”/wyy 和/cc 删除/v 数据/n 元素/n “/wyz ZHENG/x "/n 之后/f 的/ude1 状况/n 。/wj 为了/p 和/cc 指针/n 型/k 描述/v 的/ude1 线性/n 链/ng 表/n 相/d 区别/v ，/wd 我们/rr 给/p 这种/r 用/p 数组/n 描述/vn 的/ude1 链/ng 表/vg 起/vf 名叫/v 静态/n 链/ng 表/n 。/wj 
    图/n 2．10/m 静态/n 链/ng 表示/v 例/n 
(/wkz a/x )/wky 修改/v 前/f 的/ude1 状态/n ；/wf (/wkz b/x )/wky 修改/v 后/f 的/ude1 状态/n 。/wj 
    假设/n s/x 为/v SLinkList/x 型/k 变量/n ，/wd 则/d s/x [/wkz 0/m ]/wky ．/w cur/x 指示/n 第一/m 个/q 结点/n 在/p 数/m 组/q 中/f 的/ude1 位置/n ，/wd 若/c 设/v i=s/x [/wkz 0/m ]/wky ．/w cur/x ，/wd 则/d s/x [/wkz i/x ]/wky ．/w data/x 存储/vn 线性/n 表/n 的/ude1 第一/m 个/q 数据/n 元素/n ，/wd 且/c s/x [/wkz i/x ]/wky ．/w cur/x 指示/n 第二/m 个/q 结点/n 在/p 数/m 组/q 中/f 的/ude1 位置/n 。/wj 一般/a 情况/n ，/wd 若第/nrf j/x 个/q 分量/n 表示/v 链/ng 表/n 的/ude1 第七/m 个/q 结点/n ，/wd 则/d s/x [/wkz i/x ]/wky ．/w cur/x 指示/n 第/m k+1/x 个/q 结点/n 的/ude1 位置/n 。/wj 因此/c 在/p 静态/n 链/ng 表/n 中/f 实现/v 线性/n 表/n 的/ude1 操作/vn 和/cc 动态链/n 表/vg 相似/a ，/wd 以/p 整/m 型/k 游标/n i/x 代替/v 动态/n 指针/n p/x ，/wd i=s/x [/wkz i/x ]/wky ．/w cur/x 的/ude1 操作/vn 实/ad 为/v 指针/n 后移/vn (/wkz 类似/v 于/p p=p-/x >/n next/x )/wky ，/wd 例如/v ，/wd 在/p 静态/n 链/ng 表/n 中/f 实现/v 的/ude1 定位/vn 函数/n LocateElem/x 如/v 算法/n 2．13/m 所/usuo 示/vg 。/wj 
int/x  LocateElem―sL/x (/wkz SLinkLJ．st/x  s/x ，/wd El/x ~/n Type/x  e/x )/wky {/n     ，/wd 
    ∥/w 在/p 静态/n 单链/n 线性/n 表/n L/x 中/f 查找/v 第1/m 个/q 值/n 为/v e/x 的/ude1 元素/n 。/wj 
    ∥/w 若/c 找到/v ，/wd 则/c 返回/v 它/rr 在/p L/x 中/f 的/ude1 位/q 序/n 。/wj 否则/c 返回/v 0/m 。/wj 
    i=s/x [/wkz 0/m ]/wky ．/w Cttr/x ；/wf     ∥/w i/x 指示/n 表/n 中/f 第一/m 个/q 结点/n 
    曲/n ile/x (/wkz i/x &/n &/n s/x [/wkz i/x ]/wky ．/w data/x !/wt =e/x )/wky i=s/x [/wkz i/x ]/wky ．/w cur-/x ；/wf     ∥/w 在/p 表/n 中/f 顺/v 链/ng 查找/v 
    return/x   i/x ；/wf 
l/x ∥/w LocateEl/x 锄/v 一/m sL/x 
    算法/n 2．13/m 
    类似/a 地/ude2 可/v 写/v 出/vf 在/p 静态/n 链/ng 表/n 中/f 实现/v 插入/v 和/cc 删除/v 操作/v 的/ude1 算法/n 。/wj 从/p 图/n 2j/x  10/m 的/ude1 例子/n 可见/c ，/wd 指针/n 修改/v 的/ude1 操作/vn 和/cc 前面/f 描述/v 的/ude1 单链/n 表/n 中/f 的/ude1 插入/v 和/cc 删除/v 的/ude1 算法/n 2．9/m ，/wd 2．10/m 类似/a ，/wd 所/usuo 不同/a 的/ude1 是/vshi ，/wd 需/v 由/p 用户/n 自己/rr 实现/v mall/x ~/n 和/cc free/x 这/rzv 两/m 个/q 函数/n 。/wj 为了/p 辨/vg 明/ag 数组/n 中/f 哪些/ry 分量/n 未/d 被/pbei 使用/v ，/wd 解决/v 的/ude1 办法/n 是/vshi 将/p 所有/b 未/d 被/pbei 使用/v 过/uguo 以及/cc 被/pbei 删除/v 的/ude1 分量/n 用/p 游标/n 链/ng 成/v 一个/mq 备用/vi 的/ude1 链/ng 表/n ，/wd 每当/p 进行/vx 插入/v 时/ng 便/d 可/v 从/p 备用链/n 表/n 上/f 取得/v 第一/m 个/q 结点/n 作为/v 待/vi 插入/v 的/ude1 新/a 结点/n ；/wf 反之/c ，/wd 在/p 删除/v 时/ng 将/d 从/p 链/ng 表/n 中/f 删除/v 下来/vf 的/ude1 结点/n 链/ng 接到/v 备用链/n 表/n 上/f 。/wj 
    现/tg 以/p 集合/v 运算/vn (/wkz A―B/x )/wky U/x (/wkz B―A/x )/wky 为/p 例/n 来/vf 讨论/v 静态/n 链/ng 表/n 的/ude1 算法/n 。/wj 
    例/n 2．3/m 假设/n 由/p 终端/n 输入/v 集合/v 元素/n ，/wd 先/d 建立/v 表示/v 集合/v A/x 的/ude1 静态/n 链/ng 表/n s/x ，/wd 而后/d 在/p 输入/v 集合/v B/x 的/ude1 元素/n 的/ude1 同时/c 查找/v s/x 表/n ，/wd 若/c 存在/v 和/cc B/x 相同/a 的/ude1 元素/n ，/wd 则/c 从/p s/x 表/n 中/f 删除/v 之/uzhi ，/wd 否则/c 将/p 此/rzs 元素/n 插入/v S/x 表/n 。/wj 
    为/p 使/v 算法/n 清晰/a 起见/u ，/wd 我们/rr 先/d 给/v 出/vf 三/m 个/q 过程/n ：/wp 1/m )/wky 将/p 整个/b 数组/n 空间/n 初始化/v 成/v 一个/mq 链/ng 表/n ；/wf 2/m )/wky 从/p 备用/vn 空间/n 取得/v 一个/mq 结点/n ；/wf 3/m )/wky 将/d 空闲/v 结点/n 链/ng 结/v 到/v 备用链/n 表/n 上/f ，/wd 分别/d 如/v 算法/n 2．14/m ，/wd 2．15/m 和/cc 2．16/m 所/usuo 示/vg 。/wj 
void/x  InitSpace―sL/x (/wkz sLir/x ~/n List/x ~/n space/x )/wky {/n 
    ∥/w 将/p 一/m 维/q 数组/n space/x 中/f 各/rz 分量/n 链/ng 成/v 一个/mq 备用链/n 表/n ，/wd space/x [/wkz O/x ]/wky ．/w cur/x 为/p 头/n 指针/n ，/wd 
    ∥/w “/wyz 0/m ”/wyy 表示/v 空/a 指针/n 
    for/x (/wkz i=O/x ；/wf i/x </n MAXSIZE/x 一/m 1/m ；/wf   ++i/x )/wky space/x [/wkz 1/m ]/wky ．/w cur=i+1/x ；/wf 
    space/x [/wkz MAXSIZE/x 一/m 1j．cur=0/x ；/wf 
I/x ∥/w InitSpace―SL/x 
    算法/n 2．14/m 
    int/x  Malloc―SL/x (/wkz SLinkList/x ~/n space/x )/wky l/x 
    ∥/w 若/c 备用/vn 空间/n 链/ng 表/vg 非空/n ，/wd 则/c 返回/v 分配/v 的/ude1 结点/n 下标/n ，/wd 否则/c 返回/v 0/m 
    i=space/x [/wkz 0/m  J．cur/x ；/wf 
    if/x (/wkz space/x [/wkz O/x ]/wky ．/w cur/x )/wky space/x [/wkz 0/m ]/wky ．/w cur=space/x [/wkz i/x ]/wky ．/w cur/x ；/wf 
    return/x  i/x ；/wf 
}/n ∥/w Ma/x ]/wky ．/w 10c―sL/x 
算法/n 2．15/m 
void/x  Free―sL/x (/wkz sLinkList/x &/n space/x ，/wd int/x  k/x )/wky {/n 
    ∥/w 将/p 下标/n 为/v k/x 的/ude1 空闲/n 结点/n 回收/v 到/v 备用链/n 表/n 
    space/x [/wkz k/x ]/wky ．/w cur=space/x [/wkz 0/m ]/wky ．/w cur/x 。/wj ；/wf space/x [/wkz O/x ]/wky ．/w cur：k/x ；/wf 
l/x ∥/w Free―sL/x 
算法/n 2．16/m 
vold/x  difference/x (/wkz SLinkList/x &/n space/x ，/wd int/x &/n s/x )/wky {/n 
    ∥/w 依次/d 输入/v 集合/v A/x 和/cc B/x 的/ude1 元素/n ，/wd 在/p 一/m 维/q 数组/n space/x 中/f 建立/v 表示/v 集合/v (/wkz A―B/x )/wky U/x (/wkz B―A/x )/wky 
    ∥/w 的/ude1 静态/n 链/ng 表/n ，/wd s/x 为/p 其/rz 头/n 指针/n 。/wj 假设/n 备用/vn 空间/n 足够/v 大/a ，/wd space/x [/wkz 0/m ]/wky ．/w cur/x 为/p 其/rz 头/n 指针/n 。/wj 
    InitSpace―sL/x (/wkz space/x )/wky ；/wf     ∥/w 初始化/v 备用/vn 空间/n 
    s：Malloc―sL/x (/wkz space/x )/wky ；/wf     ∥/w 生成/v s/x 的/ude1 头/n 结点/n 
    r/x 。/wj s/x ；/wf     ∥/w r/x 指向/v s/x 的/ude1 当前/t 最后/f 结点/n 
    scanf/x (/wkz m/x ，/wd n/x )/wky ；/wf     ∥/w 输入/v A/x 和/cc B/x 的/ude1 元素/n 个数/n 
    for/x (/wkz j=1/x ；/wf j/x </n =m/x ；/wf ++j/x )/wky {/n     ∥/w 建立/v 集合/v A/x 的/ude1 链/ng 表/n 
    i=Malloc―sL/x (/wkz space/x )/wky ；/wf     ∥/w 分配/v 结点/n 
    ・/w 33/m   ・/w 
  mzanf/x (/wkz space/x 【/wkz i/x ]/wky ．/w data/x )/wky ；/wf 
  space/x [/wkz r/x ]/wky ．/w cur=i/x ；/wf r：i/x ；/wf 
、/wn }/n }/n for/x 
space/x [/wkz r/x ]/wky ．/w cur=0/x ；/wf 
for/x (/wkz J=1/x ；/wf J/x </n =n/x ；/wf ++J/x )/wky I/x 
∥/w 输入/v A/x 的/ude1 元素/n 值/n 
∥/w 插入/v 到/v 表/vg 尾/ng 
∥/w 尾/ng 结点/n 的/ude1 指针/n 为/v 空/ng 
∥/w 依次/d 输入/v B/x 的/ude1 元素/n ，/wd 若/c 不/d 在/p 当前/t 表/n 中/f ，/wd 则/c 插入/v ，/wd 否则/c 删除/v 
    scanf/x (/wkz b/x )/wky ；/wf P=s/x ；/wf k：space/x [/wkz S/x ]/wky ．/w cur/x ；/wf ∥/w k/x 指向/v 集合/v A/x 中/f 第一/m 个/q 结点/n 
    wh／le/x (/wkz k/x !/wt =space/x [/wkz r/x ]/wky ．/w cur/x ＆/n &/n space/x [/wkz k/x ]/wky ．/w data/x !/wt =b/x )/wky {/n ∥/w 在/p 当前/t 表中查找/n 
    P=k/x ；/wf k=space/x [/wkz k/x ]/wky ．/w cur/x ；/wf 
    }/n ∥/w while/x 
    if/x (/wkz k==space/x [/wkz r/x ]/wky ．/w cur/x )/wky {/n     ∥/w 当前/t 表/n 中/f 不/d 存在/v 该/rz 元素/n ，/wd 插入/v 在/p r/x 所/usuo 指/v 结点/n 之后/f ，/wd 且/c r/x 
    ∥/w 的/ude1 位置/n 不/d 变/v 
    i=Malloc―sL/x (/wkz space/x )/wky ；/wf 
    space/x [/wkz i/x ]/wky ．/w data=b/x ；/wf 
    space/x [/wkz i/x ]/wky ．/w cur=space/x [/wkz r/x ]/wky ．/w cur/x ；/wf 
    space/x [/wkz r/x ]/wky ．/w cur=i/x ；/wf 
    }/n ∥/w if/x 
    else/x {/n     ∥/w 该/rz 元素/n 已/d 在/p 表/n 中/f ，/wd 删除/v 之/rz 
    space/x [/wkz p/x ]/wky ．/w cur=space/x [/wkz k/x ]/wky ．/w cur/x ；/wf 
    Free―sL/x (/wkz space/x ，/wd k/x )/wky ；/wf 
    if/x (/wkz r/x  s=k/x )/wky r：p/x ；/wf     //n //n 若/c 删除/v 的/ude1 是/vshi 尾/q 元素/n ，/wd 则/c 需/v 修改/v 尾/ng 指针/n 
    }/n ∥/w else/x 
  }/n ∥/w for/x 
}/n //n //n difference/x 
算法/n 2．17/m 
    在/p 算法/n 2．17/m 中/f ，/wd 只/d 有/vyou 一个/mq 处于/v 双重/b 循环/vn 中/f 的/ude1 循环体/n (/wkz 在/p 集合/v A/x 中/f 查找/v 依次/d 输入/v 的/ude1 6/m )/wky ，/wd 其/rz 最/d 大/a 循环/vn 次数/n 为/v ：/wp 外/f 循环/vn n/x 次/qv ，/wd 内/f 循环/vn m/x 次/qv ，/wd 故/c 算法/n 2．17/m 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz m・n/x )/wky 。/wj 
   图/n 2．11/m 运算/vn 前后/f 的/ude1 静态/n 链/ng 表/n 
    (/wkz a/x )/wky 表示/v A/x 的/ude1 链/ng 表/n s/x ；/wf   (/wkz b/x )/wky 表示/v (/wkz A―B/x )/wky U/x (/wkz B―A/x )/wky 的/ude1 链/ng 表/n s/x 。/wj 
    图/n 2．1l/x 是/vshi 算法/n 2．17/m 执行/v 的/ude1 示意图/n 。/wj 假设/v 集合/v A：/x (/wkz c/x ，/wd 6/m ，/wd g/x ，/wd g/x ，/wd f/x ，/wd d/x )/wky ，/wd B=/x (/wkz a/x ，/wd 6/m ，/wd n/x ，/wd f/x )/wky ，/wd 则/c 图/n 2．1l/x (/wkz a/x )/wky 所/usuo 示/vg 为/p 输入/v 集合/v A/x 的/ude1 元素/n 之后/f 建成/v 的/ude1 链/ng 表/n S/x 和/cc 备用/vn 空间/n 链/ng 表/n 的/ude1 状况/n ，/wd 图/n 2．11/m (/wkz b/x )/wky 所/usuo 示/vg 为/v 逐个/d 输入/v 集合/v B/x 的/ude1 元素/n 并/cc 在/p 链/ng 表/n s/x 中/f 依次/d 插入/v n/x ，/wd 删除/v 6/m 、/wn 插入/v n/x 、/wn 删除/v 后/f 的/ude1 状况/n 。/wj space/x [/wkz 0/m ]/wky ．/w cur/x 为/v 备用链/n 表/n 的/ude1 头/n 指针/n ，/wd r/x 的/ude1 值/n 为/p 7/m 。/wj 
  2．3．2/m 循环/vn 链/ng 表/n  
  循环/vn 链/ng 表/n (/wkz (/wkz 2ircular/x  Linked/x  I．ist/x )/wky 是/vshi 另/rz 一/m 种/q 形式/n 的/ude1 链式/n 存储/v 结构/n 。/wj 它/rr 的/ude1 特点/n 是/vshi 表/n 中/f 最后/f 一个/mq 结点/n 的/ude1 指针/n 域/ng 指向/v 头/n 结点/n ，/wd 整个/b 链/ng 表/n 形成/v 一个/mq 环/n 。/wj 由此/d ，/wd 从/p 表/n 中/f 任/v 一/m 结点/n 出发/vi 均/d 可/v 找到/v 表/n 中/f 其它/rz 结点/n ，/wd 如/v 图/n 2．12/m 所/usuo 示/vg 为/p 单链/n 的/ude1 循环/vn 链/ng 表/n 。/wj 类似/a 地/ude2 ，/wd 还/d 可以/v 有/vyou 多重/b 链/ng 的/ude1 循环/vn 链/ng 表/n 。/wj 
图/n 2．12/m 单/b 循环/vn 链/ng 表/n 
(/wkz a/x )/wky 非空/n 表/n ；/wf (/wkz b/x )/wky 空/v 表/n 。/wj 
    循环/vn 链/ng 表/n 的/ude1 操作/vn 和/cc 线性/n 链/ng 表/vg 基本一致/n ，/wd 差别/n 仅/d 在于/v 算法/n 中/f 的/ude1 循环/vn 条件/n 不/d 是/vshi p/x 或/c p-/x >/n next/x 是否/v 为/v 空/ng ，/wd 而是/c 它们/rr 是否/v 等于/v 头/q 指针/n 。/wj 但/c 有的/rz 时候/n ，/wd 若/c 在/p 循环/vn 链/ng 表/n 中/f 设立/v 尾/ng 指针/n 而/cc 不/d 设/v 头/q 指针/n (/wkz 如/v 图/n 2．13/m (/wkz a/x )/wky 所/usuo 示/vg )/wky ，/wd 可/c 使/v 某些/rz 操作/v 简化/v 。/wj 例如/v 将/p 两/m 个/q 线性/n 表/vg 合并/v 成/v 一个/mq 表/n 时/ng ，/wd 仅/d 需/v 将/d 一个/mq 表/n 的/ude1 表/n 尾/ng 和/cc 另/rz 一个/mq 表/n 的/ude1 表头/n 相接/vi 。/wj 当/p 线性/n 表/vg 以/p 图/n 2．13/m (/wkz a/x )/wky 的/ude1 循环/vn 链/ng 表/n 作/v 存储/vn 结构/n 时/ng ，/wd 这个/rz 操作/vn 仅/d 需/v 改变/v 两/m 个/q 指针/n 值/v 即可/v ，/wd 运算/vn 时间/n 为/v O/x (/wkz 1/m )/wky 。/wj 合并/v 后/f 的/ude1 表/n 如/v 图/n 2．13/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
2．3．3/m 双向/b 链/ng 表/n 
图/n 2．13/m 仅/d 设/v 尾/ng 指针/n 的/ude1 循环/vn 链/ng 表/n 
(/wkz a/x )/wky 两/m 个/q 链/ng 表/n ；/wf   (/wkz b/x )/wky 合并/v 后/f 的/ude1 表/n 。/wj 
　　以上/f 讨论/v 的/ude1 链式/n 存储/v 结构/n 的/ude1 结点/n 中/f 只/d 有/vyou 一个/mq 指示/n 直接/a 后/f 继/vg 的/ude1 指针/n 域/ng ，/wd 由此/d ，/wd 从/p 某个/rz 结点/n 出发/vi 只能/v 顺/a 指针/n 往后/t 寻/v 查/v 其它/rz 结点/n 。/wj 若/c 要/v 寻/v 查结/v 点/qt 的/ude1 直接/a 前/f 趋/v ，/wd 则/c 需/v 从/p 表头/n 指针/n 出发/vi 。/wj 换句话说/c ，/wd 在/p 单链/n 表/n 中/f ，/wd NextElem/x 的/ude1 执行/vn 时间/n 为/p 0/m (/wkz 1/m )/wky ，/wd 而/cc PriorElem/x 的/ude1 执行/vn 时间/n 为/v O/x (/wkz n/x )/wky 。/wj 为/p 克服/v 单链/n 表/n 这种/r 单向性/n 的/ude1 缺点/n ，/wd 可/c 利用/v 双向/b 链/ng 表/n (/wkz I/x )/wky ouble/x  Linked/x  L/x ,/wd ist/x )/wky 。/wj 
　　顾名思义/vl ，/wd 在/p 双向/b 链/ng 表/n 的/ude1 结点/n 中/f 有/vyou 两/m 个/q 指针/n 域/ng ，/wd 其一/rz 指向/v 直接/a 后/f 继/vg ，/wd 另/rz 一/m 指向/v 直接/a 前/f 趋/v ，/wd 在/p c/x 语言/n 中/f 可/v 描述/v 如下/vi ：/wp 
    ∥/w ----/wp 一/m 线性/n 表/n 的/ude1 双向/b 链/ng 表存储/n 结构/n …/ws --/wp 
txr/x ~/n ,/wd aee/x  8truct/x  DuLNode/x {/n 
    ElemType/x  data：/x 
    struct/x  DuLNode/x     。/wj prior/x ；/wf 
    struct/x  DuLNode/x     */n next/x ；/wf 
    I/x  DuL/x ~/n ode/x ，/wd */n DuLinkList/x ；/wf 
　　和/cc 单链/n 的/ude1 循环/vn 表/n 类似/a ，/wd 双向/d 链/ng 表/n 也/d 可以/v 有/vyou 循环/vn 表/n ，/wd 如/v 图/n 2．14/m (/wkz c/x )/wky 所/usuo 示/vg ，/wd 链/ng 表/n 中/f 存/v 有/vyou 两/m 个/q 环/n ，/wd 图/n 2．14/m (/wkz b/x )/wky 所/usuo 示/vg 为/v 只/d 有/vyou 一个/mq 表头/n 结点/n 的/ude1 空/a 表/n 。/wj 在/p 双向/b 链/ng 表/n 中/f ，/wd 若/c d/x 为/p 指向/v 表/n 中/f 某/rz 一/m 
    图/n 2．14/m 双向/b 链/ng 表示/v 例/n 
    (/wkz a/x )/wky 结点/n 结构/n ；/wf   (/wkz b/x )/wky 空/a 的/ude1 双向/b 循环/vn 链/ng 表/n ；/wf   (/wkz c/x )/wky 非空/n 的/ude1 双向/b 循环/vn 链/ng 表/n 。/wj 
结点/n 的/ude1 指针/n (/wkz 即/v ：/wp d/x 为/v DuLinkI．ist/x 型/k 变量/n )/wky ，/wd 则/c 显然/ad 有/vyou   d-/x >/n next-/x >/n priou=d-/x >/n priou-/x >/n next=d/x 这个/rz 表示/v 式/k 恰当/a 地/ude2 反映/v 了/ule 这种/r 结构/n 的/ude1 特性/n 。/wj 
    在/p 双向/b 链/ng 表/n 中/f ，/wd 有些/rz 操作/v 如/v ：/wp ListLength/x 、/wn GetElem/x 和/cc LocateElem/x 等/udeng 仅/d 需/v 涉及/v 一个/mq 方向/n 的/ude1 指针/n ，/wd 则/c 它们/rr 的/ude1 算法/n 描述/vn 和/cc 线性/n 链/ng 表/n 的/ude1 操作/vn 相同/a ，/wd 但/c 在/p 插入/v 、/wn 删除/v 时/ng 有/vyou 很/d 大/a 的/ude1 不同/a ，/wd 在/p 双向/b 链/ng 表/n 中/f 需/v 同时/c 修改/v 两/m 个/q 方向/n 上/f 的/ude1 指针/n ，/wd 图/n 2．15/m 和/cc 图/n 2．16/m 分别/d 显示/v 了/ule 删除/v 和/cc 插入/v 结点/n 时/ng 指针/n 修改/v 的/ude1 情况/n 。/wj 它们/rr 的/ude1 算法/n 分别/d 如/v 算法/n 2．19/m 和/cc 2．18/m 所/usuo 示/vg ，/wd 两者/rzv 的/ude1 时间/n 复杂度/n 均/d 为/v O/x (/wkz n/x )/wky 。/wj 
图/n 2．15/m 在/p 双向/b 链/ng 表/n 中/f 删除/v 结点/n 时/ng 指针/n 变化/vn 状况/n 
图/n 2．16/m 在/p 双向/b 链/ng 表/n 中/f 插入/v 一个/mq 结点/n 时/ng 指针/n 的/ude1 变化/vn 状况/n 
Status/x  Listlnsert―DuL/x (/wkz DuLinkList/x ＆/n L/x ，/wd int/x  i/x ，/wd ElemType/x  e/x )/wky l/x 
    ∥/w 在/p 带头/vd 结点/n 的/ude1 双/m 链/ng 循环/vn 线性/n 表/n L/x 中/f 第/m i/x 个/q 位置/n 之前/f 插入/v 元素/n e/x ，/wd 
    ∥/w i/x 的/ude1 合法/a 值/n 为/v 1≤i≤/x 表/n 长/a +l/x 。/wj 
    if/x (/wkz !/wt (/wkz P=GetElemP―DuL/x (/wkz L/x ，/wd i/x )/wky )/wky )/wky ∥/w 在/p L/x 中/f 确定/v 第/m i/x 个/q 元素/n 的/ude1 位置/n 指针/n P/x 
    return/x  ERROR/x ；/wf     ／／P=NULL/x ，/wd 即/v 第/m i/x 个/q 元素/n 不/d 存在/v 
    if/x (/wkz !/wt (/wkz S：/x (/wkz DuLinkList/x )/wky malloc/x (/wkz sizeof/x (/wkz DuLNode/x )/wky )/wky )/wky )/wky return/x  ERROR/x ；/wf 
    S-/x >/n data=e：/x 
    s-/x >/n prior=P-/x >/n prior/x ；/wf P-/x >/n prior-/x >/n next=S：/x 
    ￡-/m >/n next=p/x ；/wf P-/x >/n prior：S/x ；/wf 
    return/x  OK/x ；/wf 
}/n Listlnsert―DuL/x 
   ・/w     算法/n 2．18/m 
Status/x  ListDelete―DuL/x (/wkz DuLinkList/x &/n L/x ，/wd int/x  i/x ，/wd ElemType/x ＆/n e/x )/wky {/n 
    ∥/w 删除/v 带头/vd 结点/n 的/ude1 双/m 链/ng 循环/vn 线性/n 表/n L/x 的/ude1 第/m i/x 个/q 元素/n ，/wd i/x 的/ude1 合法/a 值/n 为/v 1≤i≤/x 表/n 长/a 
    if/x (/wkz !/wt (/wkz P=GetElemP―D/x 、/wn 1L/x (/wkz L/x ，/wd i/x )/wky )/wky )/wky ∥/w 在/p L/x 中/f 确定/v 第/m i/x 个/q 元素/n 的/ude1 位置/n 指针/n P/x 
    return/x  ERROR/x ；/wf     ∥/w P=NUlL/x ，/wd 即/v 第/m i/x 个/q 元素/n 不/d 存在/v 
    e：P-/x >/n data：/x 
    P-/x >/n prior-/x >/n next=P-/x >/n next/x ；/wf 
    P-/x >/n next-/x >/n prior：P-/x >/n prior：/x 
    ~/n ree/x (/wkz p/x )/wky ；/wf   return/x  OK/x ；/wf 
}/n ListDelete―DuL/x 
算法/n 2．19/m 
    从/p 本/rz 节/n (/wkz 2．3/m )/wky 的/ude1 讨论/vn 中/f 可见/v ，/wd 由于/p 链/ng 表/vg 在/p 空间/n 的/ude1 合理/ad 利用/v 上/f 和/cc 插入/v 、/wn 删除/v 时/ng 不/d 需要/v 移动/vn 等/udeng 的/ude1 优点/n ，/wd 因此/c 在/p 很多/m 场合/n 下/f ，/wd 它/rr 是/vshi 线性/n 表/n 的/ude1 首选/vn 存储/vn 结构/n 。/wj 然而/c ，/wd 它/rr 也/d 存在/v 着/uzhe 实现/v 某些/rz 基本/ad 操作/v 如/v 求/v 线性/n 表/n 的/ude1 长度/n 时/ng 不/d 如/v 顺序/n 存储/vn 结构/n 的/ude1 缺点/n ；/wf 另一方面/c ，/wd 由于/c 在/p 链/ng 表/n 中/f ，/wd 结点/n 之间/f 的/ude1 关系/n 用/p 指针/n 来/vf 表示/v ，/wd 则/c 数据/n 元素/n 在/p 线性/n 表/n 中/f 的/ude1 “/wyz 位/q 序/n ”/wyy 的/ude1 概念/n 已/d 淡化/v ，/wd 而/cc 被/pbei 数据/n 元素/n 在/p 线性/n 链/ng 表/n 中/f 的/ude1 “/wyz 位置/n ”/wyy 所/usuo 代替/v 。/wj 为此/bl ，/wd 从/p 实际/n 应用/vn 角度/n 出发/vi 重新/d 定义/v 线性/n 链/ng 表/n 及/cc 其/rz 基本/a 操作/vn 。/wj 
    一个/mq 带头/vd 结点/n 的/ude1 线性/n 链/ng 表/vg 类型定义/n 如下/vi ：/wp 
    tn/x ~/n de/x ~/n struct/x  LNode/x {/n ∥/w 结点/n 类型/n 
    ElemType/x  data/x ；/wf 
    struct/x  LNode/x     */n next/x ；/wf 
    I/x */n Link/x ，/wd */n Position/x ；/wf 
tn/x ~/n 4e/x ~/n struct/x {/n     ∥/w 链/ng 表/vg 类型/n 
    Link/x  head/x ，/wd tail/x ；/wf   ∥/w 分别/d 指向/v 线性/n 链/ng 表/n 中/f 的/ude1 头/n 结点/n 和/cc 最后/f 一个/mq 结点/n 
    int/x  len/x ；/wf     ∥/w 指示/n 线性/n 链/ng 表/vg 中/b 数据/n 元素/n 的/ude1 个数/n 
}/n LinkList/x ；/wf 
Status/x  MakeNode/x (/wkz Link/x ＆/n p/x ，/wd ElemType/x  e/x )/wky ；/wf 
    ∥/w 分配/v 由/p P/x 指向/v 的/ude1 值/n 为/v e/x 的/ude1 结点/n ，/wd 并/cc 返回/v OK/x ；/wf 若/c 分配/v 失败/vi ，/wd 则/c 返回/v ERROR/x 
voi4/x  FreeNode/x (/wkz Link/x &/n p/x )/wky ；/wf 
    ∥/w 释放/v P/x 所/usuo 指/v 结点/n     、/wn 
Status/x  InitList/x (/wkz LinkList/x &/n L/x )/wky ；/wf 
    ∥/w 构造/n 一个/mq 空/a 的/ude1 线性/n 链/ng 表/n L/x 
Status/x  DestroyList/x (/wkz LinkList/x &/n L/x )/wky ；/wf 
    ∥/w 销毁/v 线性/n 链/ng 表/n L/x ，/wd L/x 不再/d 存在/v 
Status/x  ClearList/x (/wkz LiakList/x &/n L/x )/wky ；/wf 
    ∥/w 将/p 线性/n 链/ng 表/n L/x 重/d 置/v 为/p 空/a 表/n ，/wd 并/cc 释放/v 原/b 链/ng 表/n 的/ude1 结点/n 空间/n 
Status/x  InsFirst/x (/wkz Link/x  h/x ，/wd Link/x  s/x )/wky ；/wf 
    ∥/w 已/d 知/v h/x 指向/v 线性/n 链/ng 表/n 的/ude1 头/n 结点/n ，/wd 将/d s/x 所/usuo 指/v 结点/n 插入/v 在/p 第一/m 个/q 结点/n 之前/f 
Status/x  DelFirst/x (/wkz Link/x  h/x ，/wd L／nk/x &/n q/x )/wky ；/wf 
    ∥/w 已/d 知/v h/x 指向/v 线性/n 链/ng 表/n 的/ude1 头/n 结点/n ，/wd 删除/v 链/ng 表/n 中/f 的/ude1 第一/m 个/q 结点/n 并/d 以/p q/x 返回/v 
Status/x  Append/x (/wkz LinkList/x ＆/n L/x ，/wd Link/x  s/x )/wky ；/wf 
    ∥/w 将/p 指针/n s/x 所/usuo 指/v (/wkz 彼此/rr 以/p 指针/n 相/d 链/ng )/wky 的/ude1 一/m 串/q 结点/n 链接/n 在/p 线性/n 链/ng 表/n L/x 的/ude1 最后/f 一个/mq 结点/n 
    ∥/w 之后/f ，/wd 并/cc 改变/v 链/ng 表/n L/x 的/ude1 尾/q 指针/n 指向/v 新/a 的/ude1 尾/ng 结点/n 
    Status/x  Remove/x (/wkz LinkList/x &/n L/x ，/wd Link/x &/n q/x )/wky ；/wf 
    ∥/w 删除/v 线性/n 链/ng 表/n L/x 中/f 的/ude1 尾/ng 结点/n 并/d 以/p q/x 返回/v ，/wd 改变/v 链/ng 表/n L/x 的/ude1 尾/q 指针/n 指向/v 新/a 的/ude1 尾/ng 结点/n 
    Status/x  InsBefore/x (/wkz LinkList/x &/n L/x ，/wd Link/x &/n P/x ，/wd Link/x  s/x )/wky ；/wf 
    ∥/w 已/d 知/v P/x 指向/v 线性/n 链/ng 表/n L/x 中/f 的/ude1 一个/mq 结点/n ，/wd 将/d s/x 所/usuo 指/v 结点/n 插入/v 在/p P/x 所/usuo 指/v 结点/n 之前/f ，/wd 
    ∥/w 并/d 修改/v 指针/n p/x 指向/v 新/a 插入/v 的/ude1 结点/n     ’/wyy 
    Status/x  InsAfter/x (/wkz LinkList/x &/n L/x ，/wd Link/x &/n p/x ，/wd Link/x  s/x )/wky ；/wf 
    ∥/w 已/d 知/v P/x 指向/v 线性/n 链/ng 表/n L/x 中/f 的/ude1 一个/mq 结点/n ，/wd 将/d s/x 所/usuo 指/v 结点/n 插入/v 在/p P/x 所/usuo 指/v 结点/n 之后/f ，/wd 
    ∥/w 并/d 修改/v 指针/n P/x 指向/v 新/a 插入/v 的/ude1 结点/n 
    Status/x  SetCurElem/x (/wkz Li/x 咄/n ＆/n P/x ，/wd ElemType/x  e/x )/wky ；/wf 
    ∥/w 已/d 知/v P/x 指向/v 线性/n 链/ng 表/n 中/f 的/ude1 一个/mq 结点/n ，/wd 用/v e/x 更新/v P/x 所/usuo 指/v 结点/n 中/f 数据/n 元素/n 的/ude1 值/n 
    ElaTn/x ~/n GetCurElem/x (/wkz Link/x  P/x )/wky ；/wf 
    ∥/w 已/d 知/v P/x 指向/v 线性/n 链/ng 表/n 中/f 的/ude1 一个/mq 结点/n ．/w 返回/v P/x 所/usuo 指/v 结点/n 中/f 数据/n 元素/n 的/ude1 值/n 
    Status/x  ListEmpty/x (/wkz LinkList/x  L/x )/wky ；/wf 
    ∥/w 若/c 线性/n 链/ng 表/n L/x 为/p 空/a 表/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c 返回/v FALSE/x 
    int/x  ListLength/x (/wkz LinkList/x  L/x )/wky ；/wf 
    ∥/w 返回/v 线性/n 链/ng 表/n L/x 中/b 元素/n 个数/n 
    Position/x  GetHead/x (/wkz LinkList/x  L/x )/wky ；/wf 
    ∥/w 返回/v 线性/n 链/ng 表/n L/x 中/b 头/n 结点/n 的/ude1 位置/n 
    Position/x  GetLast/x (/wkz LinkList/x  L/x )/wky ；/wf 
    ∥/w 返回/v 线性/n 链/ng 表/n L/x 中/b 最后/f 一个/mq 结点/n 的/ude1 位置/n 
    Position/x  PriorPos/x (/wkz LinkList/x  L/x ，/wd Link/x  P/x )/wky ；/wf 
    ∥/w 已/d 知/v p/x 指向/v 线性/n 链/ng 表/n L/x 中/f 的/ude1 一个/mq 结点/n ，/wd 返回/v p/x 所/usuo 指/v 结点/n 的/ude1 直接/a 前驱/n 的/ude1 位置/n ，/wd 
    ∥/w 若/c 无/v 前驱/n ，/wd 则/c 返回/v NULL/x 
    Position/x  NextPos/x (/wkz LinkList/x  L/x ，/wd Link/x  P/x )/wky ；/wf 
    ∥/w 已/d 知/v P/x 指向/v 线性/n 链/ng 表/n L/x 中/f 的/ude1 一个/mq 结点/n ，/wd 返回/v p/x 所/usuo 指/v 结点/n 的/ude1 直接/a 后/f 继/vg 的/ude1 位置/n 。/wj 
    ∥/w 若/c 无/v 后/f 继/vg ，/wd 则/c 返回/v NULL/x 
    Status/x  LocatePos/x (/wkz LinkList/x  L/x ，/wd int/x  i/x ，/wd Link/x ＆/n P/x )/wky ；/wf 
    ∥/w 返回/v P/x 指示/n 线性/n 链/ng 表/n L/x 中/f 第/m i/x 个/q 结点/n 的/ude1 位置/n 并/cc 返回/v 0K/x ，/wd i/x 值/n 不/d 合法/a 时/ng 返回/v ERROR/x 
    Position/x  LocateElem/x (/wkz LinkList/x  L/x ，/wd ElemType/x  e/x ，/wd Status/x (/wkz */n compare/x )/wky (/wkz ElemType/x ，/wd ElemType/x )/wky )/wky ；/wf 
    ∥/w 返回/v 线性/n 链/ng 表/n L/x 中/f 第1/m 个/q 与/p e/x 满足/v 函数/n compare/x (/wkz )/wky 判定/v 关系/n 的/ude1 元素/n 的/ude1 位置/n ，/wd 
    ∥/w 若/c 不/d 存在/v 这样/rzv 的/ude1 元素/n ，/wd 则/c 返回/v NULL/x 
    Status/x  ListTraverse/x (/wkz LinkList/x  L/x ，/wd Status/x (/wkz */n visit/x )/wky (/wkz )/wky )/wky ；/wf 
    ∥/w 依次/d 对/p L/x 的/ude1 每个/r 元素/n 调用函数/n visit/x (/wkz )/wky 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
    在/p 上述/b 定义/n 的/ude1 线性/n 链/ng 表/n 的/ude1 基本/a 操作/vn 中/f ，/wd 除了/p DestroyList/x ，/wd ClearList/x ，/wd Remove/x ，/wd InsBefore/x ，/wd PriorPos/x ，/wd LocatePos/x ，/wd LocateElem/x 和/cc ListTraverse/x 的/ude1 时间/n 复杂度/n 和/cc 表/n 长/ad 成/v 正比/n 之外/f ，/wd 其它/rz 操作/vn 的/ude1 时间/n 复杂度/n 都/d 和/cc 表/n 长/ad 无关/v ，/wd Append/x 操作/vn 的/ude1 时间/n 复杂度/n 则/d 和/cc 插入/v 的/ude1 结/v 点数/n 成/v 正比/n 。/wj 利用/v 这些/rz 基本/a 操作/vn ，/wd 容易/ad 实现/v 诸如/v 在/p 第/m i/x 个/q 元素/n 之前/f 插入/v 元素/n 或/c 删除/v 第/m i/x 个/q 元素/n 或/c 合并/v 两/m 个/q 线性/n 表/n 等/udeng 操作/vn ，/wd 如/v 算法/n 2．20/m 和/cc 2．21/m 所/usuo 示/vg 。/wj 
Status/x  ListInsert―L/x (/wkz LinkList/x ＆/n L/x ，/wd int/x  i/x ，/wd ElemType/x  e/x )/wky {/n 
    ∥/w 在/p 带头/vd 结点/n 的/ude1 单链/n 线性/n 表/n L/x 的/ude1 第/m i/x 个/q 元素/n 之前/f 插入/v 元素/n e/x 
    if/x (/wkz !/wt LocatePos/x (/wkz L/x ，/wd i/x 一/m 1/m ，/wd h/x )/wky )/wky return/x  ERROR/x ；/wf ∥/w i/x 值/n 不/d 合法/a 
    if/x (/wkz !/wt MakeNode/x (/wkz s/x ，/wd e/x )/wky )/wky return/x  ERROR/x ；/wf     ／／/m 结点/n 存储分配/n 失败/vi 
    InsFirst/x (/wkz h/x ，/wd s/x )/wky ；/wf   ∥/w 对于/p 从/p 第/m i/x 个/q 结点/n 开始/v 的/ude1 链/ng 表/n ，/wd 第/m i/x 一/m 1/m 个/q 结点/n 是/vshi 它/rr 的/ude1 头/n 结点/n 
    return/x  OK/x ；/wf 
算法/n 2/m  20/m 
Status/x  MergeList/x (/wkz LinkList/x  &/n La/x ,/wd  LinkList/x  &/n Lb/x ,/wd  LinkList/x  &/n Lc/x )/wky 
    ∥/w 已/d 知/v 单链/n 线性/n 表/n b/x 和/cc Lb/x 的/ude1 元素/n 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
    ∥/w 归并/vi La/x 和/cc Lb/x 得到/v 新/a 的/ude1 单链/n 线性/n 表/n Lc/x ，/wd c/x 的/ude1 元/q 索/vg 也/d 按/p 值/n 非/b 递减/vi 排列/v 。/wj 
    if/x (/wkz !/wt InitList/x (/wkz Lc/x )/wky )/wky   return/x  ERROR/x ；/wf     ∥/w 存储空间/n 分配/v 失败/vi 
    ha=GetHead/x (/wkz La/x )/wky ；/wf hb=GetHead/x (/wkz Lb/x )/wky ；/wf ∥/w ha/x 和/cc hb/x 分别/d 指向/v La/x 和/cc Lb/x 的/ude1 头/n 结点/n 
    pa=Nexts/x (/wkz h/x ，/wd ha/x )/wky ；/wf pb=NextPos/x (/wkz Lb/x ，/wd 11b/x )/wky ；/wf ∥/w pa/x 和/cc pb/x 分别/d 指向/v b/x 和/cc Lb/x 中/f 当前/t 结点/n 
    while/x (/wkz pa/x &/n ＆/n pb/x )/wky {/n     ∥/w a/x 和/cc b/x 均/d 非空/n 
    a=GetCurElm/x (/wkz pa/x )/wky ；/wf b=etrBl/x (/wkz pb/x )/wky ；/wf ∥/w a/x 和/cc b/x 为/p 两/m 表/n cp/x 当前/t 比较/v 元素/n 
    if/x (/wkz (/wkz …/ws pe/x )/wky (/wkz a/x ，/wd b/x )/wky </n =0/m )/wky {/n ／／≤b/x 
  DelFirst/x (/wkz ha/x ，/wd q/x )/wky ；/wf 
eLse/x {/n     ∥/w a/x >/n b/x 
  DelFirst/x (/wkz hb/x ，/wd q/x )/wky ；/wf 
／／while/x 
Append/x (/wkz k/x ，/wd q/x )/wky ；/wf pa：NextPoS/x (/wkz La．/x 
Append/x (/wkz Lc．q/x )/wky ；/wf pb=NexLPes/x (/wkz Lb/x ，/wd pb/x 
  if/x (/wkz paj/x  Append/x (/wkz k/x ，/wd a/x )/wky ．/w 
  else/x ^/n ppld/x (/wkz k/x ，/wd pb/x )/wky ；/wf 
  FreeNode/x (/wkz ha/x )/wky ；/wf   F/x …/ws 0de/x (/wkz hb/x 
∥/w MergeList/x  L/x 
∥/w 链接/n La/x 中/b 剩余/vn 结点/n 
∥/w 链接/n Lb/x 中/b 剩余/vn 结点/n 
∥/w 释放/v h/x 和/cc Lb/x 的/ude1 头/n 结点/n 
    算法/n 2/m 、/wn 2l/x 
    算法/n 2/m  20/m 和/cc 算法/n 2/m  21分/t 别/d 为/v 算法/n 2/m  9/m 和/cc 算法/n 2/m  12/m 的/ude1 改写/vn 形式/n ．/w 它们/rr 的/ude1 时间/n 复杂度/n 和/cc 前面/f 讨论/v 相同/a 。/wj 
2/m  4/m 一元/b 多项式/n 的/ude1 表示/vn 及/cc 相加/vi 
    符号/n 多项式/n 的/ude1 操作/vn ，/wd 已经/d 成为/v 表处理/n 的/ude1 典型/n 用/p 例/n 。/wj 在/p 数学/n 上/f ，/wd 一个/mq 一元/b 多项式/n P/x 。/wj (/wkz 。/wj )/wky 
可/v 按/p 升幂/n 写/v 成/v ：/wp 
    P/x (/wkz x/x )/wky =p0+p1x+/x …/ws +pnxx/x 
它/rr 由/p n+1/x 个/q 系数/n 唯一/d 确定/v 。/wj 因此/c ，/wd 在/p 计算机/n 里/f ，/wd 它/rr 可/v 用/p 一个/mq 线性/n 表/n P/x 来/f 表示/v ：/wp 
    P=/x (/wkz p0/x ，/wd pl/x ，/wd p2/x ，/wd   ，/wd p/x 。/wj )/wky 
每/rz 一/m 项/q 的/ude1 指数/n t/x 隐含/v 在/p 其/rz 系数/n A/x 的/ude1 序号/n 里/f 。/wj 
    假设/v 0/m 。/wj (/wkz z/x )/wky 是/vshi 一/m 元/q m/x 次/qv 多项式/n ，/wd 同样/d 可用/a 线性/n 表/n Q/x 来/f 表示/v 
    P=/x (/wkz ql/x  JI/x  ql/x ，/wd g2/x ，/wd   ，/wd q/x 。/wj )/wky 
不/d 失/v 一般性/n ，/wd 设/v m/x </n n/x ，/wd 则/c 两/m 个/q 多项式/n 相加/vi 的/ude1 结果/n R/x 。/wj (/wkz 。/wj )/wky ：/wp P/x 。/wj (/wkz z/x )/wky +Q/x ，/wd 。/wj (/wkz z/x )/wky 可用/v 线性/n 表/n R/x 表示/v ：/wp 
    显然/a ，/wd 我们/rr 可以/v 对/p P/x 、/wn Q/x 和/cc R/x 采用/v 顺序/n 存储/vn 结构/n ，/wd 使得/vi 多项式/n 相加/vi 的/ude1 算法/n 定义/n 十分/d 简洁/a 。/wj 至此/d ，/wd 一元/b 多项式/n 的/ude1 表示/vn 及/cc 相加/vn 问题/n 似乎/d 已经/d 解决/v 了/y 。/wj 然而/c ，/wd 在/p 通常/b 的/ude1 应用/vn 中/f ，/wd 多项式/n 的/ude1 次数/n 可能/v 很/d 高/a 且/c 变化很大/n ，/wd 使得/vi 顺序/n 存储/vn 结构/n 的/ude1 最/d 大/a 长度/n 很/d 难/ad 确定/v 。/wj 特别/d 是/vshi 在/p 处理/v 形/ng 如/v     S/x (/wkz z/x )/wky =1+3zi0000+2．／：20000/x 的/ude1 多项式/n 时/ng ，/wd 就/d 要/v 用/p 一/m 长度/n 为/p 20001/m 的/ude1 线性/n 表/vg 来/vf 表示/v ，/wd 表/n 中/f 仅/d 有/vyou 三/m 个/q 非零元素/n ，/wd 这种/r 对/p 内存/n 空间/n 的/ude1 浪费/vn 是/vshi 应当/v 避免/v 的/ude1 ，/wd 但是/c 如果/c 只/d 存储/v 非零系数/n 项/q 则/d 显然/ad 必须/d 同时/d 存储相应/n 的/ude1 指数/n 。/wj 
    一般/a 情况/n 下/f 的/ude1 一/m 元/q n/x 次/qv 多项式/n 可/v 写/v 成/v 
其中/rz ，/wd A/x 是/vshi 指数/n 为/v q/x 的/ude1 项/q 的/ude1 非零系数/n ，/wd 且/c 满足/v 
若/c 用/v 一个/mq 长度/n 为/v m/x 且/c 每/rz 个/q 元素/n 有/vyou 两/m 个/q 数据项/n (/wkz 系数/n 项/q 和/cc 指数/n 项/q )/wky 的/ude1 线性/n 表/n 
    (/wkz (/wkz p1/x ，/wd e1/x )/wky ，/wd (/wkz p2/x ，/wd P2/x )/wky ，/wd …/ws ，/wd (/wkz p/x 。/wj ，/wd P/x 。/wj )/wky )/wky     (/wkz 2―8/m )/wky 
便/d 可/v 唯一/b 确定/v 多项式/n P/x 。/wj (/wkz z/x )/wky 。/wj 在/p 最/d 坏/a 情况/n 下/f ，/wd n+1/x (/wkz ：/wp m/x )/wky 个/q 系数/n 都/d 不/d 为/v 零/m 。/wj 则/c 比/p 只/d 存储每/n 项/q 系数/n 的/ude1 方案/n 要/v 多/ad 存储/v 一/m 倍/q 的/ude1 数据/n 。/wj 但是/c ，/wd 对于/p s/x (/wkz z/x )/wky 类/n 的/ude1 多项式/n ，/wd 这种/r 表示/v 将/d 大大/d 节省空间/n 。/wj 
    对/p 应/v 于/p 线性/n 表/n 的/ude1 两/m 种/q 存储/vn 结构/n ，/wd 由/p 式/k (/wkz 2．8/m )/wky 定义/n 的/ude1 一元/b 多项式/n 也/d 可以/v 有/vyou 两/m 种/q 存储表示/n 方法/n 。/wj 在/p 实际/a 的/ude1 应用/vn 程序/n 中/f 取/v 用/v 哪/ry 一/m 种/q ，/wd 则/c 要/v 视/vg 多项式/n 作/v 何/ry 种/q 运算/vn 而/cc 定/v 。/wj 若/c 只/d 对/p 多项式/n 进行/vx “/wyz 求/v 值/n ”/wyy 等/udeng 不/d 改变/v 多项式/n 的/ude1 系数/n 和/cc 指数/n 的/ude1 运算/vn ，/wd 则/c 采用/v 类似/v 于/p 顺序/n 表/n 的/ude1 顺序/n 存储/vn 结构/n 即可/v ，/wd 否则/c 应/v 采用/v 链式/n 存储表示/n 。/wj 本/rz 节/n 中/f 将/d 主要/d 讨论/v 如何/ryv 利用线性/n 链/ng 表/n 的/ude1 基本/ad 操作/v 来/vf 实现/v 一元/b 多项式/n 的/ude1 运算/vn 。/wj 
  抽象数据/n 类型/n 一元/b 多项式/n 的/ude1 定义/n 如下/vi ：/wp 
ADT/x  Polynomial/x {/n 
    数据/n 对象/n ：/wp D=/x {/n ail/x  ai∈TermSet/x ，/wd i=1．2/x ，/wd …/ws ，/wd m/x ，/wd   m≥0/x 
    TermSet/x 中/f 的/ude1 每个/r 元素/n 包含/v 一个/mq 表示/v 系数/n 的/ude1 实数/n 和/cc 表示/v 指数/n 的/ude1 整数/n }/n 
    数据/n 关系/n ：/wp R1=/x {/n </n ai/x 一/m 1/m ，/wd ai/x >/n Iai/x 一/m 1/m ，/wd ai∈D/x ，/wd 且/c ai―l/x 中/f 的/ude1 指数值/n </n ai/x 中/f 的/ude1 指数值/n ，/wd i=2/x ，/wd …/ws ，/wd n/x }/n 
    基本/ad 操作/v ：/wp 
    creatPoyn/x (/wkz ＆/n P/x ，/wd m/x )/wky 
    操作/v 结果/n ：/wp 输入/v m/x 项/q 的/ude1 系数/n 和/cc 指数/n ，/wd 建立/v 一元/b 多项式/n P/x 。/wj 
    DestroyPolyn/x (/wkz ＆/n P/x )/wky 
    初始条件/n ：/wp 一元/b 多项式/n P/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 一元/b 多项式/n P/x 。/wj 
    PrintPolyn/x (/wkz P/x )/wky 
    初始条件/n ：/wp 一元/b 多项式/n P/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 打印/v 输出/v 一元/b 多项式/n P/x 。/wj 
    Po/x ]/wky y/x ~/n Length/x (/wkz P/x )/wky 
    初始条件/n ：/wp 一元/b 多项式/n P/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v 一元/b 多项式/n P/x 中/f 的/ude1 项数/n 。/wj 
    AddPolyn/x (/wkz ＆/n Pa/x ，/wd &/n Pb/x )/wky 
    初始条件/n ：/wp 一元/b 多项式/n Pa/x 和/cc Pb/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 完成/v 多项式/n 相加/vn 运算/vn ，/wd 即/v ：/wp Pa=Pa+Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n Pb/x 。/wj 
    SubtractPolyn/x (/wkz &/n Pa/x ，/wd &/n Pb/x )/wky 
  初始条件/n ：/wp 一元/b 多项式/n Pa/x 和/cc Pb/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 完成/v 多项式/n 相/d 减/v 运算/vn ，/wd 即/v ：/wp Pa=Pa―Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n Pb/x 。/wj 
    Mul/x ’/wyy tiplyPolyn/x (/wkz &/n Pa/x ，/wd ＆/n Pb/x )/wky 
  初始条件/n ：/wp 一元/b 多项式/n Pa/x 和/cc Pb/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 完成/v 多项式/n 相乘/v 运算/vn ，/wd 即/v ：/wp Pa=Pa×Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n Pb/x 。/wj 
}/n KDT/x  Polynomial/x 
    实现/v 上述/b 定义/n 的/ude1 一元/b 多项式/n ，/wd 显然/ad 应/v 采用/v 链式/n 存储/v 结构/n 。/wj 例如/v ，/wd 图/n 2．17/m 中/f 的/ude1 两/m 个/q 线性/n 链/ng 表/n 分别/d 表示/v 一元/b 多项式/n A17/x (/wkz z/x )/wky =7+3z+9z/x 。/wj +5z/x "/n 和/cc 一元/b 多项式/n B8/x (/wkz z/x )/wky =8z+9z/x 。/wj 。/wj 从/p 图/n 中/f 可见/v ，/wd 每个/r 结点/n 表示/v 多项式/n 中/f 的/ude1 一/m 项/q 。/wj 
图/n 2．17/m 多项式/n 表/n 的/ude1 单链/n 存储/v 结构/n 
    如何/ryv 实现/v 用/p 这种/r 线性/n 链/ng 表表示/n 的/ude1 多/a 相/d 式/k 的/ude1 加法运算/n ?/ww 
    根据/p 一元/b 多项式/n 相加/vi 的/ude1 运算/vn 规则/n ：/wp 对于/p 两/m 个/q 一元/b 多项式/n 中/b 所有/b 指数/n 相同/a 的/ude1 项/q ，/wd 对应/vi 指数/n 相加/vi ，/wd 若/c 其/rz 和/cc 不/d 为/v 零/m ，/wd 则/c 构成/v “/wyz 和/cc 多项式/n ”/wyy 中/f 的/ude1 一/m 项/q ；/wf 对于/p 两/m 个/q 一元/b 多项式/n 中/b 所有/b 指数/n 不/d 相同/a 的/ude1 项/q ，/wd 则/c 分别/d 复/dg 抄/v 到/v “/wyz 和/cc 多项式/n ”/wyy 中/f 去/vf 。/wj 
    在/p 此/rzs ，/wd 按照/p 上述/b 抽象数据/n 类型/n Polynomial/x 中/f 基本/ad 操作/v 的/ude1 定义/n ，/wd “/wyz 和/cc 多项式/n ”/wyy 链/ng 表/n 中/f 的/ude1 结点/n 无需/v 另/rz 生成/vn ，/wd 而/cc 应该/v 从/p 两/m 个/q 多/m 项/q 式/k 的/ude1 链/ng 表/n 中/f 摘取/v 。/wj 其/rz 运算/vn 规则/n 如下/vi ：/wp 假设/v 指针/n qa/x 和/cc qb/x 分别/d 指向/v 多项式/n A/x 和/cc 多项式/n B/x 中/f 当前/t 进行/vx 比较/vn 的/ude1 某个/rz 结点/n ，/wd 则/c 比较/d 两/m 个/q 结点/n 中/f 的/ude1 指数/n 项/q ，/wd 有/vyou 下列/b 三/m 种/q 情况/n ：/wp 1/m )/wky 指针/n qa/x 所/usuo 指/v 结点/n 的/ude1 指数值/n </n 指针/n qb/x 所/usuo 指/v 结点/n 的/ude1 指数值/n ，/wd 则/c 应/v 摘取/v qa/x 指针/n 所/usuo 指/v 结点/n 插入/v 到/v “/wyz 和/cc 多项式/n ”/wyy 链/ng 表/n 中/f 去/vf ；/wf 2/m )/wky 指针/n qa/x 所/usuo 指/v 结点/n 的/ude1 指数值/n >/n 指针/n qb/x 所/usuo 指/v 结点/n 的/ude1 指数值/n ，/wd 则/c 应/v 摘取/v 指针/n qb/x 所/usuo 指/v 结点/n 插入/v 到/v “/wyz 和/cc 多项式/n ”/wyy 链/ng 表/n 中/f 去/vf ；/wf 3/m )/wky 指针/n qa/x 所/usuo 指/v 结点/n 的/ude1 指数值/n =/m 指针/n qb/x 所/usuo 指/v 结点/n 的/ude1 指数值/n ，/wd 则/c 将/p 两/m 个/q 结点/n 中/f 的/ude1 系数/n 相加/vi ，/wd 若/v 和/cc 数/n 不/d 为/v 零/m ，/wd 则/c 修改/v qa/x 所/usuo 指/v 结点/n 的/ude1 系数/n 值/n ，/wd 同时/c 释放/v qb/x 所/usuo 指/v 结点/n ；/wf 反之/c ，/wd 从/p 多项式/n A/x 的/ude1 链/ng 表/n 中/f 删除/v 相应/vd 结点/n ，/wd 并/cc 释放/v 指针/n qa/x 和/cc qb/x 所/usuo 指/v 结点/n 。/wj 例如/v ，/wd 由/p 图/n 2．17/m 中/f 的/ude1 两/m 个/q 链/ng 表表示/n 的/ude1 多项式/n 相加/vi 得到/v 的/ude1 “/wyz 和/cc 多项式/n ”/wyy 链/ng 表/n 如/v 图/n 2．18/m 所/usuo 示/vg ，/wd 图/n 中/f 的/ude1 长方框/n 表示/v 已/d 被/pbei 释放/v 的/ude1 结点/n 。/wj 
    图/n 2．18/m 相加/vi 得到/v 的/ude1 和/cc 多项式/n 
    上述/b 多项式/n 的/ude1 相加/vn 过程/n 和/cc 上/f 一/m 节/q 讨论/vn 的/ude1 归并/vi 两/m 个/q 有序/a 表/n 的/ude1 过程/n 极其/d 类似/a ，/wd 不同/a 之/uzhi 处/n 仅/d 在于/v ，/wd 后者/rzv 在/p 比较/vn 数据/n 元素/n 时/ng 只/d 出现/v 两/m 种/q 情况/n 。/wj 因此/c ，/wd 多项式/n 相加/vi 的/ude1 过程/n 亦/d 完全/ad 可以/v 利用线性/n 链/ng 表/n 的/ude1 基本/ad 操作/v 来/vf 完成/v 。/wj 
    需要/v 附加/v 说明/v 的/ude1 是/vshi ，/wd 在/p 2．3/m 节/q 末/f 定义/v 的/ude1 线性/n 链/ng 表/vg 类型/n 适用/vi 于/p 一般/a 的/ude1 线性/n 表/n ，/wd 而/cc 表示/v 一元/b 多项式/n 的/ude1 应该/v 是/vshi 有序/a 链/ng 表/n 。/wj 有序/a 链/ng 表/n 的/ude1 基本/a 操作/vn 定义/n 与/cc 线性/n 链/ng 表/n 有/vyou 两/m 处/q 不同/a ，/wd 一/m 是/vshi LocateElem/x 的/ude1 职能/n 不同/a ，/wd 二/m 是/vshi 需/v 增加/v 按/p 有序/a 关系/n 进行/vx 插入/v 的/ude1 操作/vn Orderlnsert/x ，/wd 现/tg 说明/v 如下/vi ：/wp 
st/x |/n tua/x  LocateRlem/x (/wkz LinkList/x  L/x ，/wd ElemTy/x ~/n e/x  e/x ，/wd Position・/x &/n q/x ，/wd 
    int/x (/wkz */n compare/x )/wky (/wkz ElemType/x ，/wd El/x )/wky )/wky ；/wf 
    ∥/w 若/c 有序/a 链/ng 表/n L/x 中/f 存在/v 与/p e/x 满足/v 判定/v 函数/n colnpare/x (/wkz )/wky 取值/v 为/p 0/m 的/ude1 元素/n ，/wd 则/d q/x 指示/n L/x 中/f 第一/m 个/q //n //n 值/v 为/v e/x 的/ude1 结点/n 的/ude1 位置/n ，/wd 并/cc 返回/v 。/wj rR/x 【/wkz 『/wyz E/x ；/wf 否则/c q/x 指示/n 第一/m 个/q 与/p e/x 满足/v 判定/v 函数/n compare/x (/wkz )/wky 取/v     ∥/w 值/v >/n 0/m 的/ude1 元素/n 的/ude1 前驱/n 的/ude1 位置/n ，/wd 并/cc 返回/v FALSE/x 
Status/x  OrderInsert/x (/wkz LinkList/x ＆/n L/x ，/wd ElemType/x  e/x ，/wd int/x (/wkz */n compare/x )/wky (/wkz ElemType/x ，/wd ElemType/x )/wky )/wky ；/wf 
    ∥/w 按/p 有序/ad 判定/v 函数/n compare/x (/wkz )/wky 的/ude1 约定/vn ，/wd 将/d 值/v 为/v e/x 的/ude1 结点/n 插入/v 到/v 有序/a 链/ng 表/n L/x 的/ude1 适当/a 位置/n 上/f 
例/n 2-4/m 抽象数据/n 类型/n Polynomial/x 的/ude1 实现/vn 。/wj 
Typedef/x  struct/x {/n   ∥/w 项/q 的/ude1 表示/vn ，/wd 多项式/n 的/ude1 项/q 作为/v LinkList/x 的/ude1 数据/n 元素/n 
    float/x  coef/x ；/wf     ∥/w 系数/n 
    int/x   expn/x ；/wf     ∥/w 指数/n 
}/n term/x ，/wd ElemType/x ；/wf   ∥/w 两/m 个/q 类型/n 名/q ：/wp term/x 用于/v 本/n ADT/x ，/wd ElemType/x 为/v LinkList/x 的/ude1 数据/n 对象/n 名/q 
typedef/x  LinkList/x  polynomial/x ；/wf     ∥/w 用/p 带/v 表头/n 结点/n 的/ude1 有序/a 链/ng 表表示/n 多项式/n 
    ∥/w -/wp …/ws -/wp 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v -/wp …/ws -/wp 
void/x  CreatPolyn/x (/wkz polynomail/x ＆/n P/x ，/wd int/x  m/x )/wky ；/wf 
    ∥/w 输入/v m/x 项/q 的/ude1 系数/n 和/cc 指数/n ，/wd 建立/v 表示/v 一元/b 多项式/n 的/ude1 有序/a 链/ng 表/n P/x 
 void/x  DestroyPolyn/x (/wkz polynomail/x ＆/n P/x )/wky ；/wf 
    ∥/w 销毁/v 一元/b 多项式/n P/x 
 void/x  PrintPolyn/x (/wkz polynomail/x  P/x )/wky ；/wf 
    ∥/w 打印/v 输出/v 一元/b 多项式/n P/x 
int/x  PolynLength/x (/wkz polynomail/x  P/x )/wky ；/wf     
    ∥/w 返回/v 一元/b 多项式/n P/x 中/f 的/ude1 项数/n 
void/x  AddPolyn/x (/wkz polynomail/x ＆/n Pa．polynomail/x &/n Pb/x )/wky ；/wf 
    ∥/w 完成/v 多项式/n 相加/vn 运算/vn ，/wd 即/v ：/wp Pa=Pa+Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n Pb/x 
 void/x  SubtractPolyn/x (/wkz polynomail/x  aPa/x ，/wd polynomail/x ＆/n )/wky ；/wf 
    ∥/w 完成/v 多项式/n 相/d 减/v 运算/vn ，/wd 即/v ：/wp Pa=Pa―Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n 
void/x  MultiplyPolyn/x (/wkz polynomail/x ＆/n Pa/x ，/wd polynomail/x &/n Pb/x )/wky ；/wf 
    ∥/w 完成/v 多项式/n 相乘/v 运算/vn ，/wd 即/v ：/wp Pa=Pax/x  Pb/x ，/wd 并/cc 销毁/v 一元/b 多项式/n Pb/x 
    ∥/w …/ws --/wp 基本/ad 操作/v 的/ude1 算法/n 描述/v (/wkz 部分/n )/wky ----/wp 一/m 
int/x  cmp/x (/wkz term/x  a/x ，/wd term/x  b/x )/wky ；/wf 
    ∥/w 依/v a/x 的/ude1 指数值/n </n (/wkz 或/c =/m )/wky (/wkz 或/c >/n )/wky b/x 的/ude1 指数值/n ，/wd 分别/d 返回/v 一/m 1/m 、/wn 0/m 和/cc +1/m 
 void/x  CreatPolyn/x (/wkz polyno/x ,/wd ．/w all/x &/n P/x ，/wd int/x  m/x )/wky l/x 
    ∥/w 输入/v m/x 项/q 的/ude1 系数/n 和/cc 指数/n ，/wd 建立/v 表示/v 一元/b 多项式/n 的/ude1 有序/a 链/ng 表/n P/x 
    InitList/x (/wkz P/x )/wky ；/wf h=GetHead/x (/wkz P/x )/wky ；/wf 
    e．coef=0．0/x ；/wf e．expn=/x 一/m 1/m ；/wf SetCurElem/x (/wkz h/x ，/wd e/x )/wky ；/wf ∥/w 设置/v 头/n 结点/n 的/ude1 数据/n 元素/n 
    for/x (/wkz i：i/x ；/wf i/x </n =m/x ；/wf ++i/x )/wky l/x   ∥/w 依次/d 输入/v m/x 个/q 非零/n 项/q 
    somsf/x (/wkz e．coef/x ，/wd e．expn/x )/wky ；/wf 
    if/x (/wkz !/wt LocateElem/x (/wkz P/x ，/wd e/x ，/wd q/x ，/wd (/wkz */n cmp/x )/wky (/wkz )/wky )/wky )/wky I/x   ∥/w 当前/t 链/ng 表/n 中/f 不/d 存在/v 该/rz 指数/n 项/q 
・/w 42・/m 
    if/x (/wkz MakeNode/x (/wkz s/x ，/wd e/x )/wky )/wky InsFirst/x (/wkz q/x ，/wd S/x )/wky ；/wf   ∥/w 生成/v 结点/n 并/d 插入/v 链/ng 表/n 
    }/n 
    l/x 
、/wn ff/x  CreatPolyn/x 
算法/n 2．22/m 
void/x  AddPolyn/x (/wkz polynomial/x ＆/n Pa/x ，/wd polynomial/x &/n Ph/x )/wky   I/x 
    ∥/w 多项式/n 加法/n ：/wp Pa=Pa+Pb/x ，/wd 利用/v 两/m 个/q 多/m 项/q 式/k 的/ude1 结点/n 构成/v “/wyz 和/cc 多项式/n ”/wyy 。/wj 
    ha=GetHead/x (/wkz Pa/x )/wky ；/wf hb=GetHead/x (/wkz Pb/x )/wky ；/wf ∥/w ha/x 和/cc hb/x 分别/d 指向/v Pa/x 和/cc Pb/x 的/ude1 头/n 结点/n 
    qa=NextPos/x (/wkz ha/x )/wky ；/wf qb=NextPos/x (/wkz hb/x )/wky ；/wf   ∥/w qa/x 和/cc qb/x 分别/d 指向/v Pa/x 和/cc Pb/x 中/f 当前/t 结点/n 
    while/x (/wkz !/wt Empty/x (/wkz Pa/x )/wky ＆/n ＆/n !/wt Empty/x (/wkz Pb/x )/wky )/wky j/x   ∥/w Pa/x 和/cc Pb/x 均/d 非空/n 
    a=GetCurElem/x (/wkz qa/x )/wky ；/wf b=GetCurElem/x (/wkz qb/x )/wky ；/wf ∥/w a/x 和/cc b/x 为/p 两/m 表/n 中/f 当前/t 比较/v 元素/n 
    switch/x (/wkz */n cap/x (/wkz a/x ，/wd b/x )/wky )/wky {/n 
 ∥/w 多项式/n PA/x 中/f 当前/t 结点/n 的/ude1 指数值/n 小/a 
    ha/x 。/wj qa/x ；/wf qa=NextPos/x (/wkz Pa/x ，/wd qa/x )/wky ；/wf hruk/x ；/wf     、/wn 
    case/x  0：/m     ∥/w 两者/rzv 的/ude1 指数值/n 相等/vi 
    sum/x 。/wj a．coef+b．coef：/x 
    if/x (/wkz sum/x !/wt =0．0/m )/wky {/n   ∥/w 修改/v 多项式/n PA/x 中/f 当前/t 结点/n 的/ude1 系数/n 值/n 
    SetCurElem/x (/wkz qa/x ，/wd s11m/x )/wky ；/wf ha=qa/x ；/wf   }/n 
    el∞/x {/n ∥/w 删除/v 多项式/n PA/x 中/f 当前/t 结点/n 
    DelFirst/x (/wkz ha/x ，/wd qa/x )/wky ；/wf FreeNode/x (/wkz qa/x )/wky ；/wf   I/x 
    DelFirst/x (/wkz hb/x ，/wd qh/x )/wky ；/wf Freeaode/x (/wkz qb/x )/wky ；/wf qb=NextPos/x (/wkz Pb/x ，/wd hb/x )/wky ；/wf 
    qa=NextPos/x (/wkz Pa/x ，/wd ha/x )/wky ；/wf break/x ；/wf 
    ca∞1：/x     ∥/w 多项式/n PB/x 中/f 当前/t 结点/n 的/ude1 指数值/n 小/a 
    DelFirst/x (/wkz hb/x ，/wd qb/x )/wky ；/wf   InsFirst/x (/wkz ha/x 。/wj qb/x )/wky ；/wf 
    qb=NextPos/x (/wkz Pb/x ，/wd hb/x )/wky ；/wf     break/x ；/wf 
    l/x ∥/w switch/x 
    }/n ∥/w while/x 
    if/x (/wkz !/wt Empty/x (/wkz Pb/x )/wky )/wky Append/x (/wkz Pa/x ，/wd qa/x )/wky ；/wf     ∥/w 链接/n Pb/x 中/b 剩余/vn 结点/n 
    FreeNode/x (/wkz hb/x )/wky ：/wp ∥/w 释放/v Pb/x 的/ude1 头/n 结点/n 
、/wn ?/ww }/n AddPolyn/x 
算法/n 2．23/m 
    两/m 个/q 一元/b 多项式/n 相乘/v 的/ude1 算法/n ，/wd 可以/v 利用/v 两/m 个/q 一元/b 多项式/n 相加/vi 的/ude1 算法/n 来/vf 实现/v ，/wd 因为/c 乘法运算/n 可以/v 分解/v 为/p 一/m 系列/q 的/ude1 加法运算/n 。/wj 假设/n A/x (/wkz z/x )/wky 和/cc B/x (/wkz z/x )/wky 为/v 式/k (/wkz 2―7/m )/wky 的/ude1 多项式/n ，/wd 则/d     M/x (/wkz z/x )/wky ：/wp A/x (/wkz z/x )/wky ×B/x (/wkz z/x )/wky     =A/x (/wkz z/x )/wky ×/w [/wkz b/x  xz/x 。/wj 1+b2z/x 。/wj 2+/m …/ws +6/m ，/wd 其中/rz ，/wd 每/rz 一/m 项/q 都/d 是/vshi 一个/mq 一元/b 多项式/n 。/wj 


第3/m 章/q 栈/ng 和/cc 队列/n 
    栈/ng 和/cc 队列/n 是/vshi 两/m 种/q 重要/a 的/ude1 线性/n 结构/n 。/wj 从/p 数据/n 结构/n 角度看/n ，/wd 栈/ng 和/cc 队列/n 也/d 是/vshi 线性/n 表/n ，/wd 其/rz 特殊性/n 在于/v 栈/ng 和/cc 队列/n 的/ude1 基本/a 操作/vn 是/vshi 线性/n 表/vg 操作/v 的/ude1 子集/n ，/wd 它们/rr 是/vshi 操作/v 受限/v 的/ude1 线性/n 表/n ，/wd 因此/c ，/wd 可/c 称为/v 限/v 定性/vi 的/ude1 数据/n 结构/n 。/wj 但/c 从/p 数据/n 类型/n 角度看/n ，/wd 它们/rr 是/vshi 和/cc 线性/n 表/vg 大/a 不/d 相同/a 的/ude1 两/m 类/q 重要/a 的/ude1 抽象数据/n 类型/n 。/wj 由于/c 它们/rr 广泛/ad 应用/v 在/p 各种/rz 软件/n 系统/n 中/f ，/wd 因此/c 在/p 面向对象/n 的/ude1 程序设计/n 中/f ，/wd 它们/rr 是/vshi 多/m 型/k 数据/n 类型/n 。/wj 本章/nr2 除了/p 讨论/v 栈/ng 和/cc 队列/n 的/ude1 定义/n 、/wn 表示方法/n 和/cc 实现/v 外/f ，/wd 还/d 将/d 给/v 出/vf 一些/mq 应用/vn 的/ude1 例子/n 。/wj   
    3．1/m   栈/ng 
  3．1．1/m 抽象数据/n 类型/n 栈/ng 的/ude1 定义/n 
  栈/ng (/wkz Stack/x )/wky   是/vshi 限定/v 仅/d 在/p 表/n 尾/ng 进行/vx 插入/v 或/c 删除/v 操作/v 的/ude1 线性/n 表/n 。/wj 因此/c ，/wd 对/p 栈/ng 来说/uls ，/wd 表/vg 尾/ng 端/v 有/vyou 其/rz 特殊/a 含义/n ，/wd 称为/v 栈/ng 顶/v (/wkz top/x )/wky ，/wd 相应/vi 地/n ，/wd 表头/n 端/v 称为/v 栈/ng 底/f (/wkz bottom/x )/wky 。/wj 不/d 含/v 元素/n 的/ude1 空/a 表/n 称为/v 空/ng 栈/ng 。/wj 
    假设/n 栈/ng S=/x (/wkz 。/wj 。/wj ，/wd 口/q 2/m ，/wd …/ws ，/wd n/x 。/wj )/wky ，/wd 则/c 称/v 口/q 1/m 为/v 栈/ng 底/f 元素/n ，/wd a/x 。/wj 为/p 栈/ng 顶/v 元素/n 。/wj 栈/ng 中/f 元素/n 按/p n/x ，/wd ，/wd az/x ，/wd …/ws ，/wd 口/q 。/wj 的/ude1 次序/n 进/vf 栈/ng ，/wd 退/v 栈/ng 的/ude1 第一/m 个/q 元素/n 应/v 为/v 栈/ng 顶/v 元素/n 。/wj 换句话说/c ，/wd 栈/ng 的/ude1 修改/vn 是/vshi 按/p 后进/n 先/d 出/vf 的/ude1 原则/n 进行/vx 的/ude1 (/wkz 如/v 图/n 3．1/m (/wkz a/x )/wky 所/usuo 示/vg )/wky 。/wj 因此/c ，/wd 栈/ng 又/d 称/v 为/p 后进/n 先/d 出/vf (/wkz I．ast/x  In/x  First/x  Out/x )/wky 的/ude1 线性/n 表/n (/wkz 简称/v LIFO/x 结构/n )/wky ，/wd 它/rr 的/ude1 这个/rz 特点/n 可用/a 图/n 3．1/m (/wkz b/x )/wky 所/usuo 示/vg 的/ude1 铁路/n 调度站/n 形象/n 地/ude2 表示/v 。/wj 
出/vf 栈/ng     进/vf 栈/ng     出/vf 栈/ng 
进/vf 栈/ng 
    图/n 3．1/m 栈/ng 
(/wkz a/x )/wky 栈/ng 的/ude1 示意图/n ；/wf   (/wkz b/x )/wky 用/p 铁路/n 调度站/n 表示/v 栈/ng 。/wj 
    栈/ng 的/ude1 基本/ad 操作/v 除了/p 在/p 栈/ng 顶/v 进行/vx 插入/v 或/c 删除/v 外/f ，/wd 还有/v 栈/ng 的/ude1 初始化/v 、/wn 判/v 空/a 及/cc 取/v 栈/ng 顶/v 元素/n 等/udeng 。/wj 下面/f 给/v 出/vf 栈/ng 的/ude1 抽象数据/n 类型/n 的/ude1 定义/n ：/wp 
    Stack/x  i/x 
    数据/n 对象/n ：/wp D=/x {/n ail/x  ai∈Ele/x ~/n Set/x ，/wd i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x ，/wd   n≥0/x }/n 
    数据/n 关系/n ：/wp R1=/x {/n </n ai．1/x ，/wd ai/x >/n I/x  ai/x 一/m 1/m ，/wd ai∈D/x ，/wd i=2/x ，/wd …/ws ，/wd n/x }/n 
    约定/v a/x 。/wj 端/v 为/v 栈/ng 顶/ng ，/wd a/x ，/wd 端/v 为/v 栈/ng 底/f 。/wj 
  基本/ad 操作/v ：/wp 
    InitStack/x (/wkz ＆/n s/x )/wky 
  操作/v 结果/n ：/wp 构造/v 一个/mq 空/a 栈/ng s/x 。/wj 
    DestroyStack/x (/wkz ＆/n s/x )/wky 
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 。/wj     
  操作/v 结果/n ：/wp 栈/ng s/x 被/pbei 销毁/v 。/wj 
    clearStack/x (/wkz ＆/n s/x )/wky     
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 将/d s/x 清/v 为/v 空/ng 栈/ng 。/wj 
    StackEmpty/x (/wkz S/x )/wky     ’/wyy 
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 若/v 栈/ng s/x 为/v 空/ng 栈/ng ；/wf 则/c 返回/v TRUE/x ，/wd 否则/c FALSE/x 。/wj 
    StackLength/x (/wkz s/x )/wky 
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 返回/v s/x 的/ude1 元素/n 个数/n ，/wd 即/v 栈/ng 的/ude1 长度/n 。/wj 
    GetTop/x (/wkz s/x ，/wd ＆/n e/x )/wky 
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 且/c 非空/n 。/wj 
  操作/v 结果/n ：/wp 用/v e/x 返回/v s/x 的/ude1 栈/ng 顶/v 元素/n 。/wj 
    Push/x (/wkz &/n s/x ，/wd e/x )/wky 
  初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 。/wj 
  操作/v 结果/n ：/wp 插入/v 元素/n e/x 为/p 新/a 的/ude1 栈/ng 顶/v 元素/n 。/wj 
    Pop/x (/wkz &/n s/x ，/wd ＆/n e/x )/wky 
    初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 且/c 非空/n 。/wj 
    操作/v 结果/n ：/wp 删除/v s/x 的/ude1 栈/ng 顶/v 元素/n ，/wd 并/cc 用/v e/x 返回/v 其/rz 值/n 。/wj 
    StackTraverse/x (/wkz s/x ，/wd visi/x 七/m (/wkz )/wky )/wky 
    初始条件/n ：/wp 栈/ng s/x 已/d 存在/v 且/c 非空/n 。/wj 
    操作/v 结果/n ：/wp 从/p 栈/ng 底/f 到/v 栈/ng 顶/v 依次/d 对/p s/x 的/ude1 每个/r 数据/n 元素/n 调用函数/n visit/x (/wkz )/wky 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作/v 失效/vi 。/wj 
}/n ADT/x  Stack/x 
    本书/r 在/p 以后/f 各/rz 章/n 中/f 引用/v 的/ude1 栈/ng 大多/d 为/v 如上/b 定义/n 的/ude1 数据/n 类型/n ，/wd 栈/ng 的/ude1 数据/n 元素/n 类型/n 在/p 应用/vn 程序/n 内/f 定义/n ，/wd 并/cc 称/v 插入/v 元素/n 的/ude1 操作/vn 为/v 入/v 栈/ng ，/wd 删除/v 栈/ng 顶/v 元素/n 的/ude1 操作/vn 为/v 出/vf 栈/ng 。/wj 
3．1．2/m 栈/ng 的/ude1 表示/vn 和/cc 实现/v 
    和/cc 线性/n 表/vg 类似/a ，/wd 栈/ng 也/d 有/vyou 两/m 种/q 存储表示/n 方法/n 。/wj 
    顺序/n 栈/ng ，/wd 即/v 栈/ng 的/ude1 顺序/n 存储/vn 结构/n 是/vshi ，/wd 利用/v 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 依次/d 存放/v 自/p 栈/ng 底/f 到/v 栈/ng 顶/v 的/ude1 数据/n 元素/n ，/wd 同时/c 附设/v 指针/n top/x 指示/n 栈/ng 顶/v 元素/n 在/p 顺序/n 栈/ng 中/f 的/ude1 位置/n 。/wj 通常/b 的/ude1 习惯/n 做法/n 是/vshi 以/p top=0/x 表示/v 空/ng 栈/ng ，/wd 鉴于/p c/x 语言/n 中/f 数/m 组/q 的/ude1 下标/n 约定/v 从/p O/x 开始/v ，/wd 则/c 当/v 以/p c/x 作/v 描述语言/n 时/ng ，/wd 如此/rzv 设定/v 会/v 带来/v 很/d 大/a 不便/an ；/wf 另一方面/c ，/wd 由于/p 栈/ng 在/p 使用/v 过程/n 中/f 所/usuo 需/v 最/d 大/a 空间/n 的/ude1 大小/n 很/d 难/ad 估计/v ，/wd 因此/c ，/wd 一般来说/vl ，/wd 在/p 初始化/v 设/v 空/ng 栈/ng 时/ng 不/d 应/v 限定/v 栈/ng 的/ude1 最/d 大容量/n 。/wj 一个/mq 较/d 合理/a 的/ude1 做法/n 是/vshi ：/wp 先/d 为/v 栈/ng 分配/v 一个/mq 基本/a 容量/n ，/wd 然后/c 在/p 应用/vn 过程/n 中/f ，/wd 当/v 栈/ng 的/ude1 空间/n 不够/a 使用/vn 时/ng 再/d 逐/vg 段/ng 扩大/v 。/wj 为此/bl ，/wd 可/c 设定/v 两/m 个/q 常量/n ：/wp sTACK―INIT―SIZE/x (/wkz 存储空间/n 初始/b 分配量/n )/wky 和/cc SnKKINCREMENT/x (/wkz 存储空间/n 分配/vn 增量/n )/wky ，/wd 并/cc 以下/f 述/vg 类型/n 说明/v 作为/p 顺序/n 栈/ng 的/ude1 定义/n 。/wj 
typedef/x  struct/x {/n 
    SEl/x ~/n Type/x   */n base/x ~/n 
    SElemType/x   */n top/x ；/wf 
    stacksize：/x 
    I/x  SqStack/x ；/wf 
其中/rz ，/wd stacksize/x 指示/n 栈/ng 的/ude1 当前/t 可/v 使用/v 的/ude1 最/d 大容量/n 。/wj 栈/ng 的/ude1 初始化操作/n 为/v ：/wp 按/p 设定/v 的/ude1 初始/b 分配量/n 进行/vx 第一/m 次存储/n 分配/vn ，/wd baSe/x 可/v 称为/v 栈/ng 底/f 指针/n ，/wd 在/p 顺序/n 栈/ng 中/f ，/wd 它/rr 始终/d 指向/v 栈/ng 底/f 的/ude1 位置/n 。/wj 若/v base/x 的/ude1 值/n 为/v NULL/x ，/wd 则/c 表明/v 栈/ng 结构/n 不/d 存在/v 。/wj 称/v top/x 为/v 栈/ng 顶/v 指针/n ，/wd 其/rz 初值/n 指向/v 栈/ng 底/f ，/wd 即/v top=base/x 可/v 作为/v 栈/ng 空/a 的/ude1 标记/n ，/wd 每当/p 插入/v 新/a 的/ude1 栈/ng 顶/v 元素/n 时/ng ，/wd 指针/n top/x 增/v 1/m ；/wf 删除/v 栈/ng 顶/v 元素/n 时/ng ，/wd 指针/n top/x 减/v 1/m ，/wd 因此/c ，/wd 非空/n 栈/ng 中/f 的/ude1 栈/ng 顶/v 指针/n 始终/d 在/p 栈/ng 顶/v 元素/n 的/ude1 下/vf 一个/mq 位置/n 上/f 。/wj 图/n 3．2/m 展示/v 了/ule 顺序/n 栈/ng 中/f 数据/n 元素/n 和/cc 栈/ng 顶/v 指针/n 之间/f 的/ude1 对应/vn 关系/n 。/wj     
图/n 3．2/m 栈/ng 顶/v 指针/n 和/cc 栈/ng 中/f 元素/n 之间/f 的/ude1 关系/n 
以下/f 是/vshi 顺序/n 栈/ng 的/ude1 模块/n 说明/v 。/wj 
／／==/m …/ws ADT/x  Stack/x 的/ude1 表示/vn 与/cc 实现/v =====/m 
    ∥/w …/ws 栈/ng 的/ude1 顺序/n 存储表示/n …/ws 
#/n defi/x ~/n STACKTNIT-SIZE/x  100/m ；/wf   ／／/m 存储空间/n 初始/b 分配量/n 
#/n define/x  sTAINCl/x   10/m ；/wf     ／／/m 存储空间/n 分配/vn 增量/n 
t/x 《/wkz struut/x {/n 
    SEl/x ~/n Type/x   */n base/x ；/wf   ／／/m 在/p 栈/ng 构造/n 之前/f 和/cc 销毁/v 之后/f ，/wd base/x 的/ude1 值/n 为/v NULL/x 
    SEleaType/x */n top/x ；/wf   ／／/m 栈/ng 顶/v 指针/n 
    int/x  stacksize/x ~/n     ／／/m 当前/t 已/d 分配/v 的/ude1 存储空间/n ，/wd 以/p 元素/n 为/p 单位/n 
}/n SqSt/x ~/n ；/wf 
∥/w …/ws ・/w 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v …/ws 
Status/x  InitStack/x (/wkz SqStack/x ＆/n s/x )/wky ；/wf 
    ∥/w 构造/n 一个/mq 空/a 栈/ng S/x 
 Ststum/x  DestroyStack/x (/wkz S/x ~/n Stack/x ＆/n s/x )/wky ；/wf 
    ∥/w 销毁/v 栈/ng S/x ，/wd S/x 不再/d 存在/v 
Stst/x ~/n ClearStack/x (/wkz SqStack/x ＆/n s/x )/wky ；/wf 
    ∥/w 把/pba S/x 置/v 为/v 空/ng 栈/ng 
Status/x  S/x ~/n ckEmpty/x (/wkz SqStack/x  s/x )/wky ；/wf 
    ∥/w 若/v 栈/ng S/x 为/v 空/ng 栈/ng ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c 返回/v FALSE/x 
 int/x  stacl/x 【/wkz 【/wkz gth/x (/wkz SqStack/x  s/x )/wky ；/wf 
    ∥/w 返回/v S/x 的/ude1 元素/n 个数/n ，/wd 即/v 栈/ng 的/ude1 长度/n 
Status/x  GetTop/x (/wkz SqStacl/x 【/wkz S/x ，/wd SElemType/x ＆/n e/x )/wky ；/wf 
    ∥/w 若/v 栈/ng 不/d 空/a ，/wd 则/c 用/v e/x 返回/v S/x 的/ude1 栈/ng 顶/v 元素/n ，/wd 并/cc 返回/v OK/x ；/wf 否则/c 返回/v ERROR/x 
Status/x  Push/x (/wkz SqStack/x &/n s/x ，/wd SElemType/x  e/x )/wky ；/wf 
    ∥/w 插入/v 元素/n e/x 为/p 新/a 的/ude1 栈/ng 顶/v 元素/n 
Status/x  Pop/x (/wkz SqStack/x ＆/n S/x ，/wd SE/x [/wkz emType/x ＆/n e/x )/wky ；/wf 
    ∥/w 若/v 栈/ng 不/d 空/a ，/wd 则/c 删除/v S/x 的/ude1 栈/ng 顶/v 元素/n ，/wd 用/v e/x 返回/v 其/rz 值/n ，/wd 并/cc 返回/v OK/x ；/wf 否则/c 返回/v ERROR/x 
Status/x  StackTraverse/x (/wkz SqStack/x  S/x ，/wd Status/x (/wkz */n visit/x )/wky (/wkz )/wky )/wky ；/wf 
    ∥/w 从/p 栈/ng 底/f 到/v 栈/ng 顶/v 依次/d 对/p 栈/ng 中/f 每个/r 元素/n 调用函数/n visit/x (/wkz )/wky 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 
　　∥/w …/ws 基本/a 操作/vn 的/ude1 算法/n 描述/v (/wkz 部分/n )/wky …/ws 
　　Status/x  InitStack/x (/wkz SqStack/x &/n s/x )/wky {/n 
  ∥/w 构造/n 一个/mq 空/a 栈/ng S/x 
  S．base：/x (/wkz SElemType/x */n )/wky mallet/x (/wkz STACK/x ～/ws INIT―SIZE/x */n sizeof/x (/wkz ElemType/x )/wky )/wky ；/wf 
  if/x (/wkz !/wt S．base/x )/wky exit/x (/wkz O/x ~/n _/n aFLOW/x )/wky ；/wf   ∥/w 存储分配/n 失败/vi 
  S．top=S．base：/x 
  S．stacksize=STACK―INIT―SIZE：/x 
  return/x  OK/x ；/wf     
}/n ／／InitStack/x 
Status/x  GetTop/x (/wkz SqStack/x  S/x ，/wd SElemType/x ＆/n e/x )/wky {/n 
  ∥/w 若/v 栈/ng 不/d 空/a ，/wd 则/c 用/v e/x 返回/v S/x 的/ude1 栈/ng 顶/v 元素/n ，/wd 并/cc 返回/v OK/x ；/wf 否则/c 返回/v ERROR/x 
  if/x (/wkz S．top：=S．base/x )/wky   return/x  ERROR/x ；/wf 
    e=/x */n (/wkz S．top/x 一/m 1/m )/wky ；/wf 
    return/x  OK/x ；/wf 
}/n 
GetTop/x 
Status/x  Push/x (/wkz SqStack/x ＆/n s/x ，/wd SElemType/x  e/x )/wky {/n 
    ∥/w 插入/v 元素/n e/x 为/p 新/a 的/ude1 栈/ng 顶/v 元素/n 
    if/x (/wkz S．top-S．base/x >/n =S．stacksize/x )/wky {/n ∥/w 栈/ng 满/a ，/wd 追加/v 存储空间/n 
    S．base=/x (/wkz ElemType/x */n )/wky realloc/x (/wkz S．base/x ，/wd 
    (/wkz S．stacksize+STACKINCREMENT/x )/wky */n sizeof/x (/wkz ElemType/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt S．base/x )/wky exit/x (/wkz OVERFLOW/x )/wky ；/wf ／／/m 存储分配/n 失败/vn 
    S．top：S．base+S．stacksize：/x 
    S．stacksize+=STACKINCREMENT/x ；/wf 
  }/n 
  */n S．top++=e：/x 
  return/x  OK/x ；/wf 
／／Push/x 
Status/x  Pop/x (/wkz SqStack/x &/n s/x ，/wd SElemType/x ＆/n e/x )/wky {/n 
    ∥/w 若/v 栈/ng 不/d 空/a ，/wd 则/c 删除/v S/x 的/ude1 栈/ng 顶/v 元素/n ，/wd 用/v e/x 返回/v 其/rz 值/n ，/wd 并/cc 返回/v 
    OK/x ；/wf 否则/c 返回/v ERROR/x 
    if/x (/wkz S．top=/x ；/wf S．base/x )/wky return/x  ERROR/x ；/wf 
    e/x 。/wj */n --/wp S．top：/x 
    return/x  OK/x ；/wf 
、/wn }/n }/n Pop/x 
栈/ng 顶/v 
栈/ng 底/f 
图/n 3．3/m 链/ng 栈/ng 示意图/n 
    栈/ng 的/ude1 链式/n 表示/v ――/wp 链/ng 栈/ng 如/v 图/n 3．3/m 所/usuo 示/vg 。/wj 由于/p 栈/ng 的/ude1 操作/vn 是/vshi 线性/n 表/vg 操作/v 的/ude1 特例/n ，/wd 则/d 链/ng 栈/ng 的/ude1 操作/vn 易于/vd 实现/v ，/wd 在/p 此/rzs 不/d 作/v 详细/ad 讨论/v 。/wj 
3．2/m 栈/ng 的/ude1 应用/vn 举例/vi 
    由于/p 栈/ng 结构/n 具有/v 的/ude1 后进/n 先/d 出/vf 的/ude1 固有/b 特性/n ，/wd 致使/v 栈/ng 成为/v 程序设计/n 中/f 的/ude1 有用/a 工具/n 。/wj 本/rz 节/n 将/d 讨论/v 几/m 个/q 栈/ng 应用/v 的/ude1 典型/n 例子/n 。/wj 
    3．2．1/m 数/n 制/k 转换/v 
    十进制/n 数/n N/x 和/cc 其他/rzv d/x 进制数/n 的/ude1 转换/vn 是/vshi 计算机实现/n 计算/v 的/ude1 基本/a 问题/n ，/wd 其/rz 解决/v 方法/n 很多/m ，/wd 其中/rz 一个/mq 简单/a 算法/n 基于/p 下列/b 原理/n ：/wp 
    N=/x (/wkz N/x  div/x  d/x )/wky ×d+N/x  mod/x (/wkz 其中/rz ：/wp div/x 为/p 整除/v 运算/vn ，/wd mod/x 为/p 求/v 余/m 运算/vn )/wky 
    例如/v ：/wp (/wkz 1348/m )/wky 10=/m (/wkz 2504/m )/wky 8/m ，/wd 其/rz 运算/vn 过程/n 如下/vi ：/wp 
    N/x     N/x  div/x  8/m     N/x  mod/x  8/m 
    1348/m     168/m     4/m 
    168/m     21/m     0/m 
    21/m     2/m     5/m 
    2/m     0/m     2/m 
    假设/n 现/tg 要/v 编制/n 一个/mq 满足/v 下列/b 要求/n 的/ude1 程序/n ：/wp 对于/p 输入/v 的/ude1 任意/d 一个/mq 非/b 负十/m 进制/n 整数/n ，/wd 打印/v 输出/v 与其/c 等值/vi 的/ude1 八/m 进制数/n 。/wj 由于/p 上述/b 计算/vn 过程/n 是/vshi 从/p 低位/n 到/v 高位/n 顺序/n 产生/v 八/m 进制数/n 的/ude1 各个/rz 数位/n ，/wd 而/cc 打印/vn 输出/vn ，/wd 一般来说/vl 应/v 从/p 高位/n 到/v 低位/n 进行/vx ，/wd 恰好/d 和/cc 计算/vn 过程/n 相反/vi 。/wj 因此/c ，/wd 若/c 将/d 计算/v 过程/n 中/f 得到/v 的/ude1 八/m 进制数/n 的/ude1 各位/rr 顺序/n 进/vf 栈/ng ，/wd 则/c 按/p 出/vf 栈/ng 序列/n 打印/vn 输出/vn 的/ude1 即/d 为/v 与/cc 输入/v 对应/vi 的/ude1 八/m 进制数/n 。/wj 
    v/x ,/wd oid/x  conversion/x (/wkz )/wky {/n 
    ∥/w 对于/p 输入/v 的/ude1 任意/d 一个/mq 非/b 负十/m 进制/n 整数/n ，/wd 打印/v 输出/v 与其/c 等值/vi 的/ude1 八/m 进制数/n 
    InitStack/x (/wkz s/x )/wky ；/wf     ∥/w 构造/n 空/ng 栈/ng 
    8ca/x 《/wkz (/wkz ”/wyy ％/wb ∥/w ，/wd N/x )/wky ；/wf 
    while/x (/wkz N/x )/wky {/n 
    Push/x (/wkz s/x ，/wd N％8/x )/wky ；/wf 
    N=S／8：/x 
    }/n 
    While/x (/wkz !/wt StackEmpty/x )/wky {/n 
    Pop/x (/wkz s/x ，/wd e/x )/wky ；/wf 
    prirltf/x (/wkz ”/wyy ％f/x ，/wd e/x )/wky ；/wf 
    }/n 
    }/n ∥/w conversiorl/x 
    算法/n 3．1/m 
这/rzv 是/vshi 利用/v 栈/ng 的/ude1 后进/n 先/d 出/vf 特性/n 的/ude1 最/d 简单/a 的/ude1 例子/n 。/wj 在/p 这个/rz 例子/n 中/f ，/wd 栈/ng 操作/v 的/ude1 序列/n 是/vshi 直线/n 式/k 的/ude1 ，/wd 即/d 先/d 一味/d 地/ude2 入/v 栈/ng ，/wd 然后/c 一味/d 地/ude2 出/vf 栈/ng 。/wj 也许/d ，/wd 有的/rz 读者/n 会/v 提出/v 疑问/n ：/wp 用/p 数组/n 直接/ad 实现/v 不/d 也/d 很/d 简单/a 吗/y ?/ww 仔细/ad 分析/v 上述/b 算法/n 不难/d 看出/v ，/wd 栈/ng 的/ude1 引入/v 简化/v 了/ule 程序设计/n 的/ude1 问题/n ，/wd 划分/v 了/ule 不同/a 的/ude1 关注/vn 层次/n ，/wd 使/v 思考/vn 范围/n 缩小/v 了/y 。/wj 而/cc 用/p 数组/n 不仅/c 掩盖/v 了/ule 问题/n 的/ude1 本质/n ，/wd 还要/d 分散/a 精力/n 去/vf 考虑/v 数组/n 下标/n 增减/vn 等/udeng 细节/n 问题/n 。/wj 
3．2．2/m 括号/n 匹配/vi 的/ude1 检验/vn 
　　假设/v 表达式/n 中/f 允许/v 包含/v 两/m 种/q 括号/n ：/wp 圆括号/n 和/cc 方括号/n ，/wd 其/rz 嵌套/v 的/ude1 顺序/n 随意/an ，/wd 即/v (/wkz 【/wkz ]/wky (/wkz )/wky )/wky 等/udeng 为/v 正确/a 的/ude1 格式/n ，/wd [/wkz (/wkz ]/wky )/wky 或/c (/wkz [/wkz (/wkz )/wky )/wky 或/c (/wkz (/wkz )/wky ]/wky )/wky 均/d 为/v 不/d 正确/a 的/ude1 格式/n 。/wj 检验/v 括号/n 是否/v 匹配/vi 的/ude1 方法/n 可/v 用/p “/wyz 期待/v 的/ude1 急迫/a 程度/n ”/wyy 这个/rz 概念/n 来/vf 描述/v 。/wj 例如/v 考虑/v 下列/b 括号/n 序列/n ：/wp 
　　    1/m  2/m  3/m  4/m  5/m  6/m  7/m  8/m 
当/p 计算机接受/n 了/ule 第一/m 个/q 括号/n 后/f ，/wd 它/rr 期待/v 着/uzhe 与/p 其/rz 匹配/vi 的/ude1 第八/m 个/q 括号/n 的/ude1 出现/vn ，/wd 然而/c 等/v 来/vf 的/ude1 却/d 是/vshi 第/m _/n 二/m 个/q 括号/n ，/wd 此时/r 第一/m 个/q 括号/n “/wyz [/wkz ”/wyy 只能/v 暂时/d 靠边/vi ，/wd 而/cc 迫切/ad 等待/v 与/p 第二/m 个/q 括号/n 相/d 匹配/vi 的/ude1 、/wn 第七/m 个/q 括号/n “/wyz )/wky ”/wyy 的/ude1 出现/vn ，/wd 类似/v 地/n ，/wd 因/c 等/v 来/vf 的/ude1 是/vshi 第三/m 个/q 括号/n “/wyz [/wkz ”/wyy ，/wd 其/rz 期待/v 匹配/vi 的/ude1 程度较/n 第二/m 个/q 括号/n 更/d 急迫/a ，/wd 则/c 第二/m 个/q 括号/n 也/d 只能/v 靠/v 边/k ，/wd 让位/vi 于/p 第三/m 个/q 括号/n ，/wd 显然/ad 第二/m 个/q 括号/n 的/ude1 期待/vn 急迫/a 性/ng 高于/v 第一/m 个/q 括号/n ；/wf 在/p 接受/v 了/ule 第四/m 个/q 括号/n 之后/f ，/wd 第三/m 个/q 括号/n 的/ude1 期待/vn 得到/v 满足/v ，/wd 消解/v 之后/f ，/wd 第二/m 个/q 括号/n 的/ude1 期待/vn 匹配/vi 就/d 成为/v 当前/t 最/d 急迫/a 的/ude1 任务/n 了/y ，/wd …/ws …/ws ，/wd 依次/d 类推/vi 。/wj 可见/c ，/wd 这个/rz 处理过程/n 恰/d 与/p 栈/ng 的/ude1 特点/n 相/d 吻合/vi 。/wj 由此/d ，/wd 在/p 算法/n 中/f 设置/v 一个/mq 栈/ng ，/wd 每/rz 读入/v 一个/mq 括号/n ，/wd 若是/c 右/f 括号/n ，/wd 则/c 或者/c 使/v 置于/v 栈/ng 顶/v 的/ude1 最/d 急迫/a 的/ude1 期待/vn 得以/v 消解/v ，/wd 或者/c 是/vshi 不/d 合法/a 的/ude1 情况/n ；/wf 若/c 是/vshi 左/a 括号/n ，/wd 则/c 作为/v 一个/mq 新/a 的/ude1 更/d 急迫/a 的/ude1 期待/vn 压/v 入/v 栈/ng 中/f ，/wd 自然/d 使/v 原有/v 的/ude1 在/p 栈/ng 中/f 的/ude1 所有/b 未/d 消解/v 的/ude1 期待/vn 的/ude1 急迫/a 性/ng 都/d 降/v 了/ule 一级/b 。/wj 
另外/c ，/wd 在/p 算法/n 的/ude1 开始/vn 和/cc 结束/v 时/ng ，/wd 栈/ng 都/d 应该/v 是/vshi 空/a 的/ude1 。/wj 此/rzs 算法/n 将/d 留给/v 读者/n 作为/p 习题/n 完成/v 。/wj 
3．2．3/m 行/q 编辑程序/n 
    一个/mq 简单/a 的/ude1 行/a 编辑程序/n 的/ude1 功能/n 是/vshi ：/wp 接受用户/n 从/p 终端/n 输入/v 的/ude1 程序/n 或/c 数据/n ，/wd 并/cc 存入/v 用户/n 的/ude1 数据/n 区/n 。/wj 由于/p 用户/n 在/p 终端/n 上/f 进行/vx 输入/vn 时/ng ，/wd 不/d 能/v 保证/v 不/d 出/vf 差错/n ，/wd 因此/c ，/wd 若/c 在/p 编辑程序/n 中/f ，/wd “/wyz 每/rz 接受/v 一个/mq 字符/n 即/d 存入/v 用户数/n 据区/n ”/wyy 的/ude1 做法/n 显然/ad 不/d 是/vshi 最/d 恰当/a 的/ude1 。/wj 较/d 好/a 的/ude1 做法/n 是/vshi ，/wd 设立/v 一个/mq 输入/vn 缓冲区/n ，/wd 用以/d 接受用户/n 输入/v 的/ude1 一/m 行/q 字符/n ，/wd 然后/c 逐/vg 行/ng 存入/v 用户数/n 据区/n 。/wj 允许/v 用户/n 输入/v 出/vf 差错/n ，/wd 并/cc 在/p 发现/v 有/vyou 误/v 时/ng 可以/v 及时/ad 更正/v 。/wj 例如/v ，/wd 当/p 用户/n 发现/v 刚刚/d 键/ng 入/v 的/ude1 一个/mq 字符/n 是/vshi 错/v 的/ude1 时/ng ，/wd 可/c 补/v 进/vf 一个/mq 退格符/n “/wyz #/n ”/wyy ，/wd 以/p 表示/v 前/f 一个/mq 字符/n 无效/vi ；/wf 如果/c 发现/v 当前/t 键/ng 入/v 的/ude1 行/ng 内/f 差错/n 较/d 多/a 或/c 难以/d 补救/vi ，/wd 则/c 可以/v 键/ng 入/v 一个/mq 退/v 行/ng 符/vg “/wyz @/x ”/wyy ，/wd 以/p 表示/v 当前/t 行/ng 中/f 的/ude1 字符/n 均/d 无效/vi 。/wj 例如/v ，/wd 假设/v 从/p 终端/n 接受/v 了/ule 这样/rzv 两/m 行/q 字符/n ：/wp 
    whli/x #/n #/n ilr/x #/n e/x (/wkz s/x #/n */n s/x )/wky 
    outcha@putchar/x (/wkz */n s=/x #/n ++/m )/wky ；/wf 
则/d 实际/a 有效/a 的/ude1 是/vshi 下列/b 两/m 行/q ：/wp 
    while/x (/wkz */n s/x )/wky 
    putcbar/x (/wkz */n s++/x )/wky ；/wf 
    为此/bl ，/wd 可/c 设/v 这个/rz 输入/vn 缓冲区/n 为/v 一个/mq 栈/ng 结构/n ，/wd 每当/p 从/p 终端/n 接受/v 了/ule 一个/mq 字符/n 之后/f 先/d 作/v 如下/vi 
判别/v ：/wp 如果/c 它/rr 既/c 不/d 是/vshi 退格符/n 也/d 不/d 是/vshi 退/v 行/ng 符/ng ，/wd 则/c 将/p 该/rz 字符/n 压/v 入/v 栈/ng 顶/v ；/wf 如果/c 是/vshi 一个/mq 退格符/n ，/wd 则/c 从/p 
栈/ng 顶/v 删去/v 一个/mq 字符/n ；/wf 如果/c 它/rr 是/vshi 一个/mq 退/v 行/ng 符/ng ，/wd 则/c 将/p 字符/n 栈/ng 清/v 为/v 空/ng 栈/ng 。/wj 上述/b 处理过程/n 可用/a 算法/n 
3．2/m 描述/v 之/uzhi 。/wj 
void/x  LineEdJt/x (/wkz )/wky {/n 
  ∥/w 利用/v 字符/n 栈/ng 飞/vi ，/wd 从/p 终端/n 接收/vn 一行/n 并/cc 传送/v 至/p 调用/v 过程/n 的/ude1 数据/n 区/n 。/wj 
  InitStack/x (/wkz s/x )/wky ；/wf     ∥/w 构造/n 空/ng 栈/ng s/x 
  ch：getchar/x (/wkz )/wky ；/wf     ∥/w 从/p 终端/n 接收/v 第一/m 个/q 字符/n 
  ．/w hile/x (/wkz ch/x  f/x _/n 日/b oF/x )/wky {/n ∥/w EOF/x 为/p 全文/n 结束符/n 
    while/x (/wkz ch/x !/wt =@OF/x ＆/n &/n ch/x !/wt =/m ’/wyy ＼n/x ’/wyy )/wky {/n 
    swi．tch/x (/wkz ch/x )/wky {/n 
    case/x ’/wyy #/n 。/wj ：/wp Pop/x (/wkz s/x ，/wd c/x )/wky ；/wf     break/x ；/wf ∥/w 仅/d 当/v 栈/ng 非空/n 时/ng 退/v 栈/ng 
    case/x ’/wyy @/x ’/wyy ：/wp clearStack/x (/wkz s/x )/wky ；/wf   break/x ；/wf ∥/w 重/d 置/v s/x 为/v 空/ng 栈/ng 
    defau/x ]/wky t：Push/x (/wkz ’/wyy s/x ，/wd ch/x )/wky ；/wf     break/x ；/wf ∥/w 有效/a 字符/n 进/vf 栈/ng ，/wd 未/d 考虑/v 栈/ng 满/a 情形/n 
    }/n 
    ch=getchar/x (/wkz )/wky ；/wf   ∥/w 从/p 终端/n 接收/v 下/vf 一个/mq 字符/n 
    I/x 
    将/d 从/p 栈/ng 底/f 到/v 栈/ng 顶/v 的/ude1 栈/ng 内/f 字符/n 传送/v 至/p 调用/v 过程/n 的/ude1 数据/n 区/n ；/wf 
    clearStack/x (/wkz s/x )/wky ；/wf     ∥/w 重/d 置/v s/x 为/v 空/ng 栈/ng 
    if/x (/wkz ch/x 。/wj !/wt ：/wp mr/x )/wky ch=getch/x ~/n r/x (/wkz )/wky ；/wf 
  }/n 
  DestroyStack/x (/wkz s/x )/wky ；/wf 
I／／L1need／．t/x 
算法/n 3．2/m 
3．2．4/m 迷宫/n 求解/vi 
求/v 迷宫/n 中/f 从/p 入口/n 到/v 出口/vi 的/ude1 所有/b 路径/n 是/vshi 一个/mq 经典/n 的/ude1 程序设计/n 问题/n 。/wj 由于/p 计算机/n 解/v 迷宫/n 时/ng ，/wd 通常/d 用/v 的/ude1 是/vshi “/wyz 穷举/v 求解/vi ”/wyy 的/ude1 方法/n ，/wd 即/d 从/p 入口/n 出发/vi ，/wd 顺/v 某/rz 一/m 方向/n 向前/vi 探索/v ，/wd 若/c 能/v 走/v 通/v ，/wd 则/c 继续/v 往/p 前/f 走/v ；/wf 否则/c 沿/p 原/b 路/n 退回/v ，/wd 换/v 一个/mq 方向/n 再/d 继续/v 探索/v ，/wd 直至/v 所/usuo 有/vyou 可能/n 的/ude1 通/a 路/n 都/d 探索/v 到/v 为止/u 。/wj 为了/p 保证/v 在/p 任何/rz 位置/n 上/f 都/d 能/v 沿/p 原/b 路/n 退回/v ，/wd 显然/ad 需要/v 用/p 一个/mq 后进/n 先/d 出/vf 的/ude1 结构/n 来/vf 保存/v 从/p 入口/n 到/p 当前/t 位置/n 的/ude1 路径/n 。/wj 因此/c ，/wd 在/p 求/v 迷宫/n 通路/n 的/ude1 算法/n 中/f 应用/v “/wyz 栈/ng ”/wyy 也/d 就是/v 自然而然/al 的/ude1 事/n 了/y 。/wj 
    首先/c ，/wd 在/p 计算机/n 中/f 可以/v 用/p 如/v 图/n 3．4/m 所/usuo 示/vg 的/ude1 方块图/n 表示/v 迷宫/n 。/wj 图/n 中/f 的/ude1 每个/r 方块/n 或/c 为/p 通道/n (/wkz 以/p 空白/n 方块/n 表示/v )/wky ，/wd 或/c 为/p 墙/n (/wkz 以/p 带/v 阴影/n 线/n 的/ude1 方块/n 表示/v )/wky 。/wj 所/usuo 求/v 路径/n 必须/d 入口/vi 图/n 3．4/m 迷宫/n 出口/vn 是/vshi 简单/a 路径/n ，/wd 即/d 在/p 求得/v 的/ude1 路径/n 上/f 不/d 能/v 重复/vd 出现/v 同一/b 通道/n 块/q 。/wj 
　　假设/v “/wyz 当前/t 位置/n ”/wyy 指/v 的/ude1 是/vshi “/wyz 在/p 搜索/vn 过程/n 中/f 某/rz 一时/t 刻/v 所在/n 图/n 中/f 某个/rz 方块/n 位置/n ”/wyy ，/wd 则/c 求/v 迷宫/n 中/f 一/m 条/q 路径/n 的/ude1 算法/n 的/ude1 基本思想/n 是/vshi ：/wp 若/v 当前/t 位置/n “/wyz 可/v 通/v ”/wyy ，/wd 则/c 纳入/v “/wyz 当前/t 路径/n ”/wyy ，/wd 并/cc 继续/v 朝/p “/wyz 下/vf 位置/n ”/wyy 探索/v ，/wd 即/d 切换/v “/wyz 下/f 一/m 位置/n ”/wyy 为/v “/wyz 当前/t 位置/n ”/wyy ，/wd 如此/rzv 重复/vd 直至/v 到达/v 出口/vn ；/wf 若/c 当前/t 位置/n “/wyz 不/d 可/v 通/v ”/wyy ，/wd 则/c 应/v 顺着/p “/wyz 来/f 向/p ”/wyy 退回/v 到/v “/wyz 前/f 一/m 通道/n 块/ng ”/wyy ，/wd 然后/c 朝着/p 除/p “/wyz 来/f 向/p ”/wyy 之外/f 的/ude1 其他/rzv 方向/n 继续/v 探索/v ；/wf 若/c 该/rz 通道/n 块/q 的/ude1 四周/f 四/m 个/q 方块/n 均/d “/wyz 不/d 可/v 通/v ”/wyy ，/wd 则/c 应/v 从/p “/wyz 当前/t 路径/n ”/wyy 上/f 删除/v 该/rz 通道/n 块/q 。/wj 所谓/v “/wyz 下/f 一/m 位置/n ”/wyy 指/v 的/ude1 是/vshi “/wyz 当前/t 位置/n ”/wyy 四周/f 四/m 个/q 方向/n (/wkz 东/f 、/wn 南/b 、/wn 西/b 、/wn 北/f )/wky 上/f 相邻/vi 的/ude1 方块/n 。/wj 假设/v 以/p 栈/ng S/x 记录/n “/wyz 当前/t 路径/n ”/wyy ，/wd 则/d 栈/ng 顶/v 中/f 存放/v 的/ude1 是/vshi “/wyz 当前/t 路径/n 上/f 最后/f 一个/mq 通道/n 块/ng ”/wyy 。/wj 由此/d ，/wd “/wyz 纳入/v 路径/n ”/wyy 的/ude1 操作/vn 即/d 为/v “/wyz 当前/t 位置/n 入/v 栈/ng ”/wyy ；/wf “/wyz 从/p 当前/t 路径/n 上/f 删除/v 前/f 一/m 通道/n 块/ng ”/wyy 的/ude1 操作/vn 即/d 为/v “/wyz 出/vf 栈/ng ”/wyy 。/wj 
　　求/v 迷宫/n 中/f 一/m 条/q 从/p 入口/n 到/v 出口/vi 的/ude1 路径/n 的/ude1 算法/n 可/v 简单/ad 描述/v 如下/vi ：/wp 
设定/v 当前/t 位置/n 的/ude1 初值/n 为/p 入口/n 位置/n ；/wf 
do/x  I/x 
若/c 当前/t 位置/n 可/v 通/v ，/wd 
则/c {/n   将/p 当前/t 位置/n 插入/v 栈/ng 顶/v ；/wf     ∥/w 纳入/v 路径/n 
    若/c 该/rz 位置/n 是/vshi 出口/vn 位置/n ，/wd 则/c 结束/v ；/wf     ∥/w 求得/v 路径/n 存放在/v 栈/ng 中/f 
    否则/c 切换/v 当前/t 位置/n 的/ude1 东/f 邻/vg 方块/n 为/p 新/a 的/ude1 当前/t 位置/n ；/wf 
    }/n 
  否则/c ，/wd 
    若/v 栈/ng 不/d 空/v 且/c 栈/ng 顶/v 位置/n 尚/d 有/vyou 其他/rzv 方向/n 未经/d 探索/v ，/wd 
    则/c 设定/v 新/a 的/ude1 当前/t 位置/n 为/v 沿/p 顺/a 时针/n 方向/n 旋转/vi 找到/v 的/ude1 栈/ng 顶/v 位置/n 的/ude1 下/vf 一/m 相邻/vi 块/q ；/wf 
    若/v 栈/ng 不/d 空/v 但/c 栈/ng 顶/v 位置/n 的/ude1 四周/f 均/d 不/d 可/v 通/v ，/wd 
    则/c {/n   删去/v 栈/ng 顶/v 位置/n ；/wf     ∥/w 从/p 路径/n 中/f 删/v 去/vf 该/rz 通道/n 块/q 
    若/v 栈/ng 不/d 空/a ，/wd 则/c 重新/d 测试/v 新/a 的/ude1 栈/ng 顶/v 位置/n ，/wd 
    直至/v 找到/v 一个/mq 可/v 通/v 的/ude1 相邻/vn 块/q 或/c 出/vf 栈/ng 至/p 栈/ng 空/v ；/wf 
    
}/n while/x (/wkz 栈/ng 不/d 空/v )/wky ；/wf 
　　在/p 此/rzs ，/wd 尚/d 需/v 说明/v 一点/mq 的/ude1 是/vshi ，/wd 所谓/v 当前/t 位置/n 可/v 通/v ，/wd 指/v 的/ude1 是/vshi 未曾/d 走/v 到/v 过/uguo 的/ude1 通道/n 块/q ，/wd 即/d 要求/v 该/rz 方块/n 位置/n 不仅/c 是/vshi 通道/n 块/q ，/wd 而且/c 既/c 不/d 在/p 当前/t 路径/n 上/f (/wkz 否则/c 所/usuo 求/v 路径/n 就/d 不/d 是/vshi 简单/a 路径/n )/wky ，/wd 也/d 不/d 是/vshi 曾经/d 纳入/v 过/uguo 路径/n 的/ude1 通道/n 块/q (/wkz 否则/c 只能/v 在/p 死胡同/n 内/f 转圈/vi )/wky 。/wj 
　　typedef/x  struct/x  {/n 
  int/x     ord/x ；/wf 
  PosType/x     seat/x ；/wf 
  int/x     di：/x 
}/n   sElemType/x ；/wf 
∥/w 通道/n 块/q 在/p 路径/n 上/f 的/ude1 “/wyz 序号/n ”/wyy 
∥/w 通道/n 块/q 在/p 迷宫/n 中/f 的/ude1 “/wyz 坐标/n 位置/n ”/wyy 
∥/w 从此/d 通道/n 块/q 走向/v 下/vf 一/m 通道/n 块/q 的/ude1 “/wyz 方向/n ”/wyy 
∥/w 栈/ng 的/ude1 元素/n 类型/n 
Status/x  MazePath/x (/wkz MazeType/x  maze/x ，/wd PosType/x  start/x ，/wd PosType/x  end/x )/wky {/n 
  ∥/w 若/c 迷宫/n e/x 中/f 存在/v 从/p 入口/n start/x 到/v 出口/vn end/x 的/ude1 通道/n ，/wd 则/c 求得/v 一/m 条/q 存放在/v 栈/ng 中/f (/wkz 从/p 栈/ng 底/f 到/v 栈/ng 顶/v )/wky ，/wd 并/cc 返回/v TRUE/x ；/wf 否则/c 返回/v FALSE/x 
In／/x ‘/wyz tStack/x (/wkz s/x )/wky ；/wf   curpos=start/x ；/wf 
curstep/x 。/wj 1：/m 
do/x {/n 
∥/w 设定/v “/wyz 当前/t 位置/n ”/wyy 为/v “/wyz 入口/n 位置/n ”/wyy 
∥/w 探索/v 第一/m 步/qv 
if/x (/wkz Pass/x (/wkz curpos/x )/wky )/wky {/n   ∥/w 当前/t 位置/n 可以/v 通过/v ，/wd 即/d 是/vshi 未曾/d 走/v 到/v 过/uguo 的/ude1 通道/n 块/q 
  ．/w FootPrint/x (/wkz curpos/x )/wky ；/wf     ∥/w 留下/v 足迹/n 
  e=/x (/wkz curstep/x ，/wd curpos/x ，/wd 1/m )/wky ；/wf 
  ．/w Push/x (/wkz s/x ，/wd e/x )/wky ；/wf     ∥/w 加入/v 路径/n 
  if/x (/wkz curpos==end/x )/wky return/x (/wkz TRUE/x )/wky ；/wf ∥/w 到达/v 终点/n (/wkz 出口/vn )/wky 
  curpos/x 。/wj NextPos/x (/wkz curpos/x ，/wd 1/m )/wky ；/wf     ∥/w 下/f 一/m 位置/n 是/vshi 当前/t 位置/n 的/ude1 东邻/nr2 
  curst．ep+/x ’/wyy ；/wf     ∥/w 探索/v 下/vf 一/m 步/qv 
   l/x ∥/w if/x 
    else/x {/n   ∥/w 当前/t 位置/n 不/d 能/v 通过/v 
    if/x (/wkz !/wt stac/x ~/n mpty/x (/wkz s/x )/wky )/wky l/x 
    Pop/x (/wkz s/x ，/wd e/x )/wky ；/wf 
    while/x (/wkz e．di==4/x &/n &/n !/wt StackEmpty/x (/wkz s/x )/wky )/wky {/n 
    MarkPrint/x (/wkz e．seat/x )/wky ；/wf Pop/x (/wkz s/x ，/wd e/x )/wky ；/wf   ∥/w 留下/v 不/d 能/v 通过/v 的/ude1 标记/n ，/wd 并/cc 退回/v 一/m 步/qv 
    }/n ∥/w while/x 
    if/x (/wkz e．di/x </n 4/m )/wky {/n 
    e．di+/x ’/wyy ；/wf Push/x (/wkz s/x ，/wd e/x )/wky ；/wf     ∥/w 换/v 下/vf 一个/mq 方向/n 探索/v 
    curpos：NextPos/x (/wkz e．seat/x  e．di/x )/wky ；/wf     ∥/w 设定/v 当前/t 位置/n 是/vshi 该/rz 新/a 方向/n 上/f 的/ude1 相邻/vn 块/q 
    }/n ∥/w if/x 
    }/n ∥/w if/x 
    }/n ∥/w else/x 
  }/n while/x (/wkz !/wt StackEmpt：y/x (/wkz s/x )/wky )/wky ；/wf 
return/x (/wkz LsE/x )/wky ；/wf 
∥/w MazePath/x 
算法/n 3．3/m 
  3．2．5/m 表达式/n 求/v 值/n 
  表达式/n 求/v 值/n 是/vshi 程序设计/n 语言/n 编译/vn 中/f 的/ude1 一个/mq 最/d 基本/a 问题/n 。/wj 它/rr 的/ude1 实现/vn 是/vshi 栈/ng 应用/v 的/ude1 又/d 一个/mq 典型/a 例子/n 。/wj 这里/rzs 介绍/v 一/m 种/q 简单/a 直观/a 、/wn 广/ad 为/v 使用/v 的/ude1 算法/n ，/wd 通常/d 称为/v “/wyz 算/v 符/vg 优先/v 法/n ”/wyy 。/wj 
  要/v 把/pba 一个/mq 表达式/n 翻译/v 成/v 正确/ad 求/v 值/n 的/ude1 一个/mq 机器指令/n 序列/n ，/wd 或者/c 直接/ad 对/p 表达式/n 求/v 值/n ，/wd 首先/d 要/v 能够/v 正确/ad 解释/v 表达式/n 。/wj 例如/v ，/wd 要/v 对/p 下面/f 的/ude1 算术/n 表达式/n 求/v 值/n     4+2×3―10／5/m 
首先/c 要/v 了解/v 算术/n 四则/n 运算/vn 的/ude1 规则/n 。/wj 即/v ：/wp 
  1/m )/wky 先/d 乘除/n ，/wd 后/f 加减/n ；/wf 
  2/m )/wky 从/p 左/f 算/v 到/v 右/f ；/wf 
  3/m )/wky 先/d 括号/n 内/f ，/wd 后/f 括号/n 外/f 。/wj 
由此/d ，/wd 这个/rz 算术/n 表达式/n 的/ude1 计算/vn 顺序/n 应/v 为/v 
    4+2×3―10／5=4+6―10／5=10―10／5=10―2=8/m 
算/v 符/vg 优先/v 法/n 就/d 是/vshi 根据/p 这个/rz 运算/vn 优先/vd 关系/v 的/ude1 规定/n 来/vf 实现/v 对/p 表达式/n 的/ude1 编译/vn 或/c 解释执行/n 的/ude1 。/wj 
　　任何/rz 一个/mq 表达式/n 都/d 是/vshi 由/p 操作数/n (/wkz operand/x )/wky 、/wn 运算符/n (/wkz operator/x )/wky 和/cc 界限/n 符/vg (/wkz delimiter/x )/wky 组成/v 的/ude1 ，/wd 我们/rr 称/v 它/rr 们/k 为/p 单词/n 。/wj 一般/a 地/ude2 ，/wd 操作数/n 既/c 可以/v 是/vshi 常/d 数/v 也/d 可以/v 是/vshi 被/pbei 说明/v 为/p 变量/n 或/c 常量/n 的/ude1 标识符/n ；/wf 运算符/n 可以/v 分/qt 为/p 算术/n 运算符/n 、/wn 关系/n 运算符/n 和/cc 逻辑/n 运算符/n 等/udeng 三/m 类/q ；/wf 基本/a 界限/n 符/vg 有/vyou 左右/m 括号/n 和/cc 表达式/n 结束符/n 等/udeng 。/wj 为了/p 叙述/v 的/ude1 简洁/a ，/wd 我们/rr 仅/d 讨论/v 简单/a 算术/n 表达式/n 的/ude1 求/v 值/v 问题/n 。/wj 这种/r 表达式/n 只/d 含/v 加/v 、/wn 减/v 、/wn 乘/v 、/wn 除/v 等/udeng 四/m 种/q 运算符/n 。/wj 读者/n 不/d 难/a 将/p 它/rr 推广/v 到/v 更/d 一般/a 的/ude1 表达式/n 上/f 。/wj 
　　我们/rr 把/pba 运算符/n 和/cc 界限/n 符/vg 统称/v 为/p 算/v 符/ng ，/wd 它们/rr 构成/v 的/ude1 集合/n 命名/v 为/v OP/x 。/wj 根据上述/n 三/m 条/q 运算/vn 规则/n ，/wd 在/p 运算/vn 的/ude1 每/rz 一/m 步/qv 中/f ，/wd 任意/d 两/m 个/q 相继/d 出现/v 的/ude1 算/v 符/v e/x 。/wj 和/cc e2/x 之间/f 的/ude1 优先/vn 关系/n 至多/d 是/vshi 下面/f 三/m 种/q 关系/n 之一/rz ；/wf 
　　    01/m </n e2/x  e1/x 的/ude1 优先权/n 低于/v 02/m 
        e/x 。/wj =e2/x  el/x 的/ude1 优先权/n 等于/v 02/m 
        el/x >/n e2/x  el/x 的/ude1 优先权/n 高于/v 02/m 
表/n 3．1/m 定义/n 了/ule 算/v 符/vg 之间/f 的/ude1 这种/r 优先/vn 关系/n 。/wj 
    表/n 3．1/m 算/v 符/vg 间/f 的/ude1 优先/vn 关系/n 
    由/p 规则/n 3/m )/wky ，/wd +/m 、/wn -/wp 、/wn */n 和/p ／/w 为/v q/x 时/ng 的/ude1 优先/vn 性/ng 均/d 低于/v ‘/wyz (/wkz ’/wyy 但/c 高于/v “/wyz )/wky ”/wyy ，/wd 由/p 规则/n 2/m )/wky ，/wd 当/v ql=q2/x 时/ng ，/wd 令/v q1/x >/n q2/x ，/wd ‘/wyz #/n ’/wyy 是/vshi 表达/v 式/k 的/ude1 结束符/n 。/wj 为了/p 算法/n 简洁/a ，/wd 在/p 表达/v 式/k 的/ude1 最/d 左边/f 也/d 虚设/v 一个/mq ‘/wyz #/n ’/wyy 构成/v 整个/b 表达式/n 的/ude1 一对/mq 括号/n 。/wj 表/n 中/f 的/ude1 ‘/wyz (/wkz ’/wyy =/m ‘/wyz )/wky ’/wyy 表示/v 当/p 左右/m 括号/n 相遇/vi 时/ng ，/wd 括号/n 内/f 的/ude1 运算/vn 已经/d 完成/v 。/wj 同/p 理/n ，/wd ‘/wyz #/n ’/wyy =/m ‘/wyz #/n ’/wyy 表示/v 整个/b 表达式/n 求/v 值/n 完毕/vi 。/wj ‘/wyz )/wky ’/wyy 与/p ‘/wyz (/wkz ’/wyy 、/wn ‘/wyz #/n ’/wyy 与/p ‘/wyz )/wky ’/wyy 以及/cc ‘/wyz (/wkz ’/wyy 与/p ‘/wyz #/n ’/wyy 之间/f 无/v 优先/vd 关系/v ，/wd 这/rzv 是/vshi 因为/p 表达式/n 中/f 不/d 允许/v 它们/rr 相继/d 出现/v ，/wd 一旦/d 遇到/v 这种/r 情况/n ，/wd 则/c 可以/v 认为/v 出现/v 了/ule 语法/n 错误/n 。/wj 在/p 下面/f 的/ude1 讨论/vn 中/f ，/wd 我们/rr 暂/d 假定/v 所/usuo 输入/v 的/ude1 表达式/n 不/d 会/v 出现/v 语法/n 错误/n 。/wj 
    为/p 实现/v 算/v 符/vg 优先/v 算法/n ，/wd 可以/v 使用/v 两/m 个/q 工作栈/n 。/wj 一个/mq 称/v 做/v OPTR/x ，/wd 用以/d 寄存/v 运算符/n ；/wf 另/rz 一个/mq 称/v 做/v (/wkz )/wky PND/x ，/wd 用以/d 寄存/v 操作数/n 或/c 运算/vn 结果/n 。/wj 算法/n 的/ude1 基本思想/n 是/vshi ：/wp 
    1/m )/wky 首先/d 置/v 操作数/n 栈/ng 为/v 空/ng 栈/ng ，/wd 表达式/n 起始/vn 符/vg “/wyz #/n ”/wyy 为/p 运算符/n 栈/ng 的/ude1 栈/ng 底/f 元素/n ；/wf 
    2/m )/wky 依次/d 读入/v 表达式/n 中/f 每个/r 字符/n ，/wd 若是/c 操作数/n 则/d 进/vf (/wkz )/wky PND/x 栈/ng ，/wd 若是/c 运算符/n ，/wd 则/d 和/cc OF/x ，/wd TR/x 栈/ng 的/ude1 栈/ng 顶/v 运算符/n 比较/vn 优先权/n 后/f 作/v 相应/vd 操作/v ，/wd 直至/v 整个/b 表达式/n 求/v 值/n 完毕/vi (/wkz 即/v OPTR/x 栈/ng 的/ude1 栈/ng 顶/v 元素/n 和/cc 当前/t 读入/v 的/ude1 字符/n 均/d 为/v “/wyz #/n ”/wyy )/wky 。/wj 
    算法/n 3．4/m 描述/v 了/ule 这个/rz 求/v 值/v 过程/n 。/wj 
    0perandType/x  Eva/x ]/wky uateExpression/x (/wkz )/wky {/n 
    ∥/w 算术/n 表达式/n 求/v 值/n 的/ude1 算/v 符/vg 优先/v 算法/n 。/wj 设/v 0PTR/x 和/cc 0PND/x 分别/d 为/v 运算符/n 栈/ng 和/cc 运/v 算数/vi 栈/ng ，/wd 
    ∥/w OP/x 为/p 运算符/n 集合/v 。/wj 
    InitStac/x ~/n c/x (/wkz OPTR/x )/wky ；/wf Push/x (/wkz 0PTR/x ，/wd ’/wyy #/n ，/wd )/wky ；/wf 
    initStac/x ~/n [/wkz (/wkz opt/x )/wky ；/wf   c=getchar/x ’/wyy (/wkz )/wky ；/wf 
    while/x (/wkz c/x !/wt =/m ’/wyy #/n 。/wj Il/x  GetTop/x (/wkz OPTR/x )/wky  =/m ’/wyy #/n 。/wj )/wky {/n 
    if/x (/wkz !/wt In/x (/wkz c/x ，/wd oP/x )/wky )/wky {/n Push/x (/wkz (/wkz OPND/x ，/wd c/x )/wky ；/wf c=getchar/x (/wkz )/wky ；/wf }/n   ∥/w 不是/c 运算符/n 则/d 进/vf 栈/ng 
    else/x 
    switdl/x (/wkz Precede/x (/wkz GetTop/x (/wkz OPTR/x )/wky ，/wd c/x )/wky {/n 
    case/x ’/wyy </n ’/wyy ：/wp   ∥/w 栈/ng 顶/v 元素/n 优先权/n 低/a 
    Push/x (/wkz 0PTR/x ，/wd c/x )/wky ；/wf c=getchar/x (/wkz )/wky ；/wf 
    break/x ；/wf 
    case/x ’/wyy =/m ’/wyy ：/wp   ∥/w 脱/v 括号/n 并/cc 接收/v 下/vf 一/m 字符/n 
    Pop/x (/wkz OPTR/x ，/wd x/x )/wky ；/wf   c=getchar/x (/wkz )/wky ；/wf 
    break/x ；/wf 
    casQ/x 。/wj >/n ’/wyy ：/wp   ∥/w 退/v 栈/ng 并/cc 将/p 运算/vn 结果/n 入/v 栈/ng 
    Pop/x (/wkz OPTR/x ，/wd ’/wyy theta/x )/wky ；/wf 
    Pop/x (/wkz OPND/x ，/wd b/x )/wky ；/wf Pop/x (/wkz OPND/x ，/wd a/x )/wky ；/wf 
    Push/x (/wkz OPND/x ，/wd Operate/x (/wkz a/x ，/wd theta/x ，/wd b/x )/wky )/wky ；/wf 
    break/x ；/wf 
    {/n {/n SWIj/x  tch/x 
  l/x ∥/w while/x 
  ret=rn/x  GetTop/x (/wkz OPND/x )/wky ：/wp 
}/n ∥/w Evall／ateExpression/x 
算法/n 3．4/m 
算法/n 中/f 还/d 调用/v 了/ule 两/m 个/q 函数/n 。/wj 其中/rz Precede/x 是/vshi 判定/v 运算符/n 栈/ng 的/ude1 栈/ng 顶/v 运算符/n 01/m 与/cc 读入/v 的/ude1 运算符/n e7/x 之间/f 优先/v 关系/n 的/ude1 函数/n ；/wf (/wkz )/wky perate/x 为/v 进行/vx 二/m 元/q 运算/vn a/x  e/x  6/m 的/ude1 函数/n ，/wd 如果/c 是/vshi 编译/v 表达式/n ，/wd 则/c 产生/v 这个/rz 运算/vn 的/ude1 一/m 组/q 相应/vn 指令/n 并/cc 返回/v 存放/v 结果/n 的/ude1 中间/f 变量名/n ；/wf 如果/c 是/vshi 解释执行/n 表达式/n ，/wd 则/c 直接/ad 进行/vx 该/rz 运算/vn ，/wd 并/cc 返回/v 运算/vn 的/ude1 结果/n 。/wj 
　　例/n 3―1/m   利用/v 算法/n EvaluateExpression―reduced/x 对/p 算术/n 表达式/n 3/m */n (/wkz 7―2/m )/wky 求/v 值/n ，/wd 操作过程/n 如下/vi 所/usuo 示/vg 。/wj 
　　3．3/m 栈/ng 与/p 递归/n 的/ude1 实现/vn 
    栈/ng 还有/v 一个/mq 重要/a 应用/vn 是/vshi 在/p 程序设计/n 语言/n 中/f 实现/v 递归/n 。/wj 一个/mq 直接/ad 调用/v 自己/rr 或/c 通过/p 一/m 系列/q 的/ude1 调用/v 语句/n 间接/a 地/ude2 调/v 用/p 自己/rr 的/ude1 函数/n ，/wd 称/v 做/v 递归/n 函数/n 。/wj 
    递归/n 是/vshi 程序设计/n 中/f 一个/mq 强有力/bl 的/ude1 工具/n 。/wj 其一/rz ，/wd 有/vyou 很多/m 数学/n 函数/n 是/vshi 递归/n 定义/n 的/ude1 ，/wd 如/c 大家/rr 熟悉/v 的/ude1 阶/ng 乘/v 函数/n     Factc/x  n2/x  阶/ng Fibonacci/x 数列/n  
    Fib/x (/wkz n/x )/wky =/m _/n {/n 1/m     若/v n=1/x     (/wkz 3―2/m )/wky 
    lFib/x (/wkz n/x 一/m 1/m )/wky +Fib/x (/wkz ”/wyy 一/m 2/m )/wky 其它/rz 情形/n 
和/cc Ackerman/x 函数/n 
     Ack/x (/wkz ，/wd ，/wd l/x ，/wd n/x )/wky =．/m {/n ．/w Ack/x (/wkz m/x 一/m 1/m ，/wd 1/m )/wky     若/c ，/wd z=0/x     (/wkz 3―3/m )/wky 
    其二/rz ，/wd 有/vyou 的/ude1 数据/n 结构/n ，/wd 如/v 二/m 叉树/n 、/wn 广义/n 表/n 等/udeng ，/wd 由于/c 结构/n 本身/rz 固有/b 的/ude1 递归/n 特性/n ，/wd 则/c 它们/rr 的/ude1 操作/vn 可/v 递归/n 地/ude2 描述/v ；/wf 其三/r ，/wd 还有/v 一/m 类/q 问题/n ，/wd 虽则/c 问题/n 本身/rz 没有/d 明显/a 的/ude1 递归/n 结构/n ，/wd 但/c 用/p 递归/n 求解/vi 比/p 迭代/n 求解/vi 更/d 简单/a ，/wd 如/v 八/m 皇后/n 问题/n ，/wd Hanoi/x 塔/b 问题/n 等/udeng 。/wj 
    例/n 3．2/m   (/wkz ，/wd z/x 阶/ng 14anoi/x 塔/b 问题/n )/wky 假设/v 有/vyou 三/m 个/q 分别/d 命名/v 为/v x/x 、/wn Y/x 和/cc z/x 的/ude1 塔座/n ，/wd 在/p 塔座/n x/x 上/f 图/n 3．5/m  3/m 阶/ng Hanoi/x 塔/b 问题/n 的/ude1 初始状态/n 
插/v 有/vyou n/x 个/q 直径/n 大小/n 各/rz 不/d 相同/a 、/wn 依/v 小/a 到/v 大/a 编号/n 为/p 1/m ，/wd 2/m ，/wd …/ws ，/wd n/x 的/ude1 圆盘/n (/wkz 如/v 图/n 3．5/m 所/usuo 示/vg )/wky 。/wj 现/tg 要求/v 将/d x/x 轴/n 上/f 的/ude1 n/x 个/q 圆盘/n 移/v 至/p 塔座/n z/x 上/f 并/d 仍/d 按/p 同样/b 顺序/n 叠/v 排/v ，/wd 圆盘/n 移动/vn 时/ng 必须/d 遵循/v 下列/b 规则/n ：/wp 
    1/m )/wky 每/rz 次/qv 只/d 能/v 移动/vn 一个/mq 圆盘/n ；/wf 
    2/m )/wky 圆盘/n 可以/v 插/v 在/p x/x 、/wn Y/x 和/cc z/x 中/f 的/ude1 任/v 一/m 塔座/n 上/f ；/wf 
    3/m )/wky 任何/rz 时刻/n 都/d 不/d 能/v 将/d 一个/mq 较/d 大/a 的/ude1 圆盘/n 压/v 在/p 较/d 小/a 的/ude1 圆盘/n 之上/f 。/wj 
　　如何/ryv 实现/v 移动/vn 圆盘/n 的/ude1 操作/vn 呢/y ?/ww 当/v ，/wd z=1/x 时/ng ，/wd 问题/n 比较/d 简单/a ，/wd 只要/c 将/d 编号/vi 为/p 1/m 的/ude1 圆盘/n 从/p 塔座/n x/x 直接/ad 移/v 至/p 塔座/n z/x 上/f 即可/v ；/wf 当/v ，/wd z/x >/n 1时/t ，/wd 需/v 利用/v 塔座/n Y/x 作/v 辅助/vn 塔座/n ，/wd 若/c 能/v 设法/v 将/d 压/v 在/p 编号/n 为/v ，/wd z/x 的/ude1 圆盘/n 之上/f 的/ude1 ，/wd z/x 一/m 1/m 个/q 圆盘/n 从/p 塔座/n x/x (/wkz 依照/p 上述/b 法则/n )/wky 移/v 至/p 塔座/n Y/x 上/f ，/wd 则/c 可/v 先/d 将/d 编号/vi 为/v ”/wyy 的/ude1 圆盘/n 从/p 塔座/n x/x 移/v 至/p 塔座/n Z/x 上/f ，/wd 然后/c 再/d 将/p 塔座/n Y/x 上/f 的/ude1 n-1/x 个/q 圆盘/n (/wkz 依照/p 上述/b 法则/n )/wky 移/v 至/p 塔座/n Z/x 上/f 。/wj 而/cc 如何/ryv 将/d n-1/x 个/q 圆盘/n 从/p 一个/mq 塔座/n 移/v 至/p 另/rz 一个/mq 塔座/n 的/ude1 问题/n 是/vshi 一个/mq 和/cc 原/b 问题/n 具有/v 相同/a 特征/n 属性/n 的/ude1 问题/n ，/wd 只是/c 问题/n 的/ude1 规模/n 小/a l/x ，/wd 因此/c 可以/v 用/p 同样/b 的/ude1 方法/n 求解/vi 。/wj 
　　由此/d 可/v 得/ude3 如/v 算法/n 3．5/m 所/usuo 示/vg 的/ude1 求解/vi 一/m 阶/ng Hanoi/x 塔/b 问题/n 的/ude1 c/x 函数/n 。/wj 
    void/x  hanoi．/x (/wkz Jail：n/x ，/wd char/x  x/x ，/wd char/x  y/x 。/wj char/x  z/x )/wky 
    ∥/w 将/p 塔座/n x/x 上/f 按/p 直径/n 由小到大/vl 且/c 自上而下/al 编号/n 为/p 1/m 至/p n/x 的/ude1 n/x 个/q 圆盘/n 按/p 规则/n 搬/v 到/v 
    ∥/w 塔座/n z/x 上/f ，/wd y/x 可/v 用作/v 辅助/vn 塔座/n 。/wj 
    ∥/w 搬动/v 操作/v move/x (/wkz x/x ，/wd n/x ，/wd z/x )/wky 可/v 定义/n 为/v (/wkz c/x 是/vshi 初值/n 为/p 0/m 的/ude1 全局/n 变量/n ，/wd 对/p 搬动/v 计数/vi )/wky ：/wp 
    ∥/w printf/x (/wkz 。/wj ％i．Move/x  disk％i/x  from/x   ％c/x   to/x   ％c＼n/x ’/wyy ，/wd ++c/x ，/wd n/x 。/wj x/x ，/wd z/x )/wky ；/wf 
if/x (/wkz n==1/x )/wky 
  move/x (/wkz x/x 。/wj 1/m ，/wd z/x )/wky ；/wf     ∥/w 将/p 编号/n 为/p 1/m 的/ude1 圆盘/n 从/p x/x 移/v 到/v z/x 
else/x {/n 
  hano/x ~/n (/wkz n/x 一/m 1/m ，/wd x/x ，/wd z/x ，/wd y/x )/wky ；/wf   ∥/w 将/d x/x 上/f 编号/vi 为/p 1/m 至/p n―l/x 的/ude1 圆盘/n 移/v 到/v y/x ，/wd z/x 作/v 辅助/vn 塔/n 
  moVe/x (/wkz x/x ，/wd n/x ，/wd z/x )/wky ；/wf     ∥/w 将/p 编号/n 为/v n/x 的/ude1 圆盘/n 从/p x/x 移/v 到/v z/x 
  hanoi．/x (/wkz n/x 一/m 1/m ，/wd y/x ，/wd x/x ，/wd z/x )/wky ；/wf ∥/w 将/d y/x 上/f 编号/vi 为/p 1/m 至/p n―l/x 的/ude1 圆/n irON/x  z/x ，/wd 】/wky c/x 作/v 辅助/vn 塔/n 
}/n 
算法/n 3．5/m 
    显然/a ，/wd 这/rzv 是/vshi 一个/mq 递归/n 函数/n ，/wd 在/p 函数/n 的/ude1 执行/vn 函数/n 中/f ，/wd 需/v 多次/mq 进行/vx 自我/rr 调用/v 。/wj 那末/c ，/wd 这个/rz 递归/n 函数/n 是/vshi 如何/ryv 执行/v 的/ude1 ?/ww 先/d 看/v 任意/d 两/m 个/q 函数/n 之间/f 进行/vx 调用/v 的/ude1 情形/n 。/wj 
    和/cc 汇编程序/n 设计/vn 中/f 主程序/n 和/cc 子程序/n 之间/f 的/ude1 链接/n 和/cc 信息/n 交换/v 相/d 类似/a ，/wd 在/p 高级语言/n 编制/n 的/ude1 程序/n 中/f ，/wd 调用函数/n 和/cc 被/pbei 调用函数/n ①/m 之间/f 的/ude1 链接/n 和/cc 信息/n 交换/v 需/v 通过/p 栈/ng 来/f 进行/vx 。/wj 
    通常/d ，/wd 当/v 在/p 一个/mq 函数/n 的/ude1 运行/vn 期间/f 调用/v 另/rz 一个/mq 函数/n 时/ng ，/wd 在/p 运行/vn 被/pbei 调用函数/n 之前/f ，/wd 系统/ad 需/v 先/d 完成/v 三/m 件/q 事/n ：/wp (/wkz 1/m )/wky 将/p 所有/b 的/ude1 实在/a 参数/n 、/wn 返回/v 地址/n 等/udeng 信息/n 传递/v 给/v 被/pbei 调用函数/n 保存/v ；/wf (/wkz 2/m )/wky 为/v 被/pbei 调用函数/n 的/ude1 局部变量/n 分配存储/n 区/n ；/wf (/wkz 3/m )/wky 将/d 控制/v 转移/v 到/v 被/pbei 调函数/n 的/ude1 入口/n 。/wj 而/cc 从/p 被/pbei 调用函数/n 返回/v 调用函数/n 之前/f ，/wd 系统/n 也/d 应/v 完成/v 三/m 件工作/n ：/wp (/wkz 1/m )/wky 保存/v 被/pbei 调函数/n 的/ude1 计算结果/n ；/wf (/wkz 2/m )/wky 释放/v 被/pbei 调函数/n 的/ude1 数据/n 区/n ；/wf (/wkz 3/m )/wky 依照/p 被/pbei 调函数/n 保存/v 的/ude1 返回/v 地址/n 将/d 控制/v 转移/v 到/v 调用函数/n 。/wj 当/p 有/vyou 多/m 个/q 函数/n 构成/v 嵌套/v 调用/v 时/ng ，/wd 按照/p “/wyz 后/f 调用/v 先/d 返回/v ”/wyy 的/ude1 原则/n ，/wd 上述/b 函数/n 之间/f 的/ude1 信息/n 传递/vn 和/cc 控制/v 转移/v 必须/d 通过/p “/wyz 栈/ng ”/wyy 来/f 实现/v ，/wd 即/v 系统/n 将/p 整个/b 程序运行/n 时/ng 所/usuo 需/v 的/ude1 数据/n 空间/n 安排/v 在/p 一个/mq 栈/ng 中/f ，/wd 每当/p 调用/v 一个/mq 函数/n 时/ng ，/wd 就/d 为/v 它/rr 在/p 栈/ng 顶/v 分配/v 一个/mq 存储区/n ，/wd 每当/p 从/p 一个/mq 函数/n 退出/v 时/ng ，/wd 就/d 释放/v 它/rr 的/ude1 存储区/n ，/wd 则/c 当前/t 正/d 运行/vi 的/ude1 函数/n 的/ude1 数据/n 区/n 必/d 在/p 栈/ng 顶/v 。/wj 例如/v ，/wd 在/p 图/n 3．6/m (/wkz c/x )/wky 所/usuo 示/vg 主/ag 函数/n main/x 中/f 调用/v 了/ule 函数/n first/x ，/wd 而/cc 在/p 函数/n first/x 中/f 又/d 调用/v 了/ule 函数/n second/x ，/wd 则/c 图/n 3．6/m (/wkz a/x )/wky 展示/v 了/ule 当前/t 正在/d 执行/v 函数/n second/x 中/f 某个/rz 语句/n 时/ng 栈/ng 的/ude1 状态/n ，/wd 而/cc 图/n 3．6/m (/wkz b/x )/wky 展示/v 从/p 函数/n second/x 退出/v 之后/f 正/d 执行/v 函数/n first：/x 中/f 某个/rz 语句/n 时/ng 栈/ng 的/ude1 状态/n (/wkz 图/n 中/f 以/p 语句/n 标号/n 表示/v 返回/v 地址/n )/wky 。/wj 
栈/ng 顶/v 
栈/ng 顶/v 
int/x   first/x (/wkz int/x  s/x ，/wd int/x  t/x )/wky ；/wf 
int/x   second/x (/wkz int/x  d/x )/wky ；/wf 
int/x   main/x (/wkz )/wky {/n 
    t/x   m．n/x ；/wf 
    first/x (/wkz m/x ，/wd n/x )/wky ；/wf 
    1：．．．/m 
}/n 
int/x  first/x (/wkz ／at/x  s/x ，/wd int/x  t/x )/wky f/x 
    int/x  i/x ；/wf 
    sec/x 。/wj nd/x (/wkz i/x )/wky ；/wf 
    2/m  1．．．/m 
}/n 
int/x  second/x (/wkz int/x  d/x )/wky l/x 
  x/x ，/wd y/x ；/wf 
}/n 
    (/wkz c/x )/wky 
图/n 3．6/m 主/ag 函数/n main/x 执行/vn 期间/f 运行/vi 栈/ng 的/ude1 状态/n 
　　一个/mq 递归/n 函数/n 的/ude1 运行/vn 过程/n 类似/v 于/p 多/m 个/q 函数/n 的/ude1 嵌套/v 调用/v ，/wd 只是/d 调用函数/n 和/cc 被/pbei 调用函数/n 是/vshi 同一个/b 函数/n ，/wd 因此/c ，/wd 和/cc 每次/r 调用/v 相关/vi 的/ude1 一个/mq 重要/a 的/ude1 概念/n 是/vshi 递归/n 函数/n 运行/vi 的/ude1 “/wyz 层次/n ”/wyy 。/wj 假设/v 调用/v 该/rz 递归/n 函数/n 的/ude1 主/ag 函数/n 为/p 第0/m 层/qv ，/wd 则/c 从/p 主/ag 函数/n 调用/v 递归/n 函数/n 为/p 进入/v 第1/m 层/qv ；/wf 从/p 第/m i/x 层/qv 递归/n 调用/v 本/rz 函数/n 为/p 进入/v “/wyz 下/f 一/m 层/qv ”/wyy ，/wd 即/v 第/m i+1/x 层/n 。/wj 反之/c ，/wd 退出/v 第/m i/x 层/qv 递归/n 应/v 返回/v 至/p “/wyz 上/f 一/m 层/qv ”/wyy 、/wn 
　　①/m 若/c 在/p 函数/n A/x 中/f 调用/v 了/ule 函数/n B/x ，/wd 则/c 称/v 函数/n A/x 为/p 调用函数/n ，/wd 称/v 函数/n B/x 为/v 被/pbei 调用函数/n 。/wj 
即/v 第/m j/x 一/m 1/m 层/qv 。/wj 为了/p 保证/v 递归/n 函数/n 正确/ad 执行/v ；/wf 系统/n 需/v 设立/v 一个/mq “/wyz 递归/n 工作栈/n ”/wyy ①/m 作为/p 整个/b 递归/n 函数/n 运行/vn 期间/f 使用/v 的/ude1 数据/n 存储区/n 。/wj 每/rz 一/m 层/qv 递归/n 所/usuo 需/v 信息/n 构成/v 一个/mq “/wyz 工作/vn 记录/n ”/wyy ，/wd 其中/rz 包括/v 所有/b 的/ude1 实在/a 参数/n 、/wn 所有/b 的/ude1 局部变量/n 以及/cc 上/f 一/m 层/qv 的/ude1 返回/v 地址/n 。/wj 每/rz 进入/v 一/m 层/qv 递归/n ，/wd 就/d 产生/v 一个/mq 新/a 的/ude1 工作/vn 记录/n 压/v 入/v 栈/ng 顶/v 。/wj 每/rz 退出/v 一/m 层/qv 递归/n ，/wd 就/d 从/p 栈/ng 顶/v 弹/v 出/vf 一个/mq 工作/vn 记录/n ，/wd 则/c 当前/t 执行/v 层/qv 的/ude1 工作/vn 记录/n 必/d 是/vshi 递归/n 工作栈/n 栈/ng 顶/v 的/ude1 工作/vn 记录/n ，/wd 称/v 这个/rz 记录/n 为/v “/wyz 活动记录/n ”/wyy ，/wd 并/cc 称/v 指示/n 活动记录/n 的/ude1 栈/ng 顶/v 指针/n 为/v “/wyz 当前/t 环境/n 指针/n ”/wyy 。/wj 
    例如/v ，/wd 图/n 3．7/m 展示/v 了/ule 语句/n 
    】/wky hanoi/x (/wkz 3/m ，/wd a/x ，/wd b/x ，/wd c/x )/wky     (/wkz 3―4/m )/wky 
执行/v 过程/n (/wkz 从/p 主/ag 函数/n 进入/v 递归/n 函数/n 到/v 退出/v 递归/n 函数/n 而/cc 返回/v 至/p 主/ag 函数/n )/wky 中/f 递归/n 工作栈/n 状态/n 的/ude1 变化情况/n 。/wj 由于/p 算法/n 3．5/m 所/usuo 示/vg 的/ude1 递归/n 函数/n 中/f 只/d 含/v 四/m 个/q 值/n 参数/n ，/wd 则/c 每个/r 工作/vn 记录/n 包含/v 五/m 个/q 数据项/n ：/wp 返回/v 地址/n 和/cc 四/m 个/q 实在/a 参数/n ，/wd 并/cc 以/p 递归/n 函数/n 中/f 的/ude1 语句/n 行/ng 号/n 表示/v 返回/v 地址/n ，/wd 同时/c 假设/v 主/ag 函数/n 的/ude1 返回/v 地址/n 为/p 0/m 。/wj 图/n 3．7/m 中/b ◆/n 表示/v 栈/ng 顶/v 指针/n 。/wj 
    实际上/d ，/wd 在/p 调用函数/n 和/cc 被/pbei 调用函数/n 之间/f 不/d 一定/d 传递/v 参数/n 的/ude1 值/n ，/wd 也/d 可以/v 传递/v 参数/n 的/ude1 地址/n 。/wj 通常/d ，/wd 每个/r 程序设计/n 语言/n 都/d 有/vyou 它/rr 自己/rr 约定/v 的/ude1 传递方法/n (/wkz 包括/v 被/pbei 调用函数/n 的/ude1 执行/vn 结果/n 如何/ryv 返回/v 调用函数/n 等/udeng )/wky ，/wd 其/rz 细节/n 读者/n 将/d 会/v 在/p 后续/vn 课程/n 中/f 学/v 到/v 。/wj 
    由于/c 递归/n 函数/n 结构/n 清晰/a ，/wd 程序/n 易/ad 读/v ，/wd 而且/c 它/rr 的/ude1 正确性/n 容易/ad 得/v 到/v 证明/v 。/wj 因此/c ，/wd 利用/v 允许/v 递归/n 调用/v 的/ude1 语言/n (/wkz 例如/v c/x 语言/n )/wky 进行/vx 程序设计/n 时/ng ，/wd 给/p 用户/n 编制程序/n 和/cc 调试程序/n 带来/v 很/d 大/a 方便/an 。/wj 因为/c 对/p 这样/rzv 一/m 类/q 递归/n 问题/n 编程/vi 时/ng ，/wd 不/d 需/v 用户/n 自己/rr 而/cc 由/p 系统/n 来/vf 管理/v 递归/n 工作栈/n 。/wj 
递归/n 运行/vi   运行/vn 语句/n      递归/n 工作栈/n 状态/n     塔/n 与/cc 圆盘/n 的/ude1 状态/n  说/v   明/ag  
的/ude1 层次/n     ┃/n   行/a 号/n       ┃/n (/wkz 返址/n ，/wd n/x 值/n ，/wd x/x 值/n ，/wd y/x 值/n ．/w z/x 值/n )/wky 
由/p 主/ag 函数/n 进入/v 第一/m 层/qv 递归/n 后/f ，/wd 运行/vi 至/p 语句/n (/wkz 行/ng )/wky 5/m ，/wd 因/c 递归/n 调用/v 而/cc 进入/v 下/vf 一/m 层/qv 。/wj 
由/p 第一/m 层/qv 的/ude1 语句/n (/wkz 行/ng )/wky 5/m 进入/v 第二/m 层/qv 递归/n 。/wj 执行/v 至/p 语句/n     
由/p 第二/m 层/qv 的/ude1 语句/n (/wkz 行/ng )/wky 5/m 进/vf      ┃/n 
  入/v 第三/m 层/qv 递归/n ，/wd 执行/v 语句/n     将/p 1/m 号/q 圆盘/n 由/p a/x 移/v 至/p c/x 后/f 从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第/m 
  三/m 层/qv 递归/n 。/wj 返回/v 至/p 第二/m 层/qv 的/ude1 ，/wd  将/p 2/m 号/q 圆盘/n 由/p a/x 移/v 至/p b/x 后/f ，/wd        从/p 语句/n (/wkz 行/ng )/wky 7/m 进入/v 下/vf 一/m 层/qv        递归/n 。/wj                       
图/n 3．7/m  Hanoi/x 塔/n 的/ude1 递归/n 函数/n 运行/vn 示意图/n 
    ①/m   在/p 实际/a 的/ude1 系统/n 中/f 。/wj 一般/ad 都/d 综合/vd 考虑/v 递归/n 调用/v 和/cc 非/b 递归/n 调用/v 统一/ad 处理/v ，/wd 在/p 此/rzs ，/wd 我们/rr 只/d 讨论/v 直接/ad 递归/n 调用/v 的/ude1 处理/vn 机制/n 。/wj 
   递归/n 运行/vi   运行/vn 语句/n     递归/n 工作栈/n 状态/n     塔/n 与/cc 圆盘/n 的/ude1 状态/n   说明/v  
的/ude1 层次/n     ┃/n   行/a 号/n       ┃/n (/wkz 返址/n n/x 值/n ，/wd x/x 值/n ，/wd y/x 值/n ，/wd z/x 值/n )/wky     ┃/n                                       将/p l/x 号/q 圆盘/n 由/p c/x 移/v 至/p b/x 后/f ，/wd    
从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第三/m 层/qv ，/wd 返回/v 至/p 第二/m 层/qv 的/ude1 语句/n (/wkz 行/ng )/wky   从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第二/m 层/qv 。/wj 返回/v 至/p 第一/m 层/qv 的/ude1 语句/n (/wkz 行/ng )/wky   将/p 3/m 号/q 圆盘/n 由/p a/x 移/v 至/p c/x 后/f ，/wd    从/p 语句/n (/wkz 行/ng )/wky 7/m 进入/v 下/vf 一/m 层/qv    递归/n 。/wj 
从/p 第二/m 层/qv 的/ude1 语句/n (/wkz 行/ng )/wky 5/m 进/vf    入/v 第三/m 层/qv 递归/n 。/wj   将/p 1/m 号/q 圆盘/n 由/p b/x 移/v 至/p a/x 后/f ，/wd    从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第三/m 层/qv    递归/n ，/wd 返回/v 至/p 第二/m 层/qv 语句/n   
递归/n 。/wj                   将/p 1/m 号/q 圆盘/n 由/p a/x 移/v 至/p c/x 后/f ，/wd    从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第三/m 层/qv ，/wd  
返回/v 至/p 第二/m 层/qv 语句/n (/wkz 行/ng )/wky 。/wj   从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 第二/m 层/qv ，/wd  
返回/v 至/p 第一/m 层/qv 语句/n (/wkz 行/ng )/wky 8/m 。/wj 从/p 语句/n (/wkz 行/ng )/wky 9/m 退出/v 递归/n 函数/n ，/wd 返回/v 至/p 主/ag 函数/n 。/wj 栈/ng 空/ng 。/wj 同/p 上/f  继续运行/n 主/ag 函数/n  图/n 3．7/m (/wkz 续/v )/wky 
    3．4/m   队/n 
3．4．1/m 抽象数据/n 类型/n 队列/n 的/ude1 定义/n 
和/cc 栈/ng 相反/vi ，/wd 队列/n (/wkz Queue/x )/wky 是/vshi 一/m 种/q 先进/a 先/d 出/vf (/wkz FirSt/x  In/x  First/x  Out/x ，/wd 缩写/n 为/v FIFo/x )/wky 的/ude1 线性/n 表/n 。/wj 
它/rr 只/d 允许/v 在/p 表/n 的/ude1 一/m 端/q 进行/vx 插入/v ，/wd 而/cc 在/p 另/rz 一/m 端/q 删除/v 元素/n 。/wj 这/rzv 和/p 我们/rr 日常/b 生活/vn 中/f 的/ude1 排队/vn 是/vshi 一致/a 的/ude1 ，/wd 最/d 早/ad 进入/v 队列/n 的/ude1 元素/n 最/d 早/ad 离开/v 。/wj 在/p 队列/n 中/f ，/wd 允许/v 插入/v 的/ude1 一/m 端/q 叫做/v 队尾/n (/wkz rear/x 。/wj )/wky ，/wd 允许/v 删除/v 的/ude1 一/m 端/q 则/d 称为/v 队头/n (/wkz front/x )/wky 。/wj 假设/v 队列/n 为/v q=/x (/wkz al/x ，/wd a2/x ，/wd …/ws ，/wd an/x )/wky ，/wd 那么/c ，/wd a1/x 就/d 是/vshi 队头/n 元素/n ，/wd an/x 则/d 是/vshi 队尾/n 元素/n 。/wj 队列/n 中/f 的/ude1 元素/n 是/vshi 按照/p a1/x ，/wd a2/x ，/wd …/ws ，/wd an/x 的/ude1 顺序/n 进入/v 的/ude1 ，/wd 退出/v 队列/n 也/d 只/d 能/v 按照/p 这个/rz 次序/n 依次/d 退出/v ，/wd 也就是说/vl ，/wd 只有/c 在/p 头尾/n al/x ，/wd a2/x ，/wd …/ws ，/wd an-1/x 都/d 离开/v 队列/n 之后/f ，/wd an/x 才/d 能/v 退出/v 队列/n 。/wj 图/n 3．8/m 是/vshi 队列/n 的/ude1 示意图/n 。/wj 
　　队列/n 在/p 程序设计/n 中/f 也/d 经常出现/n 。/wj 一个/mq 最/d 典型/a 的/ude1 例子/n 就/d 是/vshi 操作系统/nl 中/f 的/ude1 作业/n 排队/vi 。/wj 在/p 允许/v 多道程序/n 运行/vi 的/ude1 计算机系统/n 中/f ，/wd 同时/c 有/vyou 几/m 个/q 作业/n 运行/vn 。/wj 如果/c 运行/vi 的/ude1 结果/n 都/d 需要/v 通过/p 通道/n 输出/v i/x 那/rzv 就/d 要/v 按/p 请求/v 输出/v 的/ude1 先后/d 次序/n 排队/vi 。/wj 每当/p 通道/n 传输/vn 完毕/vi 可以/v 接受/v 新/a 的/ude1 输出/vn 任务/n 时/ng ，/wd 队头/n 的/ude1 作业/n 先/d 从/p 队列/n 中/f 退出/v 作/v 输出/vn 操作/vn 。/wj 凡是/d 申请/v 输出/v 的/ude1 作业/n 都/d 从/p 队尾/n 进入/v 队列/n 。/wj 
　　队列/n 的/ude1 操作/vn 与/cc 栈/ng 的/ude1 操作/vn 类似/a ，/wd 也/d 有/vyou 八/m 个/q 。/wj 不同/a 的/ude1 是/vshi 删除/v 是/vshi 在/p 表/n 的/ude1 头部/n (/wkz 即/v 队头/n )/wky 进行/vx 。/wj 
    下面/f 给/v 出/vf 队列/n 的/ude1 抽象数据/n 类型定义/n ：/wp 
    ADT/x  Queue/x {/n 
    数据/n 对象/n ：/wp D=faif/x  ai∈ElemSet/x ，/wd i=1/x ，/wd 2．/m …/ws ，/wd n/x ，/wd n≥0/x  l/x 
    数据/n 关系/n ：/wp R1=l/x </n ai―l/x ，/wd ai/x >/n {/n ai―l/x 。/wj ai∈D/x ，/wd i=2/x ，/wd …/ws ，/wd n/x  I/x 
    约定/v 其中/rz a1/x 端/v 为/p 队列/n 头/q ，/wd an/x 端/v 为/p 队列/n 尾/ng 。/wj 
    基本/ad 操作/v ：/wp 
    InitQueue/x (/wkz ＆/n Q/x )/wky 
    操作/v 结果/n ：/wp 构造/v 一个/mq 空/a 队列/n Q/x 。/wj 
    Destro/x !/wt ~/n )/wky ueue/x (/wkz ＆/n Q/x )/wky 
    初始条件/n ：/wp 队列/n Q/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 队列/n Q/x 被/pbei 销毁/v ，/wd 不再/d 存在/v 。/wj 
    clearOueue/x (/wkz &/n Q/x )/wky 
    初始条件/n ：/wp 队列/n Q/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 将/d Q/x 清/v 为/p 空/a 队列/n 。/wj 
    QueueEmpty/x (/wkz Q/x )/wky 
    初始条件/n ：/wp 队列/n Q/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v Q/x 为/p 空/a 队列/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c FALSE/x 。/wj 
    QueueSength/x (/wkz Q/x )/wky 
    初始条件/n ：/wp 队列/n Q/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v Q/x 的/ude1 元素/n 个数/n ，/wd 即/v 队列/n 的/ude1 长度/n 。/wj 
    GetHead/x (/wkz Q/x ，/wd &/n e/x )/wky     ’/wyy 
    初始条件/n ：/wp Q/x 为/p 非空/n 队列/n 。/wj 
    操作/v 结果/n ：/wp 用/v e/x 返回/v Q/x 的/ude1 队头/n 元素/n 。/wj 
    EnQueue/x (/wkz ＆/n Q/x ，/wd e/x )/wky 
    初始条件/n ：/wp 队列/n Q/x 已/d 存在/v 。/wj 
    操作/v 结果/n ：/wp 插入/v 元素/n e/x 为/v Q/x 的/ude1 新/a 的/ude1 队尾/n 元素/n 。/wj 
    DeQueue/x (/wkz &/n Q/x ，/wd ＆/n e/x )/wky 
    初始条件/n ：/wp Q/x 为/p 非空/n 队列/n 。/wj 
    操作/v 结果/n ：/wp 删除/v Q/x 的/ude1 队头/n 元素/n ，/wd 并/cc 用/v e/x 返回/v 其/rz 值/n 。/wj 
   

  图/n 3．10/m 链/ng 队列/n 示意图/n     图/n 3．11/m   队列/n 运算/vn 指针/n 变化/vn 状况/n 
    (/wkz a/x )/wky 空/v 队列/n ；/wf     (/wkz b/x )/wky 元素/n x/x 入/v 队列/n ；/wf 
    (/wkz c/x )/wky 元素/n Y/x 入/v 队列/n ；/wf   (/wkz d/x )/wky 元素/n x/x 出/vf 队列/n 。/wj 
    
／／/m …/ws ==ADT/x  Queue/x 的/ude1 表示/vn 与/cc 实现/v …/ws ==/m 
∥/w …/ws --/wp 单链/n 队列/n ――/wp 队列/n 的/ude1 链式/n 存储/v 结构/n …/ws --/wp 
t/x ~/n def/x  struct/x  QNode/x {/n 
  QEldata/x ；/wf 
  struct/x  QNode/x   */n next/x ；/wf 
}/n QNode/x ，/wd */n QueuePtr/x ；/wf 
tyIstruct/x {/n 
  QueuePtr/x  front/x ；/wf   ∥/w 队头/n 指针/n 
  QueuePtr/x  rear/x ；/wf   ∥/w 队尾/n 指针/n 
}/n LinkQueue/x ；/wf 
  ∥/w …/ws --/wp 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v …/ws --/wp 
  Status/x  InitQueue/x (/wkz LinkQueue/x ＆/n Q/x )/wky 
    ∥/w 构造/n 一个/mq 空/a 队列/n Q/x 
  Status/x  DestroyQueue/x (/wkz LinkQueue/x ＆/n Q/x )/wky 
    ∥/w 销毁/v 队列/n Q/x ，/wd Q/x 不再/d 存在/v 
  Status/x  ClearQueue/x (/wkz LinkQueue/x &/n Q/x )/wky 
    ∥/w 将/d Q/x 清/v 为/p 空/a 队列/n 
  Status/x  QueueEmpty/x (/wkz LinkQueue/x  Q/x )/wky 
    ∥/w 若/c 队列/n Q/x 为/p 空/a 队列/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c 返回/v FALSE/x 
  int/x  QueueLength/x (/wkz LinkQueue/x  O/x )/wky 
    ∥/w 返回/v Q/x 的/ude1 元素/n 个数/n ，/wd 即/d 为/v 队列/n 的/ude1 长度/n 
Status/x  GetHead/x (/wkz LinkQueue/x  O/x 。/wj QElemType/x ＆/n e/x )/wky 
    ∥/w 若/c 队列/n 不/d 空/a ，/wd 则/c 用/v e/x 返回/v Q/x 的/ude1 队头/n 元素/n ，/wd 并/cc 返回/v OK/x ；/wf 否则/c 返回/v ERROR/x 
  Status/x  EnQueue/x (/wkz LinkQueue/x &/n e/x ，/wd QElemType/x  e/x )/wky 
    ∥/w 插入/v 元素/n e/x 为/v Q/x 的/ude1 新/a 的/ude1 队尾/n 元素/n 
  Status/x  DeQueue/x (/wkz LinkQueue/x ＆/n Q/x ，/wd QElemType/x ＆/n e/x )/wky 
    ∥/w 若/c 队列/n 不/d 空/a ，/wd 则/c 删除/v Q/x 的/ude1 队头/n 元素/n ，/wd 用/v e/x 返回/v 其/rz 值/n ，/wd 并/cc 返回/v OK/x ；/wf 
    ∥/w 否则/c 返回/v ERROR/x 
Status/x  QueueTraverse/x (/wkz LinkQueue/x  Q/x ，/wd visit/x (/wkz )/wky )/wky 
    ∥/w 从/p 队头/n 到/v 队尾/n 依次/d 对/p 队列/n O/x 中/f 每个/r 元素/n 调用函数/n visit/x (/wkz o/x 一旦/d visit/x 失败/vi ，/wd 则/c 操作失败/n 。/wj 
∥/w …/ws 基本/a 操作/vn 的/ude1 算法/n 描述/v (/wkz 部分/n )/wky …/ws 
Status/x  InitQueue/x (/wkz LinkQueue/x ＆/n Q/x )/wky {/n 
    ∥/w 构造/n 一个/mq 空/a 队列/n Q/x 
    Q．front=Q．rear=/x (/wkz QueuePtr/x )/wky malloc/x (/wkz slzeof/x (/wkz QNode/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt Q．front/x )/wky exit/x (/wkz DW/x )/wky ；/wf     ∥/w 存储分配/n 失败/vi 
    Q．front/x 一/m >/n next=IULL/x ；/wf 
    return/x  OK/x ；/wf 
}/n 
Status/x  DestroyQueue/x (/wkz Link-Queue/x ＆/n Q/x )/wky {/n 
    ∥/w 销毁/v 队列/n Q/x 
    while/x (/wkz Q．front/x )/wky {/n 
    Q．rear/x 。/wj Q．front/x 一/m >/n next/x ；/wf 
    free/x (/wkz Q．front/x )/wky ；/wf 
    Q．front=e．rear/x ；/wf 
    }/n 
    raturn/x  OK/x ；/wf     

Status/x  EnQueue/x (/wkz LinkQueue/x &/n Q/x ，/wd QElemType/x  e/x )/wky {/n 
    ∥/w 插入/v 元素/n e/x 为/v Q/x 的/ude1 新/a 的/ude1 队尾/n 元素/n 
    p=/x (/wkz 0ueuePtr/x )/wky malloc/x (/wkz sizoof/x (/wkz ONode/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt P/x )/wky it/x (/wkz OVZ/x ~/n FLOW/x )/wky ；/wf     ／／/m 存储分配/n 失败/vn 
    p/x 一/m >/n data=e/x ；/wf P/x 一/m >/n next=N/x 【/wkz 儿/ng 正/d ．/w ；/wf 
    Q．rear/x 一/m >/n next=p/x ；/wf 
    Q．resI/x 。/wj p/x ；/wf 
    return/x  OK/x ；/wf 
}/n 
Status/x  DeQueue/x (/wkz LinkQueue/x ＆/n Q/x ，/wd QElesType/x ＆/n e/x )/wky {/n 
    ∥/w 若/c 队列/n 不/d 空/a ，/wd 则/c 删除/v Q/x 的/ude1 队头/n 元素/n ，/wd 用/v e/x 返回/v 其/rz 值/n ，/wd 并/cc 返回/v 0K/x ；/wf 
    ∥/w 否则/c 返回/v ERROR/x 
    if/x (/wkz Q．front/x  lIQ．rear/x )/wky return/x  ERROR/x ；/wf 
    P=Q．front/x 一/m >/n next/x ；/wf 
    e=P/x 一/m >/n data/x ；/wf 
    Q．front/x 一/m >/n next=P/x 一/m >/n next：/x 
    if/x (/wkz Q．rear-/x 。/wj p/x )/wky Q．rear=Q．front/x ；/wf 
    free/x (/wkz p/x )/wky ；/wf 
    return/x  OK/x ；/wf 
}/n 
    在/p 上述/b 模块/n 的/ude1 算法/n 描述/vn 中/f ，/wd 请/v 读者/n 注意/v 删除/v 队列/n 头/q 元素/n 算法/n 中/f 的/ude1 特殊/a 情况/n 。/wj 一般/a 情况/n 下/f ，/wd 删除/v 队列/n 头/q 元素/n 时/ng 仅/d 需/v 修改/v 头/n 结点/n 中/f 的/ude1 指针/n ，/wd 但/c 当/p 队列/n 中/f 最后/f 一个/mq 元素/n 被/pbei 删/v 后/f ，/wd 队列/n 尾/ng 指针/n 也/d 丢失/v 了/y ，/wd 因此/c 需/v 对/p 队尾/n 指针/n 重新/d 赋值/v (/wkz 指向/v 头/n 结点/n )/wky 。/wj 
  3．4．3/m 循环/vn 队列/n ――/wp 队列/n 的/ude1 顺序/n 表示/v 和/cc 实现/v 
  和/cc 顺序/n 栈/ng 相/d 类似/a ，/wd 在/p 队列/n 的/ude1 顺序/n 存储/vn 结构/n 中/f ，/wd 除了/p 用/v 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 依次/d 存放/v 从/p 队列/n 头/n 到/v 队列/n 尾/ng 的/ude1 元素/n 之外/f ，/wd 尚/d 需/v 附设/v 两/m 个/q 指针/n front/x 和/cc rear/x 分别/d 指示/v 队列/n 头/q 元素/n 和/cc 队列/n 尾/ng 元素/n 的/ude1 位置/n 。/wj 为了/p 在/p C/x 语言/n 中/f 描述/v 方便/v 起见/u ，/wd 在/p 此/rzs 我们/rr 约定/v ：/wp 初始化/v 建/v 空/a 队列/n 时/ng ，/wd 令/v front=rear・=0/x ，/wd 每当/p 插入/v 新/a 的/ude1 队列/n 尾/ng 元素/n 时/ng ，/wd “/wyz 尾/ng 指针/n 增/v 1/m ”/wyy ；/wf 每当/p 删除/v 队列/n 头/q 元素/n 时/ng ，/wd “/wyz 头/n 指针/n 增/v 1/m ”/wyy 。/wj 因此/c ，/wd 在/p 非空/n 队列/n 中/f ，/wd 头/q 指针/n 始终/d 指向/v 队列/n 头/q 元素/n ，/wd 而/cc 尾/ng 指针/n 始终/d 指向/v 队列/n 尾/ng 元素/n 的/ude1 下/vf 一个/mq 位置/n 。/wj 如/v 图/n 3．12/m 所/usuo 示/vg 。/wj 
    4/m 
    3/m 
    9/m 
    l/x 
Q．rear/x 
i―fro/x ’/wyy nt/x  0/m 
    图/n 3．12/m 头/q 、/wn 尾/ng 指针/n 和/cc 队列/n 中/b 元素/n 之间/f 的/ude1 关系/n 
    (/wkz a/x )/wky 空/v 队列/n ；/wf (/wkz b/x )/wky Jl/x 、/wn J2/x 和/cc J3/x 相继/d 队列/n 。/wj ；/wf 
    (/wkz b/x )/wky Jl/x 和/cc Jj/x 相继/d 被/pbei 删除/v ；/wf (/wkz d/x )/wky 04/m 、/wn J5/x 和/cc j6/x 相继/d 插入/v 队列/n 之后/f ’/wyy 4/m 被/pbei 删除/v 。/wj 
    假设/n 当前/t 为/p 队列/n 分配/vn 的/ude1 最/d 大/a 空间/n 为/p 6/m ，/wd 则/c 当/p 队列/n 处于/v 图/n 3．12/m (/wkz d/x )/wky 的/ude1 状态/n 时/ng 不/d 可/v 再/d 继续/v 插入/v 新/a 的/ude1 队尾/n 元素/n ，/wd 否则/c 会/v 因/p 数组/n 越界/vi 而/cc 遭/v 致/v 程序代码/n 被/pbei 破坏/v 。/wj 然而/c 此时/r 又/d 不宜/v 如/v 顺序/n 栈/ng 那样/rzv ，/wd 进行/vx 存储/vn 再/d 分配/v 扩大/v 数组/n 空间/n ，/wd 因为/c 队列/n 的/ude1 实际/n 可用/a 空间/n 并/cc 未/d 占/v 满/a 。/wj 一个/mq 较/d 巧妙/a 的/ude1 办法/n 是/vshi 将/p 顺序/n 队列/n 臆造/v 为/v 一个/mq 环状/n 的/ude1 空间/n ，/wd 如/v 图/n 3．13/m 所/usuo 示/vg ，/wd 称之为/v 循环/vn 队列/n 。/wj 指针/n 和/cc 队列/n 元素/n 之间/f 关系/n 不/d 变/v ，/wd 如/v 图/n 3．14/m (/wkz a/x )/wky 所/usuo 示/vg 循环/vn 队列/n 中/f ，/wd 队列/n 头/q 元素/n 是/vshi J3/x ，/wd 队列/n 尾/ng 元素/n 是/vshi J5/x ，/wd 之后/f J6/x 、/wn J7/x 和/cc J/x 。/wj 
相继/d 插入/v ，/wd 则/c 队列/n 空间/n 均/d 被/pbei 占/v 满/a ，/wd 如/v 图/n 3．14/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 此时/r Q．front=Q．rear/x ；/wf 反之/c ‘/wyz ，/wd 若/c J3/x 、/wn J4/x 和/cc J5/x 相继/d 从/p 图/n 3．14/m (/wkz a/x )/wky 的/ude1 队列/n 中/f 删除/v ，/wd 使/v 队列/n 呈/v “/wyz 空/ng ”/wyy 的/ude1 状态/n ，/wd 如/v 图/n 3．14/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 此时/r 亦/d 存在/v 关系式/n Q．/x 
图/n 3．13/m 循环/vn 队列/n 示意图/n 
front=Q．rear/x ，/wd 由此可见/c ，/wd 只/d 凭/p 等式/n Q．front=Q．rear/x 无法/v 判别/v 队列/n 空间/n 是/vshi “/wyz 空/ng ”/wyy 还是/c “/wyz 满/a ”/wyy 。/wj 可/v 有/vyou 两/m 种/q 处理/vn 方法/n ：/wp 其一/rz 是/vshi 另/d 设/v 一个/mq 标志位/n 以/p 区别/n 队列/n 是/vshi “/wyz 空/ng ”/wyy 还是/c “/wyz 满/a ”/wyy ；/wf 其二/rz 是/vshi 少/ad 用/v 一个/mq 元素/n 空间/n ，/wd 约定/v 以/p “/wyz 队列/n 头/q 指针/n 在/p 队列/n 尾/ng 指针/n 的/ude1 下/vf 一/m 位置/n (/wkz 指/v 环状/n 的/ude1 下/vf 一/m 位置/n )/wky 上/f ”/wyy 作为/p 队列/n 呈/v “/wyz 满/a ”/wyy 状态/n 的/ude1 标志/n 。/wj 
    从/p 上述/b 分析/vn 可见/c ，/wd 在/p C/x 语言/n 中/f 不/d 能/v 用/p 动态分配/n 的/ude1 ～/ws 维/b 数组/n 来/vf 实现/v 循环/vn 队列/n 。/wj 如果/c 用户/n 的/ude1 应用/vn 程序/n 中/f 设有/v 循环/vn 队列/n ，/wd 则/c 必须/d 为/v 它/rr 设定/v 一个/mq 最/d 大/a 队列长度/n ；/wf 若/c 用户/n 无法/v 予/vg 估/v 所/usuo 用/v 队列/n 的/ude1 最/d 大/a 长度/n ，/wd 则/d 宜/ag 采用/v 链/ng 队列/n 。/wj 
    
    3/m  14/m 循环/vn 队列/n 的/ude1 头尾/n 指针/n 
    (/wkz a/x )/wky 一般/a 情况/n ；/wf (/wkz b/x )/wky 队列/n 满/a 时/ng ，/wd (/wkz c/x )/wky i/x 队列/n 
循环/vn 队列/n 类型/n 的/ude1 模块/n 说明/v 如下/vi ：/wp 
∥/w …/ws 一/m   循环/vn 队列/n ――/wp 队列/n 的/ude1 顺序/n 存储/vn 结构/n …/ws 
#/n di/x ~/n QSZZE/x  i00/x   ∥/w 最/d 大/a 队列长度/n 
t/x Ⅲ/m 《/wkz stractl/x 
    l/x ’/wyy y/x   */n base/x ；/wf     ∥/w 初始化/v 的/ude1 动态分配/n 存储空间/n 
    in/x 七/m front/x ；/wf     ∥/w 头/q 指针/n 。/wj 若/c 队列/n 不/d 空/a ，/wd 指向/v 队列/n 头/q 元素/n 
    int/x …/ws ；/wf     ∥/w 尾/q 指针/n ，/wd 若/c 队列/n 不/d 空/a ，/wd 指向/v 队列/n 尾/ng 元素/n 的/ude1 下/vf 一个/mq 位置/n 
}/n SqQueue/x ；/wf 
∥/w     --/wp 循环/vn 队列/n 的/ude1 基本/a 操作/vn 的/ude1 算法/n 描述/v     一/m 
Status/x  Inlt/x 蛐/n eue/x (/wkz SqQueue/x ＆/n Q/x )/wky l/x 
    ∥/w 构造/n 一个/mq 空/a 队列/n 0/m 
    0/m  base=/x (/wkz QElem/x ~/n e/x 。/wj )/wky mnl∞/x (/wkz MAXQSIZ/x ~/n */n siz/x ~/n f/x (/wkz QEI/x ~/n Type/x 
    if/x (/wkz !/wt Q/x  base/x )/wky 口/n it/x (/wkz ∞ERFLDw/x )/wky ；/wf ∥/w 存储分配/n 失败/vi 
    Ofront/x ；/wf 0/m 一/m =0/m ；/wf 
    ㈣/m OK：/x 
int/x ~/n eueLength/x (/wkz SqQueue/x  0/m )/wky {/n 
    ∥/w 返回/v Q/x 的/ude1 元/q 索/vg 个数/n ，/wd 即/v 队列/n 的/ude1 长度/n 
    (/wkz …/ws 0/m  front/x 十/m MAx∞IzE/x )/wky ％HAxsI/x ；/wf 
Status/x  EnQueue/x (/wkz SqQueue/x ＆/n Q/x ，/wd QElemType/x  e/x )/wky 
    ∥/w 插入/v 元素/n e/x 为/v Q/x 的/ude1 新/a 的/ude1 队尾/n 元素/n 
    if/x (/wkz (/wkz Q．rear・+1/x )/wky ％MAXOSZ/x ~/n ==Q．front/x )/wky return/x  ERROR/x ；/wf ∥/w 队列/n 满/a 
    Q．base/x 【/wkz Q．rear/x 。/wj ]/wky =e/x ；/wf 
    Q．rear=/x (/wkz Q．rear/x ’/wyy +1/m )/wky ％MAXOSZZE/x ；/wf 
    return/x  OK/x ；/wf 
}/n     ．/w 
Status/x  DeQueue/x (/wkz SqQueue/x ＆/n Q/x ，/wd QElemType/x ＆/n e/x )/wky 
    ∥/w 若/c 队列/n 不/d 空/a ，/wd 则/c 删除/v Q/x 的/ude1 队头/n 元素/n ，/wd 用/v e/x 返回/v 其/rz 值/n ，/wd 并/cc 返回/v OK/x ；/wf 
    ∥/w 否则/c 返回/v ERROR/x 
    if/x (/wkz Q．front==Q．rear/x )/wky return/x  ERROR/x ；/wf 
    e=Q．base/x {/n ．/w Q．frontJ/x ；/wf 
    Q．front=/x (/wkz Q．front+1/x )/wky ％MAXQSIZE/x ；/wf 
    return/x  OK/x ；/wf 
}/n 
3．5/m 离散事件/n 模拟/vn 
    在/p 日常/b 生活/vn 中/f ，/wd 我们/rr 经常/d 会/v 遇到/v 许多/m 为了/p 维护/v 社会/n 正常/a 秩序/n 而/cc 需要/v 排队/vi 的/ude1 情境/n 。/wj 这样/rzv 一/m 类/q 活动/vn 的/ude1 模拟/vn 程序/n 通常/d 需要/v 用/p 到/v 队列/n 和/cc 线性/n 表/vg 之类/rz 的/ude1 数据/n 结构/n ，/wd 因此/c 是/vshi 队列/n 的/ude1 典型/n 应用/vn 例子/n 之一/rz 。/wj 这里/rzs 将/d 向/p 读者/n 介绍/v 一个/mq 银行/n 业务/n 的/ude1 模拟/vn 程序/n 。/wj 
    假设/v 某/rz 银行/n 有/vyou 四/m 个/q 窗口/s 对外/vd 接待/v 客户/n ，/wd 从/p 早晨/t 银行/n 开/v 门/n 起/vf 不断/d 有/vyou 客户/n 进入/v 银行/n 。/wj 由于/p 每个/r 窗口/s 在/p 某个/rz 时刻/n 只能/v 接待/v 一个/mq 客户/n ，/wd 因此/c 在/p 客户/n 人数/n 众多/m 时/ng 需/v 在/p 每个/r 窗口/s 前/f 顺次/d 排队/vi ，/wd 对于/p 刚/d 进入/v 银行/n 的/ude1 客户/n ，/wd 如果/c 某个/rz 窗口/s 的/ude1 业务员/n 正/d 空闲/v ，/wd 则/c 可/v 上/f 前/f 办理业务/n ，/wd 反之/c ，/wd 若/c 四/m 个/q 窗口/s 均/d 有/vyou 客户/n 所/usuo 占/v ，/wd 他/rr 便/d 会/v 排/v 在/p 人数/n 最/d 少/a 的/ude1 队伍/n 后面/f 。/wj 现在/t 需要/v 编制/n 一个/mq 程序/n 以/p 模拟/vn 银行/n 的/ude1 这种/r 业务/n 活动/vn 并/cc 计算/v 一/m 天/qt 中/f 客户/n 在/p 银行/n 逗留/vi 的/ude1 平均/a 时间/n 。/wj 
    为了/p 计算/v 这个/rz 平均/a 时间/n ，/wd 我们/rr 自然/d 需要/v 掌握/v 每个/r 客户/n 到达/v 银行/n 和/cc 离开/v 银行/n 这/rzv 两/m 个/q 时刻/n ，/wd 后者/rzv 减去/v 前者/rzv 即/d 为/v 每个/r 客户/n 在/p 银行/n 的/ude1 逗留/vn 时间/n 。/wj 所有/b 客户/n 逗留/vi 时间/n 的/ude1 总和/n 被/pbei 一/m 天/qt 内/f 进入/v 银行/n 的/ude1 客户/n 数/n 除/p 便是/v 所/usuo 求/v 的/ude1 平均/a 时间/n 。/wj 称/v 客户/n 到达/v 银行/n 和/cc 离开/v 银行/n 这/rzv 两/m 个/q 时刻/n 发生/v 的/ude1 事情/n 为/v “/wyz 事件/n ”/wyy ，/wd 则/c 整个/b 模拟/vn 程序/n 将/d 按/p 事件/n 发生/v 的/ude1 先后/d 顺序/n 进行/vx 处理/vn ，/wd 这样/rzv 一/m 种/q 模拟/vn 程序/n 称/v 做/v 事件/n 驱动/vn 模拟/vn 。/wj 算法/n 3．6/m 描述/v 的/ude1 正是/v 上述/b 银行/n 客户/n 的/ude1 离散事件/n 驱动/vn 模拟/vn 程序/n 。/wj 
void/x  Bank―Simulation/x (/wkz int/x  CloseTime/x )/wky {/n 
    ∥/w 银行/n 业务/n 模拟/vn ，/wd 统计/v 一/m 天/qt 内/f 客户/n 在/p 银行/n 逗留/vi 的/ude1 平均/a 时间/n 。/wj 
OpenForDay/x ；/wf     ∥/w 初始化/v 
．/w hile/x (/wkz MoreEvent/x )/wky do/x  l/x 
 EventDrired/x (/wkz 0ccurTime/x ，/wd EventType/x )/wky ；/wf     ∥/w 事件/n 驱动/vn 
switch/x (/wkz EventType/x )/wky {/n 
    case/x ’/wyy A/x ’/wyy ：/wp CustomerArrired/x ；/wf     Break/x ；/wf     ∥/w 处理/v 客户/n 到达/v 事件/n 
    case/x ’/wyy D/x ’/wyy ：/wp CustomerDeparture/x ；/wf   Break/x ；/wf     ∥/w 处理/v 客户/n 离开/v 事件/n 
    8/m ~/n Eault：Ind/x ；/wf 
  }/n ∥/w switch/x 
}/n ∥/w while/x 
 CloseForDay：/x 
∥/w B/x 【/wkz 一/m simufatl/x 。/wj on/x 
算法/n 3．6/m 
∥/w 计算平均/n 逗留/vi 时间/n 
    下面/f 讨论/v 模拟/vn 程序/n 的/ude1 实现/vn ，/wd 首先/d 要/v 讨论/vn 模拟/vn 程序/n 中/f 需要/v 的/ude1 数据/n 结构/n 及其/cc 操作/vn 。/wj 
    算法/n 3．6/m 处理/v 的/ude1 主要/b 对象/n 是/vshi “/wyz 事件/n ”/wyy ，/wd 事件/n 的/ude1 主要/b 信息/n 是/vshi 事件/n 类型/n 和/cc 事件/n 发生/v 的/ude1 时刻/n 。/wj 算法/n 中/f 处理/v 的/ude1 事件/n 有/vyou 两/m 类/q ：/wp 一/m 类/q 是/vshi 客户/n 到达/v 事件/n ；/wf 另/rz 一/m 类/q 是/vshi 客户/n 离开/v 事件/n 。/wj 前/f 一/m 类/q 事件/n 发生/v 的/ude1 时刻/n 随/p 客户/n 到来/vi 自然/d 形成/v ；/wf 后/f 一/m 类/q 事件/n 发生/v 时刻/n 则/c 由/p 客户/n 事务/n 所/usuo 需/v 时间/n 和/cc 等待/v 所/usuo 耗/v 时间/n 而/cc 定/v 。/wj 由于/p 程序驱动/n 是/vshi 按/p 事件/n 发生/v 时刻/n 的/ude1 先后/d 顺序/n 进行/vx ，/wd 则/c 事件/n 表/vg 应/v 是/vshi 有序/a 表/n ，/wd 其/rz 主要/d 操作/v 是/vshi 插入/v 和/cc 删除/v 事件/n 。/wj 
    模拟/b 程序/n 中/f 需要/v 的/ude1 另/rz 一/m 种/q 数据/n 结构/n 是/vshi 表示/v 客户/n 排队/vi 的/ude1 队列/n ，/wd 由于/p 前面/f 假设/v 银行/n 有/vyou 四/m 个/q 窗口/s ，/wd 因此/c 程序/n 中/f 需要/v 四/m 个/q 队列/n ，/wd 队列/n 中/b 有关/vn 客户/n 的/ude1 主要/b 信息/n 是/vshi 客户/n 到达/v 的/ude1 时刻/n 和/cc 客户/n 办理/v 事务/n 所/usuo 需/v 时间/n 。/wj 每个/r 队列/n 中/f 的/ude1 队头/n 客户/n 即/d 为/v 正/d 在/p 窗口/s 办理/v 事务/n 的/ude1 客户/n ，/wd 他/rr 办/v 完/vi 事务/n 离开/v 队列/n 的/ude1 时刻/n 就/d 是/vshi 即将/d 发生/v 的/ude1 客户/n 离开/v 事件/n 的/ude1 时刻/n ，/wd 这就是说/c ，/wd 对/p 每/rz 个/q 队头/n 客户/n 都/d 存在/v 一个/mq 将要/d 驱动/v 的/ude1 客户/n 离开/v 事件/n 。/wj 因此/c ，/wd 在/p 任何/rz 时刻/n 即将/d 发生/v 的/ude1 事件/n 只/d 有/vyou 下列/b 五/m 种/q 可能/n ：/wp 
(/wkz 1/m )/wky 新/a 的/ude1 客户/n 到达/v ；/wf (/wkz 2/m )/wky 1/m 号/q 窗口/s 客户/n 离开/v ；/wf (/wkz 3/m )/wky 2/m 号/q 窗口/s 客户/n 离开/v ；/wf (/wkz 4/m )/wky 3/m 号/q 窗口/s 客户/n 离开/v ；/wf 
(/wkz 5/m )/wky 4/m 号/q 窗口/s 客户/n 离开/v 。/wj 
    从/p 以上/f 分析/v 可见/c ，/wd 在/p 这个/rz 模拟/vn 程序/n 中/f 只/d 需要/v 两/m 种/q 数据/n 类型/n ：/wp 有序/a 链/ng 表/n 和/cc 队列/n 。/wj 它们/rr 的/ude1 数据/n 元素/n 类型/n 分别/d 定义/v 如下/vi ：/wp 
tn/x ~/n d-f/x  struct/x {/n 
  int/x  0ccurTime/x ；/wf     ∥/w 事件/n 发生/v 时刻/n 
  int/x  NType/x ；/wf     ∥/w 事件/n 类型/n ，/wd 0/m 表示/v 到达/v 事件/n ，/wd 1/m 至/p 4/m 表示/v 四/m 个/q 窗口/s 的/ude1 离开/v 事件/n 
}/n Event/x ，/wd ElemType/x ；/wf     ∥/w 事件/n 类型/n ，/wd 有序/a 链/ng 表/n LinkList/x 的/ude1 数据/n 元素/n 类型/n 
typedef/x  LinkList/x  EventLJ．st/x     ∥/w 事件/n 链/ng 表/vg 类型/n ，/wd 定义/v 为/p 有序/a 链/ng 表/n 
typedef/x  struct/x {/n 
    int/x   ArrivalTime/x 
    int/x  Durat：ion：/x 
}/n QElemType/x ；/wf 
∥/w 到达/v 时刻/n 
∥/w 办理/v 事务/n 所/usuo 需/v 时间/n 
∥/w 队列/n 的/ude1 数据/n 元素/n 类型/n 
    现在/t 我们/rr 详细/ad 分析算法/n 3．6/m 中/f 的/ude1 两/m 个/q 主要/b 操作步骤/n 是/vshi 如何/ryv 实现/v 的/ude1 。/wj 
    先/d 看/v 对/p 新/a 客户/n 到达/v 事件/n 的/ude1 处理/vn 。/wj 
    由于/c 在/p 实际/a 的/ude1 银行/n 中/f ，/wd 客户/n 到达/v 的/ude1 时刻/n 及其/cc 办理/v 事务/n 所/usuo 需/v 时间/n 都/d 是/vshi 随机/b 的/ude1 ，/wd 在/p 模拟/vn 程序/n 中/f 可用/v 随机数/n 来/vf 代替/v 。/wj 不/d 失/v 一般性/n ，/wd 假设/v 第二/m 个/q 顾客/n 进/vf 门/n 的/ude1 时刻/n 为/p 0/m ，/wd 即/d 是/vshi 模拟/v 程序处理/n 的/ude1 第一/m 个/q 事件/n ，/wd 之后/f 每个/r 客户/n 到达/v 的/ude1 时刻/n 在/p 前/f 一个/mq 客户/n 到达/v 时/ng 设定/v 。/wj 因此/c 在/p 客户/n 到达/v 事件/n 发生/v 时/ng 需/v 先/d 产生/v 两/m 个/q 随机数/n ：/wp 其一/rz 为此/d 时刻/d 到达/v 的/ude1 客户/n 办理/v 事务/n 所/usuo 需/v 时间/n durtime/x ；/wf 
其二/rz 为/v 下/vf 一/m 客户/n 将/d 到达/v 的/ude1 时间/n 间隔/n intertime/x ，/wd 假设/v 当前事件/n 发生/v 的/ude1 时刻/n 为/v occurtime/x ，/wd 则/d 下/vf 一个/mq 客户/n 到达/v 事件/n 发生/v 的/ude1 时刻/n 为/v OCC/x [/wkz ・/w rtime+intertime/x ,/wd ，/wd 由/p 此/rzs 应/v 产生/v 一个/mq 新/a 的/ude1 客户/n 到达/v 事件/n 插入/v 事件/n 表/n ；/wf 刚/d 到达/v 的/ude1 客户/n 则/d 应/v 插入/v 到/p 当前/t 所/usuo 含/v 元素/n 最/d 少/a 的/ude1 队列/n 中/f ；/wf 若/c 该/rz 队/n 列/v 在/p 插入/v 
前/f 为/v 空/ng ，/wd 则/c 还/d 应/v 产生/v 一个/mq 客户/n 离开/v 事件/n 插入/v 事件/n 表/n 。/wj     
　　客户/n 离开/v 事件/n 的/ude1 处理/vn 比较/d 简单/a 。/wj 首先/c 计算/v 该/rz 客户/n 在/p 银行/n 逗留/vi 的/ude1 时间/n ，/wd 然后/c 从/p 队列/n 中/f 删除/v 该/rz 客户/n 后/f 查看/v 队列/n 是否/v 空/ng ，/wd 若不空/nrf 则/d 设定/v 一个/mq 新/a 的/ude1 队头/n 客户/n 离开/v 事件/n 。/wj 
　　最后/f 我们/rr 给/v 出/vf 在/p 上述/b 数据/n 结构/n 下/f 实现/v 的/ude1 银行/n 事件/n 驱动/vn 模拟/vn 程序/n 如/v 算法/n 3．7/m 所/usuo 示/vg 。/wj 
    ∥/w 程序/n 中/f 用/v 到/v 的/ude1 主要/b 变量/n 
    EventList/x   ev：/x     ∥/w 事件/n 表/n 
    Event/x     eni/x     ff/x 
    LinkQueue/x   q/x [/wkz 4/m ]/wky ；/wf     ／／4/m 个/q 客户/n 队列/n 
    QElemType/x   customer/x ；/wf     ∥/w 客户/n 记录/v 
    int/x  TotaiTime．OustomerNum/x ；/wf   ∥/w 累计/v 客户/n 逗留/vi 时间/n ，/wd 客户/n 数/m 
int/x  cmp/x (/wkz Event/x  a/x ，/wd   Event/x  b/x )/wky ；/wf 
  ∥/w 依/p 事件/n a/x 的/ude1 发生/vn 时刻/n </n 或/c =/m 或/c >/n 事件/n b/x 的/ude1 发生/vn 时刻/n 分别/d 返回/v 一/m 1/m 或/c 0/m 或/c 1/m 
voidOpenForDay/x (/wkz )/wky {/n 
  ∥/w 初始化操作/n 
  TotaiTime=0/x ；/wf CustomerNum=0/x ；/wf     ∥/w 初始化/v 累计/v 时间/n 和/cc 客户/n 数/n 为/p 0/m 
  InitList/x (/wkz ev/x )/wky ；/wf     ∥/w 初始化/v 事件/n 链/ng 表/vg 为/p 空/a 表/n 
  en．OccurTime=0/x ；/wf   en．NType=0/x ；/wf     ∥/w 设定/v 第一/m 个/q 客户/n 到达/v 事件/n 
  Orderlnsert/x (/wkz ev/x ，/wd en/x ，/wd (/wkz */n cmp/x )/wky (/wkz )/wky )/wky ；/wf     ∥/w 插入/v 事件/n 表/n 
  for/x (/wkz i=0/x ；/wf i/x </n 4/m ；/wf ++i/x )/wky InitQueue/x (/wkz q/x [/wkz i/x ]/wky )/wky ；/wf   ∥/w 置/v 空/a 队列/n 
＼/m }/n {/n OpenForDay/x 
void/x  CustomerArrived/x (/wkz )/wky {/n 
    ∥/w 处理/v 客户/n 到达/v 事件/n ，/wd en．NType=0/x 。/wj 
    ++CustomerNum/x  0/m 
    Random/x (/wkz durtime/x ，/wd intertime/x )/wky ；/wf     ∥/w 生成/v 随机数/n 
    t=en．OccurTime+intertime/x ；/wf     ／／/m 下/f 一/m 客户/n 到达/v 时刻/n 
    if/x (/wkz t/x </n CloseTime/x )/wky     ∥/w 银行/n 尚未/d 关门/vi ，/wd 插入/v 事件/n 表/n 
    Orderlnsert/x (/wkz eV/x ，/wd (/wkz t/x ，/wd 0/m )/wky ，/wd (/wkz */n cmp/x )/wky (/wkz )/wky )/wky ；/wf 
    i=Minimum/x (/wkz q/x )/wky ；/wf     ∥/w 求/v 长度/n 最/d 短/a 队列/n 
    EnQueue/x (/wkz q/x [/wkz i/x ]/wky ，/wd (/wkz en．OccurTime/x ，/wd durtime/x )/wky )/wky ；/wf 
    if/x (/wkz QueueLength/x (/wkz q/x 【/wkz i/x ]/wky )/wky ==1/m )/wky 
    OrderInsert/x (/wkz ev/x ，/wd (/wkz en．OccurTime+durtime/x ，/wd i/x )/wky ，/wd (/wkz */n cmp/x )/wky (/wkz )/wky )/wky ；/wf 
    ∥/w 设定/v 第/m i/x 队列/n 的/ude1 一个/mq 离开/v 事件/n 并/cc 插入/v 事件/n 表/n 
}/n ／／CustomerArrived/x 
void/x  CustomerDeparture/x (/wkz )/wky {/n 
    ∥/w 处理/v 客户/n 离开/v 事件/n ，/wd en．NType/x >/n 0/m 。/wj 
    i：en．NType/x ；/wf DelQueue/x (/wkz q/x [/wkz i/x ]/wky ，/wd customer/x )/wky ；/wf ∥/w 删除/v 第/m i/x 队列/n 的/ude1 排头/n 客户/n 
    TotalTime+/x 。/wj en．OccurTime―customer．ArrivalTime：/x 
    ∥/w 累计/v 客户/n 逗留/vi 时间/n 
    if/x (/wkz !/wt QueueEmpty/x (/wkz q/x 【/wkz i/x ]/wky )/wky )/wky {/n     ∥/w 设定/v 第/m i/x 队列/n 的/ude1 一个/mq 离开/v 事件/n 并/cc 插入/v 事件/n 表/n 
    GetHead/x (/wkz q/x [/wkz i/x ]/wky ，/wd customer/x )/wky ；/wf 
    OrderInsert/x (/wkz ev/x ，/wd (/wkz e/x _/n n．OccurTime+curtomer．Duration/x ，/wd i/x )/wky ，/wd (/wkz */n cmp/x )/wky (/wkz )/wky )/wky ；/wf 
    }/n 
    
}/n ／／CustomerDeparture/x 
void/x  Bank―Simulation/x (/wkz int/x  CloseTime/x )/wky {/n 
  OpenForDay：/x     ∥/w 初始化/v 
  ．/w bile/x (/wkz !/wt EmptyEventList/x (/wkz ev/x )/wky )/wky {/n 
    DelFirst/x (/wkz GetHead/x (/wkz eV/x )/wky ，/wd p/x )/wky ；/wf   en=GetCurElem/x (/wkz p/x )/wky ；/wf 
    if/x (/wkz en．/x Ⅶ/m e==0/x )/wky 
    CustomerArrived/x ；/wf     ∥/w 处理/v 客户/n 到达/v 事件/n 
    e1/x 。/wj e/x  CustomerDeparture/x ；/wf     ∥/w 处理/v 客户/n 离开/v 事件/n 
    }/n 
    ∥/w 计算/v 并/cc 输出/v 平均/ad 逗留/vi 时间/n 
    pri．t/x ~/n (/wkz 。/wj The/x  Average/x  Time/x  is％f＼F/x ，/wd TotalTime／CustomerNum/x )/wky ；/wf 
＼/m }/n }/n Bank．Simulation/x 
算法/n 3．7/m 
　　例/n 3/m ，/wd 3/m 假设/n 每个/r 客户/n 办理业务/n 的/ude1 时间/n 不/d 超过/v 30/m 分钟/qt ；/wf 两/m 个/q 相邻/vi 到达/v 银行/n 的/ude1 客户/n 的/ude1 时间/n 间隔/n 不/d 超过/v 5/m 分钟/qt ，/wd 模拟/v 程序/n 从/p 第一/m 个/q 客户/n 到达/v 时间/n 为/v “/wyz 0/m ”/wyy 开始/v 起/vf 运行/vi 。/wj 
　　删除/v 事件/n 表/vg 上/vf 第一/m 个/q 结点/n ，/wd 得到/v en．OccurTime=0/x ，/wd 因为/p an．NType=0/x ，/wd 则/c 随即/d 得到/v 两/m 个/q 随机数/n (/wkz 23/m ，/wd 4/m )/wky ，/wd 生成/v 一个/mq 下/f 一/m 客户/n 到达/v 银行/n 的/ude1 事件/n (/wkz OccurTime=4/x ，/wd NType=0/x )/wky 插入/v 事件/n 表/n ；/wf 刚/d 到/v 的/ude1 第一/m 位/q 客户/n 排/v 在/p 第一/m 个/q 窗口/s 的/ude1 队列/n 中/f (/wkz ArrivalTime=0/x ，/wd Duration=23/x )/wky ，/wd 由于/c 他/rr 是/vshi 排头/n ，/wd 故/c 生成/v 一个/mq 客户/n 将/d 离开/v 的/ude1 事件/n (/wkz OccurTime=23/x ，/wd NType：1/x )/wky 插入/v 事件/n 表/n 。/wj 
    删除/v 事件/n 表/vg 上/vf 第一/m 个/q 结点/n ，/wd 仍/d 是/vshi 新/a 客户/n 到达/v 事件/n (/wkz 因为/p en．NType=0/x )/wky ，/wd an．OccurTime/x 
=4/m ，/wd 得到/v 随机数/n 为/v (/wkz 3/m ，/wd 1/m )/wky ，/wd 则/d 下/vf 一/m 客户/n 到达/v 银行/n 的/ude1 时间/n 为/v OccurTime=4+1=5/x ，/wd 由于/c 此时/r 第二/m 个/q 窗口/s 是/vshi 空/a 的/ude1 ，/wd 则/c 刚/d 到/v 的/ude1 第二/m 位/q 客户/n 为/p 第二/m 个/q 队/n 列/v 的/ude1 队头/n (/wkz ArrivalTime=4/x ，/wd Duration=3/x )/wky ，/wd 因而/c 生成/v 一个/mq 客户/n 将/d 离开/v 的/ude1 事件/n (/wkz OccurTime=7/x ，/wd NType：2/x )/wky 插入/v 事件/n 表/n 。/wj 
    删除/v 事件/n 表/vg 上/vf 第一/m 个/q 结点/n ，/wd 仍/d 是/vshi 新/a 客户/n 到达/v 事件/n ，/wd en．OccurTime=5/x ，/wd 得到/v 随机数/n (/wkz 11/m ，/wd 3/m )/wky ，/wd 则/c 插入/v 事件/n 表/n 的/ude1 新/a 事件/n 为/v (/wkz OccurTime：8/x ，/wd NType=0/x )/wky ，/wd 同时/c ，/wd 刚/d 到/v 的/ude1 第三/m 位/q 客户/n 成为/v 第三/m 个/q 队/n 列/v 的/ude1 队头/n (/wkz ArrivalTime=5/x ，/wd Duration：11/x )/wky ，/wd 因而/c 插入/v 事件/n 表/n 的/ude1 新/a 事件/n 为/v (/wkz Occur．Time=16/x ，/wd NType=3/x )/wky 。/wj 
    删除/v 事件/n 表/n 的/ude1 第一/m 个/q 结点/n ，/wd 因为/p NType=2/x ，/wd 说明/v 是/vshi 第二/m 个/q 窗口/s 的/ude1 客户/n 离开/v 银行/n en．OccurTime=7/x ，/wd 删/v 去/vf 第二/m 个/q 队/n 列/v 的/ude1 队头/n ，/wd curstomer．ArrivalTime：4/x ，/wd 则/c 他/rr 在/p 银行/n 的/ude1 逗留/vn 时间/n 为/p 3/m 分钟/qt 。/wj 
    依次/d 类推/vi ，/wd 在/p 模拟/v 开始/v 后/f 的/ude1 一/m 段时间/n 内/f ，/wd 事件/n 表/n 和/cc 队列/n 的/ude1 状态/n 如/v 图/n 3．15/m 所/usuo 示/vg ，/wd ev．first/x 为/v 链/ng 表头/n 指针/n 。/wj 

随机数/n     事件/n 表/n 
(/wkz 23/m ，/wd 4/m )/wky 
(/wkz 3/m ，/wd 1/m )/wky 
(/wkz 11/m 。/wj 3/m )/wky 
队列/n 状态/n 
Q/x 
随机数/n     事件/n 表/n     队列/n 状态/n 
    ev．st/x  J/x 
(/wkz 29/m ，/wd 2/m )/wky 
(/wkz 18/m ，/wd 4/m )/wky 
(/wkz 13/m ，/wd 5/m )/wky 
eV．/x 
eV．/x 
图/n 3．15/m   事件/n 驱动/vn 模拟/vn (/wkz 算法/n 3．7/m )/wky 过程/n 中/b 事件/n 表/n 和/cc 队列/n 状态/n 变化/vn 状况/n 

*/n 
第4/m 章/q   串/v 
    计算机/n 上/f 的/ude1 非/b 数值/n 处理/v 的/ude1 对象/n 基本上/d 是/vshi 字符串/n 数据/n 。/wj 在/p 较/d 早/a 的/ude1 程序设计/n 语言/n 中/f ，/wd 字符串/n 是/vshi 作为/p 输入/vn 和/cc 输出/vn 的/ude1 常量/n 出现/v 的/ude1 。/wj 随着/p 语言/n 加工程序/n 的/ude1 发展/vn ，/wd 产生/v 了/ule 字符串/n 处理/vn 。/wj 这样/rzv ，/wd 字符串/n 也/d 就/d 作为/v 一/m 种/q 变量/n 类型/n 出现/v 在/p 越来越/d 多/a 的/ude1 程序设计/n 语言/n 中/f ，/wd 同时/c 也/d 产生/v 了/ule 一/m 系列/q 字符串/n 的/ude1 操作/vn 。/wj 字符串/n 一般/ad 简称/v 为/v 串/q 。/wj 在/p 汇编/n 和/cc 语言/n 的/ude1 编译程序/n 中/f ，/wd 源/ng 程序/n 和/cc 目标/n 程序/n 都/d 是/vshi 字符串/n 数据/n 。/wj 在/p 事务/n 处理程序/n 中/f ，/wd 顾客/n 的/ude1 姓名/n 和/cc 地址/n 以及/cc 货物/n 的/ude1 名称/n 、/wn 产地/n 和/cc 规格/n 等/udeng 一般/a 也/d 是/vshi 作为/p 字符串/n 处理/v 的/ude1 。/wj 又/d 如/v 信息/n 检索系统/n 、/wn 文字/n 编辑程序/n 、/wn 问答/vn 系统/n 、/wn 自然/n 语言/n 翻译系统/n 以及/cc 音乐/n 分析程序/n 、/wn 等等/udeng ，/wd 都/d 是/vshi 以/p 字符串/n 数据/n 作为/v 处理/v 对象/n 的/ude1 。/wj 
    然而/c ，/wd 现今/t 我们/rr 使用/v 的/ude1 计算机/n 的/ude1 硬件/n 结构/n 主要/d 是/vshi 反映/v 数值/n 计算/v 的/ude1 需要/n 的/ude1 ，/wd 因此/c ，/wd 在/p 处理/v 字符串/n 数据/n 时/ng 比/p 处理/v 整数/n 和/cc 浮点数/n 要/v 复杂/a 得/ude3 多/a 。/wj 而且/c ，/wd 在/p 不同/a 类型/n 的/ude1 应用/vn 中/f ，/wd 所/usuo 处理/v 的/ude1 字符串/n 具有/v 不同/a 的/ude1 特点/n ，/wd 要/v 有效/a 地/ude2 实现/v 字符串/n 的/ude1 处理/vn ，/wd 就/d 必须/d 根据/p 具体情况/n 使用/v 合适/a 的/ude1 存储/vn 结构/n 。/wj 这/rzv 一/m 章/q ，/wd 我们/rr 将/d 讨论/v 一些/mq 基本/a 的/ude1 串/q 处理/vn 操作/vn 和/cc 几/m 种/q 不同/a 的/ude1 存储/vn 结构/n 。/wj 
4．1/m   串/v 类型/n 的/ude1 定义/n 
    串/v (/wkz string/x )/wky (/wkz 或/c 字符串/n )/wky ，/wd 是/vshi 由/p 零/m 个/q 或/c 多/m 个/q 字符/n 组成/v 的/ude1 有限/a 序列/n 。/wj 一般/ad 记/v 为/v     s=/x ’/wyy 。/wj 1/m “/wyz 2/m …/ws n/x 。/wj ’/wyy     (/wkz n≥0/x )/wky     (/wkz 4．1/m )/wky 
其中/rz ，/wd s/x 是/vshi 串/v 的/ude1 名/q ，/wd 用/p 单引号/n 括/vi 起来/vf 的/ude1 字符/n 序列/n 是/vshi 串/v 的/ude1 值/n ；/wf ai/x (/wkz 1≤i≤n/x )/wky 可以/v 是/vshi 字母/n 、/wn 数字/n 或/c 其它/rz 字符/n ；/wf 串/v 中/b 字符/n 的/ude1 数目/n n/x 称为/v 串/v 的/ude1 长度/n 。/wj 零/m 个/q 字符/n 的/ude1 串/q 称为/v 空串/n (/wkz Null/x  string/x )/wky ，/wd 它/rr 的/ude1 长度/n 为/p 零/m 。/wj 
    串/v 中/f 任意/d 个/q 连续/a 的/ude1 字符/n 组成/v 的/ude1 子/ng 序列/n 称为/v 该/rz 串/q 的/ude1 子/ng 串/v 。/wj 包含/v 子/ng 串/v 的/ude1 串/n 相应/vi 地/ude2 称/v 为主/vi 串/v 。/wj 通常/d 称/v 字符/n 在/p 序列/n 中/f 的/ude1 序号/n 为/p 该/rz 字符/n 在/p 串/v 中/f 的/ude1 位置/n 。/wj 子/ng 串/v 在/p 主/ag 串/v 中/f 的/ude1 位置/n 则/c 以/p 子/ng 串/v 的/ude1 第一/m 个/q 字符/n 在/p 主/ag 串/v 中/f 的/ude1 位置/n 来/vf 表示/v 。/wj 
    例如/v ，/wd 假设/v 口/n 、/wn 6/m 、/wn “/wyz d/x 为/v 如下/vi 的/ude1 四/m 个/q 串/v     a=/x ’/wyy BEI/x ’/wyy     ，/wd   6=/m ’/wyy JING/x ’/wyy 
    f=/x ’/wyy BEIJING/x ’/wyy ，/wd   d=/x ’/wyy ．/w BEI/x  J．ING/x ’/wyy 
则/c 它们/rr 的/ude1 长度/n 分别/d 为/v 3/m 、/wn 4/m 、/wn 7/m 和/cc 8/m ；/wf 并且/c a/x 和/cc b/x 都/d 是/vshi c/x 和/cc d/x 的/ude1 子/ng 串/v ，/wd n/x 在/p c/x 和/cc d/x 中/f 的/ude1 位置/n 都/d 是/vshi 1/m ，/wd 而/cc 6/m 在/p c/x 中/f 的/ude1 位置/n 是/vshi 4/m ，/wd 在/p d/x 中/f 的/ude1 位置/n 则/d 是/vshi 5/m 。/wj 
    称/v 两/m 个/q 串/v 是/vshi 相等/vi 的/ude1 ，/wd 当/v 且/c 仅/d 当/v 这/rzv 两/m 个/q 串/v 的/ude1 值/n 相等/vi 。/wj 也就是说/vl ，/wd 只有/c 当/p 两/m 个/q 串/v 的/ude1 长度/n 相等/vi ，/wd 并且/c 各个/rz 对应/vn 位置/n 的/ude1 字符/n 都/d 相等/vi 时/ng 才/d 相等/vi 。/wj 例如/v 上/vf 例/n 中/f 的/ude1 串/n a/x 、/wn 6/m 、/wn c/x 和/cc d/x 彼此/rr 都/d 不/d 相/v 等/udeng 。/wj 
    值得一提的是/vl ，/wd 串/v 值/n 必须/d 用/v 一/m 对/q 单引号/n 括/vi 起来/vf ，/wd 但/c 单引号/n 本身/rz 不/d 属于/v 串/q ，/wd 它/rr 的/ude1 作用/n 只是/d 为了/p 避免/v 与/p 变量名/n 或/c 数/v 的/ude1 常量/n 混淆/v 而已/y 。/wj 
  例如/v 在/p 程序设计/n 语言/n 中/f     x=/x ’/wyy 123/m ’/wyy ：/wp 则/d 表明/v x/x 是/vshi 一个/mq 串/v 变量名/n ，/wd 赋/v 给/p 它/rr 的/ude1 值/n 是/vshi 字符/n 序列/n 123/m 。/wj 又/d 如/v   tsing=/x ’/wyy T/x "/n SING/x ’/wyy 中/f ，/wd tsm/x ’/wyy g/x 是/vshi 一个/mq 串/v 变量名/n ，/wd 而/cc 字符/n 序列/n TSING/x 是/vshi 其/rz 值/n 。/wj 
　　在/p 各种/rz 应用/vn 中/f ，/wd 空格/n 常常/d 是/vshi 串/v 的/ude1 字符集/n 合/v 中/f 的/ude1 一个/mq 元素/n ，/wd 因而/c 可以/v 出现/v 在/p 其它/rz 字符/n 中间/f 。/wj 由/p 一个/mq 或/c 多/m 个/q 空格/n 组成/v 的/ude1 串/n ～/ws 称为/v 空格/n 串/q (/wkz bIank/x  string/x ，/wd 请/v 注意/v ：/wp 此处/s 不是/v 空串/n )/wky 。/wj 它/rr 的/ude1 长度/n 为/v 串/q 中/b 空格字符/n 的/ude1 个/q 数/n 。/wj 为了/p 清楚/a 起见/u ，/wd 以后/f 我们/rr 用/p 符号/n “/wyz 黟/n ”/wyy 来/f 表示/v “/wyz 空串/n ”/wyy 。/wj 
　　串/v 的/ude1 逻辑/n 结构/n 和/cc 线性/n 表/n 极为/d 相似/a ，/wd 区别/v 仅/d 在于/v 串/v 的/ude1 数据/n 对象/n 约束/vn 为/p 字符集/n 。/wj 然而/c ，/wd 串/v 的/ude1 基本/a 操作/vn 和/cc 线性/n 表/n 有/vyou 很/d 大/a 差别/n 。/wj 在/p 线性/n 表/n 的/ude1 基本/a 操作/vn 中/f ，/wd 大多/d 以/p “/wyz 单个/b 元素/n ”/wyy 作为/v 操作对象/n ，/wd 如/v ：/wp 在/p 线性/n 表中查找/n 某个/rz 元素/n 、/wn 求/v 取/v 某个/rz 元素/n 、/wn 在/p 某个/rz 位置/n 上/f 插入/v 一个/mq 元素/n 和/cc 删除/v 一个/mq 元素/n 等/udeng ；/wf 而/cc 在/p 串/v 的/ude1 基本/a 操作/vn 中/f ，/wd 通常/d 以/p “/wyz 串/v 的/ude1 整体/n ”/wyy 作为/v 操作对象/n ，/wd 如/v ：/wp 在/p 串/v 中/f 查找/v 某/rz 个子/n 串/q 、/wn 求/v 取/v 一/m 个子/n 串/q 、/wn 在/p 串/v 的/ude1 某个/rz 位置/n 上/f 插/v 入/v 一/m 个子/n 串/v 以及/cc 删除/v 一个/mq 子/ng 串/v 等/udeng 。/wj 
　　串/v 的/ude1 抽象数据/n 类型/n 的/ude1 定义/n 如下/vi ：/wp   ，/wd 
ADT/x  String/x  l/x 
    数据/n 对象/n ：/wp D=/x {/n ai/x }/n ai∈CharacterSet/x ，/wd i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x ，/wd n≥O/x }/n 
    数据/n 关系/n ：/wp R1=/x {/n </n ai―1．aj/x >/n l/x  ai/x 一/m 1/m ，/wd ai∈D/x 。/wj i=2/x ，/wd ．/w ．/w ．/w ，/wd n/x }/n 
    基本/ad 操作/v ：/wp 
    Str/x ~/n ssign/x (/wkz ＆/n T/x ，/wd chars/x )/wky 
    初始条件/n ：/wp chars/x 是/vshi 字符串/n 常量/n 。/wj 
    操作/v 结果/n ：/wp 生成/v 一个/mq 其/rz 值/n 等于/v chars/x 的/ude1 串/n T/x 。/wj 
    strCopy/x (/wkz &/n T/x ，/wd s/x )/wky 
  初始条件/n ：/wp 串/v s/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 由/p 串/v s/x 复制/v 得/ude3 串/v T/x 。/wj 
    StrEmpty/x (/wkz s/x )/wky 
    初始条件/n ：/wp 串/v s/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v s/x 为/p 空串/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c 返回/v FALSE/x 。/wj 
    StrCoapare/x (/wkz s/x ，/wd T/x )/wky     。/wj 
  初始条件/n ：/wp 串/v s/x 和/cc T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 若/v s/x >/n T/x ，/wd 则/c 返回/v 值/v >/n 0/m ；/wf 若/v s=．T/x ，/wd 则/c 返回/v 值/v =0/m ；/wf 若/v s/x </n T/x ，/wd 贝/b Ⅱ/m 返回/v 值/v </n 0/m 。/wj 
    StrUmgth/x (/wkz s/x )/wky 
    初始条件/n ：/wp 串/v s/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v s/x 的/ude1 元素/n 个数/n ，/wd 称为/v 串/v 的/ude1 长度/n 。/wj 
    ClearString/x (/wkz ＆/n S/x )/wky 
    初始条件/n ：/wp 串/v s/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 将/d s/x 清/v 为/p 空串/n 。/wj 
    Concat/x (/wkz &/n T/x ，/wd sl/x ，/wd s2/x )/wky 
    初始条件/n ：/wp 串/v sl/x 和/cc S2/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 用/v T/x 返回/v 由/p s1/x 和/cc s2/x 联接/v 而/cc 成/v 的/ude1 新/a 串/q 。/wj 
    SubS/x ~/n ing/x (/wkz ＆/n sub/x ，/wd s/x ，/wd pos/x ，/wd len/x )/wky 
    初始条件/n ：/wp 串/v s/x 存在/v ，/wd 1≤pos≤StrLength/x (/wkz s/x )/wky 且/c O≤len≤StrLength/x (/wkz s/x )/wky -/wp pos+1/x 。/wj 
    操作/v 结果/n ：/wp 用/v Sub/x 返回/v 串/v s/x 的/ude1 第/m pos/x 个/q 字符/n 起/vf 长度/n 为/v len/x 的/ude1 子/ng 串/v 。/wj 
    Index/x (/wkz S/x ，/wd T/x ，/wd pos/x )/wky 
    初始条件/n ：/wp 串/v s/x 和/cc T/x 存在/v ，/wd T/x 是非/n 空串/n ，/wd 1≤pos≤Strl/x ,/wd ength/x (/wkz s/x )/wky 。/wj 
    操作/v 结果/n ：/wp 若/v 主/ag 串/v s/x 中/f 存在/v 和/cc 串/v T/x 值/n 相同/a 的/ude1 子/ng 串/v ，/wd 则/c 返回/v 它/rr 在/p 主/ag 串/v s/x 中/f 第/m pos/x 个/q 字符/n 之后/f 第一/m 次/qv 出现/v 的/ude1 位置/n ；/wf 否则/c 函数值/n 为/p 0/m 。/wj 
    Replace/x (/wkz &/n s/x ，/wd T/x ，/wd V/x )/wky 
    初始条件/n ：/wp 串/v S/x ，/wd T/x 和/cc v/x 存在/v ，/wd T/x 是非/n 空串/n 。/wj 
    操作/v 结果/n ：/wp 用/v v/x 替换/v 主/ag 串/v S/x 中/f 出现/v 的/ude1 所有/b 与/p T/x 相等/vi 的/ude1 不/d 重叠/vi 的/ude1 子/ng 串/v 。/wj 
    StrInsert/x (/wkz &/n S/x ，/wd pos/x ，/wd T/x )/wky 
    初始条件/n ：/wp 串/v S/x 和/cc T/x 存在/v ，/wd 1≤pos≤StrLength/x (/wkz S/x )/wky +l/x 。/wj 
    操作/v 结果/n ：/wp 在/p 串/v S/x 的/ude1 第/m pos/x 个/q 字符/n 之前/f 插入/v 串/v T/x 。/wj 
    StrDelete/x (/wkz &/n S/x ，/wd pos/x ，/wd len/x )/wky 
    初始条件/n ：/wp 串/v S/x 存在/v ，/wd 1≤pos≤StrLength/x (/wkz S/x )/wky 一/m len/x 十/m 1/m 。/wj 
    操作/v 结果/n ：/wp 从/p 串/v S/x 中/f 删除/v 第/m pos/x 个/q 字符/n 起/vf 长度/n 为/v len/x 的/ude1 子/ng 串/v 。/wj 
    DestroyStrlng/x (/wkz as/x )/wky 
    初始条件/n ：/wp 串/v S/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 串/v S/x 被/pbei 销毁/v 。/wj 
    IADT/x  String/x 
    对于/p 串/v 的/ude1 基本/ad 操作/v 集/vg 可以/v 有/vyou 不同/a 的/ude1 定义方法/n ，/wd 读者/n 在/p 使用/v 高级/a 程序设计/n 语言/n 中/f 的/ude1 串/q 类型/n 时/ng ，/wd 应/v 以/p 该/rz 语言/n 的/ude1 参考/vn 手册/n 为/p 准/a 。/wj 在/p 上述/b 抽象数据/n 类型定义/n 的/ude1 13/m 种/q 操作/vn 中/f ，/wd 串/v 赋值/v StrAssign/x 、/wn 串/v 比较/d StrCompare/x 、/wn 求/v 串/q 长/a StrLength/x 、/wn 串联/v 接/v Concat/x 以及/cc 求/v 子/ng 串/v SubString/x 等/udeng 五/m 种/q 操作/v 构成/v 串/q 类型/n 的/ude1 最/d 小/a 操作/vn 子集/n 。/wj 即/v ：/wp 这些/rz 操作/vn 不/d 可能/v 利用/v 其他/rzv 串/q 操作/v 来/vf 实现/v ，/wd 反之/c ，/wd 其他/rzv 串/q 操作/v (/wkz 除/p 串/v 清除/v ClearString/x 和/cc 串/v 销毁/v DestroyString/x 外/f )/wky 均/d 可/v 在/p 这个/rz 最/d 小/a 操作/vn 子集/n 上/f 实现/v 。/wj 
    例如/v ，/wd 可/c 利用/v 判/v 等/udeng 、/wn 求/v 串/q 长/a 和/cc 求/v 子/ng 串/v 等/udeng 操作实现/n 定位/vn 函数/n Index/x (/wkz S/x ，/wd T/x ，/wd pos/x )/wky 。/wj 算法/n 的/ude1 基本思想/n 为/v ：/wp 在/p 主/ag 串/v s/x 中/f 取/v 从/p 第/m i/x (/wkz i/x 的/ude1 初值/n 为/v pos/x )/wky 个/q 字符/n 起/vf 、/wn 长度/n 和/cc 串/v T/x 相等/vi 的/ude1 子/ng 串/v 和/cc 串/v T/x 比较/vn ，/wd 若/c 相等/vi ，/wd 则/c 求得/v 函数值/n 为/v i/x ，/wd 否则/c i/x 值/n 增/v 1/m 直至/v 串/v s/x 中/f 不/d 存在/v 和/cc 串/v T/x 相等/vi 的/ude1 子/ng 串/v 为止/u 。/wj 如/v 算法/n 4．1/m 所/usuo 示/vg 。/wj 
int/x  Index/x (/wkz String/x  S/x ，/wd String/x  T/x ，/wd int/x  pos/x )/wky l/x 
  ∥/w T/x 为/p 非/b 空串/n 。/wj 若/v 主/ag 串/v S/x 中/f 第/m pos/x 个/q 字符/n 之后/f 存在/v 与/p T/x 相等/vi 的/ude1 子/ng 串/v 
  ∥/w 则/c 返回/v 第一/m 个/q 这样/rzv 的/ude1 子/ng 串/v 在/p S/x 中/f 的/ude1 位置/n ，/wd 否则/c 返回/v 0/m 
  if/x (/wkz pos/x >/n O/x )/wky {/n 
  n=StrLength/x (/wkz S/x )/wky ；/wf m=StrLength/x (/wkz T/x )/wky ；/wf   i=pos/x ；/wf 
  while/x (/wkz i/x </n =n―m+1/x )/wky {/n 
    SubString/x (/wkz sub/x ，/wd S/x ，/wd i/x ，/wd m/x )/wky ；/wf 
    if/x (/wkz StrCompare/x (/wkz sub/x ，/wd T/x )/wky !/wt =0/m )/wky     十/m +i/x ；/wf 
    else/x  return/x  i/x ；/wf     ∥/w 返回/v 子/ng 串/v 在/p 主/ag 串/v 中/f 的/ude1 位置/n 
    }/n ∥/w while/x 
  }/n ∥/w if/x 
  return/x  0/m ；/wf     ∥/w S/x 中/f 不/d 存在/v 与/p T/x 相等/vi 的/ude1 子/ng 串/v 
＼f/x }/n Index/x 
算法/n 4．1/m 
4．2/m   串/v 的/ude1 表示/vn 和/cc 实现/v 
如果/c 在/p 程序设计/n 语言/n 中/f ，/wd 串/v 只是/d 作为/v 输入/v 或/c 输出/v 的/ude1 常量/n 出现/v ，/wd 则/c 只/d 需/v 存储此/n 串/v 的/ude1 串/q 值/n ，/wd 即/v 字符/n 序列/n 即可/v 。/wj 但/c 在/p 多数/m 非/b 数值/n 处理/v 的/ude1 程序/n 中/f ，/wd 串/v 也/d 以/p 变量/n 的/ude1 形式/n 出现/v 。/wj 
    串/v 有/vyou 三/m 种/q 机/ng 内/f 表示方法/n ，/wd 分别/d 介绍/v 如下/vi 。/wj 
    4．2．1/m 定/v 长/a 顺序/n 存储表示/n 
    类似/v 于/p 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n ，/wd 用/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元存储/n 串/q 值/n 的/ude1 字符/n 序列/n 。/wj 在/p 串/v 的/ude1 定/d 长/a 顺序/n 存储/vn 结构/n 中/f ，/wd 按照/p 予/vg 定义/n 的/ude1 大小/n ，/wd 为/p 每个/r 定义/n 的/ude1 串/q 变量/n 分配/v 一个/mq 固定长度/n 的/ude1 存储区/n ，/wd 则/c 可/v 用/p 定/v 长/a 数组/n 如下/vi 描述/v 之/uzhi 。/wj 
    ∥/w …/ws 串/v 的/ude1 定/d 长/a 顺序/n 存储表示/n ～/ws 
    #/n defi．e/x  MAXSTRLEN/x  255/m     ∥/w 用户/n 可/v 在/p 255/m 以内/f 定义/n 最/d 大/a 串/q 长/a 
    thief/x   unsigned/x  char/x  SStr/x ’/wyy ing/x [/wkz MAXSTRLEN+1/x ]/wky ；/wf     ∥/w O/x 号/q 单元存放/n 串/v 的/ude1 长度/n 
串/v 的/ude1 实际/a 长度/n 可/v 在/p 这/rzv 予/vg 定义/n 长度/n 的/ude1 范围内随意/n ，/wd 超过/v 予/vg 定义/n 长度/n 的/ude1 串/q 值/n 则/d 被/pbei 舍去/v ，/wd 称之为/v “/wyz 截断/v ”/wyy 。/wj 对/p 串/v 长/a 有/vyou 两/m 种/q 表示方法/n ：/wp 一/m 是/vshi 如/v 上述/b 定义/n 描述/vn 的/ude1 那样/rzv ，/wd 以/p 下标/n 为/p 0/m 的/ude1 数组/n 分量/n 存放/v 串/v 的/ude1 实际/a 长度/n ，/wd 如/v PAS/x (/wkz ：/wp AL/x 语言/n 中/f 的/ude1 串/q 类型/n 采用/v 这种/r 表示方法/n ；/wf 二/m 是/vshi 在/p 串/q 值/n 后面/f 加/v 一个/mq 不/d 计/vi 入/v 串/q 长/a 的/ude1 结束/vn 标记/n 字符/n ，/wd 如/c 在/p 有/vyou 的/ude1 C/x 语言/n 中/f 以/p “/wyz ＼0/m ”/wyy 表示/v 串/q 值/n 的/ude1 终结/vn 。/wj 此时/r 的/ude1 串/q 长/a 为/p 隐含/v 值/n ，/wd 显然/ad 不/d 便于/v 进行/vx 某些/rz 串/q 操作/vn 。/wj 
    在/p 这种/r 存储/vn 结构/n 表示/v 时/ng 如何/ryv 实现/v 串/v 的/ude1 操作/vn ，/wd 下面/f 以/p 串联/v 接/v 和/cc 求/v 子/ng 串/v 为/p 例/n 讨论/v 之/uzhi 。/wj     1．/m 串联/v 接/v Concat/x (/wkz &/n T/x ，/wd S1/x ，/wd S2/x )/wky 
    假设/n S1/x 、/wn S2/x 和/cc T/x 都/d 是/vshi SString/x 型/k 的/ude1 串/q 变量/n ，/wd 且/c 串/v T/x 是/vshi 由/p 串/v S1/x 联结/v 串/v s2/x 得到/v 的/ude1 ，/wd 即/d 串/v T/x 的/ude1 值/n 的/ude1 前/f 一/m 段/q 和/cc 串/v s1/x 的/ude1 值/n 相等/vi ，/wd 串/v T/x 的/ude1 值/n 的/ude1 后/f 一/m 段/q 和/cc 串/v S2/x 的/ude1 值/n 相等/vi ，/wd 则/c 只/d 要/v 进行/vx 相应/vi 的/ude1 “/wyz 串/v 值/v 复制/v ”/wyy 操作/v 即可/v ，/wd 只是/d 需/v 按/p 前述/b 约定/vn ，/wd 对/p 超长/b 部分/n 实施/v “/wyz 截断/v ”/wyy 操作/vn 。/wj 基于/p 串/v s1/x 和/cc s2/x 长度/n 的/ude1 不同/a 情况/n ，/wd 串/v T/x 值/n 的/ude1 产生/vn 可能/n 有/vyou 如下/vi 三/m 种/q 情况/n ：/wp 1/m )/wky s1/x [/wkz 0/m ]/wky +S2/x [/wkz 0/m ]/wky ≤MAXS/x '/n TRLEN/x ，/wd 如/v 图/n 4．10/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 得到/v 的/ude1 串/n T/x 是/vshi 正确/a 的/ude1 结果/n ；/wf 2/m )/wky S1/x [/wkz 0/m ]/wky </n MAXSTRLEN/x 而/cc s1/x [/wkz 0/m ]/wky +s2/x [/wkz 0/m ]/wky >/n MAXSTRLEN/x ，/wd 则/c 将/d 串/v S2/x 的/ude1 一部分/m 截断/v ，/wd 得到/v 的/ude1 串/n T/x 只/d 包含/v 串/v s2/x 的/ude1 一个/mq 子/ng 串/v ，/wd 如/v 图/n 4．1/m (/wkz b/x )/wky 所/usuo 示/vg ；/wf 3/m )/wky S1/x [/wkz O/x ]/wky =MAXS/x '/n TRL/x ,/wd EN/x ，/wd 则/c 得到/v 的/ude1 串/n T/x 并非/v 联接/v 结果/n ，/wd 而/cc 和/cc 串/v s1/x 相等/vi 。/wj 上述/b 算法/n 描述/v 如/v 算法/n 4．2/m 所/usuo 示/vg 。/wj 
    Status/x  Concat/x (/wkz SString/x ＆/n T/x ，/wd SString/x  s1/x ，/wd SString/x  s2/x )/wky I/x 
    ∥/w 用/v T/x 返回/v 由/p sl/x 和/cc S2/x 联接/v 而/cc 成/v 的/ude1 新/a 串/q 。/wj 若/c 未/d 截断/v ，/wd 则/c 返回/v ，/wd TRUE/x ，/wd 否则/c FALSE/x 。/wj     if/x (/wkz sl/x [/wkz 0/m ]/wky +s2/x [/wkz 0/m ]/wky </n =MAXSTRLEN/x )/wky {/n     ∥/w 未/d 截断/v 
    T/x [/wkz 1．．sl/x [/wkz 0/m ]/wky ]/wky =s1/x [/wkz 1．．s1/x [/wkz O/x ]/wky ]/wky ；/wf 
    T/x [/wkz sl/x [/wkz 0/m ]/wky +1．．s1/x [/wkz 0/m ]/wky +s2/x [/wkz 0/m ]/wky ]/wky ：/wp s2/x [/wkz 1．．s2/x [/wkz 0/m ]/wky ]/wky ；/wf 
    T/x [/wkz O/x ]/wky ：/wp s1/x [/wkz 0/m ]/wky +S2/x [/wkz ：/wp O/x ]/wky ；/wf uncut=TRI/x ；/wf E/x ；/wf 
    }/n    
    else/x  if/x (/wkz s1/x [/wkz 0/m ]/wky </n MAXSTRSlZE/x )/wky {/n     ∥/w 截断/v 
    T/x [/wkz 1．．s1/x [/wkz O/x ]/wky ]/wky =s1/x [/wkz 1．．s1/x [/wkz O/x ]/wky ]/wky ；/wf 
    T/x [/wkz s1/x [/wkz 0/m ]/wky +1．．MAXSTRLEN/x ]/wky =s2/x [/wkz 1．．MAXSTRLEN―sl/x [/wkz 0/m ]/wky ]/wky ；/wf 
    ’/wyy r/x [/wkz 0/m ]/wky =MAXSTRLEN/x ；/wf 1mcut=FAI/x ~/n ；/wf 
    }/n 
    else/x {/n     ∥/w 截断/v (/wkz 仅/d 取/v s1/x )/wky 
    T/x [/wkz 0．．MAXSTRLEN/x ]/wky =s1/x [/wkz 0．．MAXSTRLEN/x ]/wky ；/wf 
    ∥/w T/x [/wkz 0/m ]/wky ==s1/x [/wkz 0/m ]/wky ==MAXSTRLF/x ~/n 
    1mcut=FALSE/x ；/wf 
   }/n 
    returll/x  uncut/x 
}/n f/x  Concat/x 
S1/x 
算法/n 4．2/m 
图/n 4．1/m   串/v 的/ude1 联结/vn 操作/vn Concat/x (/wkz T/x ，/wd S1/x ，/wd S2/x )/wky 示意图/n 
  (/wkz a/x )/wky S1/x [/wkz 0/m ]/wky +S2/x [/wkz 0/m ]/wky ≤MAXSTRLEN/x ；/wf 
  (/wkz b/x )/wky S1/x [/wkz 0/m ]/wky </n MAXSTRLEN/x 而/cc S1/x [/wkz 0/m 】/wky +SZ/x [/wkz 0/m ]/wky >/n MAXSTRLEN/x 
  (/wkz c/x )/wky S1/x [/wkz 0/m ]/wky =MAXSTRLEN/x 
  2．/m 求/v 子/ng 串/v SubString/x (/wkz &/n Sub/x ，/wd S/x ，/wd pos/x ，/wd len/x )/wky 
  求/v 子/ng 串/v 的/ude1 过程/n 即/d 为/v 复制/v 字符/n 序列/n 的/ude1 过程/n ，/wd 将/d 串/v s/x 中/f 从/p 第/m pos/x 个/q 字符/n 开始/v 长度/n 为/v 1en/x 的/ude1 字符/n 序列/n 复制/v 到/v 串/v Sub/x 中/f 。/wj 显然/a ，/wd 本/rz 操作/vn 不/d 会/v 有/vyou 需/v 截断/v 的/ude1 情况/n ，/wd 但/c 有/vyou 可能/n 产生/v 用户/n 给/v 出/vf 的/ude1 参数/n 不/d 符合/v 操作/v 的/ude1 初始条件/n ，/wd 当/p 参数/n 非法/b 时/ng ，/wd 返回/v ERROR/x 。/wj 其/rz 算法/n 描述/v 如/v 算法/n 4．3/m 所/usuo 示/vg 。/wj 
Status/x  SubStr/x ’/wyy ing/x (/wkz SString/x &/n Sub．SStri/x ‘/wyz ng/x  s/x ，/wd int/x  pos/x ，/wd int/x  len/x )/wky {/n 
    ∥/w 用/v Sub/x 返回/v 串/v s/x 的/ude1 第/m pos/x 个/q 字符/n 起/vf 长度/n 为/v len/x 的/ude1 子/ng 串/v 。/wj 
    ∥/w 其中/rz ，/wd l/x  pos/x ~/n StrLength/x (/wkz s/x )/wky 且/c 0≤len/x ~/n StrLength/x (/wkz s/x )/wky -/wp pos+1/x 。/wj 
    if/x (/wkz pos/x </n l/x  lI/x  pos/x >/n s/x [/wkz 0/m ]/wky ll/x  len/x </n 0/m  lI/x  len/x >/n s/x [/wkz 0/m ]/wky -/wp pos+1/x )/wky 
    return/x  ERROR/x ；/wf 
    sub/x [/wkz 1．．1eTl/x ]/wky =s/x [/wkz pos．．pos+len/x 一/m 1/m ]/wky ；/wf     ’/wyy 
    Sub/x [/wkz 0/m  3=len/x ；/wf   return/x  OK/x ；/wf 
}/n ∥/w SubString/x 
算法/n 4．3/m 
    综/ng 上/f 两/m 个/q 操作/vn 可见/c ，/wd 在/p 顺序/n 存储/vn 结构/n 中/f ，/wd 实现/v 串/q 操作/vn 的/ude1 原/b 操作/vn 为/v “/wyz 字符/n 序列/n 的/ude1 复制/vn ”/wyy ，/wd 操作/v 的/ude1 时间/n 复杂度/n 基于/p 复制/v 的/ude1 字符/n 序列/n 的/ude1 长度/n 。/wj 另/rz 一/m 操作/vn 特点/n 是/vshi ，/wd 如果/c 在/p 操作/vn 中/f 出现/v 串/q 值/n 序列/n 的/ude1 长度/n 超过/v 上/vf 界/n MAXSTRl．EN/x 时/ng ，/wd 约定/v 用/p 截尾/n 法处理/n ，/wd 这种/r 情况/n 不仅/c 在/p 求/v 联接/v 串/v 时/ng 可能/v 发生/v ，/wd 在/p 串/v 的/ude1 其它/rz 操作/vn 中/f ，/wd 如/c 插入/v 、/wn 置换/vn 等/udeng 也/d 可能/v 发生/v 。/wj 克服/v 这个/rz 弊病/n 唯有/v 不/d 限定/v 串/q 长/a 的/ude1 最/d 大/a 长度/n ，/wd 即/v 动态分配/n 串/q 值/n 的/ude1 存储空间/n 。/wj 
4．2．2/m 堆/q 分配存储/n 表示/v 
    这种/r 存储表示/n 的/ude1 特点/n 是/vshi ，/wd 仍/d 以/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 存放/v 串/q 值/n 字符/n 序列/n ，/wd 但/c 它们/rr 的/ude1 存储空间/n 是/vshi 在/p 程序执行/n 过程/n 中/b 动态分配/n 而/cc 得/v 。/wj 在/p c/x 语言/n 中/f ，/wd 存在/v 一个/mq 称之为/v “/wyz 堆/v ”/wyy 的/ude1 自由/a 存储区/n ，/wd 并/cc 由/p c/x 语言/n 的/ude1 动态分配/n 函数/n malloc/x (/wkz )/wky 和/cc free/x (/wkz )/wky 来/f 管理/vn 。/wj 利用/v 函数/n maltoc/x (/wkz )/wky 为/p 每个/r 新/d 产生/v 的/ude1 串/q 分配/v 一/m 块/q 实际/n 串/q 长/a 所/usuo 需/v 的/ude1 存储空间/n ，/wd 若/c 分配/v 成功/an ，/wd 则/c 返回/v 一个/mq 指向/v 起始/vn 地址/n 的/ude1 指针/n ，/wd 作为/v 串/v 的/ude1 基址/n ，/wd 同时/c ，/wd 为了/p 以后/f 处理/v 方便/an ，/wd 约定/v 串/q 长/a 也/d 作为/v 存储/vn 结构/n 的/ude1 一/m 部分/n 。/wj 
    ∥/w 串/v 的/ude1 堆/n 分配存储/n 表示/v 
  tst/x ~/n aet/x {/n 
    char/x   */n ch/x ；/wf     ∥/w 若是/c 非/b 空串/n ，/wd 则/c 按/p 串/v 长/a 分配存储/n 区/n ，/wd 否则/c ch/x 为/v NULL/x 
    int/x  length/x ；/wf     ∥/w 串长度/n 
    l/x  HString/x ；/wf 
这种/r 存储/vn 结构/n 表示/v 时/ng 的/ude1 串/q 操作/vn 仍/d 是/vshi 基于/p “/wyz 字符/n 序列/n 的/ude1 复制/vn ”/wyy 进行/vx 的/ude1 。/wj 例如/v ，/wd 串/v 复制/v 操作/v str/x (/wkz bpy/x (/wkz &/n T/x ，/wd s/x )/wky 的/ude1 实现/vn 算法/n 是/vshi ，/wd 若/c 串/v T/x 已/d 存在/v ，/wd 则/c 先/d 释放/v 串/v T/x 所/usuo 占/v 空间/n ，/wd 当/p 串/v s/x 不/d 空/v 时/ng ，/wd 先/d 为/v 串/v T/x 分配/vn 大小/n 和/cc 串/v S/x 长度/n 相等/vi 的/ude1 存储空间/n ，/wd 然后/c 将/d 串/v S/x 的/ude1 值/n 复制/v 到/v 串/v T/x 中/f ；/wf 又/d 如/v 串/v 插入/v 操作/v StrInsert/x (/wkz &/n S/x ，/wd pos/x ，/wd T/x )/wky 的/ude1 实现/vn 算法/n 是/vshi ，/wd 为/p 串/v s/x 重新/d 分配/v 大小/n 等于/v 串/v s/x 和/cc 串/v T/x 长度/n 之和/n 的/ude1 存储空间/n ，/wd 然后/c 进行/vx 串/v 值/v 复制/v ，/wd 如/v 算法/n 4．4/m 所/usuo 示/vg 。/wj 
Status/x  strInsert/x (/wkz HString/x ＆/n s/x ，/wd int/x  pos/x ，/wd HString/x  T/x )/wky {/n 
    ∥/w 1≤pos≤strLength/x (/wkz s/x )/wky +1/m 。/wj 在/p 串/v s/x 的/ude1 第/m pos/x 个/q 字符/n 之前/f 插入/v 串/v T/x 。/wj 
    if/x (/wkz pos/x </n 1/m  lI/x  pos/x >/n s．1ength+1/x )/wky return/x  ERROR/x ；/wf   ∥/w pos/x 不/d 合法/a 
    if/x (/wkz T．1ength/x )/wky {/n     ∥/w T/x 非空/n ，/wd 则/c 重新/d 分配空间/n ，/wd 插入/v T/x 
    if/x (/wkz !/wt (/wkz s．ch=/x (/wkz char/x */n )/wky realloc/x (/wkz s．ch/x ，/wd (/wkz s．1ength+T．1ength/x )/wky */n siz/x ~/n f/x (/wkz char/x )/wky )/wky )/wky )/wky 
    exit/x (/wkz OVERFLOw/x )/wky ；/wf 
    for/x (/wkz i=s．1ength/x 【/wkz 一/m 1/m ；/wf i/x >/n =pos/x 一/m 1/m ；/wf --/wp i/x )/wky   ∥/w 为/v 插入/v T/x 而/cc 腾出/v 位置/n 
    s/x  ch/x 【/wkz i+T．1ength/x _/n ]/wky =s．ch/x [/wkz i/x ]/wky ；/wf 
    s．ch/x [/wkz pos-1．．pos+T．1ength-2/x ]/wky =T．ch/x [/wkz 0．．T．1ength-1/x ]/wky ；/wf ∥/w 插入/v T/x 
        S．1ength+=T．1ength：/x 
    }/n 
    return/x  OK/x {/n 
}/n ／／Strlnsert/x 
    算法/n 4．4/m 
    以上/f 两/m 种/q 存储表示/n 通常/d 为/v 高级/a 程序设计/n 语言/n 所/usuo 采用/v 。/wj 由于/c 堆/v 分配存储/n 结构/n 的/ude1 串/n 既/c 有/vyou 顺序/n 存储/vn 结构/n 的/ude1 特点/n ，/wd 处理/v 方便/an ，/wd 操作/v 中/f 对/p 串/v 长/a 又/d 没有/v 任何/rz 限制/vn ，/wd 更/d 显/v 灵活/a ，/wd 因此/c 在/p 串/v 处理/v 的/ude1 应用/vn 程序/n 中/f 也/d 常/d 被/pbei 选用/v 。/wj 以下/f 所/usuo 示/vg 为/v 只/d 含/v 最/d 小/a 操作/vn 子集/n 的/ude1 HString/x 串/q 类型/n 的/ude1 模块/n 说明/v 。/wj 
    ／／/m …/ws ==ADT/x  String/x 的/ude1 表示/vn 与/cc 实现/v =：===/m 
    ∥/w 串/v 的/ude1 堆/n 分配存储/n 表示/v …/ws 
    typedef/x  struct/x {/n 
    d/x   */n ch/x ；/wf     ／／/m 若是/c 非/b 空串/n ，/wd 则/c 按/p 串/v 长/a 分配存储/n 区/n ，/wd 否则/c ch/x 为/v NULL/x 
    int/x  length/x ；/wf   ／／/m 串长度/n 
    }/n HString/x ；/wf 
∥/w 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v 
Status/x  StrAsslgn/x (/wkz HString/x ＆/n T/x ，/wd char/x */n chars/x )/wky ；/wf 
    ∥/w 生成/v 一个/mq 其/rz 值/n 等于/v 串/q 常量/n chars/x 的/ude1 串/n T/x 
int/x  StrLength/x (/wkz HString/x  S/x )/wky ；/wf 
    ∥/w 返回/v S/x 的/ude1 元素/n 个数/n ，/wd 称为/v 串/v 的/ude1 长度/n 。/wj 
Ant/x  StrCompare/x (/wkz HString/x  S/x 。/wj HString/x  T/x ，/wd 
    ∥/w 若/v S/x >/n T/x ，/wd 则/c 返回/v 值/v >/n O/x ；/wf 若/v S=T/x ，/wd 则/c 返回/v 值/n =O/x ；/wf 若/v S/x </n T/x ，/wd 则/c 返回/v 值/v </n 0/m 
Status/x  ClearString/x (/wkz HString/x ＆/n S/x )/wky ；/wf 
    ∥/w 将/d s/x 清/v 为/p 空串/n ，/wd 并/cc 释放/v S/x 所/usuo 占/v 空间/n 。/wj 
Status/x  Concat/x (/wkz }/n {/n String/x &/n T/x ，/wd HString/x  s1/x ，/wd HString/x  S2/x )/wky ；/wf 
    ∥/w 用/v T/x 返回/v 由/p s1/x 和/cc S2/x 联接/v 而/cc 成/v 的/ude1 新/a 串/q 。/wj 
HString/x  SubString/x (/wkz HString/x  S/x ，/wd int/x  pos/x ，/wd int/x  len/x )/wky ；/wf 
    ／／1≤pos/x ~/n </n StrLength/x (/wkz S/x )/wky 且/c 0≤len≤strLength/x (/wkz S/x )/wky 一/m poi+1/x 。/wj 
    ∥/w 返回/v 串/v S/x 的/ude1 第/m pos/x 个/q 字符/n 起/vf 长度/n 为/v len/x 的/ude1 子/ng 串/v 。/wj 
    ∥/w 基本/ad 操作/v 的/ude1 算法/n 描述/v …/ws 
Status/x  StrAssign/x (/wkz HString/x ＆/n T/x ，/wd char/x */n chars/x )/wky l/x 
    ∥/w 生成/v 一个/mq 其/rz 值/n 等于/v 串/q 常量/n chars/x 的/ude1 串/n T/x 
    if/x (/wkz T．ch/x )/wky free/x (/wkz T．ch/x )/wky ；/wf     ／／/m 释放/v T/x 原有/vn 空间/n 
    for/x (/wkz i：0/x ，/wd C=chars/x ；/wf   c/x ；/wf   ++i/x ，/wd ++c/x )/wky ；/wf   ／／/m 求/v chars/x 的/ude1 长度/n i/x 
    if/x (/wkz !/wt i/x )/wky {/n T．ch=IqULL/x ；/wf T．1ength=0/x ；/wf }/n 
    else/x {/n 
    if/x (/wkz !/wt (/wkz T．ch/x ；/wf (/wkz cllar/x */n )/wky 帕/ng lla/x _/n c/x (/wkz i/x */n sizeof/x (/wkz char/x )/wky )/wky )/wky )/wky 
    exit/x (/wkz OVERFLOW/x )/wky ；/wf 
    T．ch/x [/wkz 0．．i/x 一/m 1/m ]/wky =chars/x [/wkz 0．．i/x 一/m 1/m ]/wky ；/wf 
    T．1ength=i/x ；/wf 
    }/n 
    return/x  OK/x ；/wf 
・/w   76/m   ・/w 
＼jI/x  StrAssign/x 
int/x  StrLength/x (/wkz HString/x  S/x )/wky {/n 
    ∥/w 返回/v S/x 的/ude1 元素/n 个数/n ，/wd 称为/v 串/v J/x 的/ude1 长度/n 。/wj 
    return/x  S．1ength/x ；/wf 
＼/m {/n f/x  StrLength/x 
int/x  StrCompare/x (/wkz HString/x  S/x ，/wd HString/x  T/x )/wky {/n ’/wyy 
    ∥/w 若/v S/x >/n T/x ，/wd 则/c 返回/v 值/v >/n O/x ；/wf 若/v S=T/x ，/wd 则/c 返回/v 值/n ：/wp 0/m ；/wf 若/v S/x </n T/x ，/wd 则/c 返回/v 值/v </n 0/m 
    for/x (/wkz i：0/x ；/wf i/x </n S．1ength/x &/n &/n i/x </n T．1ength/x ；/wf ++i/x )/wky 
    if/x (/wkz s．ch/x [/wkz i/x ]/wky !/wt =T．ch/x [/wkz i/x ]/wky )/wky return/x  S．ch/x [/wkz 1/m ]/wky 一/m T．ch/x [/wkz i/x ]/wky ；/wf 
    return/x  S．1ength-T．1/x ~/n ngth/x ；/wf 
}/n ／／StrCompare/x 
Status/x  ClearString/x (/wkz HString/x &/n s/x )/wky {/n 
    ∥/w 将/d S/x 清/v 为/p 空串/n 。/wj 
    if/x (/wkz S．ch/x )/wky   lfree/x (/wkz S．oh/x )/wky ；/wf   S．ch=NULL/x ；/wf 
    S．1ength=0/x ；/wf 
    return/x  OK/x ；/wf 
、/wn ii/x  ClearString/x 
Status/x  Concat/x (/wkz HStrinq/x ＆/n T/x ，/wd HString/x  S1/x ，/wd HString/x  S2/x )/wky {/n 
    ∥/w 用/v T/x 返回/v 由/p s1/x 和/cc s2/x 联接/v 而/cc 成/v 的/ude1 新/a 串/q 。/wj 
    if/x (/wkz T．ch/x )/wky free/x (/wkz T．ch/x )/wky ；/wf     ／／/m 释放/v 旧/a 空间/n 
    if/x (/wkz !/wt (/wkz T．ch=/x (/wkz char/x */n )/wky malloc/x (/wkz (/wkz S1．1ength+S2．1ength/x )/wky */n sizeof/x (/wkz char/x )/wky )/wky )/wky )/wky 
    exit/x (/wkz OVERFLO．/x )/wky ；/wf 
  T．ch/x [/wkz 0．．S1．1ength/x 一/m 1/m ]/wky =S1．ch/x [/wkz 0．．S1．1ength/x 一/m 1/m ]/wky ；/wf 
  T．1ength=S1．1ength+S2．1ength/x ；/wf 
  T．ch/x [/wkz S1．1ength．．T．1ength/x 一/m 1/m ]/wky =s2．ch/x [/wkz 0．．S2．1ength/x ～/ws 1/m ]/wky ；/wf 
  returnOK/x ；/wf 
  }/n ／／Concat/x 
Status/x  SubString/x (/wkz HString/x &/n Sub/x ，/wd HString/x  S/x ，/wd int/x  pos/x ，/wd int/x  fen/x )/wky {/n 
    ∥/w 用/v Sub/x 返回/v 串/v S/x 的/ude1 第/m pos/x 个/q 字符/n 起/vf 长度/n 为/v fen/x 的/ude1 子/ng 串/v 。/wj 
    ∥/w 其中/rz ，/wd 1≤pos≤StrLength/x (/wkz S/x )/wky 且/c 0≤len≤StrLength/x (/wkz S/x )/wky 一/m pos+1/x 。/wj 
    if/x (/wkz pos/x </n 1/m  l/x 】/wky pos/x >/n S．1ength/x  ll/x  len/x </n 0/m }/n I/x  len/x >/n s．1ength―pos+1/x )/wky 
    return/x  E/x ~/n ROR/x ；/wf 
  if/x (/wkz Sub．ch/x )/wky free/x (/wkz Sub．ch/x )/wky ；/wf 
  if/x (/wkz !/wt len/x )/wky {/n Sub．ch：NULL/x ；/wf Sub．1ength=0/x ；/wf }/n 
  else/x {/n 
    Sub．ch=/x (/wkz char/x */n )/wky mallo/x ~/n (/wkz 1en/x */n sizeof/x (/wkz char/x )/wky )/wky ；/wf 
    Sub．ch/x [/wkz 0．．1en-1/x ]/wky =S/x [/wkz pos-i．．pos+len-2/x ]/wky ；/wf 
    Sub．1ength=lea/x ；/wf 
    I/x 
    return/x  OK/x ；/wf 
＼f/x }/n SubString/x 
∥/w 释放/v 旧/a 空间/n 
∥/w 空子/n 串/q 
∥/w 完整/a 子/ng 串/v 
77・/m 
  4．2．3/m 串/q 的/ude1 块/q 链/ng 存储表示/n 
  和/cc 线性/n 表/n 的/ude1 链式/n 存储/v 结构/n 相/d 类似/a ，/wd 也/d 可/v 采用/v 链/ng 表/vg 方式/n 存储/vn 串/q 值/n 。/wj 由于/c 串/v 结构/n 的/ude1 特殊性/n --/wp 结构/n 中/f 的/ude1 每个/r 数据/n 元素/n 是/vshi 一个/mq 字符/n ，/wd 则/c 用/v 链/ng 表存储/n 串/q 值/n 时/ng ，/wd 存在/v 一个/mq “/wyz 结点/n 大/a 小/a ”/wyy 的/ude1 问题/n ，/wd 即/v 每个/r 结点/n 可以/v 存放/v 一个/mq 字符/n ，/wd 也/d 可以/v 存放/v 多/m 个/q 字符/n 。/wj 例如/v ，/wd 图/n 4．2/m (/wkz a/x )/wky 是/vshi 结点/n 大小/n 为/p 4/m (/wkz 即/v 每个/r 结点/n 存放/v 四/m 个/q 字符/n )/wky 的/ude1 链/ng 表/n ，/wd 图/n 4．2/m (/wkz b/x )/wky 是/vshi 结点/n 大小/n 为/p 1/m 的/ude1 链/ng 表/n 。/wj 当/p 结点/n 大小/n 大/a 于/p 1时/t ．/w 由于/c 串/v 长/a 不/d 一定/d 是/vshi 结点/n 大小/n 的/ude1 整/m 倍数/n ，/wd 则/d 链/ng 表/n 中/f 的/ude1 最后/f 一个/mq 结点/n 不/d 一定/d 全/a 被/pbei 串/v 值/v 占/v 满/a ，/wd 此时/r 通常/d 补/v 上/vf “/wyz #/n ”/wyy 或/c 其它/rz 的/ude1 非/b 串/v 值/v 字符/n (/wkz 通常/d “/wyz #/n ”/wyy 不/d 属于/v 串/v 的/ude1 字符集/n ，/wd 是/vshi 一个/mq 特殊/a 的/ude1 符号/n )/wky 。/wj 
head/x 
(/wkz a/x )/wky 
head/x 
    (/wkz b/x )/wky 
    图/n 4．2/m 串/q 值/n 的/ude1 链/ng 表存储/n 方式/n 
(/wkz a/x )/wky 结点/n 大小/n 为/p 4/m 的/ude1 链/ng 表/n ；/wf   (/wkz b/x )/wky 结点/n 大小/n 为/v l/x 的/ude1 链/ng 表/n 。/wj 
    为了/p 便于/v 进行/vx 串/v 的/ude1 操作/vn ，/wd 当/v 以/p 链/ng 表存储/n 串/q 值/n 时/ng ，/wd 除/p 头/n 指针/n 外/f 还/d 可/v 附设/v 一个/mq 尾/ng 指针/n 指示/n 链/ng 表/n 中/f 的/ude1 最后/f 一个/mq 结点/n ，/wd 并/cc 给/v 出/vf 当前/t 串/v 的/ude1 长度/n 。/wj 称/v 如此/rzv 定义/n 的/ude1 串存储/n 结构/n 为/v 块/q 链结构/n ．/w 说明/v 如下/vi ：/wp 
    ∥/w ：/wp ==/m 串/q 的/ude1 块/q 链/ng 存储表示/n ：/wp =/m …/ws =/m 
    #/n define/x  CHUNKSIZE/x  80/m     ∥/w 可/v 由/p 用户/n 定义/n 的/ude1 块/q 大/a 小/a 
    tyP/x |/n def/x  struct/x  Chunk/x {/n 
    char/x   ch/x [/wkz c/x 【/wkz zE/x ]/wky ；/wf 
    8truct/x  Chunk/x */n next：/x 
    }/n Chunk/x ；/wf 
    typed/x ~/n struct/x {/n 
    Chunk/x */n ．/w head/x ，/wd */n tall/x ；/wf     ∥/w 串/v 的/ude1 头/n 和/cc 尾/ng 指针/n 
    int/x   curlen/x ；/wf     ∥/w 串/v 的/ude1 当前/t 长度/n 
    }/n LString/x ；/wf 
    由于/c 在/p 一般/a 情况/n 下/f ，/wd 对/p 串/v 进行/vx 操作/vn 时/ng ，/wd 只/d 需要/v 从/p 头/n 向/p 尾/ng 顺序/n 扫描/vn 即可/v ，/wd 贝/b t/x !/wt 对/p 串/q 值/n 不必/d 建立/v 双向/b 链/ng 表/n 。/wj 设/v 尾/ng 指针/n 的/ude1 目的/n 是/vshi 为了/p 便于/v 进行/vx 联结/vn 操作/vn ，/wd 但/c 应/v 注意/v 联结/v 时/ng 需/v 处理/v 第一/m 个/q 串/v 尾/ng 的/ude1 无效/vn 字符/n 。/wj 
    在/p 链式/n 存储方式/n 中/f ，/wd 结点/n 大小/n 的/ude1 选择/vn 和/cc 顺序/n 存储方式/n 的/ude1 格式/n 选择/v 一样/uyy 都/d 很/d 重要/a ，/wd 它/rr 直接/ad 影响/v 着/uzhe 串/v 处理/v 的/ude1 效率/n 。/wj 在/p 各种/rz 串/q 的/ude1 处理/vn 系统/n 中/f ，/wd 所/usuo 处理/v 的/ude1 串/n 往往/d 很/d 长/a 或/c 很/d 多/a 。/wj 例如/v ，/wd 一/m 本/q 书/n 的/ude1 几百万/m 个/q 字符/n ，/wd 情报/n 资料/n 的/ude1 成千上万/vl 个/q 条目/n 。/wj 这/rzv 要求/v 我们/rr 考虑/v 串/q 值/n 的/ude1 存储密度/n 。/wj 
存储密度/n 可/v 定义/n 为/v 
    存储密度/n ：/wp 
    显然/a ，/wd 存储密度/n 小/a (/wkz 如/v 结点/n 大小/n 为/p 1时/t )/wky ，/wd 运算/vi 处理/v 方便/an ，/wd 然而/c ，/wd 存储/v 占用/v 量/n 大/a 。/wj 如果/c 在/p 串/v 处理过程/n 中/f 需/v 进行/vx 内/f 、/wn 外存/n 交换/v 的/ude1 话/n ，/wd 则/c 会/v 因为/p 内外/f 存/v 交换操作/n 过/uguo 多/m 而/cc 影响/vn 处理/vn 的/ude1 总/b 效率/n 。/wj 应该/v 看到/v ，/wd 串/v 的/ude1 字符集/n 的/ude1 大小/n 也/d 是/vshi 一个/mq 重要/a 因素/n 。/wj 一般/a 地/ude2 ，/wd 字符集/n 小/a ，/wd 则/c 字符/n 的/ude1 机/ng 内/f 编码/n 就/d 短/a ，/wd 这/rzv 也/d 影响/v 串/q 值/n 的/ude1 存储方式/n 的/ude1 选取/v 。/wj 
    串/v 值/n 的/ude1 链式/n 存储/v 结构/n 对/p 某些/rz 串/q 操作/vn ，/wd 如/c 联接/v 操作/v 等/udeng 有/vyou 一定/d 方便/v 之/uzhi 处/n ，/wd 但/c 总的说来/c 不如/v 另外/rz 两/m 种/q 存储/vn 结构/n 灵活/a ，/wd 它/rr 占用/v 存储量/n 大/a 且/c 操作/v 复杂/a 。/wj 此外/c ，/wd 串/v 值/v 在/p 链式/n 存储/v 结构/n 时/ng 串/v 操作/v 的/ude1 实现/vn 和/cc 线性/n 表/vg 在/p 链/ng 表存储/n 结构/n 中/f 的/ude1 操作/vn 类似/a ，/wd 故/c 在/p 此/rzs 不/d 作/v 详细/ad 讨论/v 。/wj 
    4．3/m   串/v 的/ude1 模式匹配/n 算法/n     
    4．3．1/m 求/v 子/ng 串/v 位置/n 的/ude1 定位/vn 函数/n Index/x (/wkz s/x 。/wj T/x 。/wj pos/x )/wky 
    子/ng 串/v 的/ude1 定位操作/n 通常/d 称作/v 串/v 的/ude1 模式匹配/n (/wkz 其中/rz T/x 被/pbei 称为/v 模式/n 串/q )/wky 。/wj 是/vshi 各种/rz 串/q 处理/vn 系统/n 中/f 最/d 重要/a 的/ude1 操作/vn 之一/rz 。/wj 在/p 4．1/m 节/q 中曾/nrj 借用/v 串/v 的/ude1 其他/rzv 基本/ad 操作/v 给/v 出/vf 了/ule 定位/vn 函数/n 的/ude1 一/m 种/q 算法/n 。/wj 根据/p 算法/n 4．1/m 的/ude1 基本思想/n ，/wd 采用/v 定/v 长/a 顺序/n 存储/vn 结构/n ，/wd 可以/v 写/v 出/vf 不/d 依赖/v 于/p 其他/rzv 串/q 操作/vn 的/ude1 匹配/vn 算法/n ，/wd 如/v 算法/n 4．5/m 所/usuo 示/vg 。/wj 
int/x  Index/x (/wkz SString/x  s/x ，/wd SString/x  T/x ，/wd int/x  pos/x )/wky {/n     
    ∥/w 返回/v 子/ng 串/v T/x 在/p 主/ag 串/v s/x 中/f 第/m pos/x 个/q 字符/n 之后/f 的/ude1 位置/n 。/wj 若/c 不/d 存在/v ，/wd 则/c 函数值/n 为/p 0/m 。/wj 
    ∥/w 其中/rz ，/wd T/x 非空/n ，/wd 1≤pos≤strLength/x (/wkz s/x )/wky 。/wj 
    i=pos/x ；/wf     j=1/x ；/wf 
    while/x (/wkz 1/m </n =sE0/x ]/wky &/n &/n j/x </n =T/x [/wkz O/x ]/wky )/wky {/n 
    if/x (/wkz s/x [/wkz i/x ]/wky =T/x [/wkz j/x ]/wky )/wky {/n ++i/x ；/wf     ++j/x ；/wf }/n   ∥/w 继续/v 比较/d 后/f 继/vg 字符/n 
    ele/x {/n i=i―j+2/x ；/wf     j=1/x ；/wf l/x     ∥/w 指针/n 后退/vi 重新/d 开始/v 匹配/vi 
    }/n 
    if/x (/wkz j/x >/n T/x [/wkz 0/m ]/wky )/wky return/x  1-T/x [/wkz 0/m ]/wky ；/wf 
    else/x  return/x  0：/m 
}/n ∥/w Index/x 
算法/n 4．5/m 
    在/p 算法/n 4．5/m 的/ude1 函数/n 过程/n 中/f ，/wd 分别/d 利用/v 计数/vi 指针/n i/x 和/cc j/x 指示/n 主/ag 串/v S/x 和/cc 模式/n 串/v T/x 中/f 当前/t 正/d 待/vi 比较/v 的/ude1 字符/n 位置/n 。/wj 算法/n 的/ude1 基本思想/n 是/vshi ：/wp 从/p 主/ag 串/v s/x 的/ude1 第/m pos/x 个/q 字符/n 起/vf 和/cc 模式/n 的/ude1 第一/m 个/q 字符/n 比较/d 之/uzhi ，/wd 若/c 相等/vi ，/wd 则/c 继续/v 逐个/d 比较/d 后续/v 字符/n ，/wd 否则/c 从/p 主/ag 串/v 的/ude1 下/vf 一个/mq 字符/n 起/vf 再/d 重新/d 和/cc 模式/n 的/ude1 字符/n 比较/d 之/uzhi 。/wj 依次/d 类推/vi ，/wd 直至/v 模式/n T/x 中/f 的/ude1 每个/r 字符/n 依次/d 和/cc 主/ag 串/v S/x 中/f 的/ude1 一个/mq 连续/a 的/ude1 字符/n 序列/n 相等/vi ，/wd 则/c 称/v 匹配/vi 成功/an 。/wj 函数值/n 为/v 和/cc 模式/n T/x 中/f 第一/m 个/q 字符/n 相等/vi 的/ude1 字符/n 在/p 主/ag 串/v s/x 中/f 的/ude1 序号/n ，/wd 否则/c 称/v 匹配/vi 不/d 成功/a ，/wd 函数值/n 为/p 零/m 。/wj 图/n 4．3/m 展示/v 了/ule 模式/n T=/x ’/wyy abcac・/x ’/wyy 和/cc 主/ag 串/v S/x 的/ude1 匹配/vn 过程/n (/wkz pos=1/x )/wky 。/wj 
    算法/n 4．5/m 的/ude1 匹配/vn 过程/n 易/vg 於/nr1 理解/v ，/wd 且/c 在/p 某些/rz 应用/vn 场合/n ，/wd 如/v 文本/n 编辑/n 等/udeng ，/wd 效率/n 也/d 较/d 高/a ，/wd 例如/v ，/wd 在/p 检查/vn 模式/n ’/wyy sTING/x ’/wyy 是否/v 存在/v 於/nr1 下列/b 主/n 串/q 中/f 时/ng ，/wd 
    ’/wyy A/x  STRING/x  SEARCFIING/x  EXAMPI/x 。/wj E/x  C/x (/wkz )/wky NSIS/x '/n TING/x  OF/x  SIMPI/x ，/wd E/x  TEXT/x ’/wyy 
上述/b 算法/n 中/f 的/ude1 Wt/x _/n IILE/x 循环/vn 次数/n (/wkz 即/v 进行/vx 单个/b 字符/n 比较/vn 的/ude1 次数/n )/wky 为/p 41/m ，/wd 恰好/d 为/v (/wkz Index+T/x [/wkz 0/m ]/wky 一/m 1/m )/wky +4/m 这就是说/c ，/wd 除了/p 主/ag 串/v 中/f 呈/v 黑体/n 的/ude1 四/m 个/q 字符/n ，/wd 每个/r 字符/n 比较/d 了/ule 两/m 次/qv 以外/f ，/wd 其它/rz 字符/n 均/d 只/d 和/cc 模式/n 进行/vx 一/m 次比较/n 。/wj 在/p 这种/r 情况/n 下/f ，/wd 此/rzs 算法/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n+m/x )/wky 。/wj 其中/rz n/x 和/cc m/x 分别/d 为/v 主/ag 串/v 和/cc 模式/n 的/ude1 长度/n 。/wj 然而/c ，/wd 在/p 有些/rz 情况/n 下/f ，/wd 该/rz 算法/n 的/ude1 效率/n 却/d 很/d 低/a 。/wj 例如/v ，/wd 当/p 模式/n 串/q 为/v “/wyz 0000000/m  1/m ’/wyy ，/wd 而/cc 主/ag 串/v 为/v ’/wyy 000000000000000000000000000/m     。/wj “/wyz cJ：/x ，/wd 0000000000000000000000000l/x ’/wyy 时/ng ，/wd 由于/c 模式/n 中/f 前/f 7/m 个/q 字符/n 均/d 为/v “/wyz 0/m ”/wyy ，/wd 每/rz 趟/qv 比较/d 都/d 在/p 模式/n 的/ude1 最后/f 一个/mq 字符/n 出现/v 不/d 等/v ，/wd 此时/r 需/v 将/p 指针/n i/x 回溯/v 到/v i/x 一/m 6/m 的/ude1 位置/n 上/f ，/wd 并/cc 从/p 模式/n 的/ude1 第一/m 个/q 字符/n 开始重新/n 比较/v ，/wd 整个/b 匹配/vn 过程/n 中/b 指针/n i/x 需/v 回溯/v 45/m 次/qv ，/wd 则/d  wHILE/x 循环/vn 次数/n 为/p 46/m */n 8/m (/wkz index/x */n m/x )/wky 。/wj 可见/c ，/wd 算法/n 4．/m   在/p 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n/x */n m/x )/wky 。/wj 这种/r 情况/n 在/p 只/d 有/vyou 0/m 、/wn 1/m 两/m 种/q 字符/n 的/ude1 文本/n 串/q 处理/vn 中/f 经常出现/n ，/wd 因为/c 在/p 主/ag 串/v 中/f 可能/v 存在/v 多/m 个/q 和/cc 模式/n 串/q “/wyz 部分/n 匹配/vi ”/wyy 的/ude1 子/ng 串/v ，/wd 因而/c 引起/v 指针/n i/x 的/ude1 多次/mq 回溯/vn 。/wj 01/m 串/q 可以/v 用/v 在/p 许多/m 应用/vn 之中/f 。/wj 比如/v ，/wd 一些/mq 计算机/n 的/ude1 图形/n 显示/v 就是/v 把/pba 画面/n 表示/v 为/v 一个/mq 01/m 串/q ，/wd 一/m 页/q 书/n 就/d 是/vshi 一个/mq 几百万/m 个/q 0/m 和/cc l/x 组成/v 的/ude1 串/q 。/wj 在/p 二进位/n 计算机/n 上/f 实际/ad 处理/v 的/ude1 都/d 是/vshi 01/m 串/q 。/wj 一个/mq 字符/n 的/ude1 ．/w ASCII/x 码/v 也/d 可以/v 看成/v 是/vshi 八/m 个/q 二进位/n 的/ude1 01/m 串/q 。/wj 包括/v 汉字存储/n 在/p 计算机/n 中/f 处理/v 时/ng 也/d 是/vshi 作为/v 一个/mq 01/m 串/q 和/cc 其它/rz 的/ude1 字符串/n 一样/uyy 看待/v 。/wj 因此/c 在/p 下/f 一/m 节/q ，/wd 我们/rr 将/d 介绍/v 另/rz 一/m 种/q 较/d 好/a 的/ude1 模式匹配/n 算法/n 。/wj     
4．3．2/m 模式匹配/n 的/ude1 一/m 种/q 改进/v 算法/n 
    这种/r 改进/v 算法/n 是/vshi D．E．Knuth/x 与/p V．R．Pratt/x 和/cc J．H．Morris/x 同时/n 发现/v 的/ude1 ，/wd 因此/c 人们/n 称/v 它/rr 为/p 克努特/nrf 一/m 莫里斯/nrf 一/m 普拉/nrf 特/d 操作/v (/wkz 简称/v 为/v KMP/x 算法/n )/wky 。/wj 此/rzs 算法/n 可以/v 在/p 0/m (/wkz n+m/x )/wky 的/ude1 时/ng 第一/m 趟/qv 匹配/vi a/x  b/x     a/x   b/x 
第二/m 趟/qv 匹配/vi a/x  b/x 
‘/wyz i=3/x 
a/x   b/x   c/x   a/x   b/x   c/x 
C/x 
+j=3/x 
●/w i/x 一/m 0i=/x 
a/x   b/x   c/x   a/x   b/x   c/x 
    a/x   b/x   C/x   a/x   c/x 
    +-+-j=5/x 
    j=1+i/x 一/m 0i：11/x 
第三/m 趟/qv 匹配/vi a/x  b/x  a/x  b/x  c/x  a/x  b/x  c/x  a/x  c/x  b/x  a/x  b/x 
    (/wkz a/x )/wky b/x   c/x   a/x   c/x 
    j=6/x 
    j=2/x 
图/n 4．4/m 改进/v 算法/n 的/ude1 匹配/vn 过程/n 示例/n 
间/f 数量级/n 上/f 完成/v 串/v 的/ude1 模式匹配/n 操作/vn 。/wj 其/rz 改进/v 在/p 於/nr1 ：/wp 每当/p 一/m 趟/qv 匹配/vn 过程/n 中/f 出现/v 字符/n 比较/d 不等/vi 时/ng ，/wd 不/d 需/v 回溯/v i/x 指针/n ，/wd 而是/c 利用/v 已经/d 得到/v 的/ude1 “/wyz 部分/n 匹配/vi ”/wyy 的/ude1 结果/n 将/p 模式/n 向/p 右/f “/wyz 滑动/vi ”/wyy 尽可能/d 远/a 的/ude1 一/m 段距离/n 后/f ，/wd 继续/v 进行/vx 比较/vn 。/wj 下面/f 先/d 从/p 具体/a 例子/n 看/v 起/vf 。/wj 
    回顾/v 图/n 4．3/m 中/f 的/ude1 匹配/vn 过程/n 示例/n ，/wd 在/p 第三/m 趟/qv 的/ude1 匹配/vn 中/f ，/wd 当/v i=7/x 、/wn ．/w j=5/x 字符/n 比较/d 不等/vi 时/ng ，/wd 又/d 从/p 净/a 4/m 、/wn ．/w j=1/x 重新/d 开始/v 比较/vn 。/wj 然后/c ，/wd 经/p 仔细/ad 观察/v 可/v 发现/v ，/wd 在/p i=4/x 和/cc j=1/x ，/wd 卢/b 5/m 和/cc j=l/x 以及/cc i=6/x 和/cc J=1/x 这/rzv 三/m 次比较/n 都/d 是/vshi 不必/d 进行/vx 的/ude1 。/wj 因为/c 从/p 第三/m 趟/qv 部分/n 匹配/vi 的/ude1 结果/n 就/d 可/v 得/ude3 出/vf ，/wd 主/ag 串/v 中/f 第4/m 、/wn 5/m 和/cc 6/m 个/q 字符/n 必然/d 是/vshi ‘/wyz b/x ’/wyy 、/wn ‘/wyz c/x ’/wyy 和/cc ‘/wyz a/x ’/wyy (/wkz 即/v 模式/n 串/q 中/f 第2/m 、/wn 3/m 和/cc 4/m 个/q 字符/n )/wky 。/wj 因为/p 模式/n 中/f 的/ude1 第一/m 个/q 字符/n 是/vshi n/x ，/wd 因此/c 它/rr 无需/v 再/d 和/cc 这/rzv 三/m 个/q 字符/n 进行/vx 比较/vn ，/wd 而/cc 仅/d 需/v 将/p 模式/n 向/p 右/f 滑动/vi 三/m 个/q 字符/n 的/ude1 位置/n 继续/v 进行/vx i=7/x 、/wn j=2/x 时/ng 的/ude1 字符/n 比较/d 即可/v 。/wj 同/p 理/n ，/wd 在/p 第一/m 趟/qv 匹配/vi 中/f 出现/v 字符/n 不等/vi 时/ng ，/wd 仅/d 需/v 将/p 模式/n 向/p 右/f 移动/v 二/m 个/q 字符/n 的/ude1 位置/n 继续/v 进行/vx i=3/x 、/wn J=1/x 时/ng 的/ude1 字符/n 比较/vn 。/wj 由此/d ，/wd 在/p 整个/b 匹配/vi 的/ude1 过程/n 中/f ，/wd i/x 指针/n 没有/d 回溯/v ，/wd 如/v 图/n 4．4/m 所/usuo 示/vg 。/wj 
　　现在/t 讨论/v 一般/a 情况/n 。/wj 假设/n 主/ag 串/v 为/p 01/m  s2/x …/ws s/x 。/wj ’/wyy ，/wd 模式/n 串/q 为/v ’/wyy 12/m …/ws p/x 。/wj ’/wyy ，/wd 从/p 上/f 例/n 的/ude1 分析/vn 可知/v ，/wd 为了/p 实现/v 改进/v 算法/n ，/wd 需要/v 解决/v 下/f 述/vg 问题/n ：/wp 当/v 匹配/vi 过程/n 中/f 产生/v “/wyz 失/v 配/v ”/wyy (/wkz 即/v si≠pi/x )/wky 时/ng ，/wd 模式/n 串/q “/wyz 向/p 右/f 滑动/vi ”/wyy 可行/a 的/ude1 距离/n 多/m 远/a ，/wd 换句话说/c ，/wd 当/v 主/ag 串/v 中/f 第/m i/x 个/q 字符/n 与/cc 模式/n 中/f 第/m 歹/ag 个/ng 字符/n “/wyz 失/v 配/v ”/wyy (/wkz 即/v 比较/d 不等/vi )/wky 时/ng ，/wd 主/ag 串/v 中/f 第/m i/x 字符/n (/wkz i/x 指针/n 不/d 回溯/v )/wky 应/v 与/p 模式/n 中/f 哪个/ry 字符/n 再/d 比较/d ?/ww 
　　假设/n 此时/r 应/v 与/p 模式/n 中/f 第/m k/x (/wkz k/x </n j/x )/wky 个/q 字符/n 继续/v 比较/vn ，/wd 则/c 模式/n 中/f 前/f k/x 一/m 1/m 个/q 字符/n 的/ude1 子/ng 串/v 必须/d 满足/v 下列/b 关系式/n (/wkz 4―2/m )/wky ，/wd 且/c 不/d 可能/v 存在/v k/x ’/wyy >/n k/x 满足/v 下列/b 关系式/n (/wkz 4．2/m )/wky     ’/wyy 1p2/x …/ws p/x ^/n 一/m 1/m ’/wyy ：/wp ’/wyy ^/n +1/m  si+2/x …/ws 一/m 1/m ’/wyy     (/wkz 4―2/m )/wky 
而/cc 已经/d 得到/v 的/ude1 “/wyz 部分/n 匹配/vi ”/wyy 的/ude1 结果/n 是/vshi  ’/wyy ～/ws ^/n +1/m ^/n +2/m …/ws 1/m ’/wyy =/m ’/wyy ^/n +1/m  si/x 一/m ^/n +2/m …/ws 5i/x 一/m 1/m ’/wyy   (/wkz 4―3/m )/wky 
由/p (/wkz 4．2/m )/wky 和/cc (/wkz 4―3/m )/wky 推/v 得/ude3 下列/b 等式/n   ■/n 12/m …/ws A1/x ’/wyy =/m 一/m ^/n +1/m ^/n +2/m …/ws 一/m 1/m ’/wyy     (/wkz 4―4/m )/wky 
反之/c ，/wd 若/c 模式/n 串/q 中/f 存在/v 满足/v 式/k (/wkz 4．4/m )/wky 的/ude1 两/m 个/q 子/ng 串/v ，/wd 则/c 当/v 匹配/vi 过程/n 中/f ，/wd 主/ag 串/v 中/f 第/m i/x 个/q 字符/n 与/cc 模式/n 中/f 第/m 歹/ag 个/ng 字符/n 比较/d 不等/vi 时/ng ，/wd 仅/d 需/v 将/p 模式/n 向/p 右/f 滑动/vi 至/p 模式/n 中/f 第/m 忌/v 个/q 字符/n 和/cc 主/n 串/q 中/f 第/m i/x 个/q 字符/n 对齐/v ，/wd 此时/r ，/wd 模式/n 中/b 头/n k-1/x 个/q 字符/n 的/ude1 子/ng 串/v ’/wyy 12/m …/ws A/x 一/m 1/m ’/wyy 必定/d 与/p 主/ag 串/v 中/f 第/m i/x 个/q 字符/n 之前/f 长度/n 为/v k-1/x 的/ude1 子/ng 串/v ’/wyy s/x ，/wd ^/n +1/m &/n 。/wj +2/m …/ws s/x ；/wf 1/m 。/wj 相等/vi ，/wd 由此/d ，/wd 匹配/vi 仅/d 需/v 从/p 模式/n 中/f 第/m k/x 个/q 字符/n 与/p 主/ag 串/v 中/f 第/m i/x 个/q 字符/n 比较/d 起/vf 继续/v 进行/vx 。/wj 
    若/c 令/v nex￡/x [/wkz j/x ]/wky =/m ，/wd 则/d n￡/x [/wkz j/x ]/wky 表明/v 当/p 模式/n 中/f 第/m j/x 个/q 字符/n 与/p 主/ag 串/v 中/f 相应/vi 字符/n “/wyz 失/v 配/v ”/wyy 时/ng ，/wd 在/p 模式/n 中/f 需/v 重新/d 和/cc 主/n 串/q 中/f 该/rz 字符/n 进行/vx 比较/vn 的/ude1 字符/n 的/ude1 位置/n 。/wj 由此/d 可/v 引出/v 模式/n 串/q 的/ude1 nex￡/x 函数/n 的/ude1 定义/n ：/wp 
    f0/x     当/p =1/m 时/ng 
    next/x …/ws ：/wp l/x  Max-/x {/n kI/x ’/wyy </n k/x </n j/x "/n l/x ’/wyy 。/wj ■/n Ⅲ/m l/x …/ws l/x ’/wyy }/n     (/wkz 4―51/m 
    nem/x 【/wkz ’/wyy J/x 。/wj 1/m     当/p 此/rzs 集合/v 不/d 空/v 时/ng     “/wyz 。/wj 。/wj “/wyz ‘/wyz     (/wkz 4―5/m )/wky 
    11/m     其它/rz 情况/n 
由此/d 定义/v 可/v 推出/v 下列/b 模式/n 串/q 的/ude1 next/x 函数值/n ：/wp 在/p 求得/v 模式/n 的/ude1 next/x 函数/n 之后/f ，/wd 匹配/vi 可/v 如/v 下/f 进行/vx ：/wp 假设/v 以/p 指针/n i/x 和/cc j/x 分别/d 指示/v 主/ag 串/v 和/cc 模式/n 中/f 正/d 待/vi 比较/v 的/ude1 字符/n ，/wd 令/v i/x 的/ude1 初值/n 为/v pos/x ，/wd j/x 的/ude1 初值/n 为/p 1/m 。/wj 若/c 在/p 匹配/vi 过程/n 中/f si=pj/x ，/wd 则/d i/x 和/cc j/x 分别/d 增/v 1/m ，/wd 否则/c ，/wd i/x 不/d 变/v ，/wd 而/cc j/x 退/v 到/v n￡/x [/wkz J/x ]/wky 的/ude1 位置/n 再/d 比较/v ，/wd 若/c 相等/vi ，/wd 则/c 指针/n 各自/rr 增/v 1/m ，/wd 否则/c j/x 再/d 退/v 到/v 下/vf 一个/mq ”/wyy 的/ude1 位置/n ，/wd 依次/d 类推/vi ，/wd 直至/v 下列/b 两/m 种/q 可能/n ：/wp 一/m 种/q 是/vshi j/x 退/v 到/v 某个/rz next/x 值/n 时/ng 字符/n 比较/d 相等/vi ，/wd 则/c 指针/n 各自/rr 增/v 1/m 继续/v 进行/vx 匹配/vn ；/wf 另/rz 一/m 种/q 是/vshi j/x 退/v 到/v 值/v 为/p 零/m (/wkz 即/v 模式/n 的/ude1 第一/m 个/q 字符/n “/wyz 失/v 配/v ”/wyy )/wky ，/wd 则/c 此时/r 需/v 将/p 模式/n 继续/v 向/p 右/f 滑动/vi 一个/mq 位置/n 。/wj 即/v 从/p 主/ag 串/v 的/ude1 下/vf 一个/mq 字符/n si+/x ，/wd 起/vf 和/cc 模式/n 重新/d 开始/v 匹配/vi 。/wj 图/n 4．5/m 所/usuo 示/vg 正是/v 上述/b 匹配/vn 过程/n 的/ude1 一个/mq 例子/n 。/wj 
    KMP/x 算法/n 如/v 算法/n 4．6/m 所/usuo 示/vg ，/wd 它/rr 在/p 形式/n 上/f 和/cc 算法/n 4．5/m 极为/d 相似/a 。/wj 不同/a 之/uzhi 处/n 仅/d 在/p 於/nr1 ：/wp 当/v 
匹配/vi 过程/n 中/f 产生/v “/wyz 失/v 配/v ”/wyy 时/ng ，/wd 指针/n i/x 不/d 变/v ，/wd 指针/n J/x 退回/v 到/v next/x [/wkz j/x ]/wky 所/usuo 指示/v 的/ude1 位置/n 上/f 重新/d 进行/vx 比较/vn ，/wd 并且/c 当/p 指针/n j/x 退/v 至/p 零时/t ，/wd 指针/n i/x 和/cc 指针/n j/x 需/v 同时/c 增/v 1/m 。/wj 即若/c 主/ag 串/v 的/ude1 第/m i/x 个/q 字符/n 和/cc 模式/n 的/ude1 第1/m 个/q 字符/n 不等/vi ，/wd 应/v 从/p 主/ag 串/v 的/ude1 第/m i+1/x 个/q 字符/n 起/vf 重新/d 进行/vx 匹配/vn 。/wj 
int/x  Index/x 一/m 硒/n 但/c (/wkz SString/x  S/x ，/wd SString/x  T/x ，/wd in％pos/x )/wky {/n 
    ∥/w 利用/v 模式/n 串/v T/x 的/ude1 next/x 函数/n 求/v T/x 在/p 主/ag 串/v S/x 中/f 第/m pos/x 个/q 字符/n 之后/f 的/ude1 位置/n 的/ude1 
    //n //n KMP/x 算法/n 。/wj 其中/rz ，/wd T/x 非空/n ，/wd 1≤pos≤StrLength/x (/wkz S/x )/wky 。/wj 
    i/x  z/x  pos/x ；/wf     J=1/x ；/wf 
    ．/w hile/x (/wkz i/x </n =S/x [/wkz 0/m ]/wky &/n ＆/n J/x </n =T/x [/wkz 0/m ]/wky )/wky {/n 
    if/x (/wkz J：0/x  lj/x  s/x [/wkz i/x ]/wky =T/x [/wkz J/x ]/wky )/wky {/n ++i/x ；/wf   ++J/x ；/wf }/n     ∥/w 继续/v 比较/d 后/f 继/vg 字符/n 
    else/x  J=next/x [/wkz j/x ]/wky ；/wf     ／／/m 模式/n 串/v 向/p 右/f 移动/v 
    }/n 
    if/x (/wkz J/x >/n T/x [/wkz 0/m ]/wky )/wky return/x  i―T/x [/wkz 0/m ]/wky 
    else/x  return/x  0/m ；/wf 
＼/m ?/ww f/x  Index―KMP/x 
算法/n 4．6/m 
∥/w 匹配/vi 成功/an 
    KMP/x 算法/n 是/vshi 在/p 已/d 知/v 模式/n 串/q 的/ude1 next/x 函数值/n 的/ude1 基础/n 上/f 执行/v 的/ude1 ，/wd 那么/c ，/wd 如何/ryv 求得/v 模式/n 串/q 的/ude1 next/x 函数值/n 呢/y ?/ww 
    从/p 上述/b 讨论/vn 可见/c ，/wd 此/rzs 函数值/n 仅/d 取决于/v 模式/n 串/v 本身/rz 而/cc 和/cc 相/d 匹配/vi 的/ude1 主/ag 串/v 无关/v 。/wj 我们/rr 可/v 从/p 分析/v 其/rz 定义/n 出发/vi 用/p 递推/n 的/ude1 方法/n 求得/v next/x 函数值/n 。/wj 
  由/p 定义/n 得知/v     
    nex/x [/wkz [/wkz 1/m ]/wky =0/m     (/wkz 4―6/m )/wky 
设/v n/x ~/n xt/x [/wkz j/x ]/wky =k/x ，/wd 这/rzv 表明/v 在/p 模式/n 串/q 中/f 存在/v 下列/b 关系/n ：/wp 
    ≯1/m …/ws Pl/x 一/m 1/m ’/wyy =/m ’/wyy 岛/n 一/m ^/n +1/m …/ws 户/q 卜/vg 1/m     (/wkz 4．7/m )/wky 
其中/rz k/x 为/p 满足/v l/x </n k/x </n J/x 的/ude1 某个/rz 值/n ，/wd 并且/c 不/d 可能/v 存在/v k/x ’/wyy >/n k/x 满足/v 等式/n (/wkz 4―7/m )/wky 。/wj 此时/r next/x [/wkz j+1/x ]/wky =/m ?/ww 可能/v 有/vyou 两/m 种/q 情况/n ：/wp 
    (/wkz 1/m )/wky 若/v m：p/x ，/wd ，/wd 则/c 表明/v 在/p 模式/n 串/q 中/f 
    ’/wyy p1/x …/ws p/x ＆/n ’/wyy =/m ’/wyy 夕/tg ，/wd 一/m t+1/x …/ws p/x }/n ’/wyy     (/wkz 4―8/m )/wky 
并且/c 不/d 可能/v 存在/v 忌/v ’/wyy >/n 是/vshi 满足/v 等式/n (/wkz 4―8/m )/wky ，/wd 这就是说/c next/x [/wkz j+1/x ]/wky =k+1/x ，/wd 即/v 
next/x [/wkz j+1/x ]/wky ：/wp next/x [/wkz j/x ]/wky +1/m     (/wkz 4―9/m )/wky 
    (/wkz 2/m )/wky 若/v 仇/n ≠p/x ，/wd ，/wd 则/c 表明/v 在/p 模式/n 串/q 中/f 
    ‘/wyz pl/x …/ws p/x  E/x ‘/wyz ≠/w ‘/wyz p/x 卜/vg k+l/x …/ws pij/x 
此时/r 可/v 把/pba 求/v next/x 函数值/n 的/ude1 问题/n 看成/v 是/vshi 一个/mq 模式匹配/n 的/ude1 问题/n ，/wd 整个/b 模式/n 串/v 既/c 是/vshi 主/n 串/q 又/d 是/vshi 模式/n 串/q ，/wd 而/cc 当前/t 在/p 匹配/vi 的/ude1 过程/n 中/f ，/wd 已/d 有/vyou p/x 卜/vg E+1=/x 乡/n 1/m ，/wd p/x ，/wd 一/m ^/n +2=p2/x ，/wd …/ws ，/wd 1=m/x 一/m 1/m ，/wd 则/c 当/p 岛/n ≠/w 以/p 时/ng 应/v 将/p 模式/n 向/p 右/f 滑动/vi 至/p 以/p 模式/n 中/f 的/ude1 第/m next/x [/wkz k/x ]/wky 个/q 字符/n 和/cc 主/n 串/q 中/f 的/ude1 第/m j/x 个/q 字符/n 相/d 比较/v 。/wj 若/v next/x [/wkz k/x ]/wky =k/x ’/wyy ，/wd 且/c 户/ng ，/wd =/m 仇/n ，/wd ，/wd 则/c 说明/v 在/p 主/ag 串/v 中/f 第/m j+1/x 个/q 字符/n 之前/f 存在/v 一个/mq 长度/n 为/p 忌/v ‘/wyz (/wkz 即/v next/x [/wkz k/x ]/wky )/wky 的/ude1 最/d 长子/n 串/q ，/wd 和/cc 模式/n 串/q 中/f 从/p 首/m 字符/n 起/vf 长度/n 为/v 是/vshi ’/wyy 的/ude1 子/ng 串/v 相等/vi ，/wd 即/v     (/wkz 4―10/m )/wky 
这就是说/c next/x [/wkz j/x 十/m 1/m ]/wky =k/x ’/wyy 十/m 1/m 即/v 
    next/x [/wkz j+1/x ]/wky ：/wp next/x [/wkz k/x ]/wky +1/m     (/wkz 4―11/m )/wky 
同/p 理/n ，/wd 若/c A≠A/x ，/wd ，/wd 则/c 将/p 模式/n 继续/v 向/p 右/f 滑动/vi 直至/v 将/p 模式/n 中/f 第/m next/x [/wkz k/x ’/wyy ]/wky 个/q 字符/n 和/cc 岛/n 对齐/v ，/wd …/ws …/ws ，/wd 依次/d 类推/vi ，/wd 直至/v A/x 和/cc 模式/n 中/f 某个/rz 字符/n 匹配/vi 成功/a 或者/c 不/d 存在/v 任何/rz 是/vshi ’/wyy (/wkz 1/m </n 足/ng ’/wyy </n j/x )/wky 满足/v 等式/n (/wkz 4―10/m )/wky ，/wd 则/d     next/x [/wkz j+1/x ]/wky ：/wp 1/m     (/wkz 4―12/m )/wky 
例如/v ：/wp 图/n 4．6/m 中/f 的/ude1 模式/n 串/q ，/wd 已/d 求得/v 前/f 6/m 个/q 字符/n 的/ude1 next/x 函数值/n ，/wd 现/tg 求/v next/x [/wkz 7/m ]/wky ，/wd 因为/p next．/x [/wkz 6/m ]/wky =3/m ，/wd 又/d p6≠3/x ，/wd 则/c 需/v 比较/d p6/x 和/cc p1/x (/wkz 因为/p next/x [/wkz 3/m ]/wky =1/m )/wky ，/wd 这/rzv 相当/d 于/p 将/d 子/ng 串模式/n 向/p 右/f 滑动/vi 。/wj 
由于/p p6≠p1/x ，/wd 而且/c next/x [/wkz 1/m ]/wky =0/m ，/wd 所以/c next/x [/wkz 7/m ]/wky ：/wp 1/m ，/wd 而/cc 因为/p p7./x 
    根据上述/n 分析/vn 所得/n 结果/n (/wkz 式/ng (/wkz 4-6/m )/wky 、/wn (/wkz 4．9/m )/wky 、/wn (/wkz 4-11/m )/wky 和/cc     …/ws (/wkz 4．12/m )/wky )/wky ，/wd 仿照/v KMP/x 算法/n ，/wd 可/c 得到/v 求/v 函数值/n 的/ude1 算法/n ，/wd 如/v 算法/n 4．6/m 所/usuo 示/vg 。/wj 
l/x  2/m  3/m  4/m  5/m  6/m 
 a/x  b/x  a/x  a/x  b/x  c/x 
0/m  1/m  1/m  2/m  2/m  3/m 
    (/wkz a/x  b/x  a/x )/wky 
7/m  8/m 
a/x  C/x 
1/m  2/m 
  void/x  get/x _/n next/x (/wkz SString/x  T/x ,/wd  int/x  &/n  next/x [/wkz ]/wky )/wky  
    ∥/w 求/v 模式/n 串/v T/x 的/ude1 函数值/n 并/cc 存入/v 数组/n 
    i=1/x ；/wf   next/x [/wkz ：/wp 1/m ]/wky =0/m ；/wf   j=0/x ；/wf 
    ．/w hile/x (/wkz i/x </n T/x [/wkz 0/m ]/wky )/wky {/n 
    if/x (/wkz j=0/x  ll/x  T/x [/wkz i/x ]/wky =T/x [/wkz j/x ]/wky )/wky I++i/x ；/wf   ++j/x ；/wf next/x [/wkz i/x ]/wky ：/wp j/x ；/wf }/n 
    e18e/x   j=next/x [/wkz j/x ]/wky ；/wf 
    }/n 
    }/n ∥/w get―next/x 
    算法/n 4．7/m 
    算法/n 4．7/m 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz n/x )/wky 。/wj 通常/d ，/wd 模式/n 串/q 的/ude1 长度/n m/x 比/p 主/ag 串/v 的/ude1 长度/n n/x 要/v 小/a 得/ude3 多/a ，/wd 因此/c ，/wd 对/p 整个/b 匹配/vn 算法/n 来说/uls ，/wd 所/usuo 增加/v 的/ude1 这/rzv 点时间/n 是/vshi 值得/v 的/ude1 。/wj 
  最后/f ，/wd 要/v 说明/v 两点：/t 
  1/m )/wky 虽然/c 算法/n 4．5/m 的/ude1 时间/n 复杂度/n 是/vshi 0/m (/wkz ，/wd z/x */n 研/vg )/wky ，/wd 但/c 在/p 一般/a 情况/n 下/f ，/wd 其/rz 实际/a 的/ude1 执行/vn 时间/n 近似/v 于/p 0/m (/wkz n+m/x )/wky ，/wd 因此/c 至今/d 仍/d 被/pbei 采用/v 。/wj KMP/x 算法/n 仅/d 当/p 模式/n 与/p 主/ag 串/v 之间/f 存在/v 许多/m “/wyz 部分/n 匹配/vi ”/wyy 的/ude1 情况/n 下/f 才/d 显得/v 比/p 算法/n 4．5/m 快/a 得/ude3 多/a 。/wj 但是/c KMP/x 算法/n 的/ude1 最/d 大/a 特点/n 是/vshi 指示/n 主/ag 串/v 的/ude1 指针/n 不/d 需/v 回溯/vn ，/wd 整个/b 匹配/vn 过程/n 中/f ，/wd 对/p 主/ag 串/v 仅/d 需/v 从头至尾/dl 扫描/v 一/m 遍/qv ，/wd 这/rzv 对/p 处理/v 从/p 外设/n 输入/v 的/ude1 庞大/a 文件/n 很/d 有效/a ，/wd 可以/v 边/k 读入/v 边/k 匹配/vi ，/wd 而/cc 无/v 需/v 回头/d 重读/v 。/wj 
    2/m )/wky 前面/f 定义/v 的/ude1 next/x 函数/n 在/p 某些/rz 情况/n 下/f 尚/d 有/vyou 缺陷/n 。/wj 例如/v 模式/n ’/wyy a/x  o/x  n/x  n/x  6/m ’/wyy 在/p 和/cc 主/ag 串/v ’/wyy a66/x ’/wyy 匹配/vi 时/ng ，/wd 当/v i=4/x ，/wd ．/w j=4/x 时/ng s．ch/x [/wkz 4/m ]/wky ≠t．ch/x [/wkz 4/m ]/wky ，/wd 由/p next/x [/wkz j/x ]/wky 的/ude1 指示/n 还/d 需/v 进行/vx 4/m 、/wn J：3/x ，/wd 4/m 、/wn J=2/x 、/wn i=4/x 、/wn j：1/x 等/udeng 三/m 次比较/n 。/wj 实际上/d ，/wd 因为/c 模式/n 中/f 第1/m 、/wn 2/m 、/wn 3/m 个/q 字符/n 和/cc 第4/m 个/q 字符/n 都/d 相等/vi ，/wd 因此/c 不/d 需要/v 再/d 和/cc 主/n 串/q 中/f 第4/m 个/q 字符/n 相/d 比较/v ，/wd 而/cc 可以/v 将/p 模式/n 一气/d 向/p 右/f 滑动/vi 4/m 个/q 字符/n 的/ude1 位置/n 直接/ad 进行/vx 5/m ，/wd J：1/x 时/ng 的/ude1 字符/n 比较/vn 。/wj 这就是说/c ，/wd 若/c 按/p 上述/b 定义/n 得到/v next/x [/wkz j/x ]/wky =k/x ，/wd 而/cc 模式/n 中/f pj＝pk/x ，/wd 则/c 当/v 主/ag 串/v 中/b 字符/n si/x 和/cc pj/x 比较/d 不等/vi 时/ng ，/wd 不/d 需要/v 再/d 和/cc m/x 进行/vx 比较/vn ，/wd 而/cc 直接/a 和/cc Pnext/x [/wkz k/x ]/wky 进行/vx 比较/vn ，/wd 换句话说/c ，/wd 此时/r 的/ude1 next/x [/wkz j/x ]/wky 应和/v next/x [/wkz k/x ]/wky 相同/a 。/wj 由此/d 可/v 得/ude3 计算/v next．/x 函数/n 修/v 正值/v 的/ude1 算法/n 如/v 算法/n 4．8/m 所/usuo 示/vg 。/wj 此时/r 匹配/vn 算法/n 不/d 变/v 。/wj 
void/x  get―nextva/x ]/wky ．/w (/wkz SString/x  T/x ，/wd int/x   nextva/x ]/wky [/wkz ]/wky )/wky {/n 
    ∥/w 求/v 模式/n 串/v T/x 的/ude1 ne/x 】/wky 【/wkz t/x 函数/n 修/v 正值/v 并/cc 存入/v 数组/n nextval/x 。/wj 
    i=l/x ；/wf   nextva/x ]/wky ．/w [/wkz 1/m ]/wky =0/m ；/wf   j=0/x ；/wf 
    while/x (/wkz i/x </n T/x [/wkz 0/m ]/wky )/wky {/n 
    if/x (/wkz j=0/x  II/x  T/x [/wkz i/x ]/wky =T/x [/wkz j/x ]/wky )/wky {/n 
    ++i/x ；/wf     ++j/x ；/wf 
    if/x (/wkz T/x [/wkz i/x ]/wky !/wt =T/x [/wkz j/x ]/wky )/wky nextval/x [/wkz i/x ]/wky =j/x ；/wf 
    e18e/x   ne/x 】/wky 【/wkz tval/x [/wkz i/x ]/wky =ne/x )/wky 【/wkz tval/x [/wkz j/x ]/wky ；/wf 
    }/n     
    else/x  j=nex：tval/x [/wkz j/x ]/wky ；/wf 
    }/n 
}/n ∥/w get―nextval/x 
算法/n 4．8/m 
    4．4/m 串/q 操作/vn 应用/vn 举例/vi 
  4．4．1/m 文本/n 编辑/n 
  文本/n 编辑程序/n 是/vshi 一个/mq 面向用户/n 的/ude1 系统/n 服务程序/n ，/wd 广泛/ad 用于/v 源程序/n 的/ude1 输入/vn 和/cc 修改/vn ，/wd 甚至/d 用于/v 报刊/n 和/cc 书籍/n 的/ude1 编辑排版/n 以及/cc 办公室/n 的/ude1 公文/n 书信/n 的/ude1 起草/vn 和/cc 润色/vn 。/wj 文本/n 编辑/n 的/ude1 实质/n 是/vshi 修改/v 字符/n 数据/n 的/ude1 形式/n 或/c 格式/n 。/wj 虽然/c 各种/rz 文本/n 编辑程序/n 的/ude1 功能/n 强弱/n 不同/a ，/wd 但是/c 其/rz 基本/a 操作/vn 是/vshi 一致/a 的/ude1 ，/wd 一般/ad 都/d 包括/v 串/v 的/ude1 查找/vn ，/wd 插入/v 和/cc 删除/v 等/udeng 基本/a 操作/vn 。/wj 
   为了/p 编辑/n 的/ude1 方便/an ，/wd 用户/n 可以/v 利用/v 换页/n 符/vg 和/cc 换行符/n 把/pba 文本/n 划分为若干/n 页/q ，/wd 每/rz 页/q 有/vyou 若干/m 行/q (/wkz 当然/d ，/wd 也/d 可/v 不/d 分页/n 而/cc 把/pba 文件/n 直接/ad 划/v 成/v 若干/m 行/q )/wky 。/wj 我们/rr i/x ,/wd TPl/x 把/pba 文本/n 看成/v 是/vshi 一个/mq 字符串/n ，/wd 称为/v 文本/n 串/q 。/wj 页/q 则/d 是/vshi 文本/n 串/q 的/ude1 子/ng 串/v ，/wd 行/ng 又/d 是/vshi 页/q 的/ude1 子/ng 串/v 。/wj 
　　比如/v 有/vyou 下列/b 一/m 段/q 源程序/n 
　　mai/x ,/wd I/x (/wkz )/wky {/n 
    float/x  a/x ，/wd b/x ，/wd max/x ；/wf 
    8cf/x (/wkz ”/wyy ％f/x ，/wd ％f/x ，/wd ＆/n a/x ，/wd ＆/n b/x )/wky ；/wf 
    if/x  a/x >/n b/x  max=a：/x 
    elsemax/x 。/wj b：/x 
    }/n ；/wf 
我们/rr 可以/v 把/pba 此程序/n 看成/v 是/vshi 一个/mq 文本/n 串/q 。/wj 输入/v 到/v 内存/n 后/f 如/v 图/n 4．7/m 所/usuo 示/vg 。/wj 图/n 中/f “/wyz ／/w ”/wyy 为/p 换行符/n 。/wj 
　　为了/p 管理/vn 文本/n 串/q 的/ude1 页/q 和/cc 行/vi ，/wd 在/p 进入/v 文本/n 编辑/n 的/ude1 时候/n ，/wd 编辑程序/n 先/d 为/v 文本/n 串/q 建立相应/n 的/ude1 页/q 表/n 和/cc 行/a 表/n ，/wd 即/d 建立/v 各/rz 子/ng 串/v 的/ude1 存储/vn 映象/n 。/wj 页/q 表/n 的/ude1 每/rz 一/m 项/q 给/v 出/vf 了/ule 页/q 号/n 和/cc 该/rz 页/q 的/ude1 起始/vn 行/n 号/q 。/wj 而/cc 行/a 表/n 的/ude1 每/rz 一/m 项/q 则/d 指示/v 每/rz 一/m 行/q 的/ude1 行/a 号/n 、/wn 起始/vn 地址/n 和/cc 该行/r 子/ng 串/v 的/ude1 长度/n 。/wj 假设/v 图/n 4．7/m 所/usuo 示/vg 文本/n 串/q 只/d 占/v 一/m 页/q ，/wd 且/c 起始/v 行/ng 号/n 为/p 100/m ，/wd 则/c 该/rz 文本/n 串/q 的/ude1 行/a 表/n 如/v 图/n 4．8/m 所/usuo 示/vg 。/wj 
　　文本/n 编辑程序/n 中/f 设立/v 页/q 指针/n 、/wn 行/a 指针/n 和/cc 字符/n 指针/n ，/wd 分别/d 指示/v 当前/t 操作/v 的/ude1 页/q 、/wn 行/vi 和/cc 字符/n 。/wj 如果/c 在/p 某/rz 行/ng 内/f 插入/v 或/c 删除/v 若干/m 字符/n ，/wd 则/c 要/v 修改/v 行/ng 表/n 中/f 该行/r 的/ude1 长度/n 。/wj 若/c 该行/r 的/ude1 长度/n 超出/v 了/ule 分配/v 给/p 它/rr 的/ude1 存储空间/n ，/wd 则/c 要/v 为/p 该行/r 重新/d 分配存储/n 空间/n ，/wd 同时/c 还/d 要/v 修改/v 该行/r 的/ude1 起始/vn 位置/n 。/wj 如果/c 要/v 插入/v 或/c 删除/v 一行/n ，/wd 就/d 要/v 涉及/v 行/ng 表/n 的/ude1 插入/v 或/c 删除/v 。/wj 若/c 被/pbei 删除/v 的/ude1 行/n 是/vshi 所在/n 页/q 的/ude1 起始/vn 行/ng ，/wd 则/c 还/d 要/v 修改/v 页/q 表/n 中/f 相应/vi 页/ng 的/ude1 起始/vn 行/ng 号/n (/wkz 修改/v 为/v 下/vf 一/m 行/q 的/ude1 行/a 号/q )/wky 。/wj 为了/p 查找方便/n ，/wd 行/ng 表/n 是/vshi 按/p 行/ng 号/n 递增/vi 顺序/n 存储/vn 的/ude1 ，/wd 因此/c ，/wd 对/p 行/ng 表/n 进行/vx 的/ude1 插入/v 或/c 删除/v 运算/vn 需/v 移动/vn 操作位置/n 以后/f 的/ude1 全部/m 表项/n 。/wj 页/q 表/n 的/ude1 维护/vn 与/cc 行/a 表/n 类似/a ，/wd 在/p 此/rzs 不再/d 赘述/vi 。/wj 由于/c 访问/v 是/vshi 以/p 页/q 表/n 和/cc 行/a 表/n 作为/p 索引/n 的/ude1 ，/wd 所以/c 在/p 作/v 行/ng 和/cc 页/q 的/ude1 删除/v 操作/v 时/ng ，/wd 可以/v 只/d 对/p 行/ng 表/n 和/cc 页/q 表/n 作/v 相应/vi 的/ude1 修改/vn ，/wd 不必/d 删除/v 所/usuo 涉及/v 的/ude1 字符/n 。/wj 这/rzv 可以/v 节省/v 不少/m 时间/n 。/wj 
    以上/f 概述/v 了/ule 文本/n 编辑程序/n 中/f 的/ude1 基本/a 操作/vn 。/wj 其/rz 具体/a 的/ude1 算法/n ，/wd 读者/n 可/v 在/p 学习/v 本/rz 章/n 之后/f 自行/d 编写/v 。/wj 
4．4．2/m 建立/v 词/n 索引/n 表/n 
    信息/n 检索/vn 是/vshi 计算机/n 应用/vn 的/ude1 重要/a 领域/n 之一/rz 。/wj 由于/p 信息/n 检索/vn 的/ude1 主要/b 操作/vn 是/vshi 在/p 大量/m 的/ude1 存放在/v 磁盘/n 上/f 的/ude1 信息/n 中/f 查询/v 一个/mq 特定/b 的/ude1 信息/n ，/wd 为了/p 提高/v 查询效率/n ，/wd 一个/mq 重要/a 的/ude1 问题/n 是/vshi 建立/v 一个/mq 好/a 的/ude1 索引/n 系统/n 。/wj 例如/v 我们/rr 在/p 1．1/m 节/q 中/f 提到/v 过/uguo 的/ude1 图书馆/n 书目/n 检索系统/n 中/f 有/vyou 三/m 张/q 索引/n 表/n ，/wd 分别/d 可/v 按/p 书名/n 、/wn 作者/n 名/q 和/cc 分类/vn 号/n 编排/vn 。/wj 在/p 实际/n 系统/n 中/f ，/wd 按/p 书名/n 检索/vn 并/cc 不/d 方便/a ，/wd 因为/p 很多/m 内容/n 相似/a 的/ude1 书籍/n 其/rz 书名/n 不/d 一定/d 相同/a 。/wj 因此/c 较/d 好/a 的/ude1 办法/n 是/vshi 建立/v “/wyz 书名/n 关键词/n 索引/n ”/wyy 。/wj 
书/n 号/q 
005/m 
010/m 
023/m 
034/m 
050/m 
067/m 
书名/n 
(/wkz ~/n omputer/x 【/wkz )/wky ata/x  Structures/x 
Intr/x (/wkz ~/n duction/x  to/x  Data/x  Stnmtures/x 
Fundamentals．of/x 【/wkz )/wky ata/x  Structures/x 
The/x 【/wkz )/wky esigrl/x  and/x  Analysis/x  of/x  C/x (/wkz ~/n mputer/x  Algorithms/x 
Introduction/x  to/x  NIlmerical/x  Analysis/x 
Numerical/x  Analysis/x 
关键词/n     书号/n 索引/n 
034．/m 
034/m ，/wd 050/m ，/wd 067/m 
005/m ，/wd 034/m 
005/m ，/wd 010/m ，/wd a23/x 
034/m 
023/m 
010．050/m 
050．067/m 
005/m ，/wd 010/m ，/wd 023/m 
。/wj   图/n 4．9/m 书目/n 文件/n 及/cc 其/rz 关键词/n 索引/n 表/n 
    (/wkz a/x )/wky 书目/n 文件/n ；/wf   (/wkz b/x )/wky 关键词/n 索引/n 表/n 。/wj 
    例如/v ，/wd 与/p 图/n 4．9/m (/wkz a/x )/wky 中/f 书目/n 相应/vi 的/ude1 关键词/n 索引/n 表/vg 如/v 图/n 4．9/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 读者/n 很/d 容易/ad 从/p 关键词/n 索引/n 表/n 中/f 查询/v 到/v 他/rr 所/usuo 感/vg 兴趣/n 的/ude1 书目/n 。/wj 为了/p 便于/v 查询/v ，/wd 可/c 设定/v 此索引/n 表/vg 为/v 按/p 词典/n 有序/a 的/ude1 线性/n 表/n 。/wj 下面/f 要/v 讨论/v 的/ude1 是/vshi 如何/ryv 从/p 书目/n 文件/n 生成/v 这个/rz 有序/a 词表/n 。/wj 
    重复/v 下列/b 操作/vn 直至/v 文件/n 结束/v ：/wp 
    1/m )/wky 从/p 书目/n 文件/n 中/f 读入/v 一个/mq 书目/n 串/q ；/wf 
    2/m )/wky 从/p 书目/n 串/q 中/f 提取/v 所有/b 关键词/n 插入/v 词表/n ；/wf 
    3/m )/wky 对/p 词表/n 中/f 的/ude1 每/rz 一个/mq 关键/a 词/n ，/wd 在/p 索引/n 表/n 中/f 进行/vx 查找/vn 并/cc 作/v 相应/vi 的/ude1 插入/v 操作/vn 。/wj 
    为/p 识别/v 从/p 书名/n 串/q 中/f 分离/vi 出来/vf 的/ude1 单词/n 是否/v 是/vshi 关键/a 词/n ，/wd 需要/v 一/m 张/q 常用/a 词表/n (/wkz 在/p 英文/nz 书/n 名/q 中/f 的/ude1 “/wyz 常用词/n ”/wyy 指/v 的/ude1 是/vshi 诸如/v "/n all/x '/n ’/wyy 、/wn “/wyz a/x ”/wyy 、/wn “/wyz of/x ”/wyy 、/wn “/wyz the/x ”/wyy 等/udeng 词/n )/wky 。/wj 顺序/n 扫描/vn 书名/n 串/q ，/wd 首先/d 分离/vi 单词/n ，/wd 然后/c 查找/v 常用/a 词表/n ，/wd 若/c 不/d 和/cc 表/n 中/f 任/v 一/m 词/n 相等/vi ，/wd 则/c 为/p 关键词/n ，/wd 插入/v 临时/d 存放/v 关键词/n 的/ude1 词表/n 中/f 。/wj 
    在/p 索引/n 表/n 中/f 查询关键词/n 时/ng 可能/v 出现/v 两/m 种/q 情况/n ：/wp 其一/rz 是/vshi 索引/n 表/n 上/f 已/d 有/vyou 此/rzs 关键词/n 的/ude1 索引/n 项/q ，/wd 则/c 只/d 要/v 在/p 该/rz 项/q 中/f 插入/v 书号/n 索引/n 即可/v ；/wf 其二/rz 是/vshi 需/v 在/p 索引/n 表/n 中/f 插入/v 此/rzs 关键词/n 的/ude1 索引/n 项/q ，/wd 插入/v 应/v 按/p 字典/n 有序/a 原则/n 进行/vx 。/wj 下面/f 就/d 重点/d 讨论/v 这/rzv 第三/m 个/q 操作/vn 的/ude1 具体实现/n 。/wj 
  首先/c 设定/v 数据/n 结构/n 。/wj 
  词表/n 为/p 线性/n 表/n ，/wd 只/d 存放/v 一/m 本/q 书/n 的/ude1 书名/n 中/f 若干/m 关键词/n ，/wd 其/rz 数量/n 有限/a ，/wd 则/c 采用/v 顺序/n 存储/vn 结构/n 即可/v ，/wd 其中/rz 每/rz 个/q 词/n 是/vshi 一个/mq 字符串/n 。/wj 
    索引/n 表/vg 为/p 有序/a 表/n ，/wd 虽/c 是/vshi 动态/n 生成/vn ，/wd 在/p 生成/v 过程/n 中/f 需/v 频繁/ad 进行/vx 插入/v 操作/vn ，/wd 但/c 考虑/v 索引/n 表/n 主要/d 为/v 查找/v 用/v ，/wd 为了/p 提高/v 查找效率/n (/wkz 采用/v 第九/m 章/q 中/f 将/d 讨论/v 的/ude1 折半/v 查找/v )/wky ，/wd 宜/ag 采用/v 顺序/n 存储/vn 结构/n ；/wf 表/n 中/f 每个/r 索引/n 项/q 包含/v 两/m 个/q 内容/n ：/wp 其一/rz 是/vshi 关键/a 词/n ，/wd 因/p 索引/n 表/vg 为/p 常驻/v 结构/n ，/wd 则/c 应/v 考虑/v 节省存储/n ，/wd 采用/v 堆/k 分配存储/n 表示/v 的/ude1 串/q 类型/n ；/wf 其二/rz 是/vshi 书号/n 索引/n ，/wd 由于/c 书号/n 索引/n 是/vshi 在/p 索/vg }/n I/x 表/n 的/ude1 生成/vn 过程/n 中/f 逐个/d 插入/v ，/wd 且/c 不/d 同/p 关键词/n 的/ude1 书号/n 索引/n 个数/n 不等/vi ，/wd 甚至/d 可能/v 相差/v 很/d 多/a ，/wd 则/d 宜/ag 采用/v 链/ng 表/vg 结构/n 的/ude1 线性/n 表/n 。/wj 
#/n de/x ~/n Ine/x  MaxBc/x 。/wj Ⅻ/m l/x 】/wky 1000/m     ∥/w 假设/n 只/d 对/p 1000/m 本/q 书/n 建/v 索引/n 表/n 
#/n defi．e/x  MaeyN/x _/n l/x   2500/m     ／／/m 索引/n 表/n 的/ude1 最/d 大容量/n 
#/n di/x */n a1neL500/x     ∥/w 书目/n 串/q 的/ude1 最/d 大/a 长度/n 
#/n deflne/x  Maorum/x  10/m     ∥/w 词表/n 的/ude1 最/d 大容量/n 
typed6f/x  st/x ~/n c/x ~/n l/x 
  */n em/x 【/wkz ]/wky ；/wf ∥/w 字符串/n 的/ude1 数组/n 
  int/x  last/x ；/wf     ∥/w 词表/n 的/ude1 长度/n 
1w/x “/wyz 、/wn syj/x     ／／/m 词表/n 类型/n (/wkz 顺序/n 表/vg )/wky 
‘/wyz yPedit/x  ElemTyPe/x ；/wf ∥/w 定义/n 链/ng 表/n 的/ude1 数据/n 元素/n 类型/n 为/p 整/m 型/k (/wkz 书号/n 类型/n 
0n/x “/wyz f/x {/n m1/x 
  HString/x  key/x ；/wf     ∥/w 关键词/n 
  Lira．List/x  bn/x ~/n list％/x ∥/w 存放/v 书号/n 索引/n 的/ude1 链/ng 表/n 
}/n ITerm/x ’/wyy yp/x 。/wj ；/wf     ∥/w 索引/n 项/q 类型/n 
0fP8tgt1/x 
    IdBrmType/x  1t/x 【/wkz MaxKeyN/x ~/n +I/x  J/x ；/wf 
    i4t/x  lastj/x 
}/n Id1st/x ’/wyy ype/x ；/wf     ∥/w 索引/n 表/vg 类型/n (/wkz 有序/a 表/vg )/wky 
  ∥/w 主要/b 变量/n 
ch/x ^/n r/x */n huf/x ；/wf     ∥/w 书目/n 串/q 缓冲区/n 
WordListType/x  wdli/x ~/n t/x ；/wf ∥/w 词表/n 
  ∥/w 基本/ad 操作/v 
Ⅵ/m id/x  IoitIdxLlat/x (/wkz 51xListT/x ~/n ＆/n idxlist/x )/wky ；/wf 
    ∥/w 初始化操作/n ，/wd 置/v 索引/n 表/n idxlist/x 为/p 空/a 表/n ．/w 且/c 在/p idxlist/x  ie/x ~/n [/wkz O/x ]/wky 设/v 一/m 空串/n 
id/x  GetLine/x (/wkz FIf/x )/wky ；/wf 
    ∥/w 从/p 文件/n f/x 读入/v 一个/mq 书目/n 信息/n 到/v 书目/n 串/q 缓冲区/n bur/x 
void/x  ExtractKe/x ~/n Mord/x (/wkz Ele/x 艘/q yPe/x ＆/n bno/x )/wky ；/wf 
    ∥/w 从/p bur/x 中/f 提取/v 书名/n 关键/n 诃/ng 到/v 词表/n wdlist/x 。/wj 书号/n 存入/v bno/x 
S/x ~/n a/x ~/n usInsl4XList/x  CIdxListT/x ~/n e/x ＆/n ilxllst/x ，/wd m￡me/x  bno/x )/wky ’/wyy 
    ∥/w 将/p 书号/n 为/v bn/x 。/wj 的/ude1 书名/n 关键词/n 按/p 词典/n 顺序/n 插入/v 索引/n 表/n idxli/x ~/n t/x 
voi4/x  PUtT/x ~/n xt/x (/wkz FI％Id1stte/x [/wkz 4xlist/x )/wky ；/wf 
    ∥/w 将/d 生成/v 的/ude1 索引/n 表/n idxlist/x 输出/v 到/v 文件/n g/x 
void/x  maln/x (/wkz )/wky f／／/x 主/n 函数/n 
  if/x (/wkz f/x 。/wj opeaf/x  f/x 。/wj B/x ~/n okInfo/x  txt/x ‘/wyz 
    if/x (/wkz g=ope/x ，/wd lf/x (/wkz ”/wyy Bookl4x/x  t/x ~/n t/x 
    InltIdx/x “/wyz st/x  fj/x 出/vf 113t/x )/wky i/x 
    while/x (/wkz 1feof/x (/wkz f/x )/wky )/wky {/n 
    GetLine/x (/wkz f/x )/wky ；/wf 
∥/w 初始化/v 索引/n 表/n i4xlist/x 为/p 空/a 表/n 
∥/w 从/p 文件/n f/x 读入/v 一个/mq 书目/n 信息/n f/x 
    }/n 
＼f/x }/n main/x 
 ExtractKeyWord/x (/wkz BookNo/x )/wky ；/wf 
InsldxList/x (/wkz idxlist/x ，/wd BookNo/x )/wky ；/wf 
}/n 
PutText/x (/wkz g/x ，/wd idxlist/x )/wky ；/wf 
∥/w 从/p buf/x 提取/v 关键词/n 到/v 词表/n ，/wd 书号/n 存入/v BookNo/x 
∥/w 将/p 书号/n 为/v BookNo/x 的/ude1 关键词/n 插入/v 索引/n 表/n 
∥/w 将/d 生成/v 的/ude1 索引/n 表/n idxlist/x 输出/v 到/v 文件/n g/x 
算法/n 4．9/m 
为/p 实现/v 在/p 索引/n 表/n 上/f 进行/vx 插入/v ，/wd 要/v 先/d 实现/v 下列/b 操作/vn ：/wp 
void/x  GetWord/x (/wkz int/x  i/x ，/wd [/wkz -/wp '/n ]/wky String/x ＆/n wd/x )/wky ；/wf     ．/w 
    ∥/w 用/v wd/x 返回/v 词表/n wdlist/x 中/f 第/m i/x 个/q 关键/n 词/n 。/wj 
int/x  Locate/x (/wkz IdxListType/x  idxlist/x ，/wd   }/n {/n String/x  wd/x ，/wd   Boolean/x ＆/n b/x )/wky ；/wf 
    ∥/w 在/p 索引/n 表/n idxlist/x 中/f 查询/v 是否/v 存在/v 与/p wd/x 相等/vi 的/ude1 关键/n 词/n 。/wj 若/c 存在/v ，/wd 则/c 返回/v 其/rz 在/p 索引/n 表/n 
    ∥/w 中/f 的/ude1 位置/n ，/wd 且/c b/x 取值/v TRUE/x ；/wf 否则/c 返回/v 插入/v 位置/n ，/wd 且/c b/x 取值/v FALSE/x 
void/x  InsertNewKey/x (/wkz IdxListType/x ＆/n idxlist/x ，/wd   int/x  i/x ，/wd HString/x  wd/x )/wky 0/m 
    ∥/w 在/p 索引/n 表/n idxlist/x 的/ude1 第/m i/x 项/q 上/f 插/v 入/v 新/a 关键词/n wd/x ，/wd 并/cc 初始化/v 书号/n 索引/n 的/ude1 链/ng 表/vg 为/p 空/a 表/n 
Status/x  InsertBook/x (/wkz IdxListType/x ＆/n idxlist/x ，/wd   int/x  i/x ，/wd   int/x  bno/x )/wky ；/wf 
    ∥/w 在/p 索引/n 表/n idxlist/x 的/ude1 第/m i/x 项/q 中/f 插入/v 书号/n 为/v bno/x 的/ude1 索引/n 
由此/d 可/v 得/ude3 索引/n 表/n 的/ude1 插入/v 算法/n 如/v 算法/n 4．10/m 所/usuo 示/vg 。/wj 
Status/x  InsertldxList/x (/wkz IdxListType/x &/n idxlist/x ，/wd   int/x  bno/x )/wky {/n 
    for/x (/wkz i=0/x ；/wf   i/x </n wdlist．1ast/x ；/wf   ++i/x )/wky {/n 
    GetWord/x (/wkz i/x ，/wd wd/x )/wky ；/wf     J=Locate/x (/wkz idxlist/x ，/wd wd/x ，/wd b/x )/wky ；/wf 
    if/x (/wkz !/wt b/x )/wky InsertNewKey/x (/wkz idxlist/x ，/wd J/x ，/wd wd/x )/wky ；/wf     ∥/w 插入/v 新/a 的/ude1 索引/n 项/q 
    return/x (/wkz InsertBook/x (/wkz ic/x ~/n list/x ，/wd J/x ，/wd bno/x )/wky )/wky ；/wf     ∥/w   插入/v 书号/n 索引/n 
    }/n 
＼/m }/n }/n InsertIdxList/x 
算法/n 4．10/m 
其中/rz 四/m 个/q 操作/vn 的/ude1 具体实现/n 分别/d 如/v 算法/n 4．11/m ，/wd 4．12/m ，/wd 4．13/m 和/cc 4．14/m 所/usuo 示/vg 。/wj 
void/x  GetWord/x (/wkz int/x  i/x ，/wd HString/x &/n wd/x )/wky {/n 
  P=/x */n (/wkz wdlist．item/x 十/m i/x )/wky ；/wf     ／／/m 取/v 词表/n 中/f 第/m i/x 个/q 字符串/n 
  StrAssign/x (/wkz wd/x ，/wd P/x )/wky ；/wf     ／／/m 生成/vn 关键字/n 字符串/n 
I／／GetWord/x 
算法/n 4．II/x 
int/x  Locate/x (/wkz IdxListType/x ＆/n idxlist/x ，/wd HString/x  wd/x ，/wd Boolea．/x ＆/n b/x )/wky {/n 
    for/x (/wkz i=idxlist．1ast/x 一/m 1/m ；/wf 
    (/wkz m=StrCompare/x (/wkz idxlist．item/x [/wkz i/x ]/wky ．/w key/x ，/wd wd/x )/wky )/wky >/n 0/m ；/wf   --/wp i/x )/wky ；/wf 
    if/x (/wkz m==0/x )/wky   {/n b=TRUE/x ；/wf   return/x  i/x ；/wf   }/n     ∥/w 找到/v 
    else/x  lb=FALSE/x ；/wf     return/x  i+1/x ；/wf   }/n 
＼f/x }/n Locate/x 
算法/n 4．12/m 
 void/x  InsertNewKey/x (/wkz int/x  i/x ，/wd   strType/x  wd/x )/wky {/n 
  for/x (/wkz J=idxlist．1ast―l/x ；/wf   J/x >/n =i/x ；/wf   --/wp J/x )/wky 
    idxlist．item/x [/wkz J+1/x ]/wky =idxlist．item/x [/wkz J/x ]/wky ；/wf 
  ∥/w 插入/v 新/a 的/ude1 索引/n 项/q 
  StrCopy/x (/wkz idxlist．item/x [/wkz i/x ]/wky ．/w key/x ，/wd wd/x )/wky ；/wf 
  InitList/x (/wkz idxlist．item/x [/wkz i/x ]/wky ．/w bnolist/x )/wky ；/wf 
  ++idxlist．1ast：/x 
＼/m }/n f/x  Inse/x ~/n tNewKey/x 
算法/n 4．13/m 
∥/w 后移/vn 索引/n 项/q 
∥/w 串/v 赋值/v     
∥/w 初始化/v 书号/n 索引/n 表/vg 为/p 空/a 表/n 
Status/x  InsertBook/x (/wkz IdxListType/x ~/n idxlist/x ，/wd   in％i/x ，/wd   int/x  bno/x )/wky {/n 
  if/x (/wkz !/wt ~/n keNode/x (/wkz p/x 。/wj bno/x )/wky )/wky return/x  09Y／h/x ~/n LOW/x ；/wf     ∥/w 分配/v 失败/vi 
  Appand/x (/wkz idxlist．item/x [/wkz i/x ]/wky ．/w bnolist/x ，/wd p/x )/wky ；/wf     ∥/w 插入/v 新/a 的/ude1 书号/n 索引/n 
  return/x  OK/x ；/wf 
＼/m {/n f/x  InsertBook/x 
算法/n 4．14/m 


*/n 
第5/m 章/q 数组/n 和/cc 广义/n 表/n 
    前/f 几/m 章/q 讨论/vn 的/ude1 线性/n 结构/n 中/f 的/ude1 数据/n 元素/n 都/d 是非/n 结构/n 的/ude1 原子/n 类型/n ，/wd 元素/n 的/ude1 值/n 是/vshi 不再/d 分解/v 的/ude1 。/wj 本章/nr2 讨论/v 的/ude1 两/m 种/q 数据/n 结构/n ――/wp 数组/n 和/cc 广义/n 表/vg 可以/v 看成/v 是/vshi 线性/n 表/n 在下/r 述/vg 含义/n 上/f 的/ude1 扩展/vn ：/wp 表/n 中/f 的/ude1 数据/n 元素/n 本身/rz 也/d 是/vshi 一个/mq 数据/n 结构/n 。/wj 
    数组/n 是/vshi 读者/n 已经/d 很/d 熟悉/v 的/ude1 一/m 种/q 数据/n 类型/n ，/wd 几乎/d 所有/b 的/ude1 程序设计/n 语言/n 都/d 把/pba 数组/n 类型/n 设定/v 为/p 固有/b 类型/n 。/wj 本章/nr2 以/p 抽象数据/n 类型/n 的/ude1 形式/n 讨论/vn 数组/n 的/ude1 定义/n 和/cc 实现/v ，/wd 使/v 读者/n 加深/v 对/p 数组/n 类型/n 的/ude1 理解/vn 。/wj 
5．1/m 数组/n 的/ude1 定义/n 
类似/v 于/p 线性/n 表/n ，/wd 抽象数据/n 类型/n 数组/n 可/v 形式/n 地/ude2 定义/v 为/v ：/wp 
ADT/x  Array/x {/n 
  数据/n 对象/n ：/wp Ji=0/x ，/wd …/ws ，/wd bi-1/x ，/wd i=I/x ，/wd 2．/m …/ws ，/wd n/x ，/wd 
    D=/x {/n a/x ]/wky ^/n j/x 。/wj ln/x (/wkz >/n O/x )/wky 称为/v 数组/n 的/ude1 维/nr1 数/n ，/wd bi/x 是/vshi 数组/n 第/m i/x 维/b 的/ude1 长度/n ，/wd 
    Jl/x 是/vshi 数组/n 元素/n 的/ude1 第/m i/x 维/b 下标/n ，/wd a/x ]/wky 1/m ]/wky '/n …/ws ]/wky ．/w ∈ElemSet/x }/n 
    数据/n 关系/n ：/wp R=/x {/n R1/x ，/wd R2/x ，/wd …/ws ，/wd Rn/x }/n 
    Ri/x “/wyz </n ajl/x …/ws ・/w R/x ’/wyy ajl・J/x 。/wj +1l/x ”/wyy J/x 。/wj >/n }/n 
    0≤jk≤blc1/x ，/wd   1≤k≤n/x 且/d k≠i/x ，/wd 
    0≤jj≤bi2/x ，/wd 
    a91/x …/ws J：・/x ]/wky 。/wj ，/wd ajl/x ]/wky ，/wd +l/x _/n ．/w ．/w ]/wky 。/wj ∈D/x ，/wd i/x 。/wj 2/m ，/wd …/ws ，/wd n/x }/n 
    基本/ad 操作/v ：/wp 
    InitArray/x (/wkz &/n A/x ，/wd n/x ，/wd boundl/x ，/wd …/ws ，/wd boundn/x )/wky 
    操作/v 结果/n ：/wp 若/v 维/nr1 数/n n/x 和/cc 各/rz 维/ng 长度/n 合法/a ，/wd 则/c 构造/v 相应/vi 的/ude1 数组/n A/x ，/wd 并/cc 返回/v 0K/x 。/wj 
    Destroykrray/x (/wkz ＆/n A/x )/wky 
    操作/v 结果/n ：/wp 销毁/v 数组/n A/x 。/wj 
    Value/x (/wkz A/x ，/wd ＆/n e/x ，/wd indexl/x ，/wd …/ws ，/wd indexn/x )/wky     
    初始条件/n ：/wp A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    操作/v 结果/n ：/wp 若/v 各/rz 下标/n 不/d 超/v 界/k ，/wd 则/d e/x 赋值/v 为/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n 值/n ，/wd 并/cc 返回/v 0K/x 。/wj 
    Assign/x (/wkz ＆/n A/x ，/wd e/x ，/wd indexl/x ，/wd …/ws ，/wd indexn/x )/wky 
    初始条件/n ：/wp A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    操作/v 结果/n ：/wp 若/v 下标/n 不/d 超/v 界/k ，/wd 则/c 将/d e/x 的/ude1 值/n 赋/ng 给/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n ，/wd 并/cc 返回/v OK/x 。/wj 
}/n ADT/x ~/n rray/x 
    这/rzv 是/vshi 一个/mq C/x 语言/n 风格/n 的/ude1 定义/n 。/wj 从/p 上述/b 定义/n 可见/c ，/wd n/x 维/b 数组/n 中/f 含有/v Ⅱ/m bi/x 个/q 数据/n 元素/n ，/wd   i=1/x 
每个/r 元素/n 都/d 受/v 着/uzhe n/x 个/q 关系/n 的/ude1 约束/vn 。/wj 在/p 每个/r 关系/n 中/f ，/wd 元素/n aj/x 。/wj j：/x …/ws ，/wd 。/wj (/wkz 0≤ji≤6/x ；/wf  2/m )/wky 都/d 有/vyou 一个/mq 直接/a 后/f 继/vg 元素/n 。/wj 因此/c ，/wd 就/d 其/rz 单个/b 关系/n 而言/uls ，/wd 这/rzv ”/wyy 个/q 关系/n 仍/d 是/vshi 线性/n 关系/n 。/wj 和/cc 线性/n 表/n 一样/uyy ，/wd 所有/b 的/ude1 数据/n 元素/n 都/d 必须/d 属于/v 同一/b 数据/n 类型/n 。/wj 数/m 组/q 中/f 的/ude1 每个/r 数据/n 元素/n 都/d 对/p 应/v 于/p 一/m 组/q 下标/n (/wkz j/x 。/wj ，/wd j2/x ，/wd …/ws ，/wd j/x 。/wj )/wky ，/wd 每个/r 下/vf 标的/n 取值/v 范围/n 是/vshi 0≤ji≤bi―l/x ，/wd bi/x 称为/v 第/m i/x 维/b 的/ude1 长度/n (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 。/wj 显然/a ，/wd 当/v n：1/x 时/ng ，/wd n/x 维/b 数组/n 就/d 退化/vi 为/p 定/v 长/a 的/ude1 线性/n 表/n 。/wj 反之/c ，/wd n/x 维/b 数组/n 也/d 可以/v 看成/v 是/vshi 线性/n 表/n 的/ude1 推广/vn 。/wj 由此/d ，/wd 我们/rr 也/d 可以/v 从/p 另/rz 一个/mq 角度/n 来/vf 定义/n n/x 维/b 数组/n 。/wj 
    我们/rr 可以/v 把/pba 二/m 维/q 数组/n 看成/v 是/vshi 这样/rzv 一个/mq 定/v 长/a 线性/n 表/n ：/wp 它/rr 的/ude1 每个/r 数据/n 元素/n 也/d 是/vshi 一个/mq 定/v 长/a 线性/n 表/n 。/wj 例如/v 。/wj 图/n 5．1/m (/wkz a/x )/wky 所/usuo 示/vg 是/vshi 一个/mq 二/m 维/q 数组/n ，/wd 以/p m/x 行/ng ”/wyy 列/v 的/ude1 矩阵形式/n 表示/v 。/wj 它/rr 可以/v 看成/v 是/vshi 一个/mq 线性/n 表/n     A=/x (/wkz a1/x ，/wd a2/x ，/wd …/ws ，/wd an/x )/wky   (/wkz p=m-1/x 或/c n-1/x )/wky 
其中/rz 每个/r 数据/n 元素/n a/x ，/wd 是/vshi 一个/mq 列向量/n 形式/n 的/ude1 线性/n 表/n  a/x 。/wj =/m (/wkz alj/x ，/wd 。/wj 2J/x ，/wd …/ws ，/wd )/wky    1≤J≤≤/x ”/wyy 
(/wkz 如/v 图/n 5．1/m (/wkz b/x )/wky 所/usuo 示/vg )/wky 或者/c ai/x 是/vshi 一个/mq 行/a 向量/n 形式/n 的/ude1 线性/n 表/n Oli=/x (/wkz ail/x ，/wd ai2/x ，/wd …/ws ，/wd )/wky     1≤i≤m/x 
(/wkz 如/v 图/n 5．1/m (/wkz c/x )/wky 所/usuo 示/vg )/wky 。/wj 在/p C/x 语言/n 中/f ，/wd 一个/mq 二/m 维/q 数组/n 类型/n 可以/v 定义/n 为/p 其/rz 分量/n 类型/n 为/p 一/m 维/q 数组/n 类型/n 的/ude1 一/m 维/q 数组/n 类型/n ，/wd 也就是说/vl ，/wd 
    typedef/x  ElemType/x  Array2/x [/wkz m/x ]/wky [/wkz n/x ]/wky ；/wf 
等价/n 于/p 
    typedef/x  ElemType/x  Arrayl/x [/wkz n/x ]/wky ；/wf 
    typedef/x  Arrayl/x   Array2/x [/wkz m/x ]/wky ；/wf 
同/p 理/n ，/wd 一个/mq n/x 维/b 数组/n 类型/n 可以/v 定义/n 为/p 其/rz 数据/n 元素/n n-1/x 维/b 数组/n 类型/n 的/ude1 一/m 维/q 数组/n 类型/n 。/wj 
a11/x   n12/x   n13/x 
21/m     22/m     n23/x 
nml/x   nm2/x   am3/x 
    (/wkz )/wky 
A/x 。/wj 。/wj 
Am/x 。/wj =/m (/wkz (/wkz 11n12/x …/ws n1/x 。/wj )/wky ，/wd (/wkz n2la22/x …/ws 2/m 。/wj )/wky ，/wd …/ws ，/wd (/wkz nmlm2/x …/ws mn/x )/wky )/wky 
    (/wkz c/x )/wky 
    图/n 5．1/m 二/m 维/q 数组/n 图例/n 
  (/wkz a/x )/wky 矩/ng 薛/nr1 形式/n 表示/v ；/wf (/wkz b/x )/wky 列向量/n 的/ude1 一/m 维/q 数组/n ；/wf (/wkz 。/wj )/wky 行/ng 向量/n 的/ude1 一/m 维/q 数组/n 。/wj 
    数组/n 一旦/d 被/pbei 定义/v ，/wd 它/rr 的/ude1 维/nr1 数/n 和/cc 维/b 界/n 就/d 不再/d 改变/v 。/wj 因此/c ，/wd 除了/p 结构/n 的/ude1 初始化/v 和/cc 销毁/v 之外/f ，/wd 数组/n 只有/c 存取/v 元素/n 和/cc 修改/vn 元素/n 值/n 的/ude1 操作/vn 。/wj 
5．2/m 数组/n 的/ude1 顺序/n 表示/v 和/cc 实现/v 
    由于/p 数组/n 一般/uyy 不/d 作/v 插入/v 或/c 删除/v 操作/vn ，/wd 也就是说/vl ，/wd 一旦/d 建立/v 了/ule 数/m 组/q ，/wd 则/c 结构/n 中/f 的/ude1 数据/n 元素/n 个数/n 和/cc 元素/n 之间/f 的/ude1 关系/n 就/d 不再/d 发生/v 变动/vn 。/wj 因此/c ，/wd 采用/v 顺序/n 存储/vn 结构/n 表示/v 数组/n 是/vshi 自然/a 的/ude1 事/n 了/y 。/wj 
　　由于/p 存储单元/n 是/vshi 一/m 维/q 的/ude1 结构/n ，/wd 而/cc 数组/n 是/vshi 个/q 多维/n 的/ude1 结构/n ，/wd 则/c 用/p 一/m 组/q 连续/a 存储单元/n 存放/v 数组/n 的/ude1 数据/n 元素/n 就/d 有/vyou 个/q 次序/n 约定/vn 问题/n 。/wj 例如/v 图/n 5．1/m (/wkz a/x )/wky 的/ude1 二/m 维/q 数组/n 可以/v 看成/v 如/v 图/n 5．1/m (/wkz 。/wj 、/wn )/wky 的/ude1 一/m 维/q 数组/n ，/wd 也/d 可/v 看成/v 如/v 图/n 5．1/m (/wkz b/x )/wky 的/ude1 一/m 维/q 数组/n 。/wj 对/p 应/v 地/n ，/wd 对/p 二/m 维/q 数组/n 可/v 有/vyou 两/m 种/q 存储方式/n ：/wp 一/m 种/q 以/p 列/v 序/n 为主/vi 序/n (/wkz column/x  major/x  order/x )/wky 的/ude1 存储方式/n ，/wd 如/v 图/n 5．2/m (/wkz a/x )/wky 所/usuo 示/vg ；/wf 一/m 种/q 是/vshi 以/p 行/ng 序/n 为主/vi 序/n (/wkz row/x  major/x  order/x )/wky 的/ude1 存储方式/n ，/wd 如/v 图/n 5．2/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 在/p 扩展/v BASIC/x 、/wn PL／I/x 、/wn COBOL/x 、/wn PASCAL/x 和/cc c/x 语言/n 中/f ，/wd 用/v 的/ude1 都/d 是/vshi 以/p 行/ng 序/n 为主/vi 序/n 的/ude1 存储/vn 结构/n ，/wd 而/cc 在/p FORTRAN/x 语言/n 中/f ，/wd 用/v 的/ude1 是/vshi 以/p 列/v 序/n 为主/vi 序/n 的/ude1 存储/vn 结构/n 。/wj 
　　LoC：/x )/wky )/wky -/wp LOC/x (/wkz a11/x )/wky 
LoC：/x )/wky )/wky =LOC/x (/wkz a12/x )/wky 
Loc/x ~/n ：/wp 5=LOC/x (/wkz a1/x 。/wj )/wky 
A/x ’/wyy (/wkz nI/x ’/wyy ，/wd 2/m “/wyz ’/wyy ，/wd …/ws ，/wd ：/wp "/n )/wky     4/m 。/wj ’/wyy f/x ^/n ：/wp ¨/n ；/wf ¨/n …/ws ：/wp ’/wyy )/wky 
    、/wn     ’/wyy     ’/wyy     ’/wyy   n/x   ，/wd     ＼J/x     z/x     “/wyz J/x 
--/wp n/x ,/wd Ji/x ’/wyy (/wkz lJ/x ，/wd a2j/x ，/wd …/ws amj/x )/wky 
    图/n 5・2/m 二/m 维/q 数组/n 的/ude1 两/m 种/q 存储方式/n 
    (/wkz a/x )/wky 以/p 列/v 序/n 为主/vi 序/n ；/wf (/wkz b/x )/wky 以/p 行/ng 序/n 为主/vi 序/n 。/wj 
    由此/d ，/wd 对于/p 数组/n ，/wd 一旦/d 规定/v 了/ule 它/rr 的/ude1 维/nr1 数/n 和/cc 各/rz 维/ng 的/ude1 长度/n ，/wd 便/d 可/v 为/p 它/rr 分配存储/n 空间/n 。/wj 反之/c ，/wd 只要/c 给/v 出/vf 一/m 组/q 下标/n 便/d 可/v 求得/v 相应/vi 数组/n 元素/n 的/ude1 存储位置/n 。/wj 下面/f 仅/d 用/v 以/p 行/ng 序/n 为主/vi 序/n 的/ude1 存储/vn 结构/n 为/p 例/n 予以/vx 说明/vn 。/wj 
    假设/n 每个/r 数据/n 元素/n 占/v L/x 个/q 存储单元/n ，/wd 则/c 二/m 维/q 数组/n A/x 中/f 任/v 一/m 元素/n ao/x 的/ude1 存储位置/n 可/v 由/p 下/f 式/k 确定/v     LOC/x [/wkz i/x ，/wd J/x ]/wky =LOC/x [/wkz O/x ，/wd 0/m ]/wky +/m (/wkz b2×i+J/x )/wky L/x     (/wkz 5―1/m )/wky 
式/ng 中/f ，/wd LOCI/x  i/x ，/wd J/x ]/wky 是/vshi a／／/x 的/ude1 存储位置/n ；/wf LOC/x [/wkz 0/m ，/wd 0/m ]/wky 是/vshi 口/q 00/m 的/ude1 存储位置/n ，/wd 即/v 二/m 维/q 数组/n A/x 的/ude1 起始/vn 存储位置/n ，/wd 亦/d 称/v 为/p 基地/n 址/ng 或/c 基址/n 。/wj 
    将/p 式/k (/wkz 5―1/m )/wky 推广/v 到/v 一般/a 情况/n ，/wd 可/c 得到/v 托/v 维/nr1 数组/n 的/ude1 数据/n 元素/n 存储位置/n 的/ude1 计算公式/n ：/wp 
      LOC/x [/wkz j1/x ，/wd J2/x ，/wd …/ws ，/wd J/x 。/wj ]/wky =LOC/x [/wkz O/x ，/wd 0/m ，/wd …/ws ，/wd 0/m ]/wky +/m (/wkz b2/x  x/x …/ws ×b/x 。/wj ×j1+b3×/x …/ws ×b/x 。/wj ×j2/x 
    +/m …/ws +b/x 。/wj ×J/x 。/wj -/wp 1+J/x 。/wj )/wky L/x 
    n―l/x     ≈/m 
    =LOC/x [/wkz O/x ，/wd 0/m ，/wd …/ws ，/wd 0/m ]/wky +/m (/wkz ∑Ji/x  1I/x  b/x 。/wj +J/x 。/wj )/wky L/x 
    i=1/x   t=i+1/x 
可/v 缩写/n 成/v 
    LOC/x [/wkz j1/x ，/wd 2/m ，/wd …/ws ，/wd 。/wj ]/wky ：/wp LOC/x [/wkz O/x ，/wd 0/m ，/wd …/ws ，/wd 0/m ]/wky +∑6ii/x     (/wkz 5―2/m )/wky 
    i=1/x 
其中/rz   c/x 。/wj ：/wp L/x ，/wd c/x 。/wj 1=6i×q/x ，/wd   1/m </n i≤Y／/x 。/wj 
    式/ng (/wkz 5―2/m )/wky 称为/v n/x 维/b 数组/n 的/ude1 映象/n 函数/n 。/wj 容易/ad 看出/v ，/wd 数组/n 元素/n 的/ude1 存储位置/n 是/vshi 其/rz 下/vf 标的/n 线性/n 函数/n ，/wd 一旦/d 确定/v 了/ule 数/m 组/q 的/ude1 各/rz 维/ng 的/ude1 长度/n ，/wd ci/x 就/d 是/vshi 常/d 数/v 。/wj 由于/c 计算/v 各个/rz 元素/n 存储位置/n 的/ude1 时间/n 相等/vi ，/wd 所以/c 存取/v 数组/n 中/f 任/v 一/m 元素/n 的/ude1 时间/n 也/d 相等/vi 。/wj 我们/rr 称/v 具有/v 这/rzv 一/m 特点/n 的/ude1 存储/vn 结构/n 为/p 随机/b 存储/vn 结构/n 。/wj 
    下面/f 是/vshi 数组/n 的/ude1 顺序/n 存储表示/n 和/cc 实现/v 。/wj 
／／/m …/ws 数组/n 的/ude1 顺序/n 存储表示/n 
#/n include/x </n stdarq．h/x >/n 
#/n define/x  MAX/x ～/ws ARRAY―DIM/x  8/m 
tdef/x  8truct/x {/n 
    ElemType/x   */n base/x ；/wf 
    int/x  dim/x ；/wf 
    int/x     */n bounds/x ；/wf 
    int/x     */n constants/x ；/wf 
}/n Array/x ；/wf 
∥/w 标准/n 头/q 文件/n ，/wd 提供/v 宏/nz va―start/x 、/wn va/x ，/wd arg/x 和/cc va―end．/x 
∥/w 用于/v 存取/v 变/v 长/a 参数表/n 
∥/w 假设/v 数组/n 维/nr1 数/n 的/ude1 最/d 大值/n 为/p 8/m 
∥/w 数组/n 元素/n 基址/n ，/wd 由/p InitArray/x 分配/vn 
∥/w 数组/n 维/nr1 数/n 
∥/w 数组/n 维/nr1 界/n 基址/n ，/wd 由/p InitArray/x 分配/vn 
∥/w 数组/n 映象/n 函数/n 常量/n 基址/n ，/wd 由/p InitArray/x 分配/vn 
∥/w …/ws 基本/a 操作/vn 的/ude1 函数/n 原型/n 说明/v …/ws 
Status/x  InitArray/x (/wkz Array/x ＆/n A/x ，/wd int/x  dim/x ，/wd …/ws )/wky ；/wf 
    ∥/w 若/v 维/nr1 数/n dim/x 和/cc 随后/f 的/ude1 各/rz 维/ng 长度/n 合法/a ，/wd 则/c 构造/v 相应/vi 的/ude1 数组/n A/x ，/wd 并/cc 返回/v 0K/x 。/wj 
Status/x  DestroyArray/x (/wkz Array/x &/n A/x )/wky ；/wf 
  ∥/w 销毁/v 数组/n A/x 。/wj 
Status/x  Value/x (/wkz Array/x  A/x ，/wd ElemT/x !/wt ~/n e/x &/n e/x ，/wd …/ws )/wky ；/wf 
    ∥/w A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    ∥/w 若/c 各/rz 下标/n 不/d 超/v 界/k ，/wd 则/d e/x 赋值/v 为/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n 值/n ，/wd 并/cc 返回/v OK/x 。/wj 
Status/x  Assign/x (/wkz Array/x ＆/n A/x ，/wd ElemType/x  e/x ，/wd …/ws )/wky ；/wf 
    ∥/w A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    ∥/w 若/c 下标/n 不/d 超/v 界/k ，/wd 则/c 将/d e/x 的/ude1 值/n 赋/ng 给/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n ，/wd 并/cc 返回/v 0K/x 。/wj 
∥/w …/ws 基本/a 操作/vn 的/ude1 算法/n 描述/v …/ws 
Status/x  InitArray/x (/wkz Array/x ＆/n A/x ，/wd Jut/x  dim/x ，/wd …/ws )/wky {/n 
    ∥/w 若/v 维/nr1 数/n dim/x 和/cc 各/rz 维/ng 长度/n 合法/a ，/wd 则/c 构造/v 相应/vi 的/ude1 数组/n A/x ，/wd 并/cc 返回/v 0K/x 
    if/x (/wkz dim/x </n 1/m  Jl/x  dim/x >/n MAX―ARRAY―mM/x )/wky return/x  ERROR/x ；/wf 
    A．dim=dim/x ；/wf 
    A．bounds/x 。/wj (/wkz int/x 。/wj )/wky ,/wd anoc/x (/wkz dim/x */n slzeof/x (/wkz int/x )/wky )/wky ；/wf 
    if/x (/wkz !/wt A．bounds/x )/wky it/x (/wkz 0VERFL0w/x )/wky ；/wf 
    ∥/w 若/c 各/rz 维/ng 长度/n 合法/a ，/wd 则/c 存入/v A．bounds/x ，/wd 并/cc 求/v 出/vf A/x 的/ude1 元素/n 总数/n elemtota/x ’/wyy 
    elemtotal=I：/x 
va―start/x (/wkz ap/x ，/wd dim/x )/wky ；/wf     ∥/w ap/x 为/v va―list/x 类型/n ，/wd 是/vshi 存放/v 变/v 长/a 参数表/n 信息/n 的/ude1 数组/n 
for/x (/wkz i=0/x ；/wf i/x </n dim/x ；/wf ++i/x )/wky {/n 
    A．bounds/x [/wkz i/x ]/wky =va―arg/x (/wkz ap/x ，/wd ~/n nt/x )/wky ；/wf 
    if/x (/wkz A．bounds/x [/wkz i/x ]/wky </n 0/m )/wky return/x  UNDERFLOW/x ；/wf 
    elemtotal/x */n =A．boundsIi/x  J/x ；/wf 
I/x 
va―end/x (/wkz ap/x )/wky ；/wf 
A．base=/x (/wkz ElemType/x */n )/wky malloc/x (/wkz elemtotal/x */n slzeof/x (/wkz ElemType/x )/wky )/wky ；/wf 
if/x (/wkz !/wt A．base/x )/wky exit/x (/wkz O/x 、/wn ，/wd |/n 时/ng LOW/x )/wky ；/wf 
∥/w 求/v 映象/n 函数/n 的/ude1 常数/n Ci/x ，/wd 并/cc 存入/v A．constants/x [/wkz i-1/x ]/wky ，/wd i=l/x ，/wd …/ws ，/wd dim/x 
A．constants=/x (/wkz int/x */n )/wky malloc/x (/wkz dim/x */n sizeof/x (/wkz int/x )/wky )/wky ；/wf 
if/x (/wkz !/wt A．constants/x )/wky exit/x (/wkz ow/x ~/n Lo．/x )/wky ；/wf 
A．constants/x [/wkz dim-1/x ]/wky =1/m ；/wf ∥/w L=1/x ，/wd 指针/n 的/ude1 增减/vn 以/p 元素/n 的/ude1 大小/n 为/p 单位/n 
for/x (/wkz i=dim-2/x ；/wf   i/x >/n =0/m ；/wf   --/wp i/x )/wky 
  A．constants/x [/wkz i/x ]/wky =A．bounds/x [/wkz i+1/x ]/wky */n A．constants/x [/wkz i+1/x ]/wky ；/wf 
return/x  OK：/x 
Status/x  DestroyArray/x (/wkz Array/x &/n A/x )/wky {/n 
  ∥/w 销毁/v 数组/n A/x 。/wj 
  if/x (/wkz !/wt A．base/x )/wky return/x  ERROR/x ；/wf 
  free/x (/wkz A．base/x )/wky ；/wf     A．base=NULL/x ；/wf 
  if/x !/wt (/wkz A．bounds/x )/wky return/x  ERROR/x ；/wf 
  free/x (/wkz A．bounds/x )/wky ；/wf     A．bounds：NULL/x ；/wf 
  if/x !/wt (/wkz A．constants/x )/wky   return/x  ERROR/x ；/wf 
  free/x (/wkz A．eonstants/x )/wky ；/wf     A．constants=NULL/x 
  return/x  OK/x ；/wf 
}/n 
Status/x  Locate/x (/wkz Array/x  A/x ，/wd va―list/x  ap/x ，/wd int/x &/n off/x )/wky {/n 
    ∥/w 若/v ap/x 指示/n 的/ude1 各/rz 下/vf 标值/n 合法/a ，/wd 则/c 求/v 出/vf 该/rz 元素/n 在/p A/x 中/b 相对/b 地址/n off/x 
    off：0/x ；/wf 
    for/x (/wkz i=0/x ；/wf i/x </n A．dim/x ；/wf   ++i/x )/wky {/n 
    ind=va―arg/x (/wkz ap/x ，/wd int/x )/wky ；/wf 
    if/x (/wkz ind/x </n 0/m  ll/x  ind/x >/n =A．bounds/x [/wkz i/x ]/wky )/wky return/x  OVERFLOW/x ；/wf 
    off/x 十/m =A．constants/x [/wkz i/x ]/wky */n ind/x ；/wf 
    I/x 
    return/x  OK/x ；/wf 
I/x 
 Status/x  Value/x (/wkz Array/x  A/x ，/wd ElemType/x ＆/n e/x ，/wd …/ws )/wky {/n 
    ∥/w A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    ∥/w 若/c 各/rz 下标/n 不/d 超/v 界/k ，/wd 则/d e/x 赋值/v 为/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n 值/n ，/wd 并/cc 返回/v 0K/x 。/wj 
    va―start/x (/wkz ap/x ，/wd e/x )/wky ；/wf 
    if/x (/wkz (/wkz result=Locate/x (/wkz A/x ，/wd ap/x ，/wd off/x )/wky )/wky </n =0/m )/wky return/x  result/x ；/wf 
    e=/x */n (/wkz A．base+off/x )/wky ；/wf 
    return/x  OK/x ；/wf 
・/w 94・/m 
Status/x  Assign/x (/wkz Array/x ＆/n A/x ，/wd ElemType/x  e/x ，/wd …/ws )/wky {/n 
    ∥/w A/x 是/vshi n/x 维/b 数组/n ，/wd e/x 为/p 元素/n 变量/n ，/wd 随后/d 是/vshi n/x 个/q 下/f 标值/n 。/wj 
    ∥/w 若/c 下标/n 不/d 超/v 界/k ，/wd 则/c 将/d e/x 的/ude1 值/n 赋/ng 给/v 所/usuo 指定/v 的/ude1 A/x 的/ude1 元素/n ，/wd 并/cc 返回/v 0K/x 。/wj 
    Va―starlt/x (/wkz ap/x ，/wd e/x )/wky ；/wf 
    if/x (/wkz (/wkz result=Locate/x (/wkz A/x ，/wd ap/x ，/wd off/x )/wky )/wky </n =0/m )/wky return/x  result/x ；/wf 
    */n (/wkz A．base+off/x )/wky =e/x ；/wf 
    zaturn/x  OK/x 
}/n 
5．3/m 矩阵/n 的/ude1 压缩/vn 存储/vn 
    矩阵/n 是/vshi 很多/m 科学/n 与/cc 工程/n 计算/vn 问题/n 中/f 研究/v 的/ude1 数学/n 对象/n 。/wj 在/p 此/rzs ，/wd 我们/rr 感/vg 兴趣/n 的/ude1 不/d 是/vshi 矩阵/n 本身/rz ，/wd 而是/c 如何/ryv 存储矩阵/n 的/ude1 元/q 从而/c 使/v 矩阵/n 的/ude1 各种/rz 运算/vn 能/v 有效/a 地/ude2 进行/vx 。/wj 
    通常/d ，/wd 用/p 高级语言/n 编制程序/n 时/ng ，/wd 都/d 是/vshi 用/p 二/m 维/q 数组/n 来/vf 存储矩阵/n 元/q 。/wj 有/vyou 的/ude1 程序设计/n 语言/n 中/f 还/d 提供/v 了/ule 各种/rz 矩阵运算/n ，/wd 用户/n 使用/v 时/ng 都/d 很/d 方便/a 。/wj 
    然而/c ，/wd 在/p 数值/n 分析/vn 中/f 经常出现/n 一些/mq 阶数/n 很/d 高/a 的/ude1 矩阵/n ，/wd 同时/c 在/p 矩阵/n 中/f 有/vyou 许多/m 值/n 相同/a 的/ude1 元素/n 或者/c 是/vshi 零/m 元素/n 。/wj 有时/d 为了/p 节省存储/n 空间/n ，/wd 可以/v 对/p 这/rzv 类/q 矩阵/n 进行/vx 压缩/vn 存储/vn 。/wj 所谓/v 压缩/v 存储/vn 是/vshi 指/v ：/wp 为/v 多/m 个/q 值/n 相同/a 的/ude1 元/q 只/d 分配/v 一个/mq 存储空间/n ；/wf 对/p 零/m 元/q 不/d 分配空间/n 。/wj 
    假若/c 值/v 相同/a 的/ude1 元素/n 或者/c 零/m 元素/n 在/p 矩阵/n 中/f 的/ude1 分布/vn 有/vyou 一定/b 规律/n ，/wd 则/c 我们/rr 称/v 此类/r 矩阵/n 为/p 特殊/a 矩阵/n ；/wf 反之/c ，/wd 称为/v 稀疏/a 矩阵/n 。/wj 下面/f 分别/d 讨论/v 它们/rr 的/ude1 压缩/vn 存储/vn 。/wj 
  5．3．1/m 特殊/a 矩阵/n 
  若/v n/x 阶矩阵/n A/x 中/f 的/ude1 元/q 满足/v 下/f 述/vg 性质/n i/x     1≤i/x ，/wd ≤≤/m ，/wd z/x 
0/m 称为/v ，/wd z/x 阶/ng 对称/a 矩阵/n 。/wj 
    对于/p 对称/a 矩阵/n ，/wd 我们/rr 可以/v 为/p 每/rz 一/m 对/q 对称/a 元/q 分配/v 一个/mq 存储空间/n ，/wd 则/c 可/v 将/d n/x 。/wj 个/q 元/q 压缩/v 存储/v 到/v n/x (/wkz n+1/x )/wky ／2/m 个/q 元/q 的/ude1 空间/n 中/f 。/wj 不/d 失/v 一般性/n ，/wd 我们/rr 可以/v 行/ng 序/n 为主/vi 序/n 存储/vn 其/rz 下/f 三/m 角/q (/wkz 包括/v 对角线/n )/wky 中/f 的/ude1 元/q 。/wj 
    假设/v 以/p 一/m 维/q 数组/n 阳/ag [/wkz 0．．n/x (/wkz n+1/x )/wky ／2/m ]/wky 作为/v n/x 阶/ng 对称/a 矩阵/n A/x 的/ude1 存储/vn 结构/n ，/wd 则/d sa/x [/wkz k/x ]/wky 和/cc 矩阵元/n aii/x 之间/f 存在/v 着/uzhe --/wp 对应/vi 的/ude1 关系/n ：/wp 对于/p 任意/d 给定/v 一/m 组/q 下标/n (/wkz i/x ，/wd )/wky ，/wd 均/d 可/v 在/p m/x 中/f 找到/v 矩阵元/n aij/x ，/wd 反之/c ，/wd 对/p 所有/b 的/ude1 k=1/x ，/wd 2/m ，/wd …/ws ，/wd 都/d 能/v 确定/v sa/x [/wkz k/x ]/wky 中/f 的/ude1 元/q 在/p 矩阵/n 中/f 的/ude1 位置/n (/wkz i/x ，/wd j/x )/wky 。/wj 由此/d ，/wd 称/v sa/x [/wkz 0．．/m (/wkz n+1/x )/wky ／2/m ]/wky 为/v 
n/x 阶/ng 对称/a 矩阵/n A/x 的/ude1 压缩/vn 存储/vn (/wkz 见/v 图/n 5．3/m )/wky 。/wj 
    图/n 5．3/m 对称/a 矩阵/n 的/ude1 压缩/vn 存储/vn 
    这种/r 压缩/v 存储/vn 的/ude1 方法/n 同样/d 也/d 适用/vi 于/p 三角/n 矩阵/n 。/wj 所谓/v 下/vf (/wkz 上/f )/wky 三角/n 矩阵/n 是/vshi 指/v 矩阵/n 的/ude1 上/f (/wkz 下/f )/wky 三/m 角/q (/wkz 不/d 包括/v 对角线/n )/wky 中/f 的/ude1 元/q 均/d 为/v 常数/n c/x 或/c 零/m 的/ude1 n/x 阶矩阵/n 。/wj 则/c 除了/p 和/cc 对称/a 矩阵/n 一样/uyy ，/wd 只/d 存储/v 其/rz 下/f (/wkz 上/f )/wky 三/m 角/q 中/f 的/ude1 元/q 之外/f ，/wd 再/d 加/v 一个/mq 存储/vn 常数/n c/x 的/ude1 存储空间/n 即可/v 。/wj 
　　在/p 数值/n 分析/vn 中/f 经常出现/n 的/ude1 还有/v 另/rz 一/m 类/q 特殊/a 矩阵/n 是/vshi 对角/n 矩阵/n 。/wj 在/p 这种/r 矩阵/n 中/f ，/wd 所有/b 的/ude1 非零/n 元/q 都/d 集中/v 在/p 以/p 主/ag 对角线/n 为/p 中心/n 的/ude1 带状/n 区域/n 中/f 。/wj 即/v 除了/p 主/ag 对角线/n 上/f 和/cc 直接/ad 在/p 对角线/n 上/f 、/wn 下方/f 若干/m 条/q 对角线/n 上/f 的/ude1 元/q 之外/f ，/wd 所有/b 其它/rz 的/ude1 元/q 皆/d 为/v 零/m 。/wj 如/v 图/n 5．4/m 所/usuo 示/vg 。/wj 对/p 这种/r 矩阵/n ，/wd 我们/rr 亦/d 可/v 按/p 某个/rz 原则/n (/wkz 或/c 以/p 行/vi 为主/vi ，/wd 或/c 以/p 对角线/n 的/ude1 顺序/n )/wky 将/p 其/rz 压缩/v 存储/v 到/v 一/m 维/q 数组/n 上/f 。/wj 
对角/n 矩阵/n 
(/wkz b/x )/wky 三/m 对角/n 矩阵/n 。/wj 
    在/p 所有/b 这些/rz 我们/rr 统称/v 为/p 特殊/a 矩阵/n 的/ude1 矩阵/n 中/f ，/wd 非零/n 元/q 的/ude1 分布/vn 都/d 有/vyou 一个/mq 明显/a 的/ude1 规律/n ，/wd 从而/c 我们/rr 都/d 可/v 将/p 其/rz 压缩/v 存储/v 到/v 一/m 维/q 数组/n 中/f ，/wd 并/cc 找到/v 每个/r 非零/n 元/q 在/p 一/m 维/q 数组/n 中/f 的/ude1 对应/vn 关系/n 。/wj 
    然而/c ，/wd 在/p 实际/n 应用/vn 中/f 我们/rr 还/d 经常/d 会/v 遇到/v 另/rz 一/m 类/q 矩阵/n ，/wd 其/rz 非零/n 元/q 较/d 零/m 元/q 少/a ，/wd 且/c 分布/vi 没有/v 一定/b 规律/n ，/wd 我们/rr 称之为/v 稀疏/a 矩阵/n 。/wj 这/rzv 类/q 矩阵/n 的/ude1 压缩/vn 存储/vn 就/d 要/v 比/p 特殊/a 矩阵/n 复杂/a 。/wj 这/rzv 就/d 是/vshi 下/vf 一/m 节/q 我们/rr 要/v 讨论/v 的/ude1 问题/n 。/wj 
    5．3．2/m 稀疏/a 矩阵/n 
    什么/ry 是/vshi 稀疏/a 矩阵/n ?/ww 人们/n 无法/vd 给/v 出/vf 确切/a 的/ude1 定义/n ，/wd 它/rr 只/d 是/vshi 一个/mq 凭/p 人们/n 的/ude1 直觉/n 来/vf 了解/v 的/ude1 概念/n 。/wj 假设/v 在/p m×n/x 的/ude1 矩阵/n 中/f ，/wd 有/vyou ￡/m 个/q 元素/n 不/d 为/v 零/m 。/wj 令/v a/x ，/wd 称/v a/x 为/p 矩阵/n 的/ude1 稀疏/a 因子/n 。/wj 通常/d 认为/v a≤0．05/x 时/ng 称为/v 稀疏/a 矩阵/n 。/wj 矩阵运算/n 的/ude1 种类/n 很多/m ，/wd 在/p 下列/b 抽象数据/n 类型/n 稀疏/a 矩阵/n 的/ude1 定义/n 中/f ，/wd 只/d 列举/v 了/ule 几/m 种/q 常见/a 的/ude1 运算/vn 。/wj 
    抽象数据/n 类型/n 稀疏/a 矩阵/n 的/ude1 定义/n 如下/vi ：/wp 
    AIE/x  SparseMatrix/x {/n 
    数据/n 对象/n ：/wp D=/x {/n a/x 。/wj 。/wj }/n i：1/x ，/wd 2/m ，/wd …/ws ，/wd m/x ；/wf j：l/x ，/wd 2/m ，/wd …/ws ，/wd n/x ；/wf 
    a/x ，/wd 。/wj ∈ElemSet/x ，/wd m/x 和/cc n/x 分别/d 称为/v 矩阵/n 的/ude1 行/a 数/n 和/cc 列数/n }/n 
    数据/n 关系/n ：/wp R=/x {/n Row．Col/x  l/x 
    Row=l/x </n aill．aill+1/x >/n 1/m  1≤i≤m/x ，/wd   l≤j≤n―l/x }/n 
    Col=/x {/n </n ai．/x 。/wj ，/wd ai+1/x 。/wj >/n i/x  l≤i≤m―l/x ，/wd   l≤j≤n/x  I/x 
基本/ad 操作/v ：/wp 
  CreateSMatr/x ’/wyy ix/x (/wkz ＆/n M/x )/wky ；/wf 
    操作/v 结果/n ：/wp 创建/v 稀疏/a 矩阵/n M/x 。/wj 
  DestroySMatriX/x (/wkz &/n M/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 稀疏/a 矩阵/n M/x 。/wj 
  PrintSMatrix/x (/wkz M/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 输出/v 稀疏/a 矩阵/n M/x 。/wj 
  CopySMatri/x 】/wky c/x (/wkz M/x ，/wd ＆/n T/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 由/p 稀疏/a 矩阵/n M/x 复制/v 得到/v T/x 。/wj 
  ．/w AddSMatrix/x (/wkz M/x ，/wd N/x ，/wd &/n Q/x )/wky ；/wf     ．/w 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 与/p N/x 的/ude1 行/a 数/n 和/cc 列数/n 对应/vi 相等/vi 。/wj 
    操作/v 结果/n ：/wp 求/v 稀疏/a 矩阵/n 的/ude1 和/cc Q=M+N/x 。/wj 
  SubtMatrix/x (/wkz M/x ，/wd N/x ，/wd ＆/n Q/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 与/p N/x 的/ude1 行/a 数/n 和/cc 列数/n 对应/vi 相等/vi 。/wj 
    操作/v 结果/n ：/wp 求/v 稀疏/a 矩阵/n 的/ude1 差/a Q=M--N/x 。/wj 
  Mul/x 。/wj tSMatz/x 。/wj ix/x (/wkz M/x ，/wd N/x ，/wd ＆/n Q/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 的/ude1 列数/n 等于/v N/x 的/ude1 行/a 数/n 。/wj 
    操作/v 结果/n ：/wp 求/v 稀疏/a 矩阵/n 乘积/n Q=MxH/x 。/wj 
  TransposeSMatrix/x (/wkz M/x ，/wd ＆/n T/x )/wky ；/wf 
    初始条件/n ：/wp 稀疏/a 矩阵/n M/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 求/v 稀疏/a 矩阵/n M/x 的/ude1 转/vd 置/v 矩阵/n T/x 。/wj 
  IADT/x  S/x ~/n seMatr-/x 
    如何/ryv 进行/vx 稀疏/a 矩阵/n 的/ude1 压缩/vn 存储/vn 呢/y ?/ww 
    按照/p 压缩/v 存储/vn 的/ude1 概念/n ，/wd 只/d 存储/v 稀疏/a 矩阵/n 的/ude1 非零/n 元/q 。/wj 因此/c ，/wd 除了/p 存储/v 非零/n 元/q 的/ude1 值/n 之外/f ，/wd 还/d 必须/d 同时/d 记/v 下/vf 它/rr 所/usuo 在/v 行/ng 和/cc 列/v 的/ude1 位置/n (/wkz i/x ，/wd j/x )/wky 。/wj 反之/c ，/wd 一个/mq 三/m 元/q 组/n (/wkz i/x ，/wd j/x ，/wd 口/n “/wyz )/wky 唯一/d 确定/v 了/ule 矩阵/n A/x 的/ude1 一个/mq 非零/n 元/q 。/wj 由此/d ，/wd 稀疏/a 矩阵/n 可/v 由/p 表示/v 非零/n 元/q 的/ude1 三/m 元/q 组/n 及其/cc 行列/n 数/n 唯一/d 确定/v 。/wj 例如/v ，/wd 下列/b 三元/b 组/n 表/n     (/wkz (/wkz 1/m ，/wd 2/m ，/wd 12/m )/wky ，/wd (/wkz 1/m ，/wd 3/m ，/wd 9/m )/wky ，/wd (/wkz 3/m ，/wd 1/m ，/wd -/wp 3/m )/wky ，/wd (/wkz 3/m ，/wd 6/m ，/wd 14/m )/wky ，/wd (/wkz 4/m ，/wd 3/m ，/wd 24/m )/wky ，/wd (/wkz 5/m ，/wd 2/m ，/wd 18/m )/wky ，/wd (/wkz 6/m ，/wd l/x ，/wd 15/m )/wky ，/wd (/wkz 6/m ，/wd 4/m ，/wd 
-/wp 7/m )/wky )/wky 加上/v (/wkz 6/m ，/wd 7/m )/wky 这/rzv 一/m 对/p 行/ng 、/wn 列值/n 便/d 可/v 作为/p 图/n 5．5/m 中/b 矩阵/n M/x 的/ude1 另/rz 一/m 种/q 描述/vn 。/wj 而/cc 由/p 上述/b 三/m 元/q 组/n 表/n 的/ude1 不同/a 表示方法/n 可/v 引出/v 稀疏/a 矩阵/n 不同/a 的/ude1 压缩/vn 存储方法/n 。/wj 
图/n 5．5/m 稀疏/a 矩阵/n M/x 和/cc 丁/ng 
  一/m 、/wn 三/m 元/q 组/n 顺序/n 表/n 
  假设/v 以/p 顺序/n 存储/vn 结构/n 来/vf 表示/v 三/m 元/q 组/n 表/n ，/wd 则/c 可/v 得/ude3 稀疏/a 矩阵/n 的/ude1 一/m 种/q 压缩/v 存储方式/n ――/wp 我们/rr 称之为/v 三元/b 组/n 顺序/n 表/n 。/wj 
∥/w …/ws 稀疏/a 矩阵/n 的/ude1 三/m 元/q 组/n 顺序/n 表存储/n 表示/v …/ws 
#/n define/x  MAXSIZE/x  12500/m     ∥/w 假设/v 非零/n 元/q 个/q 数/n 的/ude1 最/d 大值/n 为/p 12500/m 
type/x ~/n ef/x  struct/x {/n 
    iat/x     i/x ，/wd j/x ；/wf     ∥/w 该/rz 非零/n 元/q 的/ude1 行/a 下标/n 和/cc 列/v 下标/n 
    ElelaTxjl/x ~/n   e：/x 
}/n Triple/x ；/wf     ‘/wyz 
er/x ~/n ef/x  union/x {/n 
    Triple/x  data/x [/wkz MAX/x $/n 1ZE+1/x ]/wky ；/wf ∥/w 非零/n 元/q 三/m 元/q 组/n 表/n ，/wd data/x [/wkz O/x ]/wky 未/d 用/v 
    int/x     Ⅲ/m u/x ，/wd nu/x ，/wd tu/x ；/wf     ∥/w 矩阵/n 的/ude1 行/a 数/n 、/wn 列数/n 和/cc 非零/n 元/q 个数/n 
}/n TSMatrix/x ；/wf 
在/p 此/rzs ，/wd data/x 域/n 中/f 表示/v 非零/n 元/q 的/ude1 三/m 元/q 组/n 是/vshi 以/p 行/ng 序/n 为主/vi 序/n 顺序/n 排列/v 的/ude1 ，/wd 从/p 下面/f 的/ude1 讨论/vn 中/f 读者/n 容易/ad 看/v 出/vf 这样/rzv 做/v 将/d 有利于/v 进行/vx 某些/rz 矩阵运算/n 。/wj 下面/f 将/d 讨论/v 在/p 这种/r 压缩/v 存储/vn 结构/n 下/f 如何/ryv 实现/v 矩阵/n 的/ude1 转/vd 置/v 运算/vn 。/wj 
    转/v 置/v 运算/vn 是/vshi 一/m 种/q 最/d 简单/a 的/ude1 矩阵运算/n 。/wj 对于/p 一个/mq m×/x 住/vi 的/ude1 矩阵/n M/x ，/wd 它/rr 的/ude1 转/vd 置/v 矩阵/n T/x 是/vshi 一个/mq n×m/x 的/ude1 矩阵/n ，/wd 且/c T/x (/wkz i/x ，/wd J/x )/wky =M/x (/wkz 歹/ag ，/wd i/x )/wky ，/wd 1≤i≤/x ”/wyy ，/wd 1≤J≤/x 优/ng 。/wj 例如/v ，/wd 图/n 5．5/m 中/f 的/ude1 矩阵/n M/x 和/cc T/x 互为/d 转/v 置/v 矩阵/n 。/wj 
    显然/a ，/wd 一个/mq 稀疏/a 矩阵/n 的/ude1 转/vd 置/v 矩阵/n 仍然/d 是/vshi 稀疏/a 矩阵/n 。/wj 假设/v 口/n 和/cc 6/m 是/vshi ’/wyy I/x '/n SMatrix/x 型/k 的/ude1 变量/n ，/wd 分别/d 表示/v 矩阵/n M/x 和/cc T/x 。/wj 那么/c ，/wd 如何/ryv 由/p a/x 得到/v 6/m 呢/y ?/ww 
    从/p 分析/v n/x 和/cc 6/m 之间/f 的/ude1 差异/n 可见/c 只/d 要/v 做到/v ：/wp (/wkz 1/m )/wky 将/p 矩阵/n 的/ude1 行列/n 值/n 相互/d 交换/v ；/wf (/wkz 2/m )/wky 将/p 每/rz 个/q 三/m 元/q 组/n 中/f 的/ude1 i/x 和/cc 歹/ag 相互/d 调换/v ；/wf (/wkz 3/m )/wky 重排/v 三元/b 组/n 之间/f 的/ude1 次序/n 便/d 可/v 实现/v 矩阵/n 的/ude1 转/vd 置/v 。/wj 前/f 二/m 条/q 是/vshi 容易/ad 做到/v 的/ude1 ，/wd 关键/n 是/vshi 如何/ryv 实现/v 第三/m 条/q 。/wj 即/v 如何/ryv 使/v b．data/x 冲/v 的/ude1 三/m 元/q 组/n 是/vshi 以/p T/x 的/ude1 行/n (/wkz M/x 的/ude1 列/n )/wky 为主/vi 序/n 依次/d 排列/v 的/ude1 。/wj 
6/m     4/m 
a．data/x 
 J/x     V/x 
3/m     ―/wp 3/m 
6/m     15/m 
1/m     12/m 
5/m     18/m 
1/m     9/m 
4/m     24/m 
6/m     ―/wp 7/m 
3/m     14/m 
b．data/x 
可以/v 有/vyou 两/m 种/q 处理/vn 方法/n ：/wp 
    (/wkz 1/m )/wky 按照/p b．data/x 中/f 三/m 元/q 组/n 的/ude1 次序/n 依次/d 在/p a．data/x 中/f 找到/v 相应/vi 的/ude1 三/m 元/q 组/n 进行/vx 转/vd 置/v 。/wj 换句话说/c ，/wd 按照/p 矩阵/n M/x 的/ude1 列/n 序/n 来/f 进行/vx 转/vd 置/v 。/wj 为了/p 找/v 到/v M/x 的/ude1 每/rz 一/m 列/q 中/b 所有/b 的/ude1 非零元素/n ，/wd 需要/v 对/p 其/rz 三/m 元/q 组/n 表/n a．data/x 从/p 第一/m 行/q 起/vf 整个/b 扫描/vn 一/m 遍/qv ，/wd 由于/c a．data/x 是/vshi 以/p M/x 的/ude1 行/a 序/n 为主/vi 序/n 来/vf 存放/v 每个/r 非零/n 元/q 的/ude1 ，/wd 由此/d 得/ude3 到/v 的/ude1 恰/d 是/vshi b．data/x 应有/v 的/ude1 顺序/n 。/wj 其/rz 具体/a 算法/n 描述/v 如/v 算法/n 5．1/m 所/usuo 示/vg 
Status/x  TransposeSMatrix/x (/wkz TSMa/x ~/n rix/x  M．TSMatrix/x &/n T/x )/wky {/n 
    ／／/m 采用/v 三/m 元/q 组/n 表存储/n 表示/v ，/wd 求/v 稀疏/a 矩阵/n M/x 的/ude1 转/vd 置/v 矩阵/n T/x 。/wj 
    T．mu=M．nu/x ；/wf T．nu/x 。/wj M．mu/x ；/wf T．tu/x 。/wj M．tu/x ；/wf 
    if/x (/wkz T．tu/x )/wky {/n 
    q=1/x ；/wf 
    far/x (/wkz col=1/x ；/wf col/x </n =M．nu/x ；/wf ++c01/x )/wky 
    for/x (/wkz P=I/x ；/wf p/x </n =M．tu/x ；/wf +/m ’/wyy p/x )/wky 
    if/x (/wkz M．data/x [/wkz p/x ]/wky ．/w J==c01/x )/wky {/n 
    T．data/x [/wkz q/x ]/wky ．/w i=M．data/x [/wkz p/x ]/wky ．/w J/x ；/wf T．data/x [/wkz q/x ]/wky ．/w J=M．data/x [/wkz p/x ]/wky ．/w i/x ；/wf 
    T．data/x [/wkz q/x ]/wky ．/w e=M．data/x [/wkz p/x ]/wky ．/w e/x ；/wf   +/m ’/wyy q/x ；/wf I/x 
    }/n 
    return/x  OK/x ；/wf 
}/n ∥/w TransposeSMatrix/x 
    算法/n 5．1/m 
    分析/v 这个/rz 算法/n ，/wd 主要/b 的/ude1 工作/vn 是/vshi 在/p P/x 和/cc col/x 的/ude1 两/m 重/a 循环/vn 中/f 完成/v 的/ude1 ，/wd 故/c 算法/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz nu/x ~/n tu/x )/wky ①/m ，/wd 即/v 和/cc M/x 的/ude1 列数/n 和/cc 非零/n 元/q 的/ude1 个/q 数/n 的/ude1 乘积/n 成/v 正比/n 。/wj 我们/rr 知道/v ，/wd 一般/a 矩阵/n 的/ude1 转/vd 置/v 算法/n 为/v     for/x (/wkz col：1/x ；/wf col/x </n =nu/x ；/wf ++c01/x )/wky 
    for/x (/wkz row=1/x ；/wf row/x ~/n --/wp mu/x ；/wf ++row/x )/wky 
    T/x [/wkz c01/x ]/wky [/wkz row/x ]/wky =M/x [/wkz row/x ]/wky [/wkz c01/x ]/wky ；/wf 
其/rz 时间/n 复杂度/n 为/v O/x (/wkz mu×nil/x )/wky 。/wj 当/p 非零/n 元/q 的/ude1 个数/n tu/x 和/cc mu×nu/x 同/p 数量级/n 时/ng ，/wd 算法/n 5．1/m 的/ude1 时间/n 复杂度/n 就/d 为/v O/x (/wkz mu×nu2/x )/wky 了/ule (/wkz 例如/v ，/wd 假设/v 在/p 100×500/m 的/ude1 矩阵/n 中/f 有/vyou ttl----10000/x 个/q 非零/n 元/q )/wky ，/wd 虽然/c 节省/v 了/ule 存储空间/n ，/wd 但/c 时间/n 复杂度/n 提高/v 了/y ，/wd 因此/c 算法/n 5．1/m 仅/d 适于/v tu/x </n </n mu/x ~/n flu/x 的/ude1 情况/n 。/wj 
    (/wkz 2/m )/wky 按照/p a．data/x 中/f 三/m 元/q 组/n 的/ude1 次序/n 进行/vx 转/vd 置/v ，/wd 并/cc 将/d 转/v 置/v 后/f 的/ude1 三/m 元/q 组/n 置/v 入/v b/x 中/f 恰当/a 的/ude1 位置/n 。/wj 如果/c 能/v 预先/d 确定/v 矩阵/n M/x 中/f 每/rz 一/m 列/q (/wkz 即/v T/x 中/f 每/rz 一/m 行/q )/wky 的/ude1 第一/m 个/q 非零/n 元/q 在/p b．data/x 中/f 应有/v 的/ude1 位置/n ，/wd 那么/c 在/p 对/p a．data/x 中/f 的/ude1 三/m 元/q 组/n 依次/d 作/v 转/vd 置/v 时/ng ，/wd 便/d 可/v 直接/ad 放/v 到/v b．data/x 中/f 恰当/a 的/ude1 位置/n 上/f 去/vf 。/wj 为了/p 确定/v 这些/rz 位置/n ，/wd 在/p 转/vd 置/v 前/f ，/wd 应/v 先/d 求得/v M/x 的/ude1 每/rz 一/m 列/q 中非/ns 零/m 元/q 的/ude1 个/q 数/n ，/wd 进而/c 求得/v 每/rz 一/m 列/q 的/ude1 第一/m 个/q 非零/n 元/q 在/p b．data/x 中/f 应有/v 的/ude1 位置/n 。/wj 
    在/p 此/rzs ，/wd 需要/v 附设/v num/x 和/cc cpot/x 两/m 个/q 向量/n 。/wj num/x [/wkz c01/x ]/wky 表示/v 矩阵/n M/x 中/f 第/m col/x 列/v 中非/ns 零/m 元/q 的/ude1 个/q 数/n ，/wd cpot/x [/wkz c01/x ]/wky 指示/n M/x 中/f 第/m col/x 列/n 的/ude1 第一/m 个/q 非零/n 元/q 在/p b．data/x 中/f 的/ude1 恰当/a 位置/n 。/wj 显然/ad 有/vyou     j/x  cpot/x [/wkz 1/m ]/wky =1/m ；/wf     rd/x 、/wn 
    I/x  cpot/x [/wkz c01/x ]/wky =cpot/x [/wkz col-1/x ]/wky +num/x [/wkz col-1/x ]/wky     2≤∞l≤a．nu/x     、/wn 。/wj …/ws 
例如/v ，/wd 对/p 图/n 5．5/m 的/ude1 矩阵/n M/x ，/wd Bum/x 和/cc cpot/x 的/ude1 值/n 如/v 表/vg 5．1/m 所/usuo 示/vg 。/wj 
表/n 5．1/m 矩阵/n M/x 的/ude1 向量/n elmt/x 的/ude1 值/n 
①/m 在/p 此/rzs ，/wd 我们/rr 将/d M．nu/x 和/cc M．tu/x 简写/n 成/v nu/x 和/cc tu/x ，/wd 以下/f 同/v 。/wj 
这种/r 转/v 置/v 方法/n 称为/v 快速/d 转/v 置/v ，/wd 其/rz 算法/n 如/v 算法/n 5/m  2/m 所/usuo 示/vg 。/wj 
    Status/x  EasTransp/x 。/wj sentnx/x (/wkz atr/x 】/wky x/x  M/x ，/wd TSHatr/x ~/n ＆/n T/x )/wky I/x 
    ∥/w 采用/v 三/m 元/q 组/n 顺序/n 表存储/n 表示/v ，/wd 求/v 稀疏/a 矩阵/n H/x 的/ude1 转/vd 置/v 矩阵/n T/x 。/wj 
    T/x  nm/x 。/wj M/x  nu/x ；/wf T―M/x  mu/x ；/wf Ttu/x 。/wj Mtu/x ；/wf 
    if/x (/wkz Ttu/x )/wky l/x 
    h/x (/wkz ∞l=I/x ；/wf coi/x </n -/wp M/x “/wyz ；/wf _/n +c01/x )/wky nu/x Ⅲ/m [/wkz c01/x ]/wky =0/m ；/wf 
    f/x (/wkz t=l/x ；/wf t/x </n =Mtu/x ；/wf ++t/x )/wky ¨/n Ⅱ/m [/wkz M/x  data/x [/wkz t/x ]/wky J/x 】/wky ；/wf ／／/m 求/v M/x 中/f 每/rz 一/m 列/q 含非/n 零/m 元/q 个数/n 
    cpot/x [/wkz I/x ¨/n _/n I/x ；/wf 
    ∥/w 求/v 第/m col/x 列/n 中/f 第一/m 个/q 非/b 举元/nr2 在/p bdata/x 巾/ng 的/ude1 序号/n 
    f/x Ⅱ/m (/wkz ∥/w 1/m  2/m ；/wf c/x 。/wj i/x </n -/wp M/x “/wyz ；/wf ¨/n c01/x )/wky cpot/x [/wkz e01/x ]/wky =cpot/x [/wkz col-/x 【/wkz ]/wky p/x  n/x ~/n (/wkz col―1/x ]/wky ；/wf 
    for/x (/wkz p=l/x ；/wf p/x </n =M/x  tu/x ；/wf l/x ’/wyy p/x )/wky l/x 
    col=M/x  data/x [/wkz P/x ]/wky J/x ；/wf   q=cpot/x [/wkz c01/x ]/wky ；/wf 
    T/x ~/n ata/x [/wkz q/x ]/wky i=Mdat/x ~/n [/wkz p/x ]/wky ]/wky ；/wf T/x  da/x [/wkz q/x 】/wky ]/wky =M/x  data/x [/wkz p/x ]/wky 1/m ；/wf 
    T/x  data/x [/wkz q/x ]/wky e=H/x  data/x [/wkz p/x ]/wky 。/wj ；/wf   1/m }/n cpot/x [/wkz c01/x ]/wky ；/wf 
    l/x ∥/w for/x 
    l/x ∥/w ，/wd f/x 
    rturIl/x  OK/x 
    l/x ∥/w EastTransposes№trlx/x 
算法/n 5/m  2/m 
    这个/rz 算法/n 仅/d 比/p n/x 一个/mq 算法/n 多/ad 用/v 了/ule 两/m 个/q 辅助/vn 向量/n 0/m 。/wj 从/p 时间/n 上/f 看/v ．/w 算法/n 11/m _/n l/x 有/vyou 四/m 个/q 并列/v 的/ude1 单/b 循环/vn ，/wd 循环/vn 次数/n 分别/d ll/x 为/v nu/x ¨/n tu/x ，/wd 因而/c 总/b 的/ude1 时/ng 问/v 复杂度/n 为/v 0/m (/wkz nu/x 十/m lu/x )/wky n/x 在/p M/x 的/ude1 非零/n 元/q 个数/n t/x 。/wj 和/cc m/x 。/wj ×nu/x 等/udeng 数量级/n 时/ng ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz mu×nu/x )/wky ，/wd 和/cc 经典/n 算法/n 的/ude1 时/ng 问/v 复杂度/n 相同/a 。/wj 
    三/m 元/q 组/n 顺序/n 表/n 又/d 称/v 有序/a 的/ude1 双/m 下标/n 法/n ，/wd 它/rr 的/ude1 特点/n 是/vshi ，/wd 非零/n 元/q 在/p 表/n 中/f 按/p 行/ng 序/n 有序/ad 存储/v ．/w 因此/c 便于/v 进行/vx 依/v 行/ng 顺序/n 处理/v 的/ude1 矩阵运算/n 。/wj 然而/c ，/wd 若/c 需/v 按/p 行/ng 号/n 存取/v 某/rz 一/m 行/q 的/ude1 非零/n 元/q ，/wd 则/c 需/v 从头/d 开始/v 进行/vx 查找/vn 。/wj 
  二/m 、/wn 行/a 逻辑链/n 接/v 的/ude1 顺序/n 表/n 
  为/p r/x 便于/v 随机/d 存取任意/n 一行/n 的/ude1 非零/n 元/q ，/wd 则/c 需/v 知道/v 每/rz 一/m 行/q 的/ude1 第/m 个/q 非零/n 元/q 在/p 三/m 元/q 组/n 表/n 中/f 的/ude1 位置/n 。/wj 为此/bl ，/wd 可/c 将/d 上/vf 节/n 快速/d 转/v 置/v 矩阵/n 的/ude1 算法/n 中/f 创建/v 的/ude1 ，/wd 指示/v “/wyz 行/ng ”/wyy 信息/n 的/ude1 辅助/vn 数组/n cpot/x 固定/v 在/p 稀疏/a 矩阵/n 的/ude1 存储/vn 结构/n 中/f 。/wj 称/v 这种/r “/wyz 带/v 行/ng 链接/n 信息/n ”/wyy 的/ude1 三/m 元/q 组/n 表/vg 为/v 行/ng 逻辑链/n 接/v 时/ng 顺序/n 表/n ，/wd 其/rz 类型/n 描述/v 如下/vi ：/wp 
typedef/x  8tn1/x 
  Triple/x  data/x [/wkz MAY/x ~/n 91ZE/x ’/wyy 
  iIt/x     rposlM/x Ⅺ/m Ⅱ/m C/x  1/m  l/x 
∥/w 非/b ：/wp 零/m 元/q 三/m 元/q 组/n 表/n 
∥/w 各行/r 第一/m 个/q m/x 零/m 元/q 的/ude1 位置/n 表/n 
∥/w 矩阵/n 的/ude1 行/a 数/n 、/wn 列数/n 和/cc 非零/n 元/q 个数/n 
在/p 下面/f 讨论/v 的/ude1 两/m 个/q 稀疏/a 矩阵/n 相乘/v 例子/n 中/f ，/wd 容易/ad 看/v 出/vf 这种/r 表示方法/n 的/ude1 优越性/n ：/wp 
    两/m 个/q 矩阵/n 相乘/v 的/ude1 经典/n 算法/n 也/d 是/vshi 大家/rr 所/usuo 熟悉/v 的/ude1 。/wj 若/c 设/v 
    Q=M×N/x 
其中/rz ，/wd M/x 是/vshi m1×n1/x 矩阵/n ，/wd N/x 是/vshi m2×n2/x 矩阵/n 。/wj 当/p n1=m2/x 时/ng 有/vyou ：/wp 
    for/x (/wkz i=1/x ；/wf i/x </n =ml/x ；/wf ++i/x )/wky 
    for/x (/wkz j=l/x ；/wf j/x </n =n2/x ；/wf ++j/x )/wky {/n 
    Q/x [/wkz i/x ]/wky [/wkz j/x ]/wky =0/m ；/wf 
    for/x (/wkz k=1/x ；/wf k/x </n =n1/x ；/wf ++k/x )/wky Q/x [/wkz i/x ]/wky [/wkz j/x ]/wky +=M/x [/wkz i/x ]/wky [/wkz k/x ]/wky */n N/x [/wkz k/x ]/wky [/wkz j/x ]/wky ；/wf 
    }/n 
此/rzs 算法/n 的/ude1 时间/n 复杂度/n 是/vshi 0/m (/wkz m1×nl×n2/x )/wky 。/wj 
    当/p M/x 和/cc N/x 是/vshi 稀疏/a 矩阵/n 并用/vi 三元/b 组/n 表/vg 作/v 存储/vn 结构/n 时/ng ．/w 就/d 不/d 能/v 套用/v 上述/b 算法/n 。/wj 假设/n M/x 和/cc N/x 分别/d 为/v  则/c Q=M×N/x 为/v 
    它们/rr 的/ude1 三/m 元/q 组/n M．data/x 、/wn N．data/x 和/cc Q．data/x 分别/d 为/v ：/wp 
M．data/x 
 3/m 
 5/m 
1/m 
 2/m 
N．data/x 
 2/m 
1/m 
2/m 
 4/m 
 0/m     2/m 
 1/m     0/m 
2/m   4/m 
 0/m     0/m 
Q．data/x 
6/m 
1/m 
4/m 
(/wkz 55/m )/wky 
那么/rz 如何/ryv 从/p M/x 和/cc N/x 求得/v Q/x 呢/y ?/ww 
    (/wkz 1/m )/wky 乘积/n 矩阵/n Q/x 中/b 元素/n 
        1≤i≤m/x ，/wd 
    Q/x (/wkz i/x ，/wd j/x )/wky =∑M/x (/wkz i/x ，/wd ”/wyy ×N/x (/wkz ，/wd J/x )/wky     ，/wd ，/wd ．/w ，/wd ‘/wyz     (/wkz 5―6/m )/wky 
    ・/w     =l/x     1≮/m ，/wd ≮n2/x 
在/p 经典/n 算法/n 中/f ，/wd 不论/c M/x (/wkz i/x ，/wd )/wky 和/cc N/x (/wkz ，/wd ．/w j/x )/wky 的/ude1 值/n 是否/v 为/p 零/m ，/wd 都/d 要/v 进行/vx 一/m 次/qv 乘法运算/n ，/wd 而/cc 实际上/d ，/wd 这/rzv 两者/rzv 有/vyou 一个/mq 值/n 为/p 零时/t ，/wd 其/rz 乘积/n 亦/d 为/v 零/m 。/wj 因此/c ，/wd 在/p 对/p 稀疏/a 矩阵/n 进行/vx 运算/vn 时/ng ，/wd 应/v 免去/v 这种/r 无效/vi 操作/v ，/wd 换句话说/c ，/wd 为/p 求/v Q/x 的/ude1 值/n ，/wd 只/d 需/v 在/p M．data/x 和/cc N．data/x 中/f 找到/v 相应/vi 的/ude1 各/rz 对/p 元素/n (/wkz 即/v M．data/x 中/f 的/ude1 j/x 值/n 和/cc N．data/x 中/f 的/ude1 i/x 值/n 相等/vi 的/ude1 各/rz 对/p 元素/n )/wky 相乘/v 即可/v 。/wj 
    例如/v ，/wd M．data/x [/wkz 1/m ]/wky 表示/v 的/ude1 矩阵元/n (/wkz 1/m ，/wd 1/m ，/wd 3/m )/wky 只要/c 和/p N．data/x [/wkz 1/m ]/wky 表示/v 的/ude1 矩阵元/n (/wkz 1/m ，/wd 2/m ，/wd 2/m )/wky 相乘/v ；/wf 而/cc M．data/x [/wkz 2/m ]/wky 表示/v 的/ude1 矩阵元/n (/wkz 1/m ，/wd 4/m ，/wd 5/m )/wky 则/d 不/d 需/v 和/cc N/x 中/f 任何/rz 元素/n 相乘/v ，/wd 因为/p N．data/x 中/f 没有/v i/x 为/p 4/m 的/ude1 元素/n 。/wj 由此可见/c ，/wd 为了/p 得到/v 非零/n 的/ude1 乘积/n ，/wd 只要/c 对/p M．data/x [/wkz 1．．M．tu/x ]/wky 中/f 的/ude1 每个/r 元素/n 
(/wkz i/x ，/wd k/x ，/wd M/x (/wkz i/x ，/wd k/x )/wky )/wky (/wkz 1≤i≤/x 优/ng 1/m ，/wd 1≤/m |/n iI≤/x ，/wd 11/m )/wky ，/wd 找到/v N．data/x 中/f 所/usuo 有/vyou 相应/vi 的/ude1 元素/n (/wkz ，/wd J/x ，/wd N/x (/wkz k/x ，/wd J/x )/wky )/wky 
(/wkz 1≤≤m2/x ，/wd 1≤≤/m ，/wd z2/x )/wky 相乘/v 即可/v ，/wd 为此/d 需/v 在/p N．data/x 中/f 寻找/v 矩阵/n N/x 中/f 第/m n/x 行/ng 的/ude1 所有/b 非零/n 元/q 。/wj 在/p 稀疏/a 矩阵/n 的/ude1 行/a 逻辑链/n 接/v 的/ude1 顺序/n 表/n 中/f ，/wd N．rpos/x 为/p 我们/rr 提供/v 了/ule 有关/vn 信息/n 。/wj 例如/v ，/wd 式/ng (/wkz 5．5/m )/wky 中/f 的/ude1 矩阵/n N/x 的/ude1 rpos/x 值/n 如/v 表/vg 5．2/m 所/usuo 示/vg ：/wp 
并且/c ，/wd 由于/c rpos/x [/wkz row/x ]/wky 指示/n 矩阵/n N/x 的/ude1 第/m row/x 行/ng 中/f 第一/m 个/q 非零/n 元/q 在/p N．data/x 中/f 的/ude1 序号/n ，/wd 则/d rpos/x [/wkz row+1/x ]/wky -/wp 1/m 指示/n 矩阵/n N/x 的/ude1 第/m tOW/x 行/ng 中/f 最后/f 一个/mq 非零/n 元/q 在/p N．data/x 中/f 的/ude1 序号/n 。/wj 而/cc 最后/f 一/m 行/q 中/b 最后/f 一个/mq 非零/n 元/q 在/p N．data/x 中/f 的/ude1 位置/n 显然/ad 就/d 是/vshi N．tu/x 了/vi 。/wj 
    (/wkz 2/m )/wky 稀疏/a 矩阵/n 相乘/v 的/ude1 基本/a 操作/vn 是/vshi ：/wp 对于/p M/x 中/f 每个/r 元素/n M．data/x [/wkz P/x ]/wky (/wkz P=1/x ，/wd 2/m ，/wd …/ws ，/wd M．tu/x )/wky ，/wd 找到/v N/x 中/b 所有/b 满足条件/n M．data/x [/wkz p/x ]/wky ．/w j：N．data/x [/wkz q/x ]/wky ．/w i/x 的/ude1 元素/n N．data/x [/wkz q/x 】/wky ，/wd 求得/v M．data/x [/wkz P/x ]/wky ．/w v/x 和/cc N．data/x [/wkz q/x ]/wky ．/w v/x 的/ude1 乘积/n ，/wd 而/cc 从/p 式/k (/wkz 5-6/m )/wky 得知/v ，/wd 乘积/n 矩阵/n Q/x 中/f 每个/r 元素/n 的/ude1 值/n 是/vshi 个/q 累计/v 和/cc ，/wd 这个/rz 乘积/n M．data/x [/wkz p/x ]/wky ．/w v×N．data/x [/wkz q/x ]/wky ．/w v/x 只/d 是/vshi Q/x (/wkz i/x ，/wd J/x )/wky 中/f 的/ude1 一/m 部分/n 。/wj 为/p 便于操作/n ，/wd 应/v 对/p 每个/r 元素/n 设/v 一/m 累计/v 和/cc 的/ude1 变量/n ，/wd 其/rz 初值/n 为/p 零/m ，/wd 然后/c 扫描/v 数组/n M/x ，/wd 求得/v 相应/vi 元素/n 的/ude1 乘积/n 并/cc 累加/vn 到/v 适当/a 的/ude1 求/v 累计/v 和/cc 的/ude1 变量/n 上/f 。/wj 
    (/wkz 3/m )/wky 两/m 个/q 稀疏/a 矩阵/n 相乘/v 的/ude1 乘积/n 不/d 一定/d 是/vshi 稀疏/a 矩阵/n 。/wj 反之/c ，/wd 即使/c 式/ng (/wkz 5．6/m )/wky 中/f 每个/r 分量/n 值/n M/x (/wkz i/x ，/wd n/x )/wky ×N/x (/wkz k/x ，/wd j/x )/wky 不/d 为/v 零/m ，/wd 其/rz 累加值/n Q/x 【/wkz i/x ，/wd J/x ]/wky 也/d 可能/v 为/p 零/m 。/wj 因此/c 乘积/n 矩阵/n Q/x 中/f 的/ude1 元素/n 是否/v 为/p 非零/n 元/q ，/wd 只有/c 在/p 求得/v 其/rz 累加/vn 和/cc 后/f 才/d 能/v 得知/v 。/wj 由于/p Q/x 中/b 元素/n 的/ude1 行/a 号/n 和/cc M/x 中/b 元素/n 的/ude1 行/a 号/q 一致/a ，/wd 又/d M/x 中/b 元素/n 排列/v 是/vshi 以/p M/x 的/ude1 行/a 序/n 为主/vi 序/n 的/ude1 ，/wd 由此/d 可/v 对/p Q/x 进行/vx 逐/vg 行/ng 处理/v ，/wd 先/d 求得/v 累计/vd 求和/vi 的/ude1 中间/f 结果/n (/wkz Q/x 的/ude1 一/m 行/q )/wky ，/wd 然后/c 再/d 压缩/v 存储/v 到/v Q．data/x 中/f 去/vf 。/wj 
    由此/d ，/wd 两/m 个/q 稀疏/a 矩阵/n 相乘/v (/wkz Q=M×N/x )/wky 的/ude1 过程/n 可/c 大致/d 描述/v 如下/vi ：/wp 
Q/x 初始化/v ；/wf 
if/x (/wkz Q/x 是非/n 零/m 矩阵/n )/wky {/n   ∥/w 逐/vg 行/ng 求/v 积/v 
    for/x (/wkz arow=1/x ；/wf arow/x </n ：/wp M．mu/x ；/wf ++arow/x )/wky {/n     ∥/w 处理/v M/x 的/ude1 每/rz 一/m 行/q 
    ctemp/x [/wkz ]/wky =0/m ；/wf     ∥/w 累加器/n 清/tg 零/m 
    计算/v Q/x 中/f 第/m arow/x 行/ng 的/ude1 积/vn 并/cc 存入/v ctemp/x [/wkz ]/wky 中/f ；/wf 
    将/p ctemp/x [/wkz ]/wky 中非/ns 零/m 元/q 压缩/v 存储/v 到/v Q．data/x ；/wf 
    }/n ／／for-glOW/x 
l／／if/x 
算法/n ．/w 5．3/m 是/vshi 上述/b 过程/n 求/v 精/a 的/ude1 结果/n 。/wj 
Status/x  MultSMatrix/x (/wkz RLSMatrix/x  M/x ，/wd RLSMatrix/x  N/x ，/wd RLSMatrix/x ＆/n Q/x )/wky {/n 
    ∥/w 求/v 矩阵/n 乘积/n Q=M×N/x ，/wd 采用/v 行/ng 逻辑链/n 接存储/n 表示/v 。/wj 
    if/x (/wkz M．nu/x !/wt =N．mu/x )/wky 玎/x 皇/ng turn/x  ERROR/x ；/wf 
    Q．mu=M．mu/x ；/wf Q．rill=N．nu/x ；/wf Q．tu=0/x ；/wf     ∥/w Q/x 初始化/v 
    if/x (/wkz M．tu/x */n N．tu/x !/wt =0/m )/wky {/n   ∥/w Q/x 是非/n 零/m 矩阵/n 
    for/x (/wkz ~/n LrOW=1/x ；/wf araw/x </n =M．mu/x ；/wf ++arow/x )/wky {/n     ∥/w 处理/v M/x 的/ude1 每/rz 一/m 行/q 
    ctemp/x [/wkz ]/wky =0/m ；/wf     ∥/w 当前/t 行/ng 各/rz 元素/n 累加器/n 清/tg 零/m 
    Q．rpos/x [/wkz arow/x ]/wky ：/wp Q．tu+l/x ；/wf 
    for/x (/wkz p：M．rpos/x [/wkz arow/x ]/wky ；/wf p/x </n M．rpos/x [/wkz arow+1/x ]/wky ；/wf 十/m ’/wyy p/x )/wky {/n   ∥/w 对/p 当前/t 行/ng 中/f 每/rz 一个/mq 非零/n 元/q 
    brow=M．data/x [/wkz p/x ]/wky ．/w J/x ；/wf     ∥/w 找到/v 对应/vi 元/q 在/p N/x 中/f 的/ude1 行/a 号/n 
    if/x (/wkz brow/x </n N．nu/x )/wky t=N．rpos/x [/wkz brow+1/x ]/wky ；/wf 
    else/x {/n t=N．tu+l/x }/n 
    for/x (/wkz q=N．rpos/x [/wkz brow/x ]/wky ；/wf q/x </n t/x ；/wf   +/m ’/wyy q/x )/wky {/n 
    ccol=N．data/x [/wkz q/x ]/wky ．/w J/x ；/wf     ∥/w 乘积/n 元素/n 在/p Q/x 中/f 列/v 号/n 
    ctemp/x [/wkz cc01/x ]/wky +=M．data/x [/wkz p/x ]/wky ．/w e/x */n N．data/x [/wkz q/x ]/wky ．/w e/x ；/wf 
    f/x ∥/w for/x  q/x 
    }/n ∥/w 求得/v Q/x 中/f 第/m crow/x (/wkz =arow/x )/wky 行/vi 的/ude1 非零/n 元/q 
    for/x (/wkz ccol=l/x ；/wf ccol/x </n =e．nu/x ；/wf ++cc01/x )/wky     ∥/w 压缩/v 存储/v 该行/r 非零/n 元/q 
    if/x (/wkz ctemp/x [/wkz cc01/x ]/wky )/wky {/n 
    if/x (/wkz ++O．tu/x >/n MAXSIZE/x )/wky return/x  ERROR/x ；/wf 
    e．data/x [/wkz Q．tu/x ]/wky =/m {/n arow/x ，/wd ccol/x ，/wd ctemp/x [/wkz cc01/x ]/wky I/x ；/wf 
    }/n ∥/w if/x 
    ＼f/x }/n for/x  arow/x 
    }/n ∥/w if/x 
    return/x  OK/x ；/wf 
、/wn f/x ，/wd MultSMatrix/x 
算法/n 5．3/m 
    分析/v 上述/b 算法/n 的/ude1 时间/n 复杂度/n 有/vyou 如下/vn 结果/n ：/wp 累加器/n ctemp/x 初始化/v 的/ude1 时间/n 复杂度/n 为/v 0/m 
(/wkz M．mu×N．nu/x )/wky ，/wd 求/v Q/x 的/ude1 所有/b 非零/n 元/q 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz M．tu×N．tu／N．mu/x )/wky ，/wd 进行/vx 压缩/vn 
存储/v 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz M．mux/x  N．nil/x )/wky ，/wd 因此/c ，/wd 总/b 的/ude1 时间/n 复杂度/n 就/d 是/vshi 0/m (/wkz M．mu×N．D/x _/n H+/x 
M．tu×N．tu／N．mu/x )/wky 。/wj 
    若/v M/x 是/vshi m/x 行/ng 扎/v 列/v 的/ude1 稀疏/a 矩阵/n ，/wd N/x 是/vshi n/x 行/n m/x 列/n 的/ude1 稀疏/a 矩阵/n ，/wd 则/d M/x 中非/ns 零/m 元/q 的/ude1 个数/n M．tu=8M×m×n/x ，/wd N/x 中非/ns 零/m 元/q 的/ude1 个数/n N．tu=×i1×P/x ，/wd 此时/r 算法/n 5．3/m 的/ude1 时间/n 复杂度/n 就/d 是/vshi O/x (/wkz m×p×/x (/wkz 1+nM/x “/wyz )/wky )/wky ，/wd 当/p ％/wb </n 0．05/m 和/cc 氐/n </n 0．05/m 及/cc 扎/v </n 1000/m 时/ng ，/wd 算法/n 5．3/m 的/ude1 时间/n 复杂度/n 就/d 相当/d 于/p O/x (/wkz m×P/x )/wky ，/wd 显然/a ，/wd 这/rzv 是/vshi 一个/mq 相当/d 理想/a 的/ude1 结果/n 。/wj 
    如果/c 事先/d 能/v 估算/v 出/vf 所/usuo 求/v 乘积/n 矩阵/n Q/x 不再/d 是/vshi 稀疏/a 矩阵/n ，/wd 则/c 以/p 二/m 维/q 数组/n 表示/v Q/x 。/wj 相乘/v 的/ude1 算法/n 也/d 就/d 更/d 简单/a 了/y 。/wj 
  三/m 、/wn 十字/n 链/ng 表/n 
  当/p 矩阵/n 的/ude1 非零/n 元/q 个/q 数/n 和/cc 位置/n 在/p 操作过程/n 中/f 变化/v 较/d 大/a 时/ng ，/wd 就/d 不宜/v 采用/v 顺序/n 存储/vn 结构/n 来/vf 表示/v 三/m 元/q 组/n 的/ude1 线性/n 表/n 。/wj 例如/v ，/wd 在/p 作/v “/wyz 将/p 矩阵/n B/x 加/v 到/v 矩阵/n A/x 上/f ”/wyy 的/ude1 操作/vn 时/ng ，/wd 由于/c 非零/n 元/q 的/ude1 插入/v 或/c 删除/v 将/d 会/v 引起/v A．data/x 中/b 元素/n 的/ude1 移动/vn 。/wj 为此/bl ，/wd 对/p 这/rzv 种/q 类型/n 的/ude1 矩阵/n ，/wd 采用/v 链式/n 存储/v 结构/n 表示/v 三/m 元/q 组/n 的/ude1 线性/n 表/n 更为/d 恰当/a 。/wj 
    在/p 链/ng 表/n 中/f ，/wd 每个/r 非零/n 元/q 可/v 用/p 一个/mq 含/v 五/m 个/q 域/n 的/ude1 结点/n 表示/v ，/wd 其中/rz i/x ，/wd J/x 和/cc 。/wj 三/m 个/q 域/n 分别/d 表示/v 该/rz 非零/n 元/q 所在/n 的/ude1 行/ng 、/wn 列/v 和/cc 非零/n 元/q 的/ude1 值/n ，/wd 向/p 右/f 域/n right/x 用以/d 链接/n 同/p 一/m 行/q 中/f 下/vf 一个/mq 非零/n 元/q ，/wd 向/p 下/f 域/n down/x 用以/d 链接/n 同/p 一/m 列/q 中/f 下/vf 一个/mq 非零/n 元/q 。/wj 同/p 一/m 行/q 的/ude1 非零/n 元/q 通过/v right/x 域/n 链接/n 成/v 一个/mq 线性/n 链/ng 表/n ，/wd 同/p 一/m 列/q 的/ude1 非零/n 元/q 通过/v down/x 域/n 链接/n 成/v 一个/mq 线性/n 链/ng 表/n ，/wd 每个/r 非零/n 元/q 既/c 是/vshi 某个/rz 行/ng 链/ng 表/n 中/f 的/ude1 一个/mq 结点/n ，/wd 又/d 是/vshi 某个/rz 列/n 链/ng 表/n 中/f 的/ude1 一个/mq 结点/n ，/wd 整个/b 矩阵/n 构成/v 了/ule 一个/mq 十字/b 交叉/vn 的/ude1 链/ng 表/n ，/wd 故/c 称/v 这样/rzv 的/ude1 存储/vn 结构/n 为/p 十字/n 链/ng 表/n ，/wd 可/v 用/p 两/m 个/q 分别/d 存储行/n 链/ng 表/n 的/ude1 头/n 指针/n 和/cc 列/v 链/ng 表/n 的/ude1 头/n 指针/n 的/ude1 一/m 维/q 数组/n 表示/v 之/uzhi 。/wj 例如/v ：/wp 式/ng (/wkz 5―5/m )/wky 中/f 的/ude1 矩阵/n M/x 的/ude1 十字/n 链/ng 表/n 如/v 图/n 5．6/m 所/usuo 示/vg 。/wj 
M．chead/x 
    图/n 5．6/m 稀疏/a 矩阵/n M/x 的/ude1 十字/n 链/ng 表/n 
算法/n 5．4/m 是/vshi 稀疏/a 矩阵/n 的/ude1 十字/n 链/ng 表表示/n 和/cc 建立/v 十字/n 链/ng 表/n 的/ude1 算法/n 。/wj 
    ∥/w …/ws 稀疏/a 矩阵/n 的/ude1 十字/n 链/ng 表存储/n 表示/v …/ws 
typedef/x  steer/x  Oa/x {/n 
    int/x     i/x 。/wj J/x ；/wf     ／／/m 该/rz 非零/n 元/q 的/ude1 行/n 和/cc 列/v 下标/n 
    ElemType/x     e/x ；/wf 
    struct/x  0LNode/x */n right/x ，/wd */n down/x ；/wf   ／／/m 该/rz 非零/n 元/q 所在/n 行/ng 表/n 和/cc 列表/vi 的/ude1 后/f 继/vg 链/ng 域/ng 
IOLNode/x ；/wf   */n OLink/x ；/wf 
typede/x ~/n struct/x {/n 
    OLink/x */n rhead/x 。/wj */n chead/x ；/wf 
    int/x     mu/x ，/wd nu/x ，/wd tu/x ；/wf 
}/n CrossList/x ；/wf 
∥/w 行/vi 和/cc 列/v 链/ng 表头/n 指针/n 向量/n 基址/n 由/p CreateSMatrix/x 分配/vn 
∥/w 稀疏/a 矩阵/n 的/ude1 行/a 数/n 、/wn 列数/n 和/cc 非零/n 元/q 个数/n 
Status/x  CreateSMatrix―OL/x (/wkz CrossList/x &/n M/x )/wky {/n 
    ∥/w 创建/v 稀疏/a 矩阵/n M/x 。/wj 采用/v 十字/n 链/ng 表存储/n 表示/v 。/wj 
    if/x (/wkz M/x )/wky fr∞/x (/wkz M/x )/wky ；/wf 
    scanf/x (/wkz &/n m/x ，/wd &/n n/x ，/wd &/n t/x )/wky ；/wf     ∥/w 输入/v M/x 的/ude1 行/a 数/n 、/wn 列数/n 和/cc 非零/n 元/q 个数/n 
    M．mu：=m/x ；/wf   M．nH：=n/x ；/wf   M．tu：=t/x ；/wf 
    if/x (/wkz !/wt (/wkz M．rhead=/x (/wkz OLink/x */n )/wky lloc/x (/wkz (/wkz m+1/x )/wky */n sizeo/x ~/n (/wkz OLink/x )/wky )/wky )/wky )/wky exlt/x (/wkz OVERFLOW/x )/wky ；/wf 
    if/x (/wkz !/wt (/wkz M．chead=/x (/wkz OLink/x */n )/wky 110c/x (/wkz (/wkz n+1/x )/wky ’/wyy sizeof/x (/wkz OLink/x )/wky )/wky )/wky )/wky exit/x (/wkz OVERFLOW/x )/wky ；/wf 
    M．rhead/x [/wkz ]/wky ：/wp M．chead/x 【/wkz ]/wky =LL/x ；/wf    ∥/w 初始化/v 行列/n 头/q 指针/n 向量/n ；/wf 各/rz 行列/n 链/ng 表/n 为/v 空/ng 链/ng 表/n 
    for/x (/wkz scanf/x (/wkz &/n i/x ，/wd aj/x ，/wd &/n e/x )/wky ；/wf i/x !/wt =0/m ；/wf scanf/x (/wkz ＆/n i/x ，/wd &/n j/x ，/wd ＆/n e/x )/wky )/wky {/n ∥/w 按/p 任意/b 次序/n 输入/v 非零/n 元/q 
    if/x (/wkz !/wt (/wkz P=/x (/wkz OLNode/x */n )/wky Hlloc/x (/wkz si-eof/x (/wkz OLNode/x )/wky )/wky )/wky )/wky ex／t/x (/wkz OVERFLOW/x )/wky ；/wf 
    p-/x >/n i=i/x ；/wf P-/x >/n J=J/x ；/wf P-/x >/n e=e/x ；/wf     ／／/m 生成/v 结点/n 
    if/x (/wkz M．rhead/x [/wkz i/x ]/wky ==/m )/wky M．rhead/x 【/wkz i/x ]/wky ：/wp p/x ；/wf 
    else/x {/n     ∥/w 寻/v 查/v 在行/a 表/n 中/f 的/ude1 插入/v 位置/n 
    for/x (/wkz q=M．rhead/x [/wkz i/x ]/wky ；/wf (/wkz q-/x >/n right/x )/wky ＆/n ＆/n q-/x >/n right/x ～/ws >/n J/x </n J/x ；/wf q=q-/x >/n right/x ；/wf )/wky 
    P-/x >/n right=q-/x >/n right/x ；/wf   q-/x >/n right=p/x ；/wf     I/x   ∥/w 完成/v 行/ng 插入/v 
  if/x (/wkz M．chead/x 【/wkz j/x ]/wky ==HUuI/x )/wky M．chead/x [/wkz j/x ]/wky ：/wp p/x ；/wf 
  else/x  I/x     ∥/w 寻/v 查/v 在/p 列表/vi 中/f 的/ude1 插入/v 位置/n 
    for/x (/wkz q=M．chead/x [/wkz J/x  J/x ；/wf (/wkz q-/x >/n down/x )/wky ＆/n &/n q-/x >/n down-/x >/n i/x </n i/x ；/wf   q：q-/x >/n down/x ；/wf )/wky 
    P-/x >/n down=q-/x >/n down/x ；/wf q-/x >/n down=p/x ；/wf     }/n     ∥/w 完成/v 列/v 插入/v 
  }/n 
  retttrn/x  OK/x ；/wf 
}/n ∥/w Creat：eSMatriX-OL/x 
算法/n 5．4/m 
　　对于/p m/x 行/n m/x 列/n 且/c 有/vyou ￡/m 个/q 非零/n 元/q 的/ude1 稀疏/a 矩阵/n ，/wd 算法/n 5．4/m 的/ude1 执行/vn 时间/n 为/p 0/m (/wkz ￡×s/x )/wky ，/wd s=max/x {/n m/x ，/wd n/x }/n 这/rzv 是/vshi 因为/p 每/rz 建立/v 一个/mq 非零/n 元/q 的/ude1 结点/n 时/ng 都/d 要/v 寻/v 查/v 它/rr 在/p 行/ng 表/n 和/cc 列表/vi 中/f 的/ude1 插入/v 位置/n ，/wd 此/rzs 算法/n 对/p 非零/n 元/q 输入/vn 的/ude1 先后/d 次序/n 没/v 任何/rz 要求/n 。/wj 反之/c ，/wd 若/c 按/p 以/p 行/ng 序/n 为主/vi 序/n 的/ude1 次序/n 依次/d 输入/v 三元/b 组/n ，/wd 则/c 可/v 将/d 建立/v 十字/n 链/ng 表/n 的/ude1 算法/n 改写/v 成/v (/wkz )/wky (/wkz ￡/m )/wky 数量级/n 的/ude1 (/wkz ￡/m 为/p 非零/n 元/q 的/ude1 个数/n )/wky 。/wj 
　　下面/f 我们/rr 讨论/v 在/p 十字/n 链/ng 表表示/n 稀疏/a 矩阵/n 时/ng ，/wd 如何/ryv 实现/v “/wyz 将/p 矩阵/n B/x 加/v 到/v 矩阵/n A/x 上/f ”/wyy 的/ude1 运算/vn 。/wj 
    两/m 个/q 矩阵/n 相加/vn 和/cc 第二/m 章/q 中/f 讨论/v 的/ude1 两/m 个/q 一元/b 多项式/n 相加/vi 极为/d 相似/a ，/wd 所/usuo 不同/a 的/ude1 是/vshi 一/m 元/q 多项式/n 中/f 只/d 有/vyou 一个/mq 变元/n (/wkz 即/v 指数/n 项/q )/wky ，/wd 而/cc 矩阵/n 中/f 每个/r 非零/n 元/q 有/vyou 两/m 个/q 变元/n (/wkz 行/ng 值/v 和/cc 列值/n )/wky ，/wd 每个/r 结点/n 既/c 在行/a 表/n 中/f 又/d 在/p 列表/vi 中/f ，/wd 致使/v 插入/v 和/cc 删除/v 时/ng 指针/n 的/ude1 修改/vn 稍为/d 复杂/a ，/wd 故/c 需/v 更/d 多/a 的/ude1 辅助/vn 指针/n 。/wj 
    假设/v 两/m 个/q 矩阵/n 相加/vi 后/f 的/ude1 结果/n 为/v A/x ’/wyy ，/wd 则/d 和/cc 矩阵/n A/x ’/wyy 中/f 的/ude1 非零/n 元/q ％/wb ’/wyy 只/d 可能/v 有/vyou 三/m 种/q 情况/n 。/wj 它/rr 或者/c 是/vshi 。/wj “/wyz +6/m ，/wd 或者/c 是/vshi i/x ，/wd (/wkz 6d=0/x 时/ng )/wky ；/wf 或者/c 是/vshi 6i/x ，/wd (/wkz i/x ，/wd =0/m 时/ng )/wky 。/wj 由此/d ，/wd 当/p 将/d B/x 加/v 到/v A/x 上/f 去/vf 时/ng ，/wd 对/p A/x 矩阵/n 的/ude1 十字/n 链/ng 表/n 来说/uls ，/wd 或者/c 是/vshi 改变/v 结点/n 的/ude1 val/x 域/ng 值/v (/wkz ni-6if≠0/x )/wky ，/wd 或者/c 不/d 变/v (/wkz 6i/x ，/wd =0/m )/wky ，/wd 或者/c 插入/v 一个/mq 新/a 结点/n (/wkz ‰=0/m )/wky 。/wj 还有/v 一/m 种/q 可能/n 的/ude1 情况/n 是/vshi ：/wp 和/p A/x 矩阵/n 中/f 的/ude1 某个/rz 非零/n 元/q 相/d 对应/vi ，/wd 和/cc 矩阵/n A/x ’/wyy 中/f 是/vshi 零/m 元/q ，/wd 即/d 对/p A/x 的/ude1 操作/vn 是/vshi 删除/v 一个/mq 结点/n (/wkz ai+6：i：0/x )/wky 。/wj 由此/d ，/wd 整个/b 运算/vn 过程/n 可/v 从/p 矩阵/n 的/ude1 第一/m 行/q 起/f 逐/vg 行/ng 进行/vx 。/wj 对/p 每/rz 一/m 行/q 都/d 从/p 行/ng 表头/n 出发/vi 分别/d 找到/v A/x 和/cc B/x 在/p 该行/r 中/f 的/ude1 第一/m 个/q 非零/n 元/q 结点/n 后/f 开始/v 比较/vn ，/wd 然后/c 按/p 上述/b 四/m 种/q 不同/a 情况/n 分别/d 处理/v 之/uzhi 。/wj 
    假设/v 非空/n 指针/n pa/x 和/cc pb/x 分别/d 指向/v 矩阵/n A/x 和/cc B/x 中行/n 值/v 相同/a 的/ude1 两/m 个/q 结点/n ：/wp 抛/v ：：/wp NULI/x 。/wj 表明/v 矩阵/n A/x 在/p 该行/r 中/f 没有/v 非零/n 元/q ，/wd 则/c 上述/b 四/m 种/q 情况/n 的/ude1 处理过程/n 为/v ：/wp 
    (/wkz 1/m )/wky 若/v pa=：NULI．/x 或/c pa/x ～/ws >/n j/x >/n pb-/x >/n j/x ，/wd 则/c 需要/v 在/p A/x 矩阵/n 的/ude1 链/ng 表/n 中/f 插入/v 一个/mq 值/n 为/v bij/x 的/ude1 结点/n 。/wj 此时/r ，/wd 需/v 改变/v 同/p 一/m 行/q 中/b 前/f 一/m 结点/n 的/ude1 right/x 域/ng 值/v ，/wd 以及/cc 同/p 一/m 列/q 中/b 前/f 一/m 结点/n 的/ude1 down/x 域/ng 值/v 。/wj 
    (/wkz 2/m )/wky 若/v pa-/x >/n j/x </n pb-/x >/n j/x ，/wd 则/c 只/d 要/v 将/d pa/x 指针/n 往/p 右/f 推进/vi 一/m 步/qv 。/wj 
    (/wkz 3/m )/wky 若/v pa-/x >/n j==pb-/x >/n j/x 且/d pa-/x >/n e+pb-/x >/n e/x !/wt =0/m ，/wd 则/c 只/d 要/v 将/d a/x ，/wd j+b/x “/wyz 的/ude1 值/n 送/v 到/v pa/x 所/n 
指/v 结点/n 的/ude1 e/x 域/ng 即可/v ，/wd 其它/rz 所有/b 域/n 的/ude1 值/n 都/d 不/d 变/v 。/wj 
    (/wkz 4/m )/wky 若/v pa-/x >/n j==pb-/x >/n j/x 且/d pa-/x >/n e+pb-/x >/n e==0/x ，/wd 则/c 需要/v 在/p A/x 矩阵/n 的/ude1 链/ng 表/n 中/f 删除/v pa/x 所/usuo 指/v 的/ude1 结点/n 。/wj 此时/r ，/wd 需/v 改变/v 同/p 一/m 行/q 中/b 前/f 一/m 结点/n 的/ude1 right/x 域/ng 值/v ，/wd 以及/cc 同/p 一/m 列/q 中/b 前/f 一/m 结点/n 的/ude1 down/x 域/ng 值/v 。/wj 
    为了/p 便于/v 插入/v 和/cc 删除/v 结点/n ，/wd 还/d 需要/v 设立/v 一些/mq 辅助/vn 指针/n 。/wj 其一/rz 是/vshi ，/wd 在/p A/x 的/ude1 行/ng 链/ng 表/n 上/f 设/v pre/x 指针/n ，/wd 指示/n pa/x 所/usuo 指/v 结点/n 的/ude1 前驱/n 结点/n ；/wf 其二/rz 是/vshi ，/wd 在/p A/x 的/ude1 每/rz 一/m 列/q 的/ude1 链/ng 表/n 上/f 设/v 一个/mq 指针/n hl/x [/wkz j/x ]/wky ，/wd 它/rr 的/ude1 初值/n 和/cc 列/v 链/ng 表/n 的/ude1 头/n 指针/n 相同/a ，/wd 即/v hl/x [/wkz j/x ]/wky =chead/x [/wkz j/x ]/wky 。/wj 
    下面/f 对/p 将/p 矩阵/n B/x 加/v 到/v 矩阵/n A/x 上/f 的/ude1 操作过程/n 作/v 一个/mq 概要/n 的/ude1 描述/vn 。/wj 
    (/wkz 1/m )/wky 初始/t ，/wd 令/v pa/x 和/cc pb/x 分别/d 指向/v A/x 和/cc B/x 的/ude1 第一/m 行/q 的/ude1 第一/m 个/q 非零元素/n 的/ude1 结点/n ，/wd 即/v     pa=A．rhead/x [/wkz 1/m ]/wky ；/wf pb=B．rhead/x [/wkz 1/m ]/wky ；/wf pre=NULL/x ；/wf 
且/c 令/v hl/x 初始化/v 
    for/x (/wkz ．/w j=1/x ；/wf j/x </n =A．nu/x ；/wf ++J/x )/wky hl/x [/wkz j/x ]/wky =A．cheadEj/x ]/wky ；/wf 
    (/wkz 2/m )/wky 重复/v 本/rz 步骤/n ，/wd 依次/d 处理/v 本行/r 结点/n ，/wd 直到/v B/x 的/ude1 本行/n 中/f 无非/d 零/m 元素/n 的/ude1 结点/n ，/wd 即/v pb==/x 
NULL/x 为止/u ：/wp     
    ①/m 若/v pa==NULL/x 或/c pa-/x >/n j/x >/n pb-/x >/n j/x (/wkz 即/v A/x 的/ude1 这/rzv 一/m 行/q 中非/ns 零/m 元素/n 已/d 处理/v 完/vi )/wky ，/wd 则/c 需/v 在/p A/x 中/f 插入/v 一个/mq pb/x 所/usuo 指/v 结点/n 的/ude1 复制/vn 结点/n 。/wj 假设/n 新/d 结点/n 的/ude1 地址/n 为/v P/x ，/wd 则/d A/x 的/ude1 行/a 表/n 中/f 的/ude1 指针/n 作/v 如下/vi 变化/v ：/wp 
if/x (/wkz pre==NULL/x )/wky A．/x ；/wf head/x [/wkz p-/x >/n i/x ]/wky =p/x ；/wf 
else/x {/n pre-/x >/n right．：p/x ；/wf }/n 
P-/x >/n right=pa/x ；/wf pre=p/x ；/wf 
A/x 的/ude1 列/n 链/ng 表/n 中/f 的/ude1 指针/n 也/d 要/v 作/v 相应/vi 的/ude1 改变/vn 。/wj 首先/c 需/v 从/p hl/x [/wkz p-/x >/n j/x ]/wky 开始/v 找到/v 新/a 结点/n 在/p 同/p 一/m 列/q 中/f 的/ude1 前驱/n 结点/n ，/wd 并/cc 让/v hl/x [/wkz p-/x >/n j/x ]/wky 指向/v 它/rr ，/wd 然后/c 在/p 列/v 链/ng 表/n 中/f 插入/v 新/a 结点/n ：/wp 
  if/x (/wkz A．chead/x [/wkz p-/x >/n J/x ]/wky ：/wp =NuLL/x )/wky   {/n A．chead/x [/wkz P-/x >/n J/x ]/wky =p/x ；/wf P-/x >/n down=NULL/x ；/wf }/n 
  else/x {/n P-/x >/n down=hl/x [/wkz P-/x >/n J/x ]/wky -/wp >/n down/x ；/wf hX/x [/wkz p-/x >/n J/x ]/wky -/wp >/n down=p/x ；/wf }/n 
  hl/x 【/wkz P-/x >/n J/x  J=P/x ；/wf 
②/m 若/v pa/x !/wt =NULL/x 且/d pa-/x >/n J/x </n pb-/x >/n J/x ，/wd 则/c 令/v pa/x 指向/v 本行/n 下/f 一个/mq 非零/n 元/q 结点/n ，/wd 即/v 
  pre/x 。/wj pa/x ；/wf pa：pa-/x >/n right：/x 
③/m 若/v pa-/x >/n j==pb-/x >/n j/x ，/wd 则/c 将/d B/x 中/f 当前/t 结点/n 的/ude1 值/n 加/v 到/v A/x 中/f 当前/t 结点/n 上/f ，/wd 即/v 
  pa-/x >/n e+：pb-/x >/n e/x ；/wf 
此时/r 若/v pa-/x >/n e/x !/wt =0/m ，/wd 则/c 指针/n 不/d 变/v ，/wd 否则/c 删除/v A/x 中/f 该/v 结点/n ，/wd 即/v 行/ng 表/vg 中/b 指针/n 变为/v 
if/x (/wkz pre==NULL/x )/wky A．rhead/x [/wkz pa-/x >/n i/x ]/wky =pa-/x >/n right/x ；/wf 
else/x  lpre-/x >/n right=pa-/x >/n right/x ；/wf }/n 
p=pa/x ；/wf pa=pa-/x >/n right/x ；/wf 
同时/c ，/wd 为了/p 改变/v 列表/vi 中/f 的/ude1 指针/n ，/wd 需要/v 先/d 找/v 到/v 同/p 一/m 列/q 中/f 的/ude1 前驱/n 结点/n ，/wd 且/c 让/v hl/x [/wkz pa-/x >/n j/x ]/wky 指向/v 该/rz 结点/n ，/wd 然后/c 如下/vi 修改/v 相应/vi 指针/n ：/wp    
    if/x (/wkz A．chead/x [/wkz p-/x >/n J/x ]/wky ==p/x )/wky   A．chead/x [/wkz p-/x >/n J/x ]/wky =m/x [/wkz p-/x >/n J/x ]/wky =P-/x >/n down/x ；/wf 
    else/x  Im/x [/wkz p-/x >/n j/x ]/wky -/wp >/n down=P-/x >/n down/x ；/wf }/n 
    free/x (/wkz p/x )/wky ；/wf 
    (/wkz 3/m )/wky 若/v 本行/r 不/d 是/vshi 最后/f 一/m 行/q ，/wd 则/c 令/v pa/x 和/cc pb/x 指向/v 下/vf 一/m 行/q 的/ude1 第一/m 个/q 非零/n 元/q 结点/n ，/wd 转/v (/wkz 2/m )/wky ；/wf 否则/c 结束/v 。/wj 
    通过/p 对/p 这个/rz 算法/n 的/ude1 分析/vn 可以/v 得出/v 下/f 述/vg 结论/n ：/wp 从/p 一个/mq 结点/n 来看/v ，/wd 进行/vx 比较/vn 、/wn 修改/vn 指针/n 所/usuo 需/v 的/ude1 时间/n 是/vshi 一个/mq 常数/n ；/wf 整个/b 运算/vn 过程/n 在于/v 对/p A/x 和/cc B/x 的/ude1 十字/n 链/ng 表/n 逐/vg 行/ng 扫描/v ，/wd 其/rz 循环/vn 次数/n 主要/d 取决于/v A/x 和/cc B/x 矩阵/n 中非/ns 零/m 元素/n 的/ude1 个数/n ta/x 和/cc tb/x ；/wf 由此/d 算法/n 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz ta+tb/x )/wky 。/wj 
5．4/m 广义/n 表/n 的/ude1 定义/n 
顾名思义/vl ，/wd 广义/n 表/n 是/vshi 线性/n 表/n 的/ude1 推广/vn 。/wj 也/d 有人/r 称/v 其/rz 为/v 列表/vi (/wkz Lists/x ，/wd 用/p 复数/n 形式/n 以/p 示/vg 与/p 统称/v 的/ude1 表/n list/x 的/ude1 区别/n )/wky 。/wj 广泛/a 地/ude2 用于/v 人工智能/n 等/udeng 领域/n 的/ude1 表处理/n 语言/n LISP/x 语言/n ，/wd 把/pba 广义/n 表/vg 作为/v 基本/a 的/ude1 数据/n 结构/n ，/wd 就/d 连/ulian 程序/n 也/d 表示/v 为/p 一/m 系列/q 的/ude1 广义/n 表/n 。/wj 
    抽象数据/n 类型/n 广义/n 表/n 的/ude1 定义/n 如下/vi ：/wp 
    ADT/x  GLis％/x {/n 
    数据/n 对象/n ：/wp D=/x {/n eiI/x  i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x ；/wf   n≥0/x ；/wf   ei∈AtomSet/x 或/c ei∈GList/x ，/wd 
    AtomSet/x 为/p 某个/rz 数据/n 对象/n   }/n 
    数据/n 关系/n ：/wp R1=l/x </n ei―l/x ，/wd ei/x >/n Iei―1．ei∈D/x ，/wd   2≤i≤n/x  l/x 
    基本/ad 操作/v ：/wp 
    InitGList/x (/wkz ＆/n L/x )/wky ；/wf 
    操作/v 结果/n ：/wp 创建/v 空/a 的/ude1 广义/n 表/n L/x 。/wj 
    CreateGiist/x (/wkz &/n L/x ，/wd s/x )/wky ；/wf 
    初始条件/n ：/wp s/x 是/vshi 广义/n 表/n 的/ude1 书/n 写/v 形式/n 串/q 。/wj 
    操作/v 结果/n ：/wp 由/p s/x 创建/vn 广义/n 表/n L/x 。/wj 
    DestroyGLJ．st/x (/wkz ＆/n L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 广义/n 表/n L/x 。/wj 
    copist/x (/wkz ＆/n T/x ，/wd L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 由/p 广义/n 表/n L/x 复制/v 得到/v 广义/n 表/n T/x 。/wj 
    GLJ．stLength/x (/wkz L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 求/v 广义/n 表/n L/x 的/ude1 长度/n ，/wd 即/v 元素/n 个数/n 。/wj 
    GL5．stDepth/x (/wkz L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 求/v 广义/n 表/n L/x 的/ude1 深度/n 。/wj 
    GLi．stEmpty/x (/wkz L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 判定/v 广义/n 表/n L/x 是否/v 为/v 空/ng 。/wj 
    GetHead/x (/wkz L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 取/v 广义/n 表/n L/x 的/ude1 头/n 。/wj 
    GetTail/x (/wkz L/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 取/v 广义/n 表/n L/x 的/ude1 尾/ng 。/wj 
    InsertFirst-GL/x (/wkz ＆/n L/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 插入/v 元素/n e/x 作为/p 广义/n 表/n L/x 的/ude1 第一/m 元素/n 。/wj 
    De/x ]/wky eteFirst-GL/x (/wkz ＆/n L/x ，/wd &/n e/x )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 删除/v 广义/n 表/n L/x 的/ude1 第一/m 元素/n ，/wd 并/cc 用/v e/x 返回/v 其/rz 值/n 。/wj 
    Traverse―GL/x (/wkz L/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf 
    初始条件/n ：/wp 广义/n 表/n L/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 遍历/n 广义/n 表/n L/x ，/wd 用/p 函数/n v-sit/x 处理/v 每个/r 元素/n 。/wj 
    IAGList/x 
    广义/n 表/n 一般/ad 记/v 作/v 
    LS=/x (/wkz 。/wj l/x ，/wd 。/wj 2/m ，/wd …/ws ，/wd 。/wj )/wky 
其中/rz ，/wd Ls/x 是/vshi 广义/n 表/n (/wkz al/x ，/wd a2/x ，/wd …/ws ，/wd a/x 。/wj )/wky 的/ude1 名称/n ，/wd ”/wyy 是/vshi 它/rr 的/ude1 长度/n 。/wj 在/p 线性/n 表/n 的/ude1 定义/n 中/f ，/wd 。/wj (/wkz 1≤i≤/x 
”/wyy )/wky 只/d 限于/v 是/vshi 单个/b 元素/n 。/wj 而/cc 在/p 广义/n 表/n 的/ude1 定义/n 中/f ，/wd a/x 。/wj 可以/v 是/vshi 单个/b 元素/n ，/wd 也/d 可以/v 是/vshi 广义/n 表/n ，/wd 分别/d 称为/v 广义/n 表/n LS/x 的/ude1 原子/n 和/cc 子/ng 表/n 。/wj 习惯/n 上/f ，/wd 用/p 大写字母/n 表示/v 广义/n 表/n 的/ude1 名称/n ，/wd 用/p 小写/n 字母/n 表示/v 原子/n 。/wj 当/p 广义/n 表/n LS/x 非空/n 时/ng ，/wd 称/v 第一/m 个/q 元素/n ．/w 为/v Ls/x 的/ude1 表头/n (/wkz }/n lead/x )/wky ，/wd 称/v 其余/rz 元素/n 组成/v 的/ude1 表/n (/wkz 2/m ，/wd a3/x ，/wd …/ws ，/wd 。/wj )/wky 是/vshi LS/x 的/ude1 表/n 尾/ng (/wkz Tail/x )/wky 。/wj 
    显然/a ，/wd 广义/n 表/n 的/ude1 定义/n 是/vshi 一个/mq 递归/n 的/ude1 定义/n ，/wd 因为/c 在/p 描述/v 广义/n 表/vg 时/ng 又/d 用/v 到/v 了/ule 广义/n 表/n 的/ude1 概念/n 。/wj 下面/f 列举/v 一些/mq 广义/n 表/n 的/ude1 例子/n 。/wj 
    (/wkz 1/m )/wky A=/x (/wkz ．/w )/wky ――/wp A/x 是/vshi 一个/mq 空/a 表/n ，/wd 它/rr 的/ude1 长度/n 为/p 零/m 。/wj 
    (/wkz 2/m )/wky B=/x (/wkz P/x )/wky 列表/vi B/x 只有/d -/wp ／/w }/n 、/wn 原/b F/x  r/x ，/wd B/x 的/ude1 长度/n 为/v l/x 。/wj 
    (/wkz 3/m )/wky C=/x (/wkz “/wyz ，/wd (/wkz 6/m ，/wd c/x ，/wd d/x )/wky )/wky 列表/vi (/wkz ’/wyy 的/ude1 长度/n 为/p 2/m ，/wd 两/m 个/q 元素/n 分别/d 为/v 原子/n n/x 和/cc 子表/nr2 (/wkz 6/m ，/wd r/x ，/wd 
d/x )/wky ?/ww 
    (/wkz 4/m )/wky D=/x (/wkz A/x ，/wd B/x ，/wd C/x )/wky 列表/vi D/x 的/ude1 长度/n 为/p 3/m ，/wd 三/m 个/q 元素/n 都/d 是/vshi 列表/vi 。/wj 显然/a ，/wd 将/d 子/ng 表/n 的/ude1 值/n 代/vd 入/v 后/f ，/wd 则/c 有/vyou D=/x (/wkz (/wkz )/wky ，/wd (/wkz P/x )/wky ，/wd (/wkz “/wyz ，/wd (/wkz 6√/m ，/wd d/x )/wky )/wky )/wky ，/wd 
    (/wkz 5/m )/wky E：/x (/wkz n/x ，/wd E/x )/wky ――/wp 这/rzv 是/vshi 一个/mq 递归/n 的/ude1 表/n ，/wd 它/rr 的/ude1 长度/n 为/p 2/m 。/wj j/x  E/x 相当/d 于/p 一个/mq 无限/b 的/ude1 列表/vi ￡=/m (/wkz Ⅱ/m ，/wd (/wkz ，/wd (/wkz “/wyz ，/wd …/ws )/wky )/wky )/wky 。/wj 
    从/p 上述/b 定义/n 和/cc 例子/n 可/v 推出/v 列表/vi 的/ude1 三/m 个/q 重要/a 结论/n ：/wp 
    (/wkz 1/m )/wky 列表/vi 的/ude1 元素/n 可以/v 是/vshi 子/ng 表/n ，/wd 而/cc 子表/nr2 的/ude1 元素/n 还/d 可以/v 是/vshi 子/ng 表/n ，/wd …/ws 。/wj 由此/d ，/wd 列表/vi 是/vshi 一个/mq 多/a 层次/n 的/ude1 结构/n ，/wd 可以/v 用/p 图/n 形象/n 地/ude2 表示/v 。/wj 例如/v 图/n 5．7/m 表示/v 的/ude1 是/vshi 列表/vi D/x 。/wj 图/n 中/f 以/p 圆圈/n 表示/v 列表/vi ，/wd 以/p 方块/n 表示/v 原子/n 。/wj 
    (/wkz 2/m )/wky 列表/vi 可/v 为/p 其它/rz 列表/vi 所/usuo 共享/v 。/wj 例如/v 在/p 上述/b 例子/n 中/f ，/wd 列表/vi A/x 、/wn B/x 和/cc C/x 为/v D/x 的/ude1 子/ng 表/n ，/wd 则/c 在/p D/x 中/f 可以/v 不必/d 列出/v 子/ng 表/n 的/ude1 值/n ，/wd 而是/c 通过/p 子/ng 表/n 的/ude1 名称/n 来/vf 引用/v 。/wj 
    (/wkz 3/m )/wky 列表/vi 可以/v 是/vshi 一个/mq 递归/n 的/ude1 表/n ，/wd 即/d 列表/vi 也/d 可以/v 是/vshi 其/rz 本身/rz 的/ude1 一个/mq 子/ng 表/n 。/wj 例如/v 列表/vi E/x 就/d 是/vshi 一个/mq 递归/n 的/ude1 表/n 。/wj 
    根据/p 前述/b 对/p 表头/n 、/wn 表/n 尾/ng 的/ude1 定义/n 可知/v ：/wp 任何/rz --/wp 个/q 非空/n 列表/vi 其/rz 表头/n 可能/v 是/vshi 原子/n ，/wd 也/d 可能/v 是/vshi 列表/vi ，/wd 而/cc 其/rz 表/n 尾/ng 必定/d 为/v 列表/vi 。/wj 例如/v ：/wp 
    Get/x }/n lead/x (/wkz B/x )/wky =e．/x     GetTall/x (/wkz B/x )/wky =/m (/wkz )/wky ，/wd 
    GetHead/x (/wkz D/x )/wky =A/x ，/wd     GetTail/x (/wkz D/x )/wky =/m (/wkz B/x 。/wj C/x )/wky ，/wd 
由于/p (/wkz B/x ，/wd C/x )/wky 为/p 非空/n 列表/vi ，/wd 则/c 可/v 继续/v 分解/v 得到/v ：/wp 
图/n 5．7/m 列表/vi 的/ude1 图形/n 表示/v 
    GetHead/x (/wkz (/wkz B/x ，/wd C/x )/wky )/wky =B/x ，/wd     GetTail/x (/wkz (/wkz B/x ，/wd C/x )/wky )/wky =/m (/wkz C/x )/wky ，/wd 
值得/v 提醒/v 的/ude1 是/vshi 列表/vi (/wkz )/wky 和/cc (/wkz (/wkz )/wky )/wky 不同/a 。/wj 前者/rzv 为/p 空/a 表/n ，/wd 长度/n n=0/x ；/wf 后者/rzv 长度/n ”/wyy =l/x ，/wd 可/c 分解/v 得到/v 其/rz 表头/n 、/wn 表/n 尾/ng 均/d 为/v 空/a 表/n (/wkz )/wky ：/wp 
    5．5/m 广义/n 表/n 的/ude1 存储/vn 结构/n 
    由于/p 广义/n 表/n (/wkz a/x 。/wj ，/wd a2/x ，/wd …/ws ，/wd a/x 。/wj )/wky 中/f 的/ude1 数据/n 元素/n 可以/v 具有/v 不同/a 的/ude1 结构/n ，/wd (/wkz 或/c 是/vshi 原子/n ，/wd 或是/c 列表/vi )/wky ，/wd 因此/c 难以/d 用/p 顺序/n 存储/vn 结构/n 表示/v ，/wd 通常/d 采用/v 链式/n 存储/v 结构/n ，/wd 每个/r 数据/n 元素/n 可/v 用/p 一个/mq 结点/n 表示/v 。/wj 
    表/n 结点/n 

    原子/n 结点/n 
图/n 5．8/m 列表/vi 的/ude1 链/ng 表/n 结点/n 结构/n 
    如何/ryv 设定/v 结点/n 的/ude1 结构/n ?/ww 由于/c 列表/vi 中/f 的/ude1 数据/n 元素/n 可/v 
能/v 为/p 原子/n 或/c 列表/vi ，/wd 由此/d 需要/v 两/m 种/q 结构/n 的/ude1 结点/n ：/wp 一/m 种/q 是/vshi 表/n 结点/n ，/wd 用以/d 表示/v 列表/vi ；/wf 一/m 种/q 是/vshi 原子/n 结点/n ，/wd 用以/d 表示/v 原子/n 。/wj 
从/p 上/f 节/n 得知/v ：/wp 若/v 列表/vi 不/d 空/a ，/wd 则/c 可/v 分解/v 成/v 表头/n 和/cc 表/n 昆/b ；/wf 反之/c ，/wd 一/d 对/p 确定/v 的/ude1 表头/n 和/cc 表/n 尾/ng 可/v 唯一/b 确定/v 列表/vi 。/wj 由此/d ，/wd 一个/mq 表/n 结点/n 可/v 由/p 三/m 个/q 域/ng 组成/v ：/wp 标志/v 域/ng 、/wn 指示/n 表头/n 的/ude1 指针/n 域/ng 和/cc 指示/n 表/vg 尾/ng 的/ude1 指针/n 域/ng ；/wf 而/cc 原子/n 结点/n 只/d 需/v 两/m 个/q 域/n ：/wp 标志/v 域/ng 和/cc 值域/n (/wkz 如/v 图/n 5．8/m 所/usuo 示/vg )/wky 。/wj 其/rz 形式/n 定义/n 说明/v 如下/vi ：/wp 
∥/w …/ws 广义/n 表/n 的/ude1 头尾/n 链/ng 表存储/n 表/n 求/v …/ws 
tn/x ~/n d-f/x  enuIn/x {/n ATOM/x ，/wd LISq/x ’/wyy fElemTag/x ；/wf ∥/w ATOM：=O：/x 原子/n ，/wd LIST==1：/x 子/ng 表/n 
typedef/x  struct/x  GLNode/x }/n 
    ElemTag/x  tag/x ；/wf     ∥/w 公共/b 部分/n ，/wd 用于/v 区分/v 原子/n 结点/n 和/cc 表/n 结点/n 
    union/x {/n     j/x 原/d 了结/v 点/qt 和/cc 表/n 结点/n 的/ude1 联合/vn 部分/n 
    AtomType/x  atom/x ；/wf     ／／atom/x 是/vshi 原子/n 结点/n 的/ude1 值域/n ，/wd AtomType/x 由/p 用/v 卢/b 定义/n 
    5truI/x {/n strut％GLNode/x   */n ，/wd 1p/x ，/wd   */n tp/x ；/wf }/n ptr/x ；/wf 
    √ptr/x 是/vshi 表/n 结点/n 的/ude1 指针/n 域/ng ，/wd ptr．hp/x 和/cc ptr．p/x 分别/d 指向/v 表头/n 和/cc 表/n 尾/q i/x ；/wf 
}/n */n GList/x ；/wf     ∥/w 广义/n 表/vg 类型/n 
图/n 5．9/m 广义/n 表/n 的/ude1 存储/vn 结构/n 示例/n 
上/f 节/n 中曾/nrj 列举/v 了/ule 广义/n 表/n 的/ude1 例子/n ，/wd 它们/rr 的/ude1 存储/vn 结构/n 如/v 图/n 5．9/m 所/usuo 示/vg 。/wj 在/p 这种/r 存储/vn 结构/n 中/f 有/vyou 几/m 种/q 情况/n ：/wp (/wkz 1/m )/wky 除/p 空/a 表/n 的/ude1 表头/n 指针/n 为/v 空/ng 外/f ，/wd 对/p 任何/rz 非空/n 列表/vi ，/wd 其/rz 表头/n 指针/n 均/d 指向/v 一个/mq 表/n 结点/n ，/wd 且/c 该/rz 结点/n 中/f 的/ude1 hp/x 域/ng 指示/n 列表/vi 表头/n (/wkz 或/c 为/p 原子/n 结点/n ，/wd 或/c 为/p 表/n 结点/n )/wky ，/wd tp/x 域/ng 指向/v 列表/vi 表/vg 尾/ng (/wkz 除非/c 表/vg 尾/ng 为/v 空/ng ，/wd 则/c 指针/n 为/v 空/ng ，/wd 否则/c 必/d 为/v 表/vg 结点/n )/wky ；/wf (/wkz 2/m )/wky 容易/ad 分清/v 列表/vi 中/f 原子/n 和/cc 子表/nr2 所在/n 层次/n 。/wj 
如/c 在/p 列表/vi D/x 中/f ，/wd 原子/n a/x 和/cc e/x 在/p 同一/b 层次/n 上/f ，/wd 而/cc 6/m 、/wn c/x 和/cc d/x 在/p 同一/b 层次/n 且/c 比/p 口/n 和/cc e/x 低/a 一/m 层/qv ，/wd B/x 和/cc c/x 是/vshi 同/p 一/m 层/qv 的/ude1 子/ng 表/n ；/wf (/wkz 3/m )/wky 最高/a 层/qv 的/ude1 表/n 结点/n 个数/n 即/d 为/v 列表/vi 的/ude1 长度/n 。/wj 以上/f 三/m 个/q 特点/n 在/p 某种/rz 程度/n 上/f 给/v 列表/vi 的/ude1 操作/vn 带来/v 方便/an 。/wj 也/d 可/v 采用/v 另/rz 一/m 种/q 结点/n 结构/n 的/ude1 链/ng 表表示/n 列表/vi ，/wd 如/v 图/n 5．10/m 和/cc 图/n 5．11/m 所/usuo 示/vg 。/wj 其/rz 形式/n 定义/n 说明/v 如下/vi ：/wp 
∥/w …/ws 广义/n 表/n 的/ude1 扩展/vn 线性/n 链/ng 表存储/n 表示/v …/ws 
tylw/x ~/n Qf/x  enum/x  IATOM/x ，/wd LIST/x }/n ElemTag/x ；/wf ∥/w ATOM=：0：/x 原子/n 。/wj LIST==1：/x 子/ng 表/n 
typedef/x  struct/x  GT／qode/x {/n 
    E1emTag/x  tag/x ；/wf     ／／/m 公共/b 部分/n ，/wd 用于/v 区分/v 原子/n 结点/n 和/cc 表/n 结点/n 
    union/x {/n     ∥/w 原子/n 结点/n 和/cc 表/n 结点/n 的/ude1 联合/vn 部分/n 
    AtomType/x     atom/x ；/wf   ∥/w 原子/n 结点/n 的/ude1 值域/n 
    struct/x  GLNode/x   */n hp/x ；/wf   ∥/w 表/n 结点/n 的/ude1 表头/n 指针/n 
    }/n ；/wf 
    struot/x  GlSode/x 
I/x */n GList/x ；/wf 
*/n tp/x ；/wf   ∥/w 相当于/v 线性/n 链/ng 表/n 的/ude1 next/x ，/wd 指向/v 下/vf 一个/mq 元素/n 结点/n 
    ∥/w 广义/n 表/vg 类型/n GList/x 是/vshi 一/m 种/q 扩展/v 的/ude1 线性/n 链/ng 表/n 
对于/p 列表/vi 的/ude1 这/rzv 两/m 种/q 存储/vn 结构/n ，/wd 读者/n 只/d 要/v 根据/p 自己/rr 的/ude1 习惯/n 掌握/v 其中/rz 一/m 种/q 结构/n 即可/v 。/wj 
    表/n 结点/n 
A/x 
1/m  tag=0/x   I/x  atom/x  l/x  tp/x   i/x 
    原子/n 结点/n 
图/n 5．10/m 列表/vi 的/ude1 另/rz 一/m 种/q 结点/n 结构/n 
图/n 5．11/m 列表/vi 的/ude1 另/rz 一/m 种/q 链/ng 表表示/n 
5．6m/x 元/q 多项式/n 的/ude1 表示/v 
    在/p 一般/a 情况/n 下/f 使用/v 的/ude1 广义/n 表/vg 多数/m 既/c 非/b 是/vshi 递归/n 表/n ，/wd 也/d 不/d 为/v 其它/rz 表/n 所/usuo 共享/v 。/wj 对/p 广义/n 表/vg 可以/v 这样/rzv 来/f 理解/v ，/wd 广义/n 表/n 中/f 的/ude1 一个/mq 数据/n 元素/n 可以/v 是/vshi 另/rz 一个/mq 广义/n 表/n ，/wd 一个/mq m/x 元/q 多项式/n 的/ude1 表示/v 就/d 是/vshi 广义/n 表/n 的/ude1 这种/r 应用/vn 的/ude1 典型/n 实例/n 。/wj 
    在/p 第2/m 章/q 中/f ，/wd 我们/rr 曾/d 作为/v 线性/n 表/n 的/ude1 应用/vn 实例/n 讨论/v 了/ule 一/m 元/q 多项式/n ，/wd 一个/mq 一元/b 多项式/n 可以/v 一个/mq 长度/n 为/v m/x 且/c 每/rz 个/q 数据/n 元素/n 有/vyou 两/m 个/q 数据项/n (/wkz 系数/n 项/q 和/cc 指数/n 项/q )/wky 的/ude1 线性/n 表/vg 来/vf 表示/v 。/wj 
    这里/rzs ，/wd 我们/rr 将/d 讨论/v 如何/ryv 表示/v m/x 元/q 多项式/n 。/wj 一个/mq m/x 元/q 多项式/n 的/ude1 每/rz 一/m 项/q ，/wd 最/d 多/a 有/vyou m/x 个/q 变元/n 。/wj 如果/c 用/p 线性/n 表/vg 来/vf 表示/v ，/wd 则/c 每个/r 数据/n 元素/n 需要/v m+1/x 个/q 数据项/n ，/wd 以/p 存储/v 一个/mq 系数/n 值/n 和/cc m/x 个/q 指数值/n 。/wj 这/rzv 将/d 产生/v 两/m 个/q 问题/n ：/wp 一/m 是/vshi 无论/c 多项式/n 中/f 各项/r 的/ude1 变元/n 数/n 是/vshi 多/m 是/vshi 少/a ，/wd 若/c 都/d 按/p m/x 个/q 变元/n 分配存储/n 空间/n ，/wd 则/c 将/d 造成/v 浪费/v ；/wf 反之/c ，/wd 若/c 按/p 各项/r 实际/n 的/ude1 变元/n 数/n 分配存储/n 空间/n ，/wd 就/d 会/v 造成/v 结点/n 的/ude1 大小/n 不/d 匀/a ，/wd 给/p 操作/v 带来/v 不便/an ；/wf 二/m 是/vshi 对/p 优/ag 值/v 不同/a 的/ude1 多项式/n ，/wd 线性/n 表/n 中/f 的/ude1 结点/n 大小/n 也/d 不同/a ，/wd 这/rzv 同样/d 会/v 引起/v 存储管理/n 的/ude1 不便/an 。/wj 因此/c ，/wd 由于/c 仇/n 元/q 多项式/n 中/f 每/rz 一/m 项/q 的/ude1 变化/vn 数目/n 的/ude1 不/d 均匀性/n 和/cc 变元/n 信息/n 的/ude1 重要性/n ，/wd 故/c 不/d 适于/v 用/p 线性/n 表表示/n 。/wj 例如/v 三元/b 多项式/n     P/x (/wkz z/x ，/wd y/x ，/wd 2/m )/wky =z/x 如/v y322+226y322+3z/x 。/wj 31222+z4y4z+623y4z+2yz+15/x 
其中/rz 各项/r 的/ude1 变元/n 数目/n 不尽/d 相同/a ，/wd 而/cc y/x 。/wj 、/wn z/x 。/wj 等/v 因子/n 又/d 多次/mq 出现/v 。/wj 如若/c 改写/v 为/v  
(/wkz z/x ，/wd y/x ，/wd z/x )/wky =/m (/wkz (/wkz z/x ’/wyy o+226/x )/wky y/x 。/wj +325/m ∥/w 2/m )/wky z2+/x (/wkz (/wkz z4+6z/x 。/wj )/wky y4+2y/x )/wky z+15/x 
情况/n 就/d 不同/a 了/y 。/wj 现在/t ，/wd 我们/rr 再/d 来/vf 看/v 这个/rz 多项式/n P/x ，/wd 它/rr 是/vshi 变元/n z/x 的/ude1 多项式/n ，/wd 即/v ．/w Az2+/x ＆/n +/m 
15z/x 。/wj ，/wd 只/d 是/vshi 其中/rz A/x 和/cc B/x 本身/rz 又/d 是/vshi 一个/mq (/wkz z/x ，/wd y/x )/wky 的/ude1 二元/b 多项式/n ，/wd 15/m 是/vshi z/x 的/ude1 零/m 次项/n 的/ude1 系数/n 。/wj 进一步/d 考察/v A/x (/wkz z/x ，/wd y/x )/wky ，/wd 又/d 可/v 把/pba 它/rr 看成/v 是/vshi y/x 的/ude1 多项式/n 。/wj 回/v 。/wj +Dy/x 。/wj ，/wd 而/cc 其中/rz C/x 和/cc D/x 为/v x/x 的/ude1 一元/b 多项式/n 。/wj 循/vg 此/rzs 以往/t ，/wd 每个/r 多项式/n 都/d 可/v 看作/v 是/vshi 由/p 一个/mq 变量/n 加上/v 若干/m 个/q 系数/n 指数/n 偶/d 对/p 组成/v 。/wj 
    任何/rz 一个/mq m/x 元/q 多项式/n 都/d 可/v 如此/rzv 做/v ：/wp 先/d 分解/v 出/vf 一个/mq 主/n 变元/n ，/wd 随后/d 再/d 分解/v 出/vf 第二/m 个/q 变元/n ，/wd 等等/udeng 。/wj 由此/d ，/wd 一个/mq m/x 元/q 的/ude1 多项式/n 首先/d 是/vshi 它/rr 的/ude1 主/ag 变元/n 的/ude1 多项式/n ，/wd 而/cc 其/rz 系数/n 又/d 是/vshi 第二/m 变元/n 的/ude1 多项式/n ，/wd 由此/d 可用/a 广义/n 表/vg 来/vf 表示/v m/x 元/q 多项式/n 。/wj 例如/v 上述/b 三/m 元/q 多项式/n 可用/v 式/k (/wkz 5―7/m )/wky 的/ude1 广义/n 表表示/n ，/wd 广义/n 表/n 的/ude1 深度/n 即/d 为/v 变元/n 个/q 数/n 。/wj 
    P=z/x (/wkz (/wkz A/x ，/wd 2/m )/wky ，/wd (/wkz B/x ，/wd 1/m )/wky ，/wd (/wkz 15/m ，/wd O/x )/wky )/wky ①/m     (/wkz 5―7/m )/wky 
其中/rz A=y/x (/wkz (/wkz C/x ，/wd 3/m )/wky ，/wd (/wkz D/x ，/wd 2/m )/wky )/wky 
    C=z/x (/wkz (/wkz 1/m ，/wd 10/m )/wky ，/wd (/wkz 2/m ，/wd 6/m )/wky )/wky 
    D：z/x (/wkz (/wkz 3/m ，/wd 5/m )/wky )/wky 
    B=3/x '/n (/wkz (/wkz E/x ，/wd 4/m )/wky ，/wd (/wkz F/x ，/wd 1/m )/wky )/wky 
    E=z/x (/wkz (/wkz 1/m ，/wd 4/m )/wky )/wky ，/wd (/wkz 6/m ，/wd 3/m )/wky )/wky 
    F=z/x (/wkz (/wkz 2/m ，/wd 0/m )/wky )/wky 
可/v 类似/v 于/p 广义/n 表/n 的/ude1 第二/m 种/q 存储/vn 结构/n 来/vf 定义表示/n m/x 元/q 多项式/n 的/ude1 广义/n 表/n 的/ude1 存储/vn 结构/n 。/wj 
链/ng 表/n 的/ude1 结点/n 结构/n 为/v ：/wp 
    exp/x  hp/x 
    表/n 结点/n 
  1/m  exp/x  tp/x 
    原子/n 结点/n 
其中/rz exp/x 为/p 指数/n 域/ng ，/wd coef/x ’/wyy 为/p 系数/n 域/ng ，/wd hp/x 指向/v 其/rz 系数/n 子/ng 表/n ，/wd tp/x 指向/v 同/p 一/m 层/qv 的/ude1 下/vf 一/m 结点/n 。/wj 其/rz 形式/n 定义/n 说明/v 如下/vi ：/wp 
ted．struet/x  MPNode/x {/n 
ElemTag/x  tag/x ；/wf     ∥/w 区分/v 原子/n 结点/n 和/cc 表/n 结点/n 
int/x     exp/x ；/wf   ∥/w 指数/n 域/ng 
①/m   我们/rr 在/p 广义/n 表/n 的/ude1 括弧/n 之前/f 加/v 一个/mq 变元/n ，/wd 以/p 示/vg 各/rz 层/qv 的/ude1 变元/n 。/wj 
 union/x  l/x 
    float/x     coef/x ；/wf 
    struct/x  MPNode/x */n hp/x ；/wf 
  l/x ；/wf 
  struct/x  MPNode/x     */n tp/x ；/wf 
}/n */n MPList/x ；/wf 
∥/w 系数/n 域/ng 
∥/w 表/n 结点/n 的/ude1 表头/n 指针/n 
∥/w 相当于/v 线性/n 链/ng 表/n 的/ude1 next/x ，/wd 指向/v 下/vf 一个/mq 元素/n 结点/n 
∥/w m/x 元/q 多项式/n 广义/n 表/vg 类型/n 
式/ng (/wkz 5―7/m )/wky 的/ude1 广义/n 表/n 的/ude1 存储/vn 结构/n 如/v 图/n 5．12/m 所/usuo 示/vg ，/wd 在/p 每/rz 一/m 层/qv 上/f 增设/v 一个/mq 表头/n 结点/n 并/d 利用/v exp/x 指示/n 该/rz 层/qv 的/ude1 变元/n ，/wd 可/v 用/p 一/m 维/q 数组/n 存储/vn 多项式/n 中/b 所有/b 变元/n ，/wd 故/c exp/x 域/n 存储/vn 的/ude1 是/vshi 该/rz 变元/n 在/p 一/m 维/q 数组/n 中/f 的/ude1 下标/n 。/wj 头/m 指针/n p/x 所/usuo 指/v 表/vg 结点/n 中/f exp/x 的/ude1 值/n 3/m 为/p 多项式/n 中/f 变元/n 的/ude1 个/q 数/n 。/wj 可见/c ，/wd 这种/r 存储/vn 结构/n 可/v 表示/v 任何/rz 元/q 的/ude1 多项式/n 。/wj 
图/n 5．12/m 三元/b 多项式/n 户/q (/wkz T/x ，/wd y/x ，/wd 2/m )/wky 的/ude1 存储/vn 结构/n 示意图/n 
5．7/m 广义/n 表/n 的/ude1 递归/n 算法/n 
    在/p 第三/m 章/q 中/f 曾/d 提及/v ，/wd 递归/n 函数/n 结构/n 清晰/a 、/wn 程序/n 易/ad 读/v 、/wn 且/c 容易/ad 证明/v 正确性/n ，/wd 因此/c 是/vshi 程序设计/n 的/ude1 有力/a 工具/n ，/wd 但/c 有时/d 递归/n 函数/n 的/ude1 执行/vn 效率/n 很/d 低/a ，/wd 因此/c 使用/v 递归/n 应/v 扬长避短/vl 。/wj 在/p 程序设计/n 的/ude1 过程/n 中/f ，/wd 我们/rr 并/d 不/d 一味/d 追求/v 递归/n 。/wj 如果/c 一个/mq 问题/n 的/ude1 求解/vi 过程/n 有/vyou 明显/a 的/ude1 递推/n 规律/n ，/wd 我们/rr 也/d 很/d 容易/ad 写/v 出/vf 它/rr 的/ude1 递推/n 过程/n (/wkz 如求阶/nr 乘/v 函数/n (/wkz )/wky =n/x !/wt 的/ude1 值/n )/wky ，/wd 则/c 不/d 必要/a 使用/v “/wyz 递归/n ”/wyy ；/wf 反之/c ，/wd 在/p 对/p 问题/n 进行/vx 分解/vn 、/wn 求解/vi 的/ude1 过程/n 中/f 得到/v 的/ude1 是/vshi 和/p 原/b 问题/n 性质/n 相同/a 的/ude1 子/ng 问题/n (/wkz 如/v Hanoi/x 塔/b 问题/n )/wky ，/wd 由此/d 自然/d 得/ude3 到/v 一个/mq 递归/n 算法/n ，/wd 且/c 它/rr 比/p 利用/v 栈/ng 实现/v 的/ude1 非/b 递归/n 算法/n 更/d 符合人们/n 的/ude1 思维/n 逻辑/n ，/wd 因而/c 更/d 易于/v 理解/vn 。/wj 但是/c 要/v 熟练/ad 掌握/v 递归/n 算法/n 的/ude1 设计/vn 方法/n 也/d 不/d 是/vshi 件/q 轻而易举/al 的/ude1 事情/n 。/wj 
在/p 本/rz 节/n 中/f ，/wd 我们/rr 不/d 打算/v 全面/ad 讨论/v 如何/ryv 设计/v 递归/n 算法/n ，/wd 只是/c 以/p 广义/n 表/vg 为/p 例/n ，/wd 讨论/v 如何/ryv 利用/v “/wyz 分治/v 法/n ”/wyy (/wkz 【/wkz )/wky ivide/x  and/x  Conquer/x )/wky 进行/vx 递归/n 算法/n 设计/vn 的/ude1 方法/n 。/wj 
    对/p 这/rzv 类/q 问题/n 设计/v 递归/n 算法/n 时/ng ，/wd 通常/d 可以/v 先/d 写/v 出/vf 问题/n 求解/vi 的/ude1 递归/n 定义/n 。/wj 和/cc 第二/m 数学/n 归纳法/n 类似/a ，/wd 递归/n 定义/n 由/p 基本/a 项/q 和/cc 归纳/v 项/q 两/m 部分/n 组成/v 。/wj 
    递归/n 定义/n 的/ude1 基本/a 项/q 描述/v 了/ule 一个/mq 或/c 几/m 个/q 递归/n 过程/n 的/ude1 终结/vn 状态/n 。/wj 虽然/c 一个/mq 有限/a 的/ude1 递归/n (/wkz 且/c 无/v 明显/a 的/ude1 叠代/n )/wky 可以/v 描述/v 一个/mq 无限/b 的/ude1 计算/vn 过程/n ，/wd 但/c 任何/rz 实际/n 应用/vn 的/ude1 递归/n 过程/n ，/wd 除/p 错误/n 情况/n 外/f ，/wd 必定/d 能/v 经过/p 有限/a 层次/n 的/ude1 递归/n 而/cc 终止/v 。/wj 所谓/v 终结/vi 状态/n 指/v 的/ude1 是/vshi 不/d 需要/v 继续/v 递归/n 而/cc 可/v 直接/ad 求解/vi 的/ude1 状态/n 。/wj 如/v 例/n 3―3/m 的/ude1 ”/wyy 阶/ng Hanoi/x 塔/b 问题/n ，/wd 在/p n=1/x 时/ng 可以/v 直接/ad 求得/v 解/v ，/wd 即将/d 圆盘/n 从/p x/x 塔座/n 移动/vn 到/v z/x 塔座/n 上/f 。/wj 一般/a 情况/n 下/f ，/wd 若/c 递归/n 参数/n 为/v n/x ，/wd 则/c 递归/n 的/ude1 终结/vn 状态/n 为/v ”/wyy =0/m 或/c ”/wyy ：/wp 1/m 等/udeng 。/wj 
    递归/n 定义/n 的/ude1 归纳/vn 项/q 描述/v 了/ule 如何/ryv 实现/v 从/p 当前/t 状态/n 到/v 终结/vi 状态/n 的/ude1 转化/vn 。/wj 递归/n 设计/vn 的/ude1 实质/n 是/vshi ：/wp 当/v 一个/mq 复杂/a 的/ude1 问题/n 可以/v 分解/v 成/v 若干/m 子/q 问题/n 来/vf 处理/v 时/ng ，/wd 其中/rz 某些/rz 子/ng 问题/n 与/p 原/b 问题/n 有/vyou 相同/a 的/ude1 特征/n 属性/n ，/wd 则/c 可/v 利用/v 和/cc 原/b 问题/n 相同/a 的/ude1 分析处理/n 方法/n ；/wf 反之/c ，/wd 这些/rz 子/ng 问题/n 解决/v 了/y ，/wd 原/b 问题/n 也/d 就/d 迎刃而解/vl 了/y 。/wj 递归/n 定义/n 的/ude1 归纳/vn 项/q 就/d 是/vshi 描述/v 这种/r 原/b 问题/n 和/cc 子/ng 问题/n 之间/f 的/ude1 转化/vn 关系/n 。/wj 仍/d 以/p Hanoi/x 塔/b 问题/n 为/p 例/n 。/wj 原/b 问题/n 是/vshi 将/d n/x 个/q 圆盘/n 从/p x/x 塔座/n 移/v 至/p z/x 塔座/n 上/f ，/wd 可以/v 把/pba 它/rr 分解/v 成/v 三/m 个/q 子/ng 问题/n ：/wp (/wkz 1/m )/wky 将/d 编号/vi 为/p 1/m 至/v ，/wd z―l/x 的/ude1 ”/wyy 一/m 1/m 个/q 圆盘/n 从/p x/x 塔座/n 移/v 至/p Y/x 塔座/n ；/wf (/wkz 2/m )/wky 将/d 编号/vi 为/v ”/wyy 的/ude1 圆盘/n 从/p x/x 塔座/n 移/v 至/p z/x 塔座/n ；/wf (/wkz 3/m )/wky 将/d 编号/vi 为/p 1/m 至/p ”/wyy 一/m 1/m 的/ude1 圆盘/n 从/p Y/x 塔座/n 移/v 至/p z/x 塔座/n 。/wj 其中/rz (/wkz 1/m )/wky 和/cc (/wkz 3/m )/wky 的/ude1 子/ng 问题/n 和/cc 原/b 问题/n 特征/n 属性/n 相同/a 。/wj 只/d 是/vshi 参数/n (/wkz ”/wyy 一/m 1/m 和/cc n/x )/wky 不同/a ，/wd 由此/d 实现/v 了/ule 递归/n ，/wd ，/wd     
    由于/c 递归/n 函数/n 的/ude1 设计/vn 用/v 的/ude1 是/vshi 归纳/v 思维/n 的/ude1 方法/n ，/wd 则/c 在/p 设计/v 递归/n 函数/n 时/ng ，/wd 成/v 注意/v ：/wp (/wkz 1/m )/wky 首先/d 应/v 书写/v 函数/n 的/ude1 首/m 部/q 和/cc 规格说明/n ，/wd 严格/ad 定义/v 函数/n 的/ude1 功能/n 和/cc 接口/n (/wkz 递归/n 调用/v 的/ude1 界面/n )/wky ，/wd 对/p 求/v 精/a 函数/n 中/f 所/usuo 得/v 的/ude1 和/cc 原/b 问题/n 性质/n 相同/a 的/ude1 子/ng 问题/n ，/wd 只要/c 接口/n 一致/an ，/wd 便/d 可/v 进行/vx 递归/n 调用/v ；/wf (/wkz 2/m )/wky 对/p 函数/n 中/f 的/ude1 每/rz 一个/mq 递归/n 调用/v 都/d 看成/v 只/d 是/vshi 一个/mq 简单/a 的/ude1 操作/vn ，/wd 只要/c 接口/n 一致/an ，/wd 必/d 能/v 实现/v 规格说明/n 中/b 定义/n 的/ude1 功能/n ，/wd 切忌/v 想/v 得/ude3 太/d 深/d 太/d 远/a 。/wj 正/d 如/v 用/p 第二/m 数学/n 归纳法/n 证明/v 命题/n 时/ng ，/wd 由/p 归纳/v 假设/n 进行/vx 归纳/vn 证明/v 时/ng 绝不/d 能/v 怀疑/v 归纳/v 假设/v 是否/v 正确/a 。/wj 
    下面/f 讨论/v 广义/n 表/n 的/ude1 三/m 种/q 操作/vn 。/wj 首先/c 约定/v 所/usuo 讨论/v 的/ude1 广义/n 表/n 都/d 是非/n 递归/n 表/n 且/c 无/v 共享/v 子/ng 表/n 。/wj 
    5．7．1/m 求/v 广义/n 表/n 的/ude1 深度/n 
　　广义/n 表/n 的/ude1 深度/n 定义/n 为/p 广义/n 表/vg 中/b 括弧/n 的/ude1 重/a 数/n ，/wd 是/vshi 广义/n 表/n 的/ude1 一/m 种/q 量度/n 。/wj 例如/v ：/wp 多元/b 多项式/n 广义/n 表/n 的/ude1 深度/n 为/p 多项式/n 中/f 变元/n 的/ude1 个/q 数/n 。/wj 
　　  设/v 非空/n 广义/n 表/vg 为/v 
    LS=/x (/wkz 。/wj l/x ，/wd “/wyz 2/m ，/wd …/ws ，/wd a/x 。/wj )/wky 
其中/rz a/x 。/wj (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky 或/c 为/p 原子/n 或/c 为/v LS/x 的/ude1 子/ng 表/n ，/wd 则/c 求/v LS/x 的/ude1 深度/n 可/v 分解/v 为/v ”/wyy 个子/n 问题/n ，/wd 每个/r 子/ng 问题/n 为/p 求/v 口/n i/x 的/ude1 深度/n ，/wd 若/c a/x 。/wj 是/vshi 原子/n ，/wd 则/c 由/p 定义/n 其/rz 深度/n 为/p 零/m ，/wd 若/c a/x ，/wd 是/vshi 广义/n 表/n ，/wd 则/d 和/cc 上述/b 一样/a 处理/vn ，/wd 而/cc Ls/x 的/ude1 深度/n 为/p 各/rz a：/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky 的/ude1 深度/n 中/f 最/d 大值/n 加/v 1/m 。/wj 空/a 表/n 也/d 是/vshi 广义/n 表/n ，/wd 并/cc 由/p 定义/n 可知/v 空/a 表/n 的/ude1 深度/n 为/p 1/m 。/wj 
    由此可见/c ，/wd 求/v 广义/n 表/n 的/ude1 深度/n 的/ude1 递归/n 算法/n 有/vyou 两/m 个/q 终结/vn 状态/n ：/wp 空/a 表/n 和/cc 原子/n ，/wd 且/c 只/d 要求/v 得/v 。/wj ．/w (/wkz i：1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 的/ude1 深度/n ，/wd 广义/n 表/n 的/ude1 深度/n 就/d 容易/ad 求得/v 了/y 。/wj 显然/a ，/wd 它/rr 应/v 比/p 子/ng 表/vg 深度/n 的/ude1 最/d 大值/n 多/m 1/m 。/wj 
    广义/n 表/n 
    LS：/x (/wkz al/x ，/wd a2/x ，/wd …/ws ，/wd a/x 。/wj )/wky 
的/ude1 深度/n DEPTH/x (/wkz LS/x )/wky 的/ude1 递归/n 定义/n 为/v 
    ・/w   1/m  1/m  3/m   ・/w 
基本/a 项/q ：/wp DEPTH/x (/wkz LS/x )/wky =l/x   当/p LS/x 为/p 空/a 表/n 时/ng 
    DEPTH/x (/wkz LS/x )/wky =0/m   当/p LS/x 为/p 原子/n 时/ng 
归纳/v 项/q ：/wp DEPTH/x (/wkz LS/x )/wky =1+Max/x {/n DEPTH/x (/wkz a/x ；/wf )/wky }/n   n≥l/x 
    l≤t≤/x ”/wyy 
由此/d 定义/v 容易/ad 写/v 出/vf 求/v 深度/n 的/ude1 递归/n 函数/n 。/wj 假设/n L/x 是/vshi GList/x 型/k 的/ude1 变量/n ，/wd 则/d L=NULL/x 表明/v 广义/n 表/vg 为/p 空/a 表/n ，/wd L-/x >/n tag=0/x 表明/v 是/vshi 原子/n 。/wj 反之/c ，/wd L/x 指向/v 表/vg 结点/n ，/wd 该/rz 结点/n 中/f 的/ude1 hp/x 指针/n 指向/v 表头/n ，/wd 即/d 为/v L/x 的/ude1 第一/m 个子/n 表/n ，/wd 而/cc 结点/n 中/f 的/ude1 tp/x 指针/n 所/usuo 指/v 表/vg 尾/ng 结点/n 中/f 的/ude1 hp/x 指针/n 指向/v L/x 的/ude1 第二/m 个子/n 表/n 。/wj 在/p 第一/m 层/qv 中/f 由/p tp/x 相连/vi 的/ude1 所有/b 尾/ng 结点/n 中/f 的/ude1 hp/x 指针/n 均/d 指向/v L/x 的/ude1 子/ng 表/n 。/wj 由此/d ，/wd 求/v 广义/n 表/vg 深度/n 的/ude1 递归/n 函数/n 如/v 算法/n 5．5/m 所/usuo 示/vg 。/wj 
int/x  GListDepth/x (/wkz GList/x  L/x )/wky {/n 
    ∥/w 采用/v 头尾/n 链/ng 表存储/n 结构/n ，/wd 求/v 广义/n 表/n L/x 的/ude1 深度/n 。/wj 
    if/x (/wkz !/wt L/x )/wky return/x  1/m ；/wf     ∥/w 空/v 表/vg 深度/n 为/v l/x 
    if/x (/wkz L-/x >/n tag==ATOM/x )/wky return/x  0/m ；/wf     ∥/w 原子/n 深度/n 为/p 0/m 
    for/x (/wkz ma/x 】/wky 【/wkz =0/m ，/wd PP=L/x ；/wf PP/x ；/wf PP=PP-/x >/n ptr．tp/x )/wky {/n 
    dep=GListDepth/x (/wkz pp-/x >/n ptr．hp/x )/wky ；/wf ∥/w 求/v 以/p PP-/x >/n ptr．hp/x 为/p 头/n 指针/n 的/ude1 子/ng 表/vg 深度/n 
    if/x (/wkz dep/x >/n max/x )/wky max=dep/x ；/wf 
    }/n 
    return/x  max+1/x ；/wf     ∥/w 非空/n 表/n 的/ude1 深度/n 是/vshi 各/rz 元素/n 的/ude1 深度/n 的/ude1 最/d 大值/n 加/v 1/m 
＼ft/x  GListDepth/x 
算法/n 5．5/m 
    上述/b 算法/n 的/ude1 执行/vn 过程/n 实质/n 上/f 是/vshi 遍历/n 广义/n 表/n 的/ude1 过程/n ，/wd 在/p 遍历/n 中/f 首先/d 求得/v 各/rz 子/ng 表/n 的/ude1 深度/n ，/wd 然后/c 综合/vd 得到/v 广义/n 表/n 的/ude1 深度/n 。/wj 例如/v ：/wp 图/n 5．13/m 展示/v 了/ule 求/v 广义/n 表/n D/x 的/ude1 深度/n 的/ude1 过程/n 。/wj 图/n 中用/a 虚线/n 示意/v 遍历/n 过程/n 中/b 指针/n L/x 的/ude1 变化/vn 状况/n ，/wd 在/p 指向/v 结点/n 的/ude1 虚线/n 旁/f 标记/n 的/ude1 是/vshi 将要/d 遍历/n 的/ude1 子/ng 表/n ，/wd 而/cc 在/p 从/p 结/v 点射/v 出/vf 的/ude1 虚线/n 旁/f 标记/n 的/ude1 数字/n 是/vshi 刚/d 求得/v 的/ude1 子/ng 表/n 的/ude1 深度/n ，/wd 从/p 图/n 中/f 可见/v 广义/n 表/n D=/x (/wkz A/x ，/wd B/x ，/wd C/x )/wky =/m (/wkz (/wkz )/wky ，/wd (/wkz e/x )/wky ，/wd (/wkz n/x ，/wd (/wkz b/x ，/wd C/x ，/wd d/x )/wky )/wky )/wky 的/ude1 深度/n 为/p 3/m 。/wj 若/c 按/p 递归/n 定义/n 分析/vn 广义/n 表/n D/x 的/ude1 深度/n ，/wd 则/c 有/vyou ：/wp 
    D/x |/n Pm/x (/wkz D/x )/wky =1+Max/x  IDa/x (/wkz A/x )/wky ，/wd DBFI/x ~/n (/wkz B/x )/wky ，/wd DEPTH/x (/wkz C/x )/wky }/n 
    DEPTH/x (/wkz A/x )/wky =1/m ；/wf 
    DEPTH/x (/wkz B/x )/wky =1十Max/x {/n DF2TH/x (/wkz e/x )/wky }/n =I+0=1/x ；/wf 
    DEPTH/x (/wkz C/x )/wky =1+Max/x {/n DEPTH/x (/wkz a/x )/wky ，/wd DI：/x 阿/b I/x (/wkz (/wkz b/x ，/wd C/x ，/wd d/x )/wky )/wky }/n =2/m 
    I/x (/wkz a/x )/wky =0/m 
    DEPTH/x (/wkz (/wkz b/x ，/wd C/x ，/wd d/x )/wky )/wky =l+Max/x  ID/x ~/n WH/x (/wkz a/x )/wky ，/wd DF2TH/x (/wkz B/x )/wky ，/wd DEPTH/x (/wkz c/x )/wky }/n 
    =1+0=1/m 
由此/d ，/wd DEPTH/x (/wkz D/x )/wky ：/wp 1+Max/x {/n 1/m ，/wd 1/m ，/wd 2/m }/n =3/m 。/wj 
5．7．2/m 复制/v 广义/n 表/n 
    在/p 5．5/m 节/q 中曾/nrj 提及/v ，/wd 任何/rz 一个/mq 非空/n 广义/n 表/n 均/d 可/v 分解/v 成/v 表头/n 和/cc 表/n 尾/ng ，/wd 反之/c ，/wd 一/d 对/p 确定/v 的/ude1 表头/n 和/cc 表/n 尾/ng 可/v 唯一/b 确定/v 一个/mq 广义/n 表/n 。/wj 由此/d ，/wd 复制/v 一个/mq 广义/n 表/n 只要/c 分别/d 复制/v 其/rz 表头/n 和/cc 表/n 尾/ng ，/wd 然后/c 合成/v 即可/v 。/wj 假设/n LS/x 是/vshi 原/b 表/n ，/wd NEWLS/x 是/vshi 复制/v 表/n ，/wd 则/c 复制/v 操作/v 的/ude1 递归/n 定义/n 为/v ：/wp 
基本/a 项/q ：/wp IIlitGList/x (/wkz NEwLs/x )/wky {/n 置/v 空/a 表/n }/n ，/wd 当/v Ls/x 为/p 空/a 表/n 时/ng 。/wj 
归纳/v 项/q ：/wp cOPY/x (/wkz GetHead/x (/wkz Ls/x )/wky -/wp >/n GetHead/x (/wkz NEWLS/x )/wky )/wky   {/n 复制/vn 表头/n }/n 
    图/n 5．13/m 求/v 广义/n 表/n D/x 的/ude1 深度/n 的/ude1 过程/n -/wp 
    cOPY/x (/wkz ＆/n tTail/x (/wkz Ls/x )/wky   >/n GetTail/x (/wkz NEWLS/x )/wky )/wky   {/n 复/vg 制表/vn 尾/ng }/n 
若/c 原/b 表/n 以/p 图/n 5．9/m 的/ude1 链/ng 表表示/n ，/wd 则/c 复制/v 表/n 的/ude1 操作/vn 便/d 是/vshi 建立相应/n 的/ude1 链/ng 表/n 。/wj 只要/c 建立/v 和/cc 原/b 表/n 中/f 的/ude1 结点/n --/wp 对应/vi 的/ude1 新/a 结点/n ，/wd 便/d 可/v 得到/v 复制/v 表/n 的/ude1 新/a 链/ng 表/n 。/wj 由此/d 可/v 写/v 出/vf 复制/v 广义/n 表/n 的/ude1 递归/n 算法/n 如/v 算法/n 5．6/m 所/usuo 示/vg 。/wj 
Status/x  CopyGList/x (/wkz GList/x &/n T/x ，/wd GList/x  L/x )/wky {/n 
    ∥/w 采用/v 头尾/n 链/ng 表存储/n 结构/n ，/wd 由/p 广义/n 表/n L/x 复制/v 得到/v 广义/n 表/n T/x 。/wj 
    if/x (/wkz !/wt L/x )/wky T：NULL/x ；/wf   ∥/w 复制/v 空/a 表/n 
    else/x {/n 
    if/x (/wkz !/wt (/wkz T=/x (/wkz GList/x )/wky malloc/x (/wkz sizeof/x (/wkz Gt／/x ~/n ode/x )/wky )/wky )/wky )/wky 旺/a 北/f (/wkz 0VERFl0W/x )/wky ；/wf   ∥/w 建/v 表/vg 结点/n 
    T-/x >/n tag=L-/x >/n tag/x ；/wf 
    if/x (/wkz L-/x >/n tag==A∞M/x )/wky T-/x >/n atom=L-/x >/n atom/x ；/wf   ∥/w 复制/v 单/b 原子/n 
    else/x  jCopyGList/x (/wkz T-/x >/n ptr．hp/x ，/wd L-/x >/n ptr．hp/x )/wky ；/wf 
    ∥/w 复制/v 广义/n 表/n L-/x >/n ptr．hp/x 的/ude1 一个/mq 副本/n T-/x >/n ptr．hp/x 
    CopyGList/x (/wkz T-/x >/n ptr．tp/x ，/wd L-/x >/n ptr．tp/x )/wky ；/wf 
    ∥/w 复制/v 广义/n 表/n L-/x >/n ptr．tp/x 的/ude1 一个/mq 副本/n T-/x >/n ptr．tp/x 
    I／／else/x 
    }/n ∥/w else/x 
    return/x  OK/x ；/wf 
}/n ∥/w CopyGList/x 
算法/n 5．6/m 
注意/v ，/wd 这里/rzs 使用/v 了/ule 变/v 参/vg ，/wd 使得/vi 这个/rz 递归/n 函数/n 简单/ad 明了/v ，/wd 直截了当/nl 地/ude2 反映/v 出/vf 广义/n 表/n 的/ude1 复制/vn 过程/n ，/wd 读者/n 可/v 试/v 以/p 广义/n 表/n c/x 为/p 例/n 循/vg 序/n 察看/v 过程/n ，/wd 以便/d 得到/v 更/d 深刻/a 的/ude1 了解/vn 。/wj 
5．7．3/m 建立/v 广义/n 表/n 的/ude1 存储/vn 结构/n 
    从/p 上述/b 两/m 种/q 广义/n 表/vg 操作/v 的/ude1 递归/n 算法/n 的/ude1 讨论/vn 中/f 可以/v 发现/v ：/wp 在/p 对/p 广义/n 表/n 进行/vx 的/ude1 操作/vn 下/f 递归/n 定义/n 时/ng ，/wd 可/v 有/vyou 两/m 种/q 分析方法/n 。/wj 一/m 种/q 是/vshi 把/pba 广义/n 表/vg 分解/v 成/v 表头/n 和/cc 表/n 尾/ng 两/m 部分/m ；/wf 另/rz 一/m 种/q 是/vshi 把/pba 广义/n 表/vg 看成/v 是/vshi 含有/v ”/wyy 个/q 并列/v 子/ng 表/n (/wkz 假设/n 原子/n 也/d 视作/v 子/ng 表/vg )/wky 的/ude1 表/n 。/wj 在/p 讨论/v 建立/v 广义/n 表/n 的/ude1 存储/vn 结构/n 时/ng ，/wd 这/rzv 两/m 种/q 分析方法/n 均/d 可/v 。/wj 
    假设/n 把/pba 广义/n 表/n 的/ude1 书/n 写/v 形式/n 看成/v 是/vshi 一个/mq 字符串/n S/x ，/wd 则/c 当/v S/x 为/p 非/b 空白/n 串/v 时/ng 广义/n 表/vg 非空/n 。/wj 此时/r 可以/v 利用/v 5．4/m 节/q 中/b 定义/n 的/ude1 取/v 列表/vi 表头/n Get/x }/n lead/x 和/cc 取/v 列表/vi 表/vg 尾/ng GetTail/x 两/m 个/q 函数/n 建立/v 广义/n 表/n 的/ude1 链/ng 表存储/n 结构/n 。/wj 这个/rz 递归/n 算法/n 和/cc 复制/v 的/ude1 递归/n 算法/n 极为/d 相似/a ，/wd 读者/n 可/c 自行/d 试/v 之/uzhi 。/wj 
下面/f 就/d 第二/m 种/q 分析方法/n 进行/vx 讨论/vn 。/wj 
    广义/n 表/vg 字符串/n S/x 可能/n 有/vyou 两/m 种/q 情况/n ：/wp (/wkz 1/m )/wky S=/x ‘/wyz (/wkz )/wky ’/wyy (/wkz 带/v 括弧/n 的/ude1 空白/n 串/q )/wky ；/wf (/wkz 2/m )/wky S=/x (/wkz a1/x ，/wd a/x  2/m ，/wd …/ws ，/wd a/x 。/wj )/wky ，/wd 其中/rz a=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 是/vshi s/x 的/ude1 子/ng 串/v 。/wj 对/p 应/v 于/p 第一/m 种/q 情况/n s/x 的/ude1 广义/n 表/vg 为/p 空/a 表/n ，/wd 对/p 应/v 于/p 第二/m 种/q 情况/n S/x 的/ude1 广义/n 表/n 中/f 含有/v n/x 个子/n 表/n ，/wd 每个/r 子/ng 表/n 的/ude1 书/n 写/v 形式/n 即/d 为/v 子/ng 串/v ai/x (/wkz 1/m ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 。/wj 此时/r 可/v 类似/v 于/p 求/v 广义/n 表/n 的/ude1 深度/n ，/wd 分析/v 由/p s/x 建立/v 的/ude1 广义/n 表/n 和/cc 由/p a/x ，/wd (/wkz i=l/x ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky 建立/v 的/ude1 子/ng 表/n 之间/f 的/ude1 关系/n 。/wj 假设/v 按/p 图/n 5．8/m 所/usuo 示/vg 结点/n 结构/n 来/vf 建立/v 广义/n 表/n 的/ude1 存储/vn 结构/n ，/wd 则/c 含有/v ”/wyy 个子/n 表/n 的/ude1 广义/n 表/n 中/f 有/vyou n/x 个/q 表/n 结点/n 序列/n 。/wj 第/m i/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd ”/wyy -/wp 1/m )/wky 个/q 表/n 结点/n 中/f 的/ude1 表/n 尾/ng 指针/n 指向/v 第/m H/x  1/m 个/q 表/n 结点/n 。/wj 第/m n/x 个/q 表/n 结点/n 的/ude1 表/n 尾/ng 指针/n 为/v NuuL/x ，/wd 并且/c ，/wd 如果/c 把/pba 原子/n 也/d 看成/v 是/vshi 子/ng 表/n 的/ude1 话/n ，/wd 则/c 第/m i/x 个/q 表/n 结点/n 的/ude1 表头/n 指针/n hp/x 指向/v 由/p ai/x 建立/v 的/ude1 子表/nr2 (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky 。/wj 由此/d ，/wd 由/p S/x 建/v 广义/n 表/n 的/ude1 问题/n 可/v 转化/v 为/v 由/p a：/x (/wkz 江/nr1 1/m ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky 建子表/nr 的/ude1 问题/n 。/wj 又/c ，/wd ai/x 可能/n 有/vyou 三/m 种/q 情况/n ：/wp (/wkz 1/m )/wky 带/v 括弧/n 的/ude1 空白/n 串/q ；/wf (/wkz 2/m )/wky 长度/n 为/p 1/m 的/ude1 单/b 字符串/n ；/wf (/wkz 3/m )/wky 长度/n >/n l/x 的/ude1 字符串/n 。/wj 显然/a ，/wd 前/f 两/m 种/q 情况/n 为/p 递归/n 的/ude1 终结/vn 状态/n ，/wd 子表/nr2 为/v 空/a 表/n 或/c 只/d 含/v 一个/mq 原子/n 结点/n ，/wd 后/f 一/m 种/q 情况/n 为/p 递归/n 调用/v 。/wj 
由此/d ，/wd 在/p 不/d 考虑/v 输入/vn 字符串/n 可能/v 出错/vi 的/ude1 前提/n 下/f ，/wd 可/v 得/ude3 下列/b 建立/v 广义/n 表链/n 表存储/n 结构/n 的/ude1 递归/n 定义/n 。/wj 
基本/a 项/q ：/wp 
  置/v 空/a 广义/n 表/n     当/p S/x 为/p 空/a 表/n 串/v 时/ng 
  建/v 原子/n 结点/n 的/ude1 子/ng 表/n     当/p S/x 为/p 单/b 字符串/n 时/ng 
归纳/v 项/q ：/wp 假设/v sub/x 为/p 脱/v 去/vf S/x 中/f 最/d 外层/n 括弧/n 的/ude1 子/ng 串/v ，/wd 记/v 为/v ’/wyy sl/x '/n s2/x ，/wd …/ws ，/wd s/x 。/wj ’/wyy ，/wd 其中/rz si/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd   ”/wyy )/wky 为/p 非/b 空字符/n 串/q 。/wj 对/p 每/rz 一个/mq si/x 建立/v 一个/mq 表/n 结点/n ，/wd 并/cc 令/v 其/rz 矗/n p/x 域/n 的/ude1 指针/n 为/v 由/p s/x ，/wd 建立/v 的/ude1 子/ng 表/n 的/ude1 头/n 指针/n ，/wd 除/p 最后/f 建立/v 的/ude1 表/n 结点/n 的/ude1 尾/q 指针/n 为/v NuuL/x 外/f ，/wd 其余/rz 表/n 结点/n 的/ude1 尾/q 指针/n 均/d 指向/v 在/p 它/rr 之后/f 建立/v 的/ude1 表/n 结点/n 。/wj 
    假定/v 函数/n sever/x (/wkz str/x ，/wd hstr/x )/wky 的/ude1 功能/n 为/v ，/wd 从/p 字符串/n str/x 中/f 取出/v 第一/m 个/q “/wyz ，/wd ”/wyy 之前/f 的/ude1 子/ng 串/v 赋/ng 给/v hstr/x ，/wd 并/cc 使/v str/x 成为/v 删去/v 子/ng 串/v hstr/x 和/cc ‘/wyz ，/wd ’/wyy 之后/f 的/ude1 剩余/vn 串/q ，/wd 若/c 串/v str/x 中/f 没有/v 字符/n ‘/wyz ，/wd ’/wyy ，/wd 则/c 操作/v 后/f 的/ude1 hstr/x 即/d 为/v 操作前/n 的/ude1 str/x ，/wd 而/cc 操作/vn 后/f 的/ude1 str/x 为/p 空串/n NULL/x 。/wj 根据上述/n 递归/n 定义/n 可/v 得到/v 建/v 广义/n 表存储/n 结构/n 的/ude1 递归/n 函数/n 如/v 算法/n 5．7/m 所/usuo 示/vg 。/wj 函数/n sever/x 如/v 算法/n 5．8/m 所/usuo 示/vg 。/wj 
Status/x  CreateGList/x (/wkz GList/x &/n L/x ，/wd SString/x  s/x )/wky l/x 
    ∥/w 采用/v 头尾/n 链/ng 表存储/n 结构/n ，/wd 由/p 广义/n 表/n 的/ude1 书/n 写/v 形式/n 串/v s/x 创建/vn 广义/n 表/n L/x 。/wj 设/v emp=/x ”/wyy (/wkz )/wky ”/wyy     if/x (/wkz strCompare/x (/wkz s/x ，/wd emp/x )/wky )/wky L=MOLL/x ；/wf ∥/w 创建/v 空/a 表/n 
    else/x  J/x 
    if/x (/wkz !/wt (/wkz L：/x (/wkz GList/x )/wky malfoe/x (/wkz sizeof/x (/wkz GLNode/x )/wky )/wky )/wky )/wky exit/x (/wkz OVERFIZW/x )/wky ；/wf ∥/w 建/v 表/vg 结点/n 
    if/x (/wkz strLength/x (/wkz s/x )/wky ==1/m )/wky {/n L-/x >/n tag=ATOM/x ；/wf   L-/x >/n atom=s/x }/n   ∥/w 创建/v 单/b 原子/n 广义/n 表/n 
    else/x {/n 
    L-/x >/n tag=L/x 工/n ST/x ；/wf   p=L/x ；/wf 
    subSt．ring/x (/wkz sub．s/x ，/wd 2/m ，/wd strLength/x (/wkz s/x )/wky -/wp 2/m )/wky ；/wf     ∥/w 脱/v 外层/n 括号/n 
    do/x {/n   ∥/w 重复/v 建/v n/x 个子/n 表/n 
    sever/x (/wkz sub/x ，/wd hsub/x )/wky ；/wf ∥/w 从/p sub/x 中/f 分离/vi 出/vf 表头/n 串/v hsub/x 
    CreateGList/x (/wkz P-/x >/n P．hp/x ，/wd hsub/x )/wky ；/wf q=p/x ；/wf 
    if/x (/wkz !/wt StrEmpty/x (/wkz sub/x )/wky )/wky {/n     ∥/w 表/vg 尾/ng 不/d 空/a 
    if/x (/wkz !/wt (/wkz P：/x (/wkz GLNode/x */n )/wky malloc/x (/wkz sizeof/x (/wkz GLNode/x )/wky )/wky )/wky )/wky 
    exit/x (/wkz OVEI/x ~/n LOW/x )/wky ；/wf 
    P-/x >/n tag=LIST/x ；/wf   q-/x >/n p．tp=p/x ；/wf 
    }/n ∥/w if/x 
    }/n while/x (/wkz !/wt StrEmpty/x (/wkz sub/x )/wky )/wky ；/wf 
    q-/x >/n p．tp=lULL/x ；/wf 
    }/n else/x 
    }/n ∥/w else/x 
    return/x  OK/x ；/wf 
}/n ／／CreateGList/x 
算法/n S．7/x 
Status/x  sever/x (/wkz SString/x ＆/n str/x ，/wd SString/x ＆/n hstr/x )/wky {/n 
    ∥/w 将/p 非/b 空串/n str/x 分割/v 成/v 两/m 部分/m ：/wp hsub/x 为/p 第一/m 个/q ’/wyy ，/wd ’/wyy 之前/f 的/ude1 子/ng 串/v ，/wd str/x 为/v 之后/f 的/ude1 子/ng 串/v 
    n=StrLength/x (/wkz str/x )/wky ；/wf   i=1/x ；/wf k=0/x ；/wf ∥/w k/x 记/v 尚未/d 配对/vi 的/ude1 左/a 括号/n 个数/n 
    for/x (/wkz i=I/x ，/wd k=0/x ；/wf i/x </n ：/wp n/x ＆/n ＆/n ch/x !/wt ：/wp ’/wyy ，/wd ‘/wyz l/x _/n k/x !/wt =0/m ；/wf   ++i/x )/wky {/n     ．/w 
    ∥/w 搜索/v 最/d 外/f 层/qv 的/ude1 第一/m 个/q 逗号/n 
    SubString/x (/wkz ch/x ，/wd str/x ，/wd i/x ，/wd 1/m )/wky ；/wf 
    if/x (/wkz ch==/x ’/wyy (/wkz ’/wyy )/wky     ++k/x ；/wf 
    else/x  if/x (/wkz ch==/x ’/wyy )/wky ’/wyy )/wky   --/wp k：/x 
    f／／for/x 
    if/x (/wkz i/x </n =n/x )/wky 
    {/n SubString/x (/wkz hstr/x ，/wd str/x ，/wd 1．I-2/x )/wky ；/wf SubString/x (/wkz str/x ，/wd 
  else/x {/n StrCopy/x (/wkz hstr/x ，/wd str/x )/wky ；/wf ClearString/x (/wkz str/x )/wky }/n 
}/n ／／sever/x 
算法/n 5．8/m 



第6/m 章/q 树/n 和/cc 二/m 叉树/n 
    树/n 型/k 结构/n 是/vshi 一/m 类/q 重要/a 的/ude1 非线性/b 数据/n 结构/n 。/wj 其中/rz 以/p 树/n 和/cc 二/m 叉树/n 最为/d 常/d 用/v ，/wd 直观/ad 看来/v ，/wd 树/n 是/vshi 以/p 分支/n 关系定义/n 的/ude1 层次/n 结构/n 。/wj 树结构/n 在/p 客观/a 世界/n 中/f 广泛/ad 存在/v ，/wd 如/v 人类/n 社会/n 的/ude1 族谱/n 和/cc 各种/rz 社会/n 组织/v 机构/n 都/d 可/v 用/p 树/n 来/vf 形象/n 表示/v 。/wj 树/n 在/p 计算机领域/n 中/f 也/d 得到/v 广泛/ad 应用/v ，/wd 如/c 在/p 编译程序/n 中/f ，/wd 可用/v 树/n 来/vf 表示/v 源程序/n 的/ude1 语法/n 结构/n 。/wj 又/d 如/v 在/p 数据库/n 系统/n 中/f ，/wd 树形/n 结构/n 也/d 是/vshi 信息/n 的/ude1 重要/a 组织/n 形式/n 之一/rz 。/wj 本/rz 章/n 重点/d 讨论/v 二/m 叉树/n 的/ude1 存储/vn 结构/n 及其/cc 各种/rz 操作/vn ，/wd 并/cc 研究/vn 树/n 和/cc 森林/n 与/p 二/m 叉树/n 的/ude1 转换/vn 关系/n ，/wd 最后/f 介绍/v 几/m 个/q 应用/vn 例子/n 。/wj     
6．1/m 树/n 的/ude1 定义/n 和/cc 基本/a 术语/n 
树/n (/wkz Tree/x )/wky 是/vshi n/x (/wkz n≥0/x )/wky 个/q 结点/n 的/ude1 有限/a 集/vg 。/wj 在/p 任意/d 一/m 棵/q 非空/n 树/n 中/f ：/wp (/wkz 1/m )/wky 有/vyou 且/c 仅/d 有/vyou 一个/mq 特定/b 的/ude1 称为/v 根/n (/wkz Root/x ，/wd )/wky 的/ude1 结点/n ；/wf (/wkz 2/m )/wky 当/v ，/wd z/x >/n l/x 时/ng ，/wd 其余/rz 结点/n 可/v 分为/v 优/ag (/wkz 优/ag >/n 0/m )/wky 个/q 互不/d 相交/vi 的/ude1 有限/a 集/vg 丁/ng l/x ，/wd T2/x ，/wd …/ws ，/wd T/x 。/wj ，/wd 其中/rz 每/rz 一个/mq 集合/v 本身/rz 又/d 是/vshi 一/m 棵/q 树/n ，/wd 并且/c 称为/v 根/n 的/ude1 子树/nr2 (/wkz SubTree/x )/wky 。/wj 例如/v ，/wd 在/p 图/n 6．1/m 中/f ，/wd (/wkz a/x )/wky 是/vshi 只/d 有/vyou 一个/mq 根/n 结点/n 的/ude1 树/n ；/wf (/wkz b/x )/wky 是/vshi 有/vyou 13/m 个/q 结点/n 的/ude1 树/n ，/wd 其中/rz A/x 是/vshi 根/n ，/wd 其余/rz 结点/n 分成/vi 三/m 个/q 互不/d 相交/vi 的/ude1 子集/n ：/wp T/x ，/wd =/m {/n B/x ，/wd E/x ，/wd F/x ，/wd K/x ，/wd L/x }/n ，/wd T2=/x {/n C/x ，/wd G/x }/n ，/wd T3=/x {/n D/x ，/wd H/x ，/wd J/x ，/wd -/wp  ，/wd M/x }/n ；/wf  1/m 、/wn T2/x 和/cc T3/x 都/d 是/vshi 根/n A/x 的/ude1 子/ng 树/n ，/wd 且/c 本身/rz 也/d 是/vshi 一/m 棵/q 树/n 。/wj 例如/v 
④/m 
  (/wkz a/x )/wky 
    图/n 6．1/m 树/n 的/ude1 示例/n 
(/wkz a/x )/wky 只/d 有/vyou 根/n 结点/n 的/ude1 树/n ；/wf   (/wkz b/x )/wky 一般/uyy 的/ude1 树/n 。/wj 
T-/x ，/wd 其/rz 根/n 为/v B/x ，/wd 其余/rz 结点/n 分为/v 两/m 个/q 互不/d 相交/vi 的/ude1 子集/n ；/wf T/x 。/wj ，/wd =/m {/n E/x ，/wd K/x ，/wd L/x }/n ，/wd 。/wj 2=/m {/n F/x }/n 。/wj T/x 。/wj 。/wj 和/cc T/x 。/wj 2/m 都/d 是/vshi B/x 的/ude1 子/ng 树/n 。/wj 而/cc T/x 。/wj 。/wj 中/f E/x 是/vshi 根/n ，/wd {/n K/x }/n 和/cc {/n L/x }/n 是/vshi E/x 的/ude1 两/m 棵/q 互不/d 相交/vi 的/ude1 子/ng 树/n ，/wd 其/rz 本身/rz 又/d 是/vshi 只/d 有/vyou 一个/mq 根/n 结点/n 的/ude1 树/n 。/wj 
    上述/b 树/n 的/ude1 结构/n 定义/n 加上/v 树/n 的/ude1 一/m 组/q 基本/a 操作/vn 就/d 构成/v 了/ule 抽象数据/n 类型/n 树/n 的/ude1 定义/n 。/wj 
．/w ADT/x  Tree/x {/n 
  数据/n 对象/n D：D/x 是/vshi 具有/v 相同/a 特性/n 的/ude1 数据/n 元素/n 的/ude1 集合/n 。/wj 
  数据/n 关系/n R：/x 若/v D/x 为/v 空/ng 集/ng ，/wd 则/c 称为/v 空/a 树/n ；/wf 
    若/v D/x 仅/d 含/v 一个/mq 数据/n 元素/n ，/wd 则/d R/x 为/v 空/ng 集/ng ，/wd 否则/c R=/x {/n H/x }/n ，/wd H/x 是/vshi 如下/vi 二元/b 关系/n ：/wp 
    (/wkz 1/m )/wky 在/p D/x 中/f 存在/v 唯一/b 的/ude1 称为/v 根/n 的/ude1 数据/n 元素/n root/x ，/wd 它/rr 在/p 关系/n H/x 下/f 无/v 前驱/n ；/wf 
    (/wkz 2/m )/wky 若/v D/x －/wp {/n root/x }/n ≠/w 垂/v ，/wd 则/c 存在/v D/x －/wp {/n root．/x }/n 的/ude1 －/wp ／r/x 划分/v D1/x ，/wd D2/x ，/wd …/ws ，/wd 珥/n (/wkz m/x >/n 0/m )/wky ，/wd 对/p 任意/d j≠k/x (/wkz 1≤j/x ，/wd k≤m/x )/wky 有/vyou D/x ]/wky n/x  Dl/x 【/wkz ：/wp 巾/ng ，/wd 且/c 对/p 任意/b 的/ude1 i/x (/wkz 1≤i≤m/x )/wky ，/wd 唯一/d 存在/v 数据/n 元素/n x：∈D/x 。/wj ，/wd 
    </n root/x ，/wd x/x 。/wj >/n ∈H/x ；/wf 
　　(/wkz 3/m )/wky 对/p 应/v 于/p D/x 一/m {/n root/x }/n 的/ude1 划分/vn ，/wd H/x 一/m {/n </n root：/x ，/wd x1/x >/n ，/wd …/ws ，/wd </n root/x ，/wd 】/wky (/wkz m/x >/n }/n 有/vyou 唯一/b 的/ude1 一个/mq 划分/v H1/x ，/wd H2/x ，/wd …/ws ，/wd Ha/x (/wkz re/x >/n O/x )/wky ，/wd 对/p 任意/d j≠k/x (/wkz 1≤j/x ，/wd k≤m/x )/wky 有/vyou n=/x ，/wd 且/c 对/p 任意/d i/x (/wkz 1≤i≤m/x )/wky ，/wd Hi/x 是/vshi Di/x 上/f 的/ude1 二元/b 关系/n ，/wd (/wkz Di/x ，/wd {/n H/x 。/wj }/n )/wky 是/vshi 一/m 棵/q 符合本/n 定义/n 的/ude1 树/n ，/wd 称为/v 根/n root/x 的/ude1 子/ng 树/n 。/wj 
　　基本/ad 操作/v P：/x 
  InitTree/x (/wkz ＆/n T/x )/wky ；/wf 
  操作/v 结果/n ：/wp 构造/v 空/a 树/n T/x 。/wj 
DestroyTree/x (/wkz ＆/n T/x )/wky ；/wf 
  初始条件/n ：/wp 树/n T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 销毁/v 树/n To/x 
  CreateTree/x (/wkz ＆/n T/x 。/wj definition/x )/wky ；/wf 
    初始条件/n ：/wp definition/x 给/v 出/vf 树/n T/x 的/ude1 定义/n 。/wj 
    操作/v 结果/n ：/wp 按/p definition/x 构造/n 树/n T/x 。/wj 
ClearTree/x (/wkz ＆/n T/x )/wky ；/wf 
  初始条件/n ：/wp 树/n T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 将/p 树/n T/x 清/v 为/p 空/a 树/n 。/wj 
  TreeEmpty/x (/wkz T/x )/wky ；/wf 
  初始条件/n ：/wp 树/n T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 若/v T/x 为/p 空/a 树/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c FALSE/x 。/wj 
TreeDepth/x (/wkz T/x )/wky ；/wf     ．/w 
  初始条件/n ：/wp 树/n T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 返回/v T/x 的/ude1 深度/n 。/wj     ．/w 
  Root/x (/wkz T/x )/wky ；/wf 
  初始条件/n ：/wp 树/n T/x 存在/v 。/wj 
  操作/v 结果/n ：/wp 返回/v T/x 的/ude1 根/n 。/wj 
  Value/x (/wkz T/x ，/wd cur．e/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd cure/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v cure/x 的/ude1 值/n 。/wj 
  Assign/x (/wkz T/x ，/wd cure/x ，/wd value/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd cure/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 结点/n cure/x 赋值/v 为/v value/x 。/wj 
Parent/x (/wkz T/x ，/wd cure/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd cue/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 若/v cure/x 是/vshi T/x 的/ude1 非/b 根/n 结点/n ，/wd 则/c 返回/v 它/rr 的/ude1 双亲/n ，/wd 否则/c 函数值/n 为/v “/wyz 空/ng ”/wyy 。/wj 
LeftChild/x (/wkz T/x ，/wd cure/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd Cure/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 若/v cure/x 是/vshi T/x 的/ude1 非/b 叶子/n 结点/n ，/wd 则/c 返回/v 它/rr 的/ude1 最/d 左/a 孩子/n ，/wd 否则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
  RightSibling/x (/wkz T/x ，/wd cure/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd Cure/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 若/v cur．e/x 有/vyou 右/f 兄弟/n ，/wd 则/c 返回/v 它/rr 的/ude1 右/f 兄弟/n ，/wd 否则/c 函数值/n 为/v “/wyz 空/ng ”/wyy 。/wj 
  InsertChild/x (/wkz &/n T/x ，/wd ＆/n P/x ，/wd i/x 。/wj c/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd P/x 指向/v T/x 中/f 某个/rz 结点/n ，/wd 1≤i≤p/x 所/usuo 指/v 结点/n 的/ude1 度/qv +1/m ，/wd 非空/n 树/n c/x 与/p T/x 不/d 相交/vi 。/wj 
    操作/v 结果/n ：/wp 插入/v C/x 为/v T/x 中/f P/x 指/v 结点/n 的/ude1 第/m i/x 棵子/n 树/n 。/wj 
DeleteChild/x (/wkz ＆/n T/x ，/wd &/n P/x ，/wd i/x )/wky ；/wf 
    初始条件/n ：/wp 树/n T/x 存在/v ，/wd P/x 指向/v T/x 中/f 某个/rz 结点/n ，/wd 1≤i≤p/x 指/v 结点/n 的/ude1 度/qv 。/wj 
    操作/v 结果/n ：/wp 删除/v T/x 中/f P/x 所/usuo 指/v 结点/n 的/ude1 第/m i/x 棵子/n 树/n 。/wj 
TraverseTree/x (/wkz T/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf     
  初始条件/n ：/wp 树/n T/x 存在/v ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 按/p 某种/rz 次序/n 对/p T/x 的/ude1 每个/r 结点/n 调用函数/n visit/x (/wkz )/wky 一/m 次/qv 且/c 至多/d 一/m 次/qv 。/wj 
    一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
    
lADT/x  Tree/x 
　　树/n 的/ude1 结构/n 定义/n 是/vshi 一个/mq 递归/n 的/ude1 定义/n ，/wd 即/d 在/p 树/n 的/ude1 定义/n 中/f 又/d 用/v 到/v 树/n 的/ude1 概念/n ，/wd 它/rr 道出/v 了/ule 树/n 的/ude1 固有/b 特性/n 。/wj 树/n 还/d 可/v 有/vyou 其它/rz 的/ude1 表示形式/n ，/wd 如/v 图/n 6．2/m 所/usuo 示/vg 为/p 图/n 6．1/m (/wkz b/x )/wky 中/f 树/v 的/ude1 各种/rz 表示/v 。/wj 其中/rz (/wkz a/x )/wky 是以/c 嵌套/v 集合/v (/wkz 即/v 是/vshi 一些/mq 集合/n 的/ude1 集体/n ，/wd 对于/p 其中/rz 任何/rz 两/m 个/q 集合/n ，/wd 或者/c 不/d 相/d 交/v ，/wd 或者/c 一个/mq 包含/v 另/rz 一个/mq )/wky 的/ude1 形式/n 表示/v 的/ude1 ；/wf (/wkz b/x )/wky 是/vshi 以/p 广义/n 表/n 的/ude1 形式/n 表示/v 的/ude1 ，/wd 根/n 作为/v 由/p 子/ng 树/v 森林/n 组成/v 的/ude1 表/n 的/ude1 名字/n 写/v 在/p 表/n 的/ude1 左边/f ；/wf (/wkz c/x )/wky 用/v 的/ude1 是/vshi 凹/a 入/v 表示法/n (/wkz 类似/a 书/n 的/ude1 编目/n )/wky 。/wj 表示方法/n 的/ude1 多样化/vn ，/wd 正/d 说明/v 了/ule 树结构/n 在/p 日常/b 生活/vn 中/f 及/cc 计算机程序/n 设计/vn 中/f 的/ude1 重要性/n 。/wj 一般说来/vl ，/wd 分等级/n 的/ude1 分类/vn 方案/n 都/d 可/v 用/p 层次/n 结构/n 来/vf 表示/v ，/wd 也就是说/vl ，/wd 都/d 可/v 导致/v 一个/mq 树结构/n 。/wj 
　　 (/wkz a/x )/wky (/wkz A/x (/wkz B/x (/wkz E/x (/wkz K/x ，/wd L/x )/wky ，/wd F/x )/wky ，/wd C/x (/wkz G/x )/wky ，/wd D/x (/wkz H/x (/wkz M/x )/wky ，/wd I/x ，/wd J/x )/wky )/wky )/wky 
    (/wkz b/x )/wky 图/n 6．2/m 树/n 的/ude1 其它/rz 三/m 种/q 表示法/n 
    下面/f 列出/v 树结构/n 中/f 的/ude1 一些/mq 基本/a 术语/n 。/wj 
    树/n 的/ude1 结点/n 包含/v 一个/mq 数据/n 元素/n 及/cc 若干/m 指向/v 其/rz 子/ng 树/n 的/ude1 分支/n 。/wj 结点/n 拥有/v 的/ude1 子/ng 树/v 数/n 称为/v 结点/n 的/ude1 度/qv (/wkz Degree/x )/wky 。/wj 例如/v ，/wd 在/p 图/n 6．1/m (/wkz b/x )/wky 中/f ，/wd A/x 的/ude1 度/qv 为/v 3/m ，/wd c/x 的/ude1 度/qv 为/v 1/m ，/wd F/x 的/ude1 度/qv 为/v 0/m 。/wj 度/v 为/p 0/m 的/ude1 结点/n 称为/v 叶子/n (/wkz Leaf/x )/wky 或/c 终端/n 结点/n 。/wj 图/n 6．1/m (/wkz b/x )/wky 中/f 的/ude1 结点/n K/x 、/wn L/x 、/wn F/x 、/wn G/x 、/wn M/x 、/wn I/x 、/wn J/x 都/d 是/vshi 树/n 的/ude1 叶子/n 。/wj 度/ng 不/d 为/v 0/m 的/ude1 结点/n 称为/v 非/b 终端/n 结点/n 或/c 分支/n 结点/n 。/wj 除根/vi 结点/n 之外/f ，/wd 分支/n 结点/n 也/d 称为/v 内部/f 结点/n 。/wj 树/n 的/ude1 度/qv 是/vshi 树/n 内/f 各/rz 结点/n 的/ude1 度/qv 的/ude1 最/d 大值/n 。/wj 如/v 图/n 6．1/m (/wkz b/x )/wky 的/ude1 树/n 的/ude1 度/qv 为/v 3/m 。/wj 结点/n 的/ude1 子/ng 树/n 的/ude1 根/n 称为/v 该/rz 结点/n 的/ude1 孩子/n (/wkz Ch5．1d/x )/wky ，/wd 相应/vi 地/n ，/wd 该/rz 结点/n 称为/v 孩子/n 的/ude1 双亲/n (/wkz Parent/x )/wky 。/wj 例如/v ，/wd 在/p 图/n 6．1/m (/wkz b/x )/wky 所/usuo 示/vg 的/ude1 树/n 中/f ，/wd D/x 为/v A/x 的/ude1 子/ng 树/n T3/x 的/ude1 根/n ，/wd 则/d D/x 是/vshi A/x 的/ude1 孩子/n ，/wd 而/cc A/x 则/d 是/vshi D/x 的/ude1 双亲/n ，/wd 同一个/b 双亲/n 的/ude1 孩子/n 之间/f 互/d 称/v 兄弟/n (/wkz sibling/x )/wky 。/wj 例如/v ，/wd H/x 、/wn I/x 和/cc J/x 互为/v 兄弟/n 。/wj 将/p 这些/rz 关系/n 进一步/d 推广/v ，/wd 可/c 认为/v D/x 是/vshi M/x 的/ude1 祖父/n 。/wj 结点/n 的/ude1 祖先/n 是/vshi 从/p 根/n 到/v 该/rz 结点/n 所/usuo 经/v 分支/n 上/f 的/ude1 所有/b 结点/n 。/wj 例如/v ，/wd M/x 的/ude1 祖先/n 为/v A/x 、/wn D/x 和/cc H/x 。/wj 反之/c ，/wd 以/p 某/rz 结点/n 为/p 根/n 的/ude1 子树中/nr 的/ude1 任/v 一/m 结点/n 都/d 称/v 为/p 该/rz 结点/n 的/ude1 子孙/n 。/wj 如/v B/x 的/ude1 子孙/n 为/v E/x 、/wn K/x 、/wn L/x 和/cc F/x 。/wj 
    结点/n 的/ude1 层次/n (/wkz Level/x )/wky 从/p 根/n 开始/v 定义/n 起/vf ，/wd 根/n 为/p 第一/m 层/qv ，/wd 根/n 的/ude1 孩子/n 为/p 第二/m 层/qv 。/wj 若某/nr 结点/n 在/p 第/m z/x 层/n ，/wd 则/c 其/rz 子/ng 树/n 的/ude1 根/n 就/d 在/p 第/m z+1/x 层/n 。/wj 其/rz 双亲/n 在/p 同/p 一/m 层/qv 的/ude1 结点/n 互为/v 堂兄弟/n 。/wj 例如/v ，/wd 结点/n G/x 与/p E/x 、/wn F/x 、/wn H/x 、/wn I/x 、/wn J/x 互为/v 堂兄弟/n 。/wj 树/n 中/f 结点/n 的/ude1 最/d 大/a 层次/n 称为/v 树/n 的/ude1 深度/n (/wkz Depth/x )/wky 或/c 高度/n 。/wj 图/n 6．1/m (/wkz b/x )/wky 所/usuo 示/vg 的/ude1 树/n 的/ude1 深度/n 为/p 4/m 。/wj 
    如果/c 将/d 树/v 中/f 结点/n 的/ude1 各/rz 子/ng 树/v 看成/v 从/p 左/f 至/p 右/f 是/vshi 有/vyou 次序/n 的/ude1 (/wkz 即/v 不/d 能/v 互换/v )/wky ，/wd 则/c 称/v 该/rz 树/n 为/p 有序/a 树/n ，/wd 否则/c 称为/v 无序/b 树/n 。/wj 在/p 有序/a 树/n 中/f 最/d 左边/f 的/ude1 子/ng 树/n 的/ude1 根/n 称为/v 第一/m 个/q 孩子/n ，/wd 最/d 右边/f 的/ude1 称为/v 最后/f 一个/mq 孩子/n 。/wj 
    森林/n (/wkz I：orest/x )/wky 是/vshi m/x (/wkz m≥0/x )/wky 棵/q 互不/d 相交/vi 的/ude1 树/n 的/ude1 集合/n 。/wj 对/p 树/n 中/f 每个/r 结点/n 而言/uls ，/wd 其/rz 子/ng 树/n 的/ude1 -/wp 集合/v 即/v 为/p 森林/n 。/wj 由此/d ，/wd 也/d 可以/v 森林/n 和/cc 树/n 相互/d 递归/n 的/ude1 定义/n 来/vf 描述/v 树/n 。/wj     
    就/p 逻辑/n 结构/n 而言/uls ，/wd 任何/rz 一/m 棵/q 树/n 是/vshi 一个/mq 二元/b 组/n me=/x (/wkz ，/wd oot/x ，/wd F/x )/wky ，/wd 其中/rz ：/wp root/x 是/vshi 数据/n 元素/n ，/wd 称/v 做/v 树/n 的/ude1 根/n 结点/n ；/wf F/x 是/vshi m/x (/wkz m≥0/x )/wky 棵/q 树/n 的/ude1 森林/n ，/wd F=/x (/wkz r1/x ，/wd T2/x ，/wd …/ws ，/wd T/x 。/wj )/wky ，/wd 其中/rz t=/x (/wkz _/n ，/wd E/x )/wky 称/v 做/v 根/n ，/wd "/n oot/x 的/ude1 第/m i/x 棵子/n 树/n ；/wf 当/p 优/ag ≠O/x 时/ng ，/wd 在/p 树根/n 和/cc 其/rz 子/ng 树/v 森林/n 之间/f 存在/v 下列/b 关系/n ：/wp   RF：/x {/n (/wkz root/x ，/wd n/x )/wky l/x  i=l/x ，/wd 2/m ，/wd …/ws ，/wd m/x ，/wd >/n 0/m }/n 
这个/rz 定义/n 将/d 有助于/v 得到/v 森林/n 和/cc 树/n 与/p 二/m 叉树/n 之间/f 转换/v 的/ude1 递归/n 定义/n 。/wj 
    树/n 的/ude1 应用/vn 广泛/a ，/wd 在/p 不同/a 的/ude1 软件/n 系统/n 中/f 树/v 的/ude1 基本/ad 操作/v 集/vg 不尽/d 相同/a 。/wj 
6．2/m 二/m 叉树/n 
    在/p 讨论/v 一般/ad 树/v 的/ude1 存储/vn 结构/n 及其/cc 操作/vn 之前/f ，/wd 我们/rr 首先/d 研究/v 一/m 种/q 称为/v 二/m 叉树/n 的/ude1 抽象数据/n 类型/n 。/wj 
  6．2．1/m 二/m 叉树/n 的/ude1 定义/n 
  二/m 叉树/n (/wkz Bi／18ry/x  Tree/x )/wky 是/vshi 另/rz 一/m 种/q 树/n 型/k 结构/n ，/wd 它/rr 的/ude1 特点/n 是/vshi 每个/r 结点/n 至/p 多/m 只/q 有/vyou 二/m 棵子/n 树/n (/wkz 即/v 二/m 叉树/n 中/f 不/d 存在/v 度/qv 大于/v 2/m 的/ude1 结点/n )/wky ，/wd 并且/c ，/wd 二/m 叉树/n 的/ude1 子/ng 树/n 有/vyou 左右/m 之/uzhi 分/ng ，/wd 其/rz 次序/n 不/d 能/v 任意/d 颠倒/v 。/wj 
    抽象数据/n 类型/n 二/m 叉树/n 的/ude1 定义/n 如下/vi ：/wp 
    ^/n DT/x  Bin/x |/n Iqee/x {/n 
    数据/n 对象/n D：D/x 是/vshi 具有/v 相同/a 特性/n 的/ude1 数据/n 元素/n 的/ude1 集合/n 。/wj 
    数据/n 关系/n R：/x 
    若/v D=/x 中/f ，/wd 则/d R=/x 中/f ，/wd 称/v BinaryTree/x 为/v 空/ng 二/m 叉树/n ；/wf  
    若/v D≠/x 中/f ，/wd 则/d R=/x {/n H/x }/n ，/wd H/x 是/vshi 如下/vi 二元/b 关系/n ：/wp 
    (/wkz 1/m )/wky 在/p D/x 中/f 存在/v 唯一/b 的/ude1 称为/v 根/n 的/ude1 数据/n 元素/n root/x ，/wd 它/rr 在/p 关系/n H/x 下/f 无/v 前驱/n ；/wf 
    (/wkz 2/m )/wky 若/v D/x 一/m {/n root/x }/n ≠/w 垂/v ，/wd 则/c 存在/v D/x 一/m {/n root/x }/n =/m {/n Dl/x ，/wd D：/x }/n ，/wd 且/c Dln/x  Dr=/x ；/wf 
    (/wkz 3/m )/wky 若/v D1≠∞/x ，/wd 则/d D1/x 中/f 存在/v 唯一/b 的/ude1 元素/n x/x 】/wky ，/wd </n root/x ，/wd Xl/x >/n ∈H/x ，/wd 且/c 存在/v Dl/x 上/f 的/ude1 关系/n H1cH/x ；/wf 若/v Dr≠/x 包/n 则/d Dr/x 中/f 存在/v 唯一/b 的/ude1 元素/n 写/v ，/wd </n root/x ，/wd ≈/m >/n ∈H/x ，/wd 
    且/c 存在/v Dr/x 上/f 的/ude1 关系/n 臣/n cH/x ；/wf H：/x {/n </n root：/x ，/wd x1/x >/n ，/wd </n root/x ，/wd >/n ，/wd Hl/x ，/wd K/x }/n ．/w 
    (/wkz 4/m )/wky (/wkz D/x 。/wj ，/wd {/n H1/x }/n )/wky 是/vshi 一/m 棵/q 符合本/n 定义/n 的/ude1 二/m 叉树/n ，/wd 称为/v 根/n 的/ude1 左子树/nr ，/wd 
    (/wkz Dr/x ，/wd {/n 也/d }/n )/wky 是/vshi 一/m 棵/q 符合本/n 定义/n 的/ude1 二/m 叉树/n ，/wd 称为/v 根/n 的/ude1 右/f 子/ng 树/n 。/wj 
    基本/ad 操作/v P：/x 
    InitBiTree/x (/wkz ＆/n T/x )/wky ；/wf 
    操作/v 结果/n ：/wp 构造/n 空/ng 二/m 叉树/n T/x 。/wj 
    DestroyBiTree/x (/wkz ＆/n T/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 二/m 叉树/n T/x 。/wj 
    CreateBiTree/x (/wkz &/n T/x ，/wd defin/x 北/f ion/x )/wky ；/wf 
    初始条件/n ：/wp definition/x 给/v 出/vf 二/m 叉树/n T/x 的/ude1 定义/n 。/wj 
    操作/v 结果/n ：/wp 按/p definltion/x 构造/n 二/m 叉树/n L/x 
    clearBiTree/x (/wkz ＆/n T/x )/wky ；/wf     。/wj 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 将/p 二/m 叉树/n T/x 清/v 为/p 空/a 树/n 。/wj 
    BiTreeEmpty/x (/wkz T/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 若/v T/x 为/v 空/ng 二/m 叉树/n ，/wd 则/c 返回/v TRUE/x ，/wd 否则/c FALSE/x 。/wj 
    BiTreeDepth/x (/wkz T/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v T/x 的/ude1 深度/n 。/wj 
    Root/x (/wkz T/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 返回/v T/x 的/ude1 根/n 。/wj 
    Value/x (/wkz T/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v e/x 的/ude1 值/n 。/wj 
    Assign/x (/wkz T/x ，/wd ＆/n e/x ，/wd value/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 结点/n e/x 赋值/v 为/v value/x 。/wj 
    Parent/x (/wkz T/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 若/v e/x 是/vshi T/x 的/ude1 非/b 根/n 结点/n ，/wd 则/c 返回/v 它/rr 的/ude1 双亲/n ，/wd 否则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
    LeftChild/x (/wkz T/x ，/wd e/x )/wky ；/wf     ．/w 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v e/x 的/ude1 左/a 孩子/n 。/wj 若/v e/x 无/v 左/a 孩子/n ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
    RightChlld/x (/wkz T/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v e/x 的/ude1 右/f 孩子/n 。/wj 若/v e/x 无/v 右/f 孩子/n ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
    LeftSibl．ing/x (/wkz T/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v e/x 的/ude1 左/a 兄弟/n 。/wj 若/v e/x 是/vshi T/x 的/ude1 左/a 孩子/n 或/c 无/v 左/a 兄弟/n ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
    RightSibling/x (/wkz T/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd e/x 是/vshi T/x 中/f 某个/rz 结点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v e/x 的/ude1 右/f 兄弟/n 。/wj 若/v e/x 是/vshi T/x 的/ude1 右/f 孩子/n 或/c 无/v 右/f 兄弟/n ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
    InsertChild/x (/wkz T/x ，/wd p/x ，/wd LR/x ，/wd c/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd p/x 指向/v T/x 中/f 某个/rz 结点/n ，/wd LR/x 为/p 0/m 或/c 1/m ，/wd 非空/n 二/m 叉树/n c/x 与/p T/x 不/d 相交/vi 且/c 右/f 子/ng 树/v 为/v 空/ng 。/wj 
    操作/v 结果/n ：/wp 根据/p LR/x 为/v O/x 或/c 1/m ，/wd 插入/v c/x 为/v T/x 中/f p/x 所/usuo 指/v 结点/n 的/ude1 左/a 或/c 右/f 子/ng 树/n 。/wj p/x 所/usuo 指/v 结点/n 的/ude1 原有/vn 左/f 或/c 右/f 子/ng 树/n 则/d 成为/v c/x 的/ude1 右/f 子/ng 树/n 。/wj 
    DeleteChild/x (/wkz T/x ，/wd p/x ，/wd LR/x )/wky ；/wf 
    初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd p/x 指向/v T/x 中/f 某个/rz 结点/n ，/wd LR/x 为/v O/x 或/c 1/m 。/wj 
  操作/v 结果/n ：/wp 根据/p LR/x 为/v O/x 或/c 1/m ，/wd 删除/v T/x 中/f p/x 所/usuo 指/v 结点/n 的/ude1 左/a 或/c 右/f 子/ng 树/n 。/wj 
PreOx/x ~/n erTraverse/x (/wkz T/x ，/wd Vislt/x (/wkz )/wky )/wky ；/wf 
  初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 先/d 序/n 遍历/n TI/x 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
InOrderTraverse/x (/wkz T/x ，/wd VisJ．t/x (/wkz )/wky )/wky ；/wf 
  初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 中/b 序/n 遍历/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
PostOrderTraverse/x (/wkz T/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf 
  初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 后/f 序/n 遍历/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
LevelOrderTraverse/x (/wkz T/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf 
  初始条件/n ：/wp 二/m 叉树/n T/x 存在/v ，/wd Vis／．t/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 层序/n 遍历/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操/v     作/v 失败/vi 。/wj 
    I/x ^/n DT/x  BjnaryTree/x 
　　上述/b 数据/n 结构/n 的/ude1 递归/n 定义/n 表明/v 二/m 叉树/n 或/c 为/v 空/ng ，/wd 或/c 是/vshi 由/p 一个/mq 根/n 结点/n 加上/v 两/m 棵/q 分别/d 称为/v 左子树/nr 和/cc 右/f 子/ng 树/n 的/ude1 、/wn 互不/d 相交/vi 的/ude1 二/m 叉树/n 组成/v 。/wj 由于/p 这/rzv 两/m 棵子/n 树/n 亦/d 是/vshi 二/m 叉树/n ，/wd 则/c 由/p 二/m 叉树/n 的/ude1 定义/n ，/wd 它们/rr 也/d 可以/v 是/vshi 空/a 树/n 。/wj 由此/d ，/wd 二/m 叉树/n 可以/v 有/vyou 五/m 种/q 基本/a 形态/n ，/wd 如/v 图/n 6．3/m 所/usuo 示/vg 。/wj 
图/n 6．3/m 二/m 叉树/n 的/ude1 五/m 种/q 基本/a 形态/n 
(/wkz a/x )/wky 空/v 二/m 叉树/n ；/wf (/wkz b/x )/wky 仅/d 有/vyou 根/n 结点/n 的/ude1 二/m 叉树/n ；/wf (/wkz c/x )/wky 右/f 子/ng 树/v 为/p 空/a 的/ude1 二/m 叉树/n ；/wf 
    (/wkz d/x )/wky 左/f 、/wn 右/f 子/ng 树均非/nr 空/a 的/ude1 二/m 叉树/n ；/wf 【/wkz e/x )/wky 左子树/nr 为/v 空/a 的/ude1 二/m 叉树/n 。/wj 
6．1/m 节/q 中/f 引入/v 的/ude1 有关/vn 树/n 的/ude1 术语/n 也/d 都/d 适用/vi 于/p 二/m 叉树/n 。/wj 
6．2．2/m 二/m 叉树/n 的/ude1 性质/n 
  二/m 叉树/n 具有/v 下列/b 重要/a 特性/n 。/wj 
  性质/n 1/m 在/p 二/m 叉树/n 的/ude1 第/m i/x 层/n 上/f 至/p 多/m 有/vyou 2/m 个/q 结点/n (/wkz i≥1/x )/wky 。/wj 
  利用/v 归纳法/n 容易/a 证/n 得/v 此/rzs 性质/n 。/wj 
  i=1/x 时/ng ，/wd 只/d 有/vyou 一个/mq 根/n 结点/n 。/wj 显然/a ，/wd 2=20：1/m 是/vshi 对/p 的/ude1 。/wj 
  现在/t 假定/v 对/p 所有/b 的/ude1 ．/w 『/wyz ，/wd 1≤J/x </n i/x ，/wd 命题/n 成立/vi ，/wd 即/v 第/m n/x 层/n 上/f 至/p 多/m 有/vyou 2J/x 叫/vi 个/q 结点/n 。/wj 那么/c ，/wd 可以/v 证明/v j=i/x 时/ng 命题/n 也/d 成立/vi 。/wj 
    由/p 归纳/v 假设/n ：/wp 第/m i/x －/wp 1/m 层/qv 上/f 至/p 多/m 有/vyou 2/m 卜/vg 。/wj 个/q 结点/n 。/wj 由于/p 二/m 叉树/n 的/ude1 每个/r 结点/n 的/ude1 度/qv 至/p 多/ad 为/v 2/m ，/wd 故/c 在/p 第/m i/x 层/n 上/f 的/ude1 最/d 大/a 结/v 点数/n 为/p 第/m i/x －/wp 1/m 层/qv 上/f 的/ude1 最/d 大/a 结/v 点数/n 的/ude1 2/m 倍/q ，/wd 即/v 2×2/m ’/wyy 12=2/m 。/wj 。/wj 
    性质/n 2/m 深度/n 为/p 志/n 的/ude1 二/m 叉树/n 至多/d 有/vyou 2/m ‘/wyz －/wp 1/m 个/q 结点/n ，/wd (/wkz 五/m ≥1/m )/wky 。/wj 
    由/p 性质/n 1/m 可见/c ，/wd 深度/n 为/v n/x 的/ude1 二/m 叉树/n 的/ude1 最/d 大/a 结/v 点数/n 为/v 
    ∑/m (/wkz 第/m i/x 层/n 上/f 的/ude1 最/d 大/a 结/v 点数/n )/wky =∑2H=2/x ‘/wyz 一/m 1/m 
    性质/n 3/m   对/p 任何/rz 一/m 棵/q 二/m 叉树/n T/x ，/wd 如果/c 其/rz 终端/n 结/v 点数/n 为/v n0/x ，/wd 度/qv 为/v 2/m 的/ude1 结/v 点数/n 为/v ”/wyy 2/m ，/wd 则/d o=2+10/x     设/v ，/wd z/x ，/wd 为/p 二/m 叉树/n 丁/Mg 中度/d 为/v 1/m 的/ude1 结/v 点数/n 。/wj 因为/p 二/m 叉树/n 中/b 所有/b 结点/n 的/ude1 度/qv 均/d 小于/v 或/c 等于/v 2/m ，/wd 所以/c 其/rz 结点/n 总数/n 为/v =o+/x ，/wd z1+/x ，/wd z2/x     (/wkz 6―1/m )/wky 
    再/d 看/v 二/m 叉树/n 中/f 的/ude1 分支/n 数/n 。/wj 除了/p 根/n 结点/n 外/f ，/wd 其余/rz 结点/n 都/d 有/vyou 一个/mq 分支/n 进入/v ，/wd 设/v B/x 为/p 分支/n 总数/n ，/wd 则/c ，/wd z=B+1/x 。/wj 由于/p 这些/rz 分支/n 是/vshi 由/p 度/qv 为/v 1/m 或/c 2/m 的/ude1 结/v 点射/v 出/vf 的/ude1 ，/wd 所以/c 又/d 有/vyou B=n1+2n2/x 。/wj 于是/cc 得/v 1+221/m     (/wkz 6．2/m )/wky 
由/p 式/k (/wkz 6―1/m )/wky 和/cc (/wkz 6―2/m )/wky 得/v 
    ，/wd z0/x 。/wj 2+1/m 
    完全/a 二/m 叉树/n 和/cc 满/a 二/m 叉树/n ，/wd 是/vshi 两/m 种/q 特殊/a 形态/n 的/ude1 二/m 叉树/n 。/wj 
    一/m 棵/q 深度/n 为/v 且/c 有/vyou 2/m ‘/wyz 1/m 个/q 结点/n 的/ude1 二/m 叉树/n 称为/v 满/a 二/m 叉树/n 。/wj 如/v 图/n 6．4/m (/wkz a/x )/wky 所/usuo 示/vg 是/vshi 一/m 棵/q 深度/n 为/p 4/m 的/ude1 满/a 二/m 叉树/n ，/wd 这/rzv 种/q 树/n 的/ude1 特点/n 是/vshi 每/rz 一/m 层/qv 上/f 的/ude1 结/v 点数/n 都/d 是/vshi 最/d 大/a 结/v 点数/n 。/wj 
    可以/v 对/p 满/a 二/m 叉树/n 的/ude1 结点/n 进行/vx 连续/a 编号/n ，/wd 约定/v 编号/n 从/p 根/n 结点/n 起/f ，/wd 自上而下/al ，/wd 自/p 左/f 至/p 右/f 。/wj 由此/d 可/v 引出/v 完全/a 二/m 叉树/n 的/ude1 定义/n 。/wj 深度/n 为/v 是的/vl ，/wd 有/vyou 咒/v 个/q 结点/n 的/ude1 二/m 叉树/n ，/wd 当/v 且/c 仅/d 当/v 其/rz 每/rz 一个/mq 结点/n 都/d 与/p 深度/n 为/v m/x 的/ude1 满/a 二/m 叉树/n 中/f 编号/vi 从/p 1/m 至/v ，/wd z/x 的/ude1 结点/n --/wp 对/p 应/v 时/ng ，/wd 称之为/v 完全/a 二/m 叉树/n 。/wj ①/m 如/v 图/n 6．4/m (/wkz b/x )/wky 所/usuo 示/vg 为/p 一/m 棵/q 深度/n 为/p 4/m 的/ude1 完全/a 二/m 叉树/n 。/wj 显然/a ，/wd 这/rzv 种/q 树/n 的/ude1 特点/n 是/vshi ：/wp (/wkz 1/m )/wky 叶子/n 结点/n 只/d 可能/v 在/p 层次/n 最/d 大/a 的/ude1 两/m 层/qv 上/f 出现/v ；/wf (/wkz 2/m )/wky 对/p 任/v 一/m 结点/n ，/wd 若/c 其/rz 右/f 分支/n 下/f 的/ude1 子孙/n 的/ude1 最/d 大/a 层次/n 为/v z/x ，/wd 则/c 其/rz 左/a 分支/n 下/f 的/ude1 子孙/n 的/ude1 最/d 大/a 层次/n 必/d 为/v z/x 或/c z+1/x 。/wj 如/v 图/n 6．4/m 中/f (/wkz c/x )/wky 和/cc (/wkz d/x )/wky 不/d 是/vshi 完全/a 二/m 叉树/n 。/wj 
    完全/a 二/m 叉树/n 将/d 在/p 很多/m 场合/n 下/f 出现/v ，/wd 下面/f 介绍/v 完全/a 二/m 叉树/n 的/ude1 两/m 个/q 重要/a 特性/n 。/wj 
    性质/n 4/m 具有/v n/x 个/q 结点/n 的/ude1 完全/a 二/m 叉树/n 的/ude1 深度/n 为/v L/x  log2/x 扎/v j+1/x ⑦/m 。/wj 
    证明/v ：/wp 假设/v 深度/n 为/v 愚/an ，/wd 则/c 根据/p 性质/n 2/m 和/cc 完全/a 二/m 叉树/n 的/ude1 定义/n 有/vyou ≤n/x </n 2/m ‘/wyz 
于是/cc 是/vshi ～/ws 1≤log2/x  n/x </n   。/wj ．/w 。/wj 是/vshi 整数/n   ．/w ’/wyy ．/w =L/x  log2/x ”/wyy j+1/x 
　　性质/n 5/m 如果/c 对/p 一/m 棵/q 有/vyou m/x 个/q 结点/n 的/ude1 完全/a 二/m 叉树/n (/wkz 其/rz 深度/n 为/v L：log2J+1/x )/wky 的/ude1 结点/n 按/p 层序/n 编号/n (/wkz 从/p 第1/m 层/qv 到/v 第/m L/x |/n og2j+1/x 层/n ，/wd 每/rz 层/qv 从/p 左/f 到/v 右/f )/wky ，/wd 则/c 对/p 任/v 一/m 结点/n i/x (/wkz 1≤i≤/x ，/wd z/x )/wky ，/wd 有/vyou 
　　   (/wkz 1/m )/wky 如果/c 1/m ，/wd 则/c 结点/n i/x 是/vshi 二/m 叉树/n 的/ude1 根/n ，/wd 无/v 双亲/n ；/wf 如果/c i/x >/n 1/m ，/wd 则/c 其/rz 双亲/n PARENT/x (/wkz i/x )/wky 是/vshi ①/m   在/p 各种/rz 版本/n 的/ude1 数据/n 结构/n 书/n 中/f ，/wd 对/p 完全/a 二/m 叉树/n 的/ude1 定义/n 均/d 不/d 相同/a 。/wj 本/rz 书/n 中/f 将/d 一律/d 以/p 此/rzs 定义/n 为/p 准/a 。/wj ②/m 符号/n 【/wkz ．/w r/x  J/x 表示/v 不/d 大/a 于/p z/x 的/ude1 最/d 大/a 整数/n ，/wd 反之/c ，/wd r/x  z/x ]/wky 表示/v 不/d 小于/v z/x 的/ude1 最/d 小/a 整数/n 。/wj 
    图/n 6．4/m 特殊/a 形态/n 的/ude1 二/m 叉树/n 
    (/wkz a/x )/wky 满/v 二/m 叉树/n ；/wf (/wkz b/x )/wky 完全/ad 二/m 叉树/n ；/wf (/wkz c/x )/wky 和/cc (/wkz d/x )/wky 非/b 完全/a 二/m 叉树/n 。/wj 
  结点/n L/x  i／2/x  j/x 。/wj 
，/wd     (/wkz 2/m )/wky 如果/c 2i/x >/n ，/wd z/x ，/wd 则/c 结点/n i/x 无/v 左/a 孩子/n (/wkz 结点/n f/x 为/p 叶子/n 结点/n )/wky ；/wf 否则/c 其/rz 左/a 孩子/n LCHILD/x (/wkz i/x )/wky LCHIt/x ，/wd D/x (/wkz i/x )/wky     LCHILD/x (/wkz i+1/x )/wky 
    RCHII/x ，/wd D/x (/wkz i/x )/wky   RCHILD/x (/wkz i+1/x )/wky 
    (/wkz a/x )/wky 
图/n 6．5/m 完全/a 二/m 叉树/n 中/f 结点/n i/x 和/cc i+1/x 的/ude1 左/a 、/wn 右/f 孩子/n 
    (/wkz a/x )/wky 结点/n i/x 和/cc i+1/x 在/p 同/p 一/m 层/qv 上/f ；/wf 
    (/wkz b/x )/wky 结点/n i/x 和/cc i+1/x 不/d 在/p 同/p 一/m 层/qv 上/vf 。/wj 
是/vshi 结点/n 2i/x 。/wj 
    (/wkz 3/m )/wky 如果/c 2i+1/x >/n n/x ，/wd 则/c 结点/n i/x 无/v 右/f 孩子/n ；/wf 
否则/c 其/rz 右/f 孩子/n R/x (/wkz 7HI．LD/x (/wkz i/x )/wky 是/vshi 结点/n 2i+1/x 。/wj 
    我们/rr 只/d 要/v 先/d 证明/v (/wkz 2/m )/wky 和/cc (/wkz 3/m )/wky ，/wd 便/d 可以/v 从/p (/wkz 2/m )/wky 
和/cc (/wkz 3/m )/wky 导出/v (/wkz 1/m )/wky 。/wj 
    对于/p 产/v 1/m ，/wd 由/p 完全/a 二/m 叉树/n 的/ude1 定义/n ，/wd 其/rz 左/a 孩子/n 是/vshi 结点/n 2/m 。/wj 若/c 2/m >/n "/n ，/wd 即/d 不/d 存在/v 结点/n 2/m ，/wd 此时/r 结点/n i/x 无/v 左/a 孩子/n 。/wj 结点/n i/x 的/ude1 右/f 孩子/n 也/d 只能/v 是/vshi 结点/n 3/m ，/wd 若/c 结点/n 3/m 不/d 存在/v ，/wd 即/v 3/m >/n ，/wd 此时/r 结点/n i/x 无/v 右/f 孩子/n 。/wj 
    对于/p i/x >/n 1/m 可/v 分/qt 两/m 种/q 情况/n 讨论/v ：/wp (/wkz 1/m )/wky 设/v 第/m j/x (/wkz 1≤j≤L/x  log2n/x  J/x )/wky 层/n 的/ude1 第一/m 个/q 结点/n 的/ude1 编号/n 为/v i/x (/wkz 由/p 二/m 叉树/n 的/ude1 定义/n 和/cc 性质/n 2/m 可知/v i=2j/x  11/m )/wky ，/wd 则/c 其/rz 左/a 孩子/n 必/d 为/v 第/m J+1/x 层/n 的/ude1 第一/m 个/q 结点/n ，/wd 其/rz 编号/n 为/v 2j：2/x (/wkz 2/m ，/wd )/wky =2i/x ，/wd 若/c 2i/x >/n ”/wyy ，/wd 则/c 无/v 左/a 孩子/n ；/wf 其/rz 右/f 孩子/n 必/d 为/v 第/m 歹/ag +1/m 层/qv 的/ude1 第二/m 个/q 结点/n ，/wd 其/rz 编号/n 为/v 2i+1/x ，/wd 若/c 2￡+1/m >/n ，/wd z/x ，/wd 则/c 无/v 右/f 孩子/n ；/wf (/wkz 2/m )/wky 假设/v 第/m J/x (/wkz 1≤/m 歹/ag ≤L/x  log2n/x  j/x )/wky 层/n 上/f 某个/rz 结点/n 的/ude1 编号/n 为/v i/x (/wkz 2/m 卜/vg 。/wj ≤i/x </n 2J/x 一/m 1/m )/wky ，/wd 且/c 2i+1/x </n n/x ，/wd 则/c 其/rz 左/a 孩子/n 为/v 2i/x ，/wd 右/f 孩子/n 为/v 2i+1/x ，/wd 则/c 编号/n 为/v i+l/x 的/ude1 结点/n 是/vshi 编号/n 为/v i/x 的/ude1 结点/n 的/ude1 右/f 兄弟/n 或者/c 堂兄弟/n ，/wd 若/c 它/rr 有/vyou 左/a 孩子/n ，/wd 则/c 编号/n 必/d 为/v 2i+2=2/x (/wkz i+1/x )/wky ，/wd 若/c 它/rr 有/vyou 右/f 孩子/n ，/wd 则/c 其/rz 编号/n 必/d 为/v 2i+3：2/x (/wkz i+1/x )/wky 十/m 1/m 。/wj 图/n 6．5/m 所/usuo 示/vg 为/p 完全/a 二/m 叉/n 树上/s 结点/n 及其/cc 左/a 、/wn 右/f 孩子/n 结点/n 之间/f 的/ude1 关系/n 。/wj 
  6．2．3/m 二/m 叉树/n 的/ude1 存储/vn 结构/n 
  一/m 、/wn 顺序/n 存储/vn 结构/n ，/wd 
  ∥/w …/ws 二/m 叉树/n 的/ude1 顺序/n 存储表示/n …/ws 
  #/n define/x  MAX/x 。/wj TREE/x ～/ws SIZE/x  100/m     ∥/w 二/m 叉树/n 的/ude1 最/d 大/a 结/v 点数/n 
  typedef/x  TElemType/x  SqBiTree/x [/wkz MAX/x ’/wyy FREESIZE/x ]/wky ；/wf   ∥/w 0/m 号/q 单元存储/n 根/n 结点/n 
  SqBiTree/x  bt：/x 
  按照/p 顺序/n 存储/vn 结构/n 的/ude1 定义/n ，/wd 在/p 此/rzs 约定/v ，/wd 用/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 依次/d 自上而下/al 、/wn 自/p 左/f 至/p 右/f 存储/v 完全/a 二/m 叉/n 树上/s 的/ude1 结点/n 元素/n ，/wd 即/d 将/d 完全/a 二/m 叉/n 树上/s 编号/n 为/v i/x 的/ude1 结点/n 元素/n 存储/vn 在/p 如上/b 定义/n 的/ude1 一/m 维/q 数组/n 中下/f 标/v 为/v i-1/x 的/ude1 分量/n 中/f 。/wj 例如/v ，/wd 图/n 6．6/m (/wkz a/x )/wky 所/usuo 示/vg 为/p 图/n 6．4/m (/wkz b/x )/wky 所/usuo 示/vg 完全/a 二/m 叉树/n 的/ude1 顺序/n 存储/vn 结构/n 。/wj 对于/p 一般/a 二/m 叉树/n ，/wd 则/c 应/v 将/p 其/rz 每个/r 结点/n 与/p 完全/a 二/m 叉/n 树上/s 的/ude1 结点/n 相/d 对照/v ，/wd 存储/v 在/p 一/m 维/q 数组/n 的/ude1 相应/vn 分量/n 中/f ，/wd 如/v 图/n 6．4/m (/wkz c/x )/wky 所/usuo 示/vg 二/m 叉树/n 的/ude1 顺序/n 存储/vn 结构/n 如/v 图/n 6．6/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 图/n 中/f 以/p “/wyz O/x ”/wyy 表示/v 不/d 存在/v 此/rzs 结点/n 。/wj 由此可见/c ，/wd 这种/r 顺序/n 存储/vn 结构/n 仅/d 适用/vi 于/p 完全/a 二/m 叉树/n 。/wj 因为/c ，/wd 在/p 最/d 坏/a 的/ude1 情况/n 下/f ，/wd 一个/mq 深度/n 为/p 量/n 且/c 只/d 有/vyou n/x 个/q 结点/n 的/ude1 单支树/nr (/wkz 树/n 中/f 不/d 存在/v 度/qv 为/v 2/m 的/ude1 结点/n )/wky 却/d 需要/v 长度/n 为/p 2/m ‘/wyz －/wp 1/m 的/ude1 一/m 维/q 数组/n 。/wj 
图/n 6．6/m 二/m 叉树/n 的/ude1 顺序/n 存储/vn 结构/n 
    (/wkz a/x )/wky 完全/ad 二/m 叉树/n ；/wf (/wkz b/x )/wky 一般/a 二/m 叉树/n 。/wj 
  二/m 、/wn 链式/n 存储/v 结构/n 
  设计/v 不同/a 的/ude1 结点/n 结构/n 可/v 构成/v 不同/a 形式/n 的/ude1 链式/n 存储/v 结构/n 。/wj 由/p 二/m 叉树/n 的/ude1 定义/n 得知/v ，/wd 二/m 叉树/n 的/ude1 结点/n (/wkz 如/v 图/n 6．7/m (/wkz )/wky 所/usuo 示/vg )/wky 由/p 一个/mq 数据/n 元素/n 和/cc 分别/d 指向/v 其/rz 左/a 、/wn 右/f 子/ng 树/n 的/ude1 两/m 个/q 分支/n 构成/v ，/wd 则/c 表示/v 二/m 叉树/n 的/ude1 链/ng 表/n 中/f 的/ude1 结点/n 至少/d 包含/v 三/m 个/q 域/n ：/wp 数据/n 域/ng 和/cc 左/a 、/wn 右/f 指针/n 域/ng ，/wd 如/v 图/n 6．7/m (/wkz 6/m )/wky 所/usuo 示/vg 。/wj 有时/d ，/wd 为了/p 便于/v 找到/v 结点/n 的/ude1 双亲/n ，/wd 则/c 还/d 可/v 在/p 结点/n 结构/n 中/f 增加/v 一个/mq 指向/v 其/rz 双亲/n 结点/n 的/ude1 指针/n 域/ng ，/wd 如/v 图/n 6．7/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 利用/v 这/rzv 两/m 种/q 结点/n 结构/n 所得/n 二/m 叉树/n 的/ude1 存储/vn 结构/n 分别/d 称之为/v 二/m 叉/n 链/ng 表/n 和/cc 三叉/b 链/ng 表/n ，/wd 如/v 图/n 6．8/m 所/usuo 示/vg 。/wj 链/ng 表/n 的/ude1 头/n 指针/n 指向/v 二/m 叉树/n 的/ude1 根/n 结点/n 。/wj 容图/nrf 6．7/m 二/m 叉树/n 的/ude1 结点/n 及其/cc 存储/vn 结构/n     (/wkz a/x )/wky 二/m 叉树/n 的/ude1 结点/n ；/wf   (/wkz b/x )/wky 含有/v 两/m 个/q 指针/n 域/ng 的/ude1 结点/n 结构/n ；/wf   (/wkz c/x )/wky 含有/v 三/m 个/q 指针/n 域/ng 的/ude1 结点/n 结构/n 。/wj 易/vg 证/n 得/v ，/wd 在/p 含有/v ，/wd z/x 个/q 结点/n 的/ude1 二/m 叉/n 链/ng 表/n 中/f 有/vyou ，/wd z+1/x 个/q 空/a 链/ng 域/ng 。/wj 在/p 6．3/m 节/q 中/f 我们/rr 将/d 会/v 看到/v 可以/v 利用/v 这些/rz 空/ng 链/ng 域/ng 存储/v 其它/rz 有用/a 信息/n ，/wd 从而/c 得到/v 另/rz 一/m 种/q 链式/n 存储/v 结构/n ――/wp 线索/n 链/ng 表/n 。/wj 以下/f 是/vshi 二/m 叉/n 链/ng 表/n 的/ude1 定义/n 和/cc 部分/n 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v 。/wj 
∥/w …/ws 二/m 叉树/n 的/ude1 二/m 叉/n 链/ng 表存储/n 表示/v 
tIR/x ~/n f/x  stz/x ~/n ct/x  BiTNode/x {/n 
    TElType/x  data/x ；/wf 
    struct/x  BiTNode/x   */n Ichild/x ，/wd */n rchild/x ；/wf ∥/w 左右/m 孩子/n 指针/n 
}/n BiTNode/x ，/wd */n B/x '/n iTree/x ；/wf 
∥/w 基本/ad 操作/v 的/ude1 函数/n 原型/n 说明/v (/wkz 部分/n )/wky …/ws 
Status/x  CreateBiTree/x (/wkz BiTree/x ＆/n T/x )/wky ；/wf 
  ∥/w 按/p 先/d 序/vg 次序/n 输入/v 二/m 叉树/n 中/f 结点/n 的/ude1 值/n (/wkz 一个/mq 字符/n )/wky ，/wd 空格字符/n 表示/v 空/a 树/n ，/wd 
  ∥/w 构造/n 二/m 叉/n 链/ng 表表示/n 的/ude1 二/m 叉树/n T/x 。/wj 
Status/x  PreOrderTraverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz TElemType/x  e/x )/wky )/wky ；/wf 
  ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  ∥/w 先/d 序/n 遍历/n 二/m 叉树/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 
  ∥/w 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
Status/x  InOrderTraverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz lType/x  e/x )/wky )/wky ；/wf 
  ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  ∥/w 中/b 序/n 遍历/n 二/m 叉树/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 
  ∥/w 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
Status/x  PostOrderTraverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz TZlemType/x  e/x )/wky )/wky ；/wf 
  ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  ∥/w 后/f 序/n 遍历/n 二/m 叉树/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 
  ∥/w 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
Status/x  LevelOrderTraverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz TElT/x '/n 5/m 『/wyz pe/x  e/x )/wky )/wky ；/wf 
  ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
  ∥/w 层序/n 遍历/n 二/m 叉树/n T/x ，/wd 对/p 每个/r 结点/n 调用函数/n Visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 
  ∥/w 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
    图/n 6．8/m 链/ng 表存储/n 结构/n 
(/wkz a/x )/wky 单支树/nr 的/ude1 二/m 叉/n 链/ng 表/n ；/wf (/wkz b/x )/wky 二/m 叉/n 链/ng 表/n ；/wf (/wkz c/x )/wky 三叉/b 链/ng 表/n 。/wj 
  在/p 不同/a 的/ude1 存储/vn 结构/n 中/f ，/wd 实现/v 二/m 叉树/n 的/ude1 操作/vn 方法/n 亦/d 不/d 同/v ，/wd 如/c 找/v 结点/n x/x 的/ude1 双亲/n PARENT/x (/wkz T/x ，/wd e/x )/wky ，/wd 在/p 三叉/b 链/ng 表/n 中/f 很/d 容易/ad 实现/v ，/wd 而/cc 在/p 二/m 叉/n 链/ng 表/n 中/f 则/d 需/v 从/p 根/n 指针/n 出发/vi 巡查/v 。/wj 由此/d ，/wd 在/p 具体/a 应用/vn 中/f 采用/v 什么/ry 存储/vn 结构/n ，/wd 除/p 根据/p 二/m 叉树/n 的/ude1 形态/n 之外/f 还/d 应/v 考虑/v 需/v 进行/vx 何种/r 操作/vn 。/wj 读者/n 可/v 试/v 以/p 6．2/m 节/q 中/b 定义/n 的/ude1 各种/rz 操作/v 对/p 以上/f 三/m 种/q 存储/vn 结构/n 进行/vx 比较/vn 。/wj 
6．3/m 遍历/n 二/m 叉树/n 和/cc 线索/n 二/m 叉树/n 
6．3．1/m 遍历/n 二/m 叉树/n 
　　在/p 二/m 叉树/n 的/ude1 一些/mq 应用/vn 中/f ，/wd 常常/d 要求/v 在/p 树/n 中/f 查找/v 具有/v 某种/rz 特征/n 的/ude1 结点/n ，/wd 或者/c 对/p 树/n 中/f 全部/m 结点/n 逐一/d 进行/vx 某种/rz 处理/vn 。/wj 这/rzv 就/d 提出/v 了/ule 一个/mq 遍历/n 二/m 叉树/n (/wkz Traversing/x  Binary/x  Tree/x )/wky 的/ude1 问题/n ，/wd 即/v 如何/ryv 按/p 某/rz 条/q 搜索/vn 路径/n 巡/vg 访/v 树/n 中/f 每个/r 结点/n ，/wd 使得/vi 每个/r 结点/n 均/d 被/pbei 访问/v 一/m 次/qv ，/wd 而且/c 仅/d 被/pbei 访问/v 一/m 次/qv 。/wj “/wyz 访问/v ”/wyy 的/ude1 含义/n 很/d 广/a ，/wd 可以/v 是/vshi 对/p 结点/n 作/v 各种/rz 处理/vn ，/wd 如/c 输出/v 结点/n 的/ude1 信息/n 等/udeng 。/wj 遍历/n 对/p 线性/n 结构/n 来说/uls ，/wd 是/vshi 一个/mq 容易/ad 解决/v 的/ude1 问题/n 。/wj 而/cc 对/p 二/m 叉树/n 则/c 不然/c ，/wd 由于/c 二/m 叉树/n 是/vshi 一/m 种/q 非线性/b 结构/n ，/wd 每个/r 结点/n 都/d 可能/v 有/vyou 两/m 棵子/n 树/n ，/wd 因而/c 需要/v 寻找/v 一/m 种/q 规律/n ，/wd 以便/d 使/v 二/m 叉/n 树上/s 的/ude1 结点/n 能/v 排列/v 在/p 一个/mq 线性/n 队列/n 上/f ，/wd 从而/c 便于/v 遍历/n 。/wj 
　　回顾/v 二/m 叉树/n 的/ude1 递归/n 定义/n 可知/v ，/wd 二/m 叉树/n 是/vshi 由/p 三/m 个/q 基本单元/n 组成/v ：/wp 根/n 结点/n 、/wn 左子树/nr 和/cc 右/f 子/ng 树/n 。/wj 因此/c ，/wd 若/c 能/v 依次/d 遍历/n 这/rzv 三/m 部分/n ，/wd 便是/v 遍历/n 了/ule 整个/b 二/m 叉树/n 。/wj 假如/c 以/p L/x 、/wn D/x 、/wn R/x 分别/d 表示/v 遍历/n 左/a 子/ng 树/n 、/wn 访问/vn 根/n 结点/n 和/cc 遍历/n 右/f 子/ng 树/n ，/wd 则/c 可/v 有/vyou DLR/x 、/wn I．DR/x 、/wn LRD/x 、/wn DRL/x 、/wn RDL/x 、/wn RLD/x 六/m 种/q 遍历/n 二/m 叉树/n 的/ude1 方案/n 。/wj 若/c 限定/v 先/d 左/a 后/f 右/f ，/wd 则/c 只/d 有/vyou 前/f 三/m 种/q 情况/n ，/wd 分别/d 称之为/v 先/d (/wkz 根/n )/wky 序/n 遍历/n ，/wd 中/f (/wkz 根/n )/wky 序/n 遍历/n 和/cc 后/f (/wkz 根/n )/wky 序/n 遍历/n 。/wj 基于/p 二/m 叉树/n 的/ude1 递归/n 定义/n ，/wd 可/v 得/ude3 下/vf 述/vg 遍历/n 二/m 叉树/n 的/ude1 递归/n 算法/n 定义/n 。/wj 
　　先/d 序/n 遍历/n 二/m 叉树/n 的/ude1 操作/vn 定义/n 为/v ：/wp 
    若/c 二/m 叉树/n 为/v 空/ng ，/wd 则/c 空操作/n ；/wf 否则/c 
    (/wkz 1/m )/wky 访问/v 根/n 结点/n ；/wf 
    (/wkz 2/m )/wky 先/d 序/n 遍历/n 左/a 子/ng 树/n ；/wf 
    (/wkz 3/m )/wky 先/d 序/n 遍历/n 右/f 子/ng 树/n 。/wj 
    中/b 序/n 遍历/n 二/m 叉树/n 的/ude1 操作/vn 定义/n 为/v ：/wp 
    若/c 二/m 叉树/n 为/v 空/ng ，/wd 则/c 空操作/n ；/wf 否则/c 
    (/wkz 1/m )/wky 中/f 序/n 遍历/n 左/a 子/ng 树/n ；/wf 
    (/wkz 2/m )/wky 访问/v 根/n 结点/n ；/wf 
    (/wkz 3/m )/wky 中/f 序/n 遍历/n 右/f 子/ng 树/n 。/wj 
    后/f 序/n 遍历/n 二/m 叉树/n 的/ude1 操作/vn 定义/n 为/v ：/wp 
    若/c 二/m 叉树/n 为/v 空/ng ，/wd 则/c 空操作/n ；/wf 否则/c 
    (/wkz 1/m )/wky 后/f 序/n 遍历/n 左/a 子/ng 树/n ；/wf 
    (/wkz 2/m )/wky 后/f 序/n 遍历/n 右/f 子/ng 树/n ；/wf   。/wj 
    (/wkz 3/m )/wky 访问/v 根/n 结点/n 。/wj 
　　算法/n 6．1/m 给/v 出/vf 了/ule 先/d 序/n 遍历/n 二/m 叉树/n 基本/ad 操作/v 的/ude1 递归/n 算法/n 在/p 二/m 叉/n 链/ng 表/n 上/f 的/ude1 实现/vn 。/wj 读者/n 可/v 类似/a 地/ude2 实现/v 中/b 序/n 遍历/n 和/cc 后/f 序/n 遍历/n 的/ude1 递归/n 算法/n ，/wd 此处/s 不再/d --/wp 列举/v 。/wj 
　　Status/x  PreOrder/x ~/n ’/wyy raverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n   Visit/x )/wky (/wkz TElemType/x  e/x )/wky )/wky {/n 
∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 数据/n 元/q 索/vg 操作/v 的/ude1 应用/vn 函数/n ，/wd 
∥/w 先/d 序/n 遍历/n 二/m 叉树/n T/x 的/ude1 递归/n 算/v {/n 对/p 每个/r 数据/n 元/q 索/vg 调用函数/n Visit/x 。/wj 
∥/w 最/d 简单/a 的/ude1 Visit/x 函数/n 是/vshi ：/wp 
／／/m   Status/x  prIntEl/x ~/n t/x (/wkz TEleType/x  e/x )/wky f/x ∥/w 输出/v 元/q 索/vg e/x 的/ude1 值/n 
∥/w prIntf/x (/wkz e/x )/wky ，/wd     ／／/m 实用/a 时/ng ．/w an/x ~/n 格式串/n 
∥/w return/x  OK/x ；/wf 
∥/w     }/n 
∥/w 调用/v 实例/n ：/wp Pr/x 如/v de/x 以/p se/x (/wkz T．PrIntEl/x ~/n ent/x )/wky ；/wf 
if/x (/wkz {/n 
  if/x (/wkz Vislt/x (/wkz T-/x >/n data/x ”/wyy 
    if/x (/wkz p/x ~/n -/wp eOrderTraverse/x (/wkz T-/x >/n ichild/x ，/wd Visit/x )/wky )/wky 
    if/x (/wkz PreorderTraverse/x (/wkz T-/x >/n rchild/x ，/wd Visit/x )/wky )/wky retu/x 蚰/n OK/x ；/wf 
    retERROR：/x 
Iel86/x  retOK/x 
算法/n 6/m  I/x 
  例如/v 图/n 6/m  9/m 所/usuo 示/vg 的/ude1 二/m 叉树/n 0/m 表示/v 下/f 述/vg 表达式/n 
    a+b/x */n (/wkz cd/x )/wky e／f/x 
若先/nr2 序/n 遍历/n 此/rzs 二/m 叉树/n ，/wd 按/p 访问/v 结点/n 的/ude1 先后/d 次序/n 将/d 结点/n 排列/v 起来/vf ，/wd 
为/p  a/x */n b―cd／ef/x     (/wkz 6．3/m )/wky 
类似/a 地/n 。/wj 中/b 序/n 遍历/n 此/rzs 二/m 叉树/n ，/wd 可/c 得/v 此/rzs 二/m 叉树/n 的/ude1 中/b 序/n 序列/n 为/v     a+b/x */n c―d―df/x     (/wkz 6．4/m )/wky 
后/f 序/n 遍历/n 此/rzs 二/m 叉树/n ，/wd 可/c 得/v 此/rzs 二/m 叉树/n 的/ude1 后/f 序/n 序列/n 为/v     abed/x 一/m */n +d／/x 一/m     (/wkz 6．5/m )/wky 
从/p 表达式/n 来看/u ，/wd 以上/f 三/m 个/q 序列/n (/wkz 6-3/m )/wky 、/wn (/wkz 6-4/m )/wky 和/cc (/wkz 6．5/m )/wky 恰好/d 为/v 表达/v 式/k 的/ude1 前缀/n 表示/v (/wkz 波兰/nsf 式/k )/wky 、/wn 中缀/n 表示/v 和/cc 后缀/n 表示/v (/wkz 逆/vg 波兰/nsf 式/k )/wky 。/wj 
　　从/p 上述/b 二/m 叉树/n 遍历/n 的/ude1 定义/n 可知/v ．/w 三/m 种/q 遍历/n 算法/n 之/uzhi 不/d 同/p 处/n 仅/d 在于/v 访问/vn 根/n 结点/n 和/cc 遍历/n 左/a 、/wn 右/f 子/ng 柑/ng 的/ude1 先后/d 关系/v 。/wj 如果/c 在/p 算法/n 中/f 暂且/d 抹/v 去/vf 和/cc 递归/n 无关/v 的/ude1 visite/x 语句/n ，/wd 则/c 三/m 个/q 遍历/n 算法/n 完全/ad 相同/a 。/wj 由此/d ，/wd 从/p 递归/n 执行/v 过程/n 的/ude1 角度/n 来看/u 先/d 序/n 、/wn 中/b 序/n 和/cc 后/f 序/n 遍历/n 也/d 是/vshi 完/vi 可/v 得到/v 二/m 叉树/n 的/ude1 先/d 序/vg 序列/n 表/vg 选/v 式/k (/wkz a/x 十/m h/x */n (/wkz c―d/x )/wky 一/m √f/x )/wky 的/ude1 二/m 叉树/n 相同/a 的/ude1 。/wj 图/n 6/m  lO/x (/wkz b/x )/wky 中/f 用/v 带/v 箭头/n 的/ude1 虚线/n 表示/v 了/ule 这/rzv 三/m 种/q 遍历/n 算法/n 的/ude1 递归/n 执行/v 过程/n 。/wj 其中/rz ，/wd 向/p 下/f 的/ude1 箭头/n 表示/v 更/d 深/a 一/m 层/qv 的/ude1 递归/n 调用/v ，/wd 向上/vi 的/ude1 箭头/n 表示/v 从/p 递归/n 调用/v 退出/v 返回/v ；/wf 虚线/n 旁/f 的/ude1 三角形/n 、/wn 圆形/n 和/cc 方形/n 内/f 的/ude1 字符/n 分别/d 表示/v 在先/d 序/n 、/wn 中/b 序/n 和/cc 后/f 序/n 遍历/n 二/m 叉树/n 过程/n 中/f 访问/v 结点/n 时/ng 输出/v 的/ude1 信息/n 。/wj 例如/v ，/wd 由于/c 中/b 序/n 遍历/n 中/f 访问/v 结点/n 是/vshi 在/p 遍历/n 左/a 子/ng 树/n 之后/f 、/wn 遍历/n 右/f 子/ng 树/n 之前/f 进行/vx ，/wd 则/c 带/v 圆形/n 的/ude1 字符/n 标/v 在/p 向/p 左/f 递归/n 返回/v 和/cc 向/p 右/f 递归/n 调用/v 之间/f 。/wj 由此/d ，/wd 只要/c 沿/p 虚线/n 从/p 1/m 出发/vi 到/v 2/m 结束/v ，/wd 将/d 沿途/d 所/usuo 见/v 的/ude1 三角形/n (/wkz 或/c 圆形/n 、/wn 或/c 方形/n )/wky 内/f 的/ude1 字符/n 记/v 下/f ，/wd 便/d 得/ude3 遍历/n 二/m 叉树/n 的/ude1 先/d 序/n (/wkz 或/c 中/b 序/n 、/wn 或/c 后/f 序/n )/wky 序列/n 。/wj 例如/v ，/wd 从/p 图/n 6．10/m (/wkz b/x )/wky 分别/d 可/v 得/ude3 图/n 6/m ，/wd 10/m (/wkz a/x )/wky 所/usuo 示/vg 表达式/n 的/ude1 前缀/n 表示/v (/wkz 一/m */n abc/x )/wky 、/wn 中缀/n 表示/v (/wkz a/x */n b―c/x )/wky 和/cc 后缀/n 表示/v (/wkz ab/x */n c/x 一/m )/wky 。/wj 
    图/n 6．10/m 三/m 种/q 遍历/n 过程/n 示意图/n 
　　(/wkz a/x )/wky 表达式/n (/wkz a/x */n b―c/x )/wky 的/ude1 二/m 叉树/n ；/wf (/wkz b/x )/wky 遍历/n 的/ude1 递归/n 执行/v 过程/n 。/wj 
    仿照/v 递归/n 算法/n 执行/vn 过程/n 中/f 递归/n 工作栈/n 的/ude1 状态/n 变化/vn 状况/n 可/v 直接/ad 写/v 出/vf 相应/vi 的/ude1 非/b 递归/n 算法/n 。/wj 例如/v ，/wd 从中/d 序/n 遍历/n 递归/n 算法/n 执行/vn 过程/n 中/f 递归/n 工作栈/n 的/ude1 状态/n 可见/v ：/wp (/wkz 1/m )/wky 工作/vn 记录/n 中/f 包含/v 两/m 项/q ，/wd 其一/rz 是/vshi 递归/n 调用/v 的/ude1 语句/n 编号/vi ，/wd 其二/rz 是/vshi 指向/v 根/n 结点/n 的/ude1 指针/n ，/wd 则/c 当/v 栈/ng 顶/v 记录/n 中/f 的/ude1 指针/n 非空/n 时/ng ，/wd 应/v 遍历/n 左/a 子/ng 树/n ，/wd 即/d 指向/v 左/a 子/ng 树根/n 的/ude1 指针/n 进/vf 栈/ng ；/wf (/wkz 2/m )/wky 若/v 栈/ng 顶/v 记录/n 中/f 的/ude1 指针/n 值/v 为/v 空/ng ，/wd 则/c 应/v 退/v 至上/vi 一/m 层/qv ，/wd 若/c 是/vshi 从/p 左子树/nr 返回/v ，/wd 则/c 应/v 访问/v 当前/t 层/n 即/v 栈/ng 顶/v 记录/v 中/b 指针/n 所/usuo 指/v 的/ude1 根/n 结点/n ；/wf (/wkz 3/m )/wky 若/c 是/vshi 从/p 右/f 子/ng 树/v 返回/v ，/wd 则/c 表明/v 当前/t 层/n 的/ude1 遍历/n 结束/v ，/wd 应/v 继续/v 退/v 栈/ng 。/wj 从/p 另/rz 一/m 角度看/n ，/wd 这/rzv 意味着/v 遍历/n 右/f 子/ng 树/n 时/ng 不再/d 需要/v 保存/v 当前/t 层/n 的/ude1 根/n 指针/n ，/wd 可/v 直接/ad 修改/v 栈/ng 顶/v 记录/n 中/f 的/ude1 指针/n 即可/v 。/wj 由此/d 可/v 得/ude3 两/m 个/q 中/b 序/n 遍历/n 二/m 叉树/n 的/ude1 非/b 递归/n 算法/n 如/v 算法/n 6．2/m 和/cc 6．3/m 所/usuo 示/vg ，/wd 供/vi 读者/n 分析比较/n ，/wd 以/p 加深/v 理解/vn 。/wj 
Status/x  InOrderTraverse/x (/wkz BiTree/x  T/x ，/wd Status/x (/wkz */n Vis/x  it/x )/wky (/wkz TElemType/x  e/x )/wky )/wky {/n 
    ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 数据/n 元素/n 操作/vn 的/ude1 应用/vn 函数/n 。/wj 
    ∥/w 中/b 序/n 遍历/n 二/m 叉树/n T/x 的/ude1 非/b 递归/n 算法/n ，/wd 对/p 每个/r 数据/n 元素/n 调用函数/n visit/x 。/wj 
    Initstack/x (/wkz s/x )/wky ；/wf Push/x (/wkz s/x ，/wd T/x )/wky ；/wf     ∥/w 根/q 指针/n 进/vf 栈/ng 
    ．/w hile/x (/wkz !/wt StackEmpty/x (/wkz S/x )/wky )/wky {/n 
    whlle/x (/wkz ~/n tTop/x (/wkz s/x ，/wd p/x )/wky &/n ＆/n 。/wj p/x )/wky th／sh/x (/wkz S/x ，/wd p-/x >/n ichild/x )/wky ；/wf ∥/w 向/p 左/f 走/v 到/v 尽头/f 
    Pop/x (/wkz s/x ，/wd p/x )/wky ；/wf     ∥/w 空/a 指针/n 退/v 栈/ng 
    if/x (/wkz !/wt St/x ~/n ckEmpty/x (/wkz s/x )/wky )/wky {/n     ∥/w 访问/v 结点/n ，/wd 向/p 右/f 一/m 步/qv 
    Pop/x (/wkz s/x ，/wd p/x )/wky ；/wf   1f/x (/wkz !/wt Vj/x ，/wd it/x (/wkz p-/x >/n dat：a/x )/wky )/wky return/x  ERROR/x ；/wf 
    Push/x (/wkz s/x ，/wd p-/x >/n rchild/x )/wky ；/wf 
    }/n ∥/w if/x 
  l/x ∥/w While/x 
  return/x 【/wkz OK：/x 
＼/m }/n f/x  InOrderTraverse/x 
算法/n 6．2/m 
Status/x  InOrderTraverse/x (/wkz BiTree/x  T/x 。/wj Status/x (/wkz */n Visit/x )/wky (/wkz TElemType/x  e/x )/wky )/wky {/n 
  ∥/w 采用/v 二/m 叉/n 链/ng 表存储/n 结构/n ，/wd Visit/x 是/vshi 对/p 数据/n 元素/n 操作/vn 的/ude1 应用/vn 函数/n 。/wj 
  ∥/w 中/b 序/n 遍历/n 二/m 叉树/n T/x 的/ude1 非/b 递归/n 算法/n ，/wd 对/p 每个/r 数据/n 元素/n 调用函数/n Visit/x 。/wj 
  InitStack/x (/wkz S/x )/wky ；/wf P=T/x ；/wf 
  while/x (/wkz P/x  0/m  1/m  Stac/x ~/n pty/x (/wkz S/x )/wky )/wky {/n 
    if/x (/wkz P/x )/wky {/n Push/x (/wkz S/x ，/wd p/x )/wky ；/wf P：P-/x >/n Ichild/x ；/wf }/n ∥/w 根/q 指针/n 进/vf 栈/ng ，/wd 遍历/n 右/f 予/vg 树/n 
    else/x {/n     ∥/w 根/q 指针/n 退/v 栈/ng ，/wd 访问/v 根/n 结点/n ，/wd 遍历/n 右/f 子/ng 树/n 
    Pop/x (/wkz S/x ，/wd p/x )/wky ；/wf   if/x (/wkz !/wt Visit/x (/wkz p-/x >/n data/x )/wky )/wky return/x  ERROR/x ；/wf 
    P：P-/x >/n rchild/x ；/wf 
    ＼/m }/n f/x  else/x 
  }/n ∥/w While/x 
  return/x  OK/x ；/wf 
}/n ∥/w InorderTraverse/x 
    算法/n 6．3/m 
    “/wyz 遍历/n ”/wyy 是/vshi 二/m 叉树/n 各种/rz 操作/vn 的/ude1 基础/n ，/wd 可以/v 在/p 遍历/n 过程/n 中/f 对/p 结点/n 进行/vx 各种/rz 操作/v ．/w 如/v 一/m 棵/q 已/d 知/v 树/n 可/v 求/v 结点/n 的/ude1 双亲/n ，/wd 求/v 结点/n 的/ude1 孩子/n 结点/n ．/w 判定/v 结点/n 所在/n 层次/n 等/udeng ，/wd 反之/c ，/wd 也/d 可/v 在/p 遍历/n 过程/n 中/f 生成/v 结点/n ，/wd 建立/v 二/m 叉树/n 的/ude1 存/v f/x 睬/v 估/v 构/vg 。/wj 例如/v ．/w 算法/n 6．4/m 是/vshi 一个/mq 按/p 先/d 序/vg 序列/n 建立/v 的/ude1 二/m 叉/n 链/ng 表/n 的/ude1 过程/n 。/wj 对/p 图/n 6．8/m (/wkz b/x )/wky 所/usuo 示/vg 二/m 叉树/n ，/wd 按/p 下列/b 次序/n 顺序/n 读入/v 字符/n     A/x  B/x  C/x ①/m D/x  可/v 建立/v 的/ude1 _/n I/x 叉/n 链/ng 表/n 。/wj 
Status/x  CreateBiTree/x (/wkz BiTree/x ＆/n T/x )/wky 1/m 
  ∥/w 按/p 先/d 序/vg 次序/n 输入/v 二/m 叉树/n 中/f -/wp Bj/x 值/n (/wkz 一个/mq 字符/n )/wky ，/wd 空格字符/n 表示/v 空/a 树/n ，/wd 
  ∥/w 构造/n 二/m 叉/n 链/ng 表表示/n 的/ude1 ：：/wp 
  8caInf/x (/wkz &/n ch/x )/wky ；/wf 
  if/x (/wkz ch==/x ～/ws )/wky T=I/x ；/wf 
  else/x  I/x 
    if/x (/wkz !/wt (/wkz T=/x (/wkz Bil/x ~/n Node/x */n )/wky ~/n lloc/x (/wkz sizeof/x (/wkz BiTNode/x )/wky )/wky )/wky )/wky exit/x (/wkz OVERFLOW/x )/wky ；/wf 
    T-/x >/n data=ch/x ；/wf     ／／/m 生成/vn 根/n 结点/n 
    Cre/x ~/n teBiTree/x (/wkz T-/x >/n ichild/x )/wky ；/wf     ∥/w 构造/n 左/f 子/ng 树/n 
    CreateBiTree/x (/wkz T-/x >/n rchild/x )/wky ；/wf     ∥/w 构造/n 右/f 子/ng 树/n 
  }/n 
  return/x  OK/x ；/wf 
}/n ∥/w CreateBiTree/x 
    算法/n 6．4/m 
    对/p 二/m 叉树/n 进行/vx 遍历/n 的/ude1 搜索/vn 路径/n 除了/p 上述/b 按/p 先/d 序/n 、/wn 中/b 序/n 或/c 后/f 序/n 外/f ，/wd 还/d 可/v 从/p 上/f 到/v 下/f 、/wn 从/p 左/f 到/v 右/f 按/p 层次/n 进行/vx 。/wj 
    显然/a ，/wd 遍历/n 二/m 叉树/n 的/ude1 算法/n 中/f 的/ude1 基本/a 操作/vn 是/vshi 访问/v 结点/n ，/wd 则/c 不/d 论/v 按/p 哪/ry 一/m 种/q 次序/n 进行/vx 遍历/n 。/wj 对/p 含/v ”/wyy 个/q 结点/n 的/ude1 二/m 叉树/n ，/wd 其/rz 时间/n 复杂度/n 均/d 为/v o/x (/wkz ”/wyy )/wky 。/wj 所/usuo 需/v 辅助/vn 空间/n 为/v 遍历/n 过程/n 中/f 栈/ng 的/ude1 最/d 大容量/n ，/wd 即/v 书/n 时/ng 的/ude1 深度/n ，/wd 最/d 坏/a 情况/n 下/f 为/v ”/wyy ，/wd 则/c 空间/n 复杂度/n 也/d 为/v 0/m (/wkz n/x )/wky 。/wj 遍/v 历时/vi 如果/c 用/p 二/m 叉树/n 的/ude1 其它/rz 存储/vn 结构/n ，/wd 如/c 带/v 标志/n 域/ng 的/ude1 三叉/b 链/ng 表/n (/wkz 参见/v 算法/n 6．13/m )/wky ，/wd 此时/r 因/p 存储/vn 结构/n 中/f 已/d 存/v 有/vyou 遍历/n 所/usuo 需/v 足够/v 信息/n ，/wd 则/c 遍历/n 过程/n 中/f 不/d 需/v 另/rz 设/v 栈/ng ，/wd 也/d 可/v 和/cc 8．5/m 节/q 将/d 讨论/v 的/ude1 遍历/n 广义/n 表/n 的/ude1 算法/n 相/d 类似/a ，/wd 采用/v 带/v 标志/n 域/ng 的/ude1 二/m 叉/n 链/ng 表/n 作/v 存储/vn 结构/n ，/wd 并/cc 在/p 遍历/n 过程/n 中/f 利用/v 指针/n 域/ng 暂/d 存/v 遍历/n 路径/n ，/wd 也/d 可/v 省略/v 栈/ng 的/ude1 空间/n ，/wd 但/c 这样/rzv 做/v 将/d 使/v 时间/n 上/f 有/vyou 很/d 大/a 损失/n 。/wj 
6．3．2/m 线索/n 二/m 叉树/n 
    从/p 上/f 节/n 的/ude1 讨论/vn 得知/v ：/wp 遍历/n 二/m 叉树/n 是/vshi 以/p 一定/b 规则/n 将/d 二/m 叉树/n 中/f 结点/n 排列/v 成/v 一个/mq 线性/n 序列/n ，/wd 得到/v 二/m 叉树/n 中/f 结点/n 的/ude1 先/d 序/vg 序列/n 或/c 中/b 序/n 序列/n 或/c 后/f 序/n 序列/n 。/wj 这/rzv 实质/n 上/f 是/vshi 对/p 一个/mq 非线性/b 结构/n 进行/vx 线性/n 化操作/n ，/wd 使/v 每个/r 结点/n (/wkz 除/p 第一/m 个/q 和/cc 最后/f 一个/mq 外/f )/wky 在/p 这些/rz 线性/n 序列/n 中/f 有/vyou 且/c 仅/d 有/vyou 一个/mq 直接/a 前驱/n 和/cc 直接/a 后/f 继/vg (/wkz 在/p 不致于/v 混淆/v 的/ude1 情况/n ，/wd 我们/rr 省去/v 直接/a 二/m 字/n )/wky ①/m 。/wj 例如/v 在/p 图/n 6．9/m 所/usuo 示/vg 的/ude1 二/m 叉树/n 的/ude1 结点/n 的/ude1 中/b 序/n 序列/n a+b/x */n c―d―e／f/x 中/b ’/wyy c/x ’/wyy 的/ude1 前驱/n 是/vshi ’/wyy */n ，/wd 后/f 继/dg 是/vshi ’/wyy 。/wj 
    但是/c ，/wd 当/v 以/p 二/m 叉/n 链/ng 表/n 作为/v 存储/vn 结构/n 时/ng ，/wd 只/d 能/v 找到/v 结点/n 的/ude1 左/a 、/wn 右/f 孩子/n 信息/n ，/wd 而/cc 不/d 能/v 直接/ad 得到/v 结点/n 在/p 任/v 一/m 序列/n 中/f 的/ude1 前驱/n 和/cc 后/f 继/vg 信息/n ，/wd 这种/r 信息/n 只有/c 在/p 遍历/n 的/ude1 动态/n 过程/n 中/f 才/d 能/v 得到/v 。/wj     如何/ryv 保存/v 这种/r 在/p 遍历/n 过程/n 中/f 得到/v 的/ude1 信息/n 呢/y ?/ww 一个/mq 最/d 简单/a 的/ude1 办法/n 是/vshi 在/p 每个/r 结点/n 上/f 增加/v 两/m 个/q 指针/n 域/n fwd/x 和/cc bkwd/x ，/wd 分别/d 指示/v 结点/n 在/p 依/v 任/v 一/m 次序/n 遍/qv 历时/vi 得到/v 的/ude1 前驱/n 和/cc 后/f 继/vg 信息/n 。/wj 显然/a ，/wd 这样/rzv 做/v 使得/vi 结构/n 的/ude1 存储密度/n 大大降低/n 。/wj 另一方面/c ，/wd 在/p 有/vyou n/x 个/q 结点/n 的/ude1 二/m 叉/n 链/ng 表/n 中/f 必定/d 存在/v n+1/x 个/q 空/a 链/ng 域/ng 。/wj 由此/d 设想/v 能否/v 利用/v 这些/rz 空/ng 链/ng 域/ng 来/f 存放/v 结点/n 的/ude1 前驱/n 和/cc 后/f 继/vg 的/ude1 信息/n 。/wj 
    试/v 作/v 如下/vi 规定/v ：/wp 若/c 结点/n 有/vyou 左子树/nr ，/wd 则/c 其/rz lchild/x 域/ng 指示/n 其/rz 左/a 孩子/n ，/wd 否则/c 令/v lchild/x 域/ng 指示/n 其/rz 前驱/n ；/wf 若/c 结点/n 有/vyou 右/f 子/ng 树/n ，/wd 则/c 其/rz rchild/x 域/ng 指示/n 其/rz 右/f 孩子/n ，/wd 否则/c 令/v rchild/x 域/ng 指示/n 其后/t 继/vg 。/wj 为了/p 避免/v 混淆/v ，/wd 尚/d 需/v 改变/v 结点/n 结构/n ，/wd 增加/v 两/m 个/q 标志/n 域/n lchild/x   l/x  ltag/x  I/x  data/x  l/x  nag/x  l/x   rchild/x 
其中/rz ：/wp 
    ．/w     f/x  0/m  lchild/x 域/ng 指示/v 结点/n 的/ude1 左/a 孩子/n 
    “/wyz u6/x   i/x  l/x  lchild/x 域/ng 指示/v 结点/n 的/ude1 前驱/n 
    f/x  0/m  rchild/x 域/ng 指示/v 结点/n 的/ude1 右/f 孩子/n 
    …/ws 。/wj   f/x  l/x  rchild/x 域/ng 指示/v 结点/n 的/ude1 后/f 继/vg 
    以/p 这种/r 结点/n 结构/n 构成/v 的/ude1 二/m 叉/n 链/ng 表/n 作为/v 二/m 叉树/n 的/ude1 存储/vn 结构/n ，/wd 叫做/v 线索/n 链/ng 表/n ，/wd 其中/rz 指向/v 结点/n 前驱/n 和/cc 后/f 继/vg 的/ude1 指针/n ，/wd 叫做/v 线索/n 。/wj 加上/v 线索/n 的/ude1 二/m 叉树/n 称之为/v 线索/n 二/m 叉树/n (/wkz Threaded/x  BinaryTree/x )/wky 。/wj 例如/v 图/n 6．11/m (/wkz a/x )/wky 所/usuo 示/vg 为/p 中/b 序/n 线索/n 二/m 叉树/n ，/wd 与其/c 对应/vi 的/ude1 中/b 序/n 线索/n 链/ng 表/n 如/v 图/n 6．1l/x (/wkz b/x )/wky 所/usuo 示/vg 。/wj 其中/rz 实线/n 为/p 指针/n (/wkz 指向/v 左/a 、/wn 右/f 子/ng 树/n )/wky ，/wd 虚线/n 为/p 线索/n (/wkz 指向/v 前驱/n 和/cc 后/f 继/vg )/wky 。/wj 对/p 二/m 叉树/n 以/p 某种/rz 次序/n 遍历/n 使/v 其/rz 变/v 为/p 线索/n 二/m 叉树/n 的/ude1 过程/n 叫做/v 线索/n 化/v 。/wj 
    在/p 线索/n 树/n 上/f 进行/vx 遍历/n ，/wd 只/d 要/v 先/d 找/v 到/v 序列/n 中/f 的/ude1 第一/m 个/q 结点/n ，/wd 然后/c 依次/d 找/v 结点/n 后/f 继/vg 直至/v 其后/t 继/dg 为/v 空/ng 时/ng 而/cc 止/v 。/wj 
    如何/ryv 在/p 线索/n 树/n 中/f 找/v 结点/n 的/ude1 后/f 继/vg ?/ww 以/p 图/n 6．11/m 的/ude1 中/b 序/n 线索/n 树/n 为/p 例/n 来看/u ，/wd 树/v 中/b 所有/b 叶子/n 结点/n 的/ude1 右/f 链/ng 是/vshi 线索/n ，/wd 则/c 右/f 链/ng 域/ng 直接/ad 指示/v 了结/v 点/qt 的/ude1 后/f 继/vg ，/wd 如/c 结点/n b/x 的/ude1 后/f 继/vg 为/p 结点/n */n 。/wj 树/n 中/b 所有/b ①/m   注意/v 在/p 本/rz 节/n 下/vf 文/ng 中/f 提到/v 的/ude1 “/wyz 前驱/n ”/wyy 和/cc “/wyz 后/f 继/vg ”/wyy 均/d 指/v 以/p 某种/rz 次序/n 遍历/n 所得/n 序列/n 中/f 的/ude1 前驱/n 和/cc 后/f 继/vg 。/wj 
图/n 6．11/m   线索/n 二/m 叉树/n 及其/cc 存储/vn 结构/n 
(/wkz a/x )/wky 中/f 序/n 线索/n 二/m 叉树/n ；/wf (/wkz b/x )/wky 中/f 序/n 线索/n 链/ng 表/n 。/wj 
非/b 终端/n 结点/n 的/ude1 右/f 链/ng 均/d 为/v 指针/n ，/wd 则/c 无/v 法/n 由此/d 得/ude3 到/v 后/f 继/vg 的/ude1 信息/n 。/wj 然而/c ，/wd 根据/p 中/b 序/n 遍历/n 的/ude1 规律/n 可/v 知/v ，/wd 结点/n 的/ude1 后/f 继/vg 应/v 是/vshi 遍历/n 其/rz 右/f 子/ng 树/n 时/ng 访问/v 的/ude1 第一/m 个/q 结点/n ，/wd 即/v 右/f 子/ng 树/n 中/f 最/d 左/a 下/f 的/ude1 结点/n 。/wj 例如/v 在/p 找/v 结点/n */n 的/ude1 后/f 继/vg 时/ng ，/wd 首先/c 沿/p 右/f 指针/n 找到/v 其/rz 右/f 子/ng 树/n 的/ude1 根/n 结点/n “/wyz 一/m ”/wyy ，/wd 然后/c 顺/v 其/rz 左/a 指针/n 往/p 下/f 直至/v 其/rz 左/a 标志/n 为/p 1/m 的/ude1 结点/n ，/wd 即/d 为/v 结点/n */n 的/ude1 后/f 继/vg ，/wd 在/p 图/n 中/f 是/vshi 结点/n c/x 。/wj 反之/c ，/wd 在/p 中/b 序/n 线索/n 树/n 中/f 找/v 结点/n 前驱/n 的/ude1 规律/n 是/vshi ：/wp 若/v 其/rz 左/a 标志/n 为/v “/wyz 1/m ”/wyy ，/wd 则/d 左/a 链/ng 为/p 线索/n ，/wd 指示/v 其/rz 前驱/n ，/wd 否则/c 遍历/n 左/a 子/ng 树/n 时/ng 最后/f 访问/v 的/ude1 一个/mq 结点/n (/wkz 左子树/nr 中/f 最/d 右/f 下/vf 的/ude1 结点/n )/wky 为/p 其/rz 前驱/n 。/wj 
在/p 后/f 序/n 线索/n 树/n 中/f 找/v 结点/n 后/f 继/vg 较复杂/n 些/q ，/wd 可/v 分/qt 三/m 种/q 情况/n ：/wp (/wkz 1/m )/wky 若/c 结点/n x/x 是/vshi 二/m 叉树/n 的/ude1 根/n ，/wd 则/c 其后/t 继/vg 为/p 空/a ；/wf (/wkz 2/m )/wky 若/c 结点/n x/x 是/vshi 其/rz 双亲/n 的/ude1 右/f 孩子/n 或/c 是/vshi 其/rz 双亲/n 的/ude1 左/a 孩子/n 且/c 其/rz 双亲/n 没有/v 右/f 子/ng 树/n ，/wd 则/c 其后/t 继/dg 即/v 为/p 双亲/n 结点/n ；/wf (/wkz 3/m )/wky 若/c 结点/n x/x 是/vshi 其/rz 双亲/n 的/ude1 左/a 孩子/n ，/wd 且/c 其/rz 双亲/n 有/vyou 右/f 子/ng 树/n ，/wd 则/c 其后/t 继/vg 为/p 双亲/n 的/ude1 右/f 子/ng 树/n 上/f 按/p 后/f 序/n 遍历/n 列出/v 的/ude1 第一/m 个/q 结点/n 。/wj 例如/v 图/n 6．12/m 所/usuo 示/vg 为/v 后/f 序/n 后/f 继/vg 线索/n 二/m 叉树/n ，/wd 结点/n B/x 的/ude1 后/f 继/vg 为/p 结点/n c/x ，/wd 结点/n C/x 的/ude1 后/f 继/vg 为/p 结点/n D/x ，/wd 结点/n F/x 的/ude1 后/f 继/vg 为/p 结点/n G/x ，/wd 而/cc 结点/n D/x 的/ude1 后/f 继/vg 为/p 结点/n E/x 。/wj 可见/c ，/wd 在/p 后/f 序/n 线索/n 化/k 树/v 上/f 找/v 后/f 继/vg 时/ng 需/v 知道/v 结点/n 双亲/n ，/wd 即/d 需/v 带/v 标志/n 域/ng 的/ude1 三叉/b 链/ng 表/n 作/v 存储/vn 结构/n 。/wj 
    可见/c ，/wd 在/p 中/b 序/n 线索/n 二/m 叉/n 树上/s 遍历/n 二/m 叉树/n ，/wd 虽则/c 时间/n 复杂度/n 亦/d 为/v 0/m (/wkz n/x )/wky ，/wd 但/c 常数/n 因子/n 要/v 比/p 上/f 节/n 讨论/vn 的/ude1 算法/n 小/a ，/wd 且/c 不/d 需要/v 设/v 栈/ng 。/wj 
图/n 6．12/m 后/f 序/n 后/f 继/vg 
  线索/n 二/m 叉树/n 
因此/c ，/wd 若/c 在/p 某/rz 程序/n 中/f 所/usuo 用/v 二/m 叉树/n 需/v 经常/d 遍历/n 或/c 查找/v 结点/n 在/p 遍历/n 所得/n 线性/n 序列/n 中/f 的/ude1 前驱/n 和/cc 后/f 继/vg ，/wd 则/c 应/v 采用/v 线索/n 链/ng 表/n 作/v 存储/vn 结构/n 。/wj 
∥/w 二/m 叉树/n 的/ude1 二/m 叉/n 线索/n 存储表示/n 
tenum/x {/n Link/x ，/wd Thread/x }/n PoInterTag/x ；/wf 
tstru/x ~/n BiThrNode/x {/n 
  TElemType/x  data：/x 
  8truct/x  BiThJ：Node/x     */n ichild/x ，/wd   */n rchJ．1d/x ；/wf 
  PointerTag/x  LTag/x ，/wd RTag/x ；/wf 
∥/w Link==0：/x 指针/n ，/wd Thread==1：/x 线索/n 
∥/w 左右/m 孩子/n 指针/n 
∥/w 左右/m 标志/n 
    }/n BiThrNode/x 。/wj */n BiThrTree/x ；/wf 
    为/p 方便/v 起见/u ，/wd 仿照/v 线性/n 表/n 的/ude1 存储/vn 结构/n ，/wd 在/p 二/m 叉树/n 的/ude1 线索/n 链/ng 表/n 上/f 也/d 添加/v 一个/mq 头/n 结点/n ，/wd 并/cc 令/v 其/rz lchild/x 域/n 的/ude1 指针/n 指向/v 二/m 叉树/n 的/ude1 根/n 结点/n ，/wd 其/rz rchild/x 域/n 的/ude1 指针/n 指向/v 中/b 序/n 遍/qv 历时/vi 访问/v 的/ude1 最后/f 一个/mq 结点/n ；/wf 反之/c ，/wd 令/v 二/m 叉树/n 中/b 序/n 序列/n 中/f 的/ude1 第一/m 个/q 结点/n 的/ude1 lchild/x 域/ng 指针/n 和/cc 最后/f 一个/mq 结点/n rehild/x 域/n 的/ude1 指针/n 均/d 指向/v 头/n 结点/n 。/wj 这/rzv 好比/v 为/p 二/m 叉树/n 建立/v 了/ule 一个/mq 双向/b 线索/n 链/ng 表/n ，/wd 既/c 可/v 从/p 第一/m 个/q 结点/n 起/f 顺/v 后/f 继/vg 进行/vx 遍历/n ，/wd 也/d 可/v 从/p 最后/f 一个/mq 结点/n 起/f 顺/v 前驱/n 进行/vx 遍历/n (/wkz 如/v 图/n 6．11/m (/wkz b/x )/wky 所/usuo 示/vg )/wky 。/wj 
下/f 述/vg 算法/n 6．5/m 正是/v 以/p 双向/b 线索/n 链/ng 表/vg 为/p 存储/vn 结构/n 时/ng 对/p 二/m 叉树/n 进行/vx 遍历/n 的/ude1 算法/n 。/wj 
Status/x  InOrderTraverse―Thr/x (/wkz BiThrTree/x  T/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz TElemType/x  e/x )/wky )/wky {/n 
  ∥/w T/x 指向/v 头/n 结点/n ，/wd 头/n 结点/n 的/ude1 左/a 链/ng ichild/x 指向/v 根/n 结点/n ，/wd 可/c 参见/v 线索/n 化/v 算法/n 。/wj 
  ∥/w 中/b 序/n 遍历/n 二/m 叉/n 线索/n 树/n T/x 的/ude1 非/b 递归/n 算法/n ，/wd 对/p 每个/r 数据/n 元素/n 调用函数/n Visit/x 。/wj 
  P=T-/x >/n Ichild/x ；/wf     ∥/w P/x 指向/v 根/n 结点/n 
  while/x (/wkz P/x !/wt =T/x )/wky {/n     ∥/w 空/a 树/n 或/c 遍历/n 结束/v 时/ng ，/wd P：=T/x 
    while/x (/wkz p-/x >/n LTag==Link/x )/wky P=P-/x >/n ichild/x ；/wf 
    if/x (/wkz !/wt Visit/x (/wkz p-/x >/n data/x )/wky )/wky return/x  ERROR/x ；/wf     ∥/w 访问/v 其/rz 左/a 子/ng 树/v 为/p 空/a 的/ude1 结点/n 
    while/x (/wkz p-/x >/n RTag==Thread/x ＆/n ＆/n P-/x >/n rchild/x !/wt =T/x )/wky {/n 
    P=P-/x >/n rchild/x ；/wf   Visit/x (/wkz p-/x >/n data/x )/wky ；/wf     ∥/w 访问/v 后/f 继/vg 结/v ．/w -/wp 0/m 
    }/n 
    P=P-/x >/n rchild：/x 
  }/n 
  return/x  OK/x ；/wf 
、/wn }/n }/n InOrderTraverse/x 。/wj Thr/x 
    算法/n 6．5/m 
    那末/c ，/wd 又/d 如何/ryv 进行/vx 二/m 叉树/n 的/ude1 线索/n 化/v 呢/y ?/ww 由于/p 线索/n 化/k 的/ude1 实质/n 是/vshi 将/p 二/m 叉/n 链/ng 表/n 中/f 的/ude1 空/a 指针/n 
改/v 为/p 指向/v 前驱/n 或/c 后/f 继/vg 的/ude1 线索/n ，/wd 而/cc 前驱/n 或/c 后/f 继/vg 的/ude1 信息/n 只有/c 在/p 遍/qv 历时/vi 才/d 能/v 得到/v ，/wd 因此/c 线索/n 化/k 的/ude1 
过程/n 即/d 为/v 在/p 遍历/n 的/ude1 过程/n 中/f 修改/v 空/a 指针/n 的/ude1 过程/n 。/wj 为了/p 记/v 下/vf 遍历/n 过程/n 中/f 访问/v 结点/n 的/ude1 先后/d 关/v 
系/v ，/wd 附设/v 一个/mq 指针/n pre/x 始终/d 指向/v 刚刚/d 访问/v 过/uguo 的/ude1 结点/n ，/wd 若/c 指针/n P/x 指向/v 当前/t 访问/v 的/ude1 结点/n ，/wd 则/d pre/x 
指向/v 它/rr 的/ude1 前驱/n 。/wj 由此/d 可/v 得/ude3 中/b 序/n 遍历/n 建立/v 中/b 序/n 线索/n 化/v 链/ng 表/n 的/ude1 算法/n 如/v 算法/n 6．6/m 和/cc 6．7/m 所/usuo 示/vg 。/wj 
Status/x  InOrderThreading/x (/wkz BiThrTree/x &/n Thrt/x ，/wd BiThrTree/x  T/x )/wky {/n 
  ∥/w 中/b 序/n 遍历/n 二/m 叉树/n T/x ，/wd 井/n 将/p 其中/rz 序/n 线索/n 化/k ，/wd Thrt/x 指向/v 头/n 结点/n 。/wj 
  if/x (/wkz !/wt (/wkz Thrt=/x (/wkz BiThrTree/x )/wky mall/x ~/n (/wkz size/x ~/n (/wkz BiThrNode/x )/wky )/wky )/wky )/wky exit/x (/wkz OVERFLOW/x )/wky ；/wf 
  Thrt-/x >/n LTag=Link/x ；/wf Thrt-/x >/n RTag=Thread/x ；/wf     ∥/w 建/v 头/n 结点/n 
  Thrt-/x >/n rchild=Thrt/x ；/wf     ∥/w 右/f 指针/n 回/qv 指/v 
  if/x (/wkz !/wt T/x )/wky Thrt-/x >/n Ichild=Thrt/x ；/wf     ∥/w 若/v 二/m 叉树/n 空/ng ，/wd 则/d 左/a 指针/n 回/qv 指/v 
  else/x }/n     ・/w 
    Thrt-/x >/n ichild=T/x ；/wf pre=Thrt：/x 
    InThreading/x (/wkz T/x )/wky ；/wf     ∥/w 中/b 序/n 遍历/n 进行/vx 中/b 序/n 线索/n 化/v 
    pre-/x >/n rchild：Thrt/x ；/wf pre-/x >/n RTag：Thread/x ；/wf   ∥/w 最后/f 一个/mq 结点/n 线索/n 化/v 
    Thrt-/x >/n rchild=pre/x ；/wf 
  }/n 
  return/x  OK/x ；/wf 
}/n ∥/w InorderThreading/x 
    算法/n 6．6/m 
・/w 134・/m 
void/x  InThreading/x (/wkz BiThrTree/x  P/x )/wky {/n 
  if/x (/wkz P/x )/wky {/n 
    InThreading/x (/wkz p-/x >/n ichild/x )/wky ；/wf   ∥/w 左/a 子/ng 树/v 线索/n 化/v 
    if/x (/wkz !/wt P-/x >/n ichild/x )/wky {/n P-/x >/n LTag=Thread/x ；/wf P-/x >/n ichild=pre/x ；/wf }/n   ∥/w 前驱/n 线索/n 
    if/x (/wkz !/wt pre-/x >/n rchild/x )/wky {/n pre-/x >/n RTag=Thread/x ；/wf pre-/x >/n rchild=p/x ；/wf }/n ∥/w 后/f 继/vg 线索/n 
    pre/x  i/x  p/x ；/wf     ∥/w 保持/v pre/x 指向/v p/x 的/ude1 前驱/n 
    InThreading/x (/wkz p-/x >/n rchild/x )/wky ；/wf   ∥/w 右/f 子/ng 树/v 线索/n 化/v 
  }/n     ．/w 
＼/m }/n ?/ww InThreading/x 
    算法/n 6．7/m 
6．4/m 树/n 和/cc 森林/n 
这/rzv 一/m 节/q 我们/rr 将/d 讨论/v 树/n 的/ude1 表示/vn 及其/cc 遍历/n 操作/v ，/wd 并/cc 建立/v 森林/n 与/p 二/m 叉树/n 的/ude1 对应/vn 关系/n 。/wj 
6．4．1/m 树/n 的/ude1 存储/vn 结构/n 
    在/p 大量/m 的/ude1 应用/vn 中/f ，/wd 人们/n 曾/d 使/v 用/p 多种形式/n 的/ude1 存储/vn 结构/n 来/vf 表示/v 树/n 。/wj 这里/rzs ，/wd 我们/rr 介绍/v 三/m 种/q 常用/a 的/ude1 链/ng 表/vg 结构/n 。/wj 
  一/m 、/wn 双亲/n 表示法/n 
  假设/v 以/p 一/m 组/q 连续/a 空间存储/n 树/n 的/ude1 结点/n ，/wd 同时/c 在/p 每个/r 结点/n 中/f 附设/v 一个/mq 指示器/n 指示/n 其/rz 双亲/n 结点/n 在/p 链/ng 表/n 中/f 的/ude1 位置/n ，/wd 其/rz 形式/n 说明/v 如下/vi ：/wp 
∥/w 树/n 的/ude1 双亲/n 表存储/n 表示/v 
#/n define/x  MAX―TREE―SIZE/x  100/m 
tnx/x ~/n f/x  stru/x ~/n ．/w PTNode/x {/n 
  TElemType/x  data/x ；/wf 
  int/x  parent/x ；/wf ∥/w 双亲/n 位置/n 域/ng 
}/n PTNode/x ；/wf 
tdef/x  stru=t/x {/n 
  PTNode/x  nodes/x 【/wkz MAX-TREE-SIZE/x ]/wky ；/wf 
  int/x     n/x ；/wf     ∥/w 结/v 点数/n 
}/n PTree/x ；/wf 
例如/v ，/wd 图/n 6．13/m 展示/v 一/m 棵/q 树/n 及其/cc 双亲/n 表示/v 的/ude1 存储/vn 结构/n 。/wj 这种/r 存储/vn 结构/n 利用/v 了/ule 每个/r 结点/n (/wkz 除根/vi 以外/f )/wky 只有/c 唯一/b 的/ude1 双亲/n 的/ude1 性质/n 。/wj PARENT/x (/wkz T/x ，/wd x/x )/wky 操作/v 可以/v 在/p 常量/n 时间/n 内/f 实现/v 。/wj 反复/d 调用/v PARENT/x 操作/vn ，/wd 直到/v 遇见/v 无/v 双亲/n 的/ude1 结点/n 时/ng ，/wd 便/d 找/v 到/v 了/ule 树/n 的/ude1 根/n ，/wd 这/rzv 就/d 是/vshi ROOT/x (/wkz x/x )/wky 操作/v 的/ude1 执行/vn 过程/n 。/wj 但是/c ，/wd 在/p 这种/r 表示法/n 中/f ，/wd 求/v 结点/n 的/ude1 孩子/n 时/ng 需要/v 遍历/n 整个/b 结构/n 。/wj 
  二/m 、/wn 孩子/n 表示法/n 
数组/n 下标/n 
图/n 6．13/m 树/n 的/ude1 双亲/n 表示法/n 示例/n 
由于/p 树/n 中/f 每个/r 结点/n 可能/v 有/vyou 多/m 棵子/n 树/n ，/wd 则/c 可/v 用/p 多重/b 链/ng 表/n ，/wd 即/v 每个/r 结点/n 有/vyou 多/m 个/q 指针/n 域/ng ，/wd 其中/rz 每个/r 指针/n 指向/v 一/m 棵子/n 树/n 的/ude1 根/n 结点/n ，/wd 此时/r 链/ng 表/n 中/f 的/ude1 结点/n 可以/v 有/vyou 如下/vi 两/m 种/q 结点/n 格式/n ：/wp data/x   1/m   childl/x   l/x   child2/x   若/c 采用/v 第一/m 种/q 结点/n 格式/n ，/wd 则/d 多/a 重/a 链/ng 表/n 中/f 的/ude1 结点/n 是/vshi 同/p 构/vg 的/ude1 ，/wd 其中/rz d/x 为/p 树/n 的/ude1 度/qv 。/wj 由于/p 树/n 中/f 很多/m 结点/n 的/ude1 度/qv 小于/v d/x ，/wd 所以/c 链/ng 表/n 中/f 有/vyou 很多/m 空/ng 链/ng 域/ng ，/wd 空间较/n 浪费/v ，/wd 不/d 难/ad 推出/v ，/wd 在/p 一/m 棵/q 有/vyou n/x 个/q 结点/n 度/qv 为/v 是/vshi 的/ude1 树/n 中/f 必/d 有/vyou n/x (/wkz 忌/v 一/m 1/m )/wky +1/m 个/q 空/a 链/ng 域/ng 。/wj 若/c 采用/v 第二/m 种/q 结点/n 格式/n ，/wd 则/d 多/a 重/a 链/ng 表/n 中/f 的/ude1 结点/n 是/vshi 不同/a 构/vg 的/ude1 ，/wd 其中/rz 刁/a 为/p 结点/n 的/ude1 度/qv ，/wd degree/x 域/n 的/ude1 值/n 同/p a/x 。/wj 此时/r ，/wd 虽/c 能/v 节约/vd 存储空间/n ，/wd 但/c 操作/v 不/d 方便/a 。/wj 
　　另/rz 一/m 种/q 办法/n 是/vshi 把/pba 每个/r 结点/n 的/ude1 孩子/n 结点/n 排列/v 起来/vf ，/wd 看成/v 是/vshi 一个/mq 线性/n 表/n ，/wd 且/c 以/p 单链/n 表/n 作/v 存储/vn 结构/n ，/wd 则/c ，/wd z/x 个/q 结点/n 有/vyou n/x 个/q 孩子/n 链/ng 表/n (/wkz 叶子/n 的/ude1 孩子/n 链/ng 表/n 为/v 空/ng 表/vg )/wky 。/wj 而/cc n/x 个头/n 指针/n 又/d 组成/v 一个/mq 线性/n 表/n ，/wd 为了/p 便于/v 查找/v ，/wd 可/c 采用/v 顺序/n 存储/vn 结构/n 。/wj 这种/r 存储/vn 结构/n 可/v 形式/n 地/ude2 说明/v 如下/vi ：/wp 
　　    ∥/w 树/n 的/ude1 孩子/n 链/ng 表存储/n 表示/v 
    typedef/x  struct/x  CTNode/x {/n     ∥/w 孩子/n 结点/n 
    ．/w int/x     chi．1d：/x 
    struc/x ~/n c/x  CTNode/x ”/wyy next：/x 
    }/n */n Chilc/x [/wkz Ptr/x ；/wf 
    type4ef/x  stz/x ~/n ct/x {/n 
  -/wp rEle/x  data/x ；/wf 
  ChiidPtr/x  firstchild/x ；/wf   ∥/w 孩子/n 链/ng 表头/n 指针/n 
    ICTBox/x ；/wf 
    typedef/x  struct/x {/n 
    BDx/x  nodes/x [/wkz MAX-TREE-S/x ~/n ZE/x ]/wky ；/wf 
    int/x   n/x ，/wd r/x ；/wf     ∥/w 结/v 点数/n 和/cc 根/n 的/ude1 位置/n ；/wf 
    Icrree/x ；/wf 
    图/n 6．14/m (/wkz a/x )/wky 是/vshi 图/n 6．13/m 中/f 的/ude1 树/n 的/ude1 孩子/n 表示法/n 。/wj 与/p 双亲/n 表示法/n 相反/vi ，/wd 孩子/n 表示法/n 便/d 于/p 那些/rz 涉及/v 孩子/n 的/ude1 操作/vn 的/ude1 实现/vn ，/wd 却/d 不/d 适用/vi 于/p PARENT/x (/wkz T/x ，/wd x/x )/wky 操作/vn 。/wj 我们/rr 可以/v 把/pba 双亲/n 表示法/n 和/cc 孩子/n 表示法/n 结合/v 起来/vf ，/wd 即将/d 双亲/n 表示/v 和/cc 孩子/n 链/ng 表/n 合/v 在/p 一起/s 。/wj 图/n 6．14/m (/wkz b/x )/wky 就是/v 这种/r 存储/vn 结构/n 的/ude1 一/m 例/q ，/wd 它/rr 和/cc 图/n 6．14/m (/wkz a/x )/wky 表示/v 的/ude1 是/vshi 同/p 一/m 棵/q 树/n 。/wj 
    三/m 、/wn 孩子/n 兄弟/n 表示法/n 
    又/d 称/v 二/m 叉树/n 表示法/n ，/wd 或/c 二/m 叉/n 链/ng 表表示/n 法/n 。/wj 即/v 以/p 二/m 叉/n 链/ng 表/n 作/v 树/n 的/ude1 存储/vn 结构/n 。/wj 链/ng 表/n 中/f 结点/n 的/ude1 两/m 个/q 链/ng 域/ng 分别/d 指向/v 该/rz 结点/n 的/ude1 第一/m 个/q 孩子/n 结点/n 和/cc 下/vf 一个/mq 兄弟/n 结点/n ，/wd 分别/d 命名/v 为/v firstchild/x 域/n 和/cc nextsibling/x 域/ng 。/wj 
    ∥/w …/ws 树/n 的/ude1 二/m 叉/n 链/ng 表/n (/wkz 孩子/n 一/m 兄弟/n )/wky 存储表示/n 
    tl/x ~/n ef/x  struct/x  CSNode/x {/n     ’/wyy 
    ElemType/x  data：/x 
    struct/x  CSNode/x   */n firstchJ．1d/x ，/wd */n nextsibling/x ；/wf 
  }/n CSNode/x 。/wj */n CSTree/x ；/wf 
  图/n 6．15/m 是/vshi 图/n 6．13/m 中/f 的/ude1 树/n 的/ude1 孩子/n 兄弟/n 链/ng 表/n 。/wj 利用/v 这种/r 存储/vn 结构/n 便于实现/n 各/rz 种/q 树/n 的/ude1 操作/vn 。/wj 首先/c 易于/v 实现/v 找/v 结点/n 孩子/n 等/udeng 的/ude1 操作/vn 。/wj 例如/v ：/wp 若/c 要/v 访问/v 结点/n x/x 的/ude1 第/m i/x 个/q 孩子/n ，/wd 则/c 只/d 要/v 先/d     图/n 6．14/m 图/n 6．13/m 的/ude1 树/n 的/ude1 另外/rz 两/m 种/q 表示法/n 
    (/wkz a/x )/wky 孩子/n 链/ng 表/n ；/wf (/wkz b/x )/wky 带/v 双亲/n 的/ude1 孩子/n 链/ng 表/n 。/wj 
从/p firstchild/x 域/ng 找到/v 第1/m 个/q 孩子/n 结点/n ，/wd 然后/c 沿着/p 孩子/n 结点/n 的/ude1 nextsibling/x 域/n 连续/ad 走/v i/x ～/ws 1/m 步/qv ，/wd 便/d 可/v 找到/v x/x 的/ude1 第/m i/x 个/q 孩子/n 。/wj 
当然/d ，/wd 如果/c 为/v 每个/r 结点/n 增设/v 一个/mq ：/wp PARENT/x 域/ng ，/wd 则/c 同样/d 能/v 方便/a 地/ude2 实现/v PARENT/x (/wkz T/x ，/wd x/x )/wky 操作/vn 。/wj 
  6．4．2/m 森林/n 与/p 二/m 叉树/n 的/ude1 转换/vn 
  由于/p 二/m 叉树/n 和/cc 树/n 都/d 可/v 用/p 二/m 叉/n 链/ng 表/n 作为/v 存储/vn 结构/n ，/wd 则/c 以/p 二/m 叉/n 链/ng 表/vg 作为/p 媒介/n 可/v 导出/v 树/n 与/p 二/m 叉树/n 之间/f 的/ude1 一个/mq 对/p 应/v 关系/n 。/wj 也就是说/vl ，/wd 给/p 定/v 一/m 棵/q 树/n ，/wd 可以/v 找到/v 唯一/b 的/ude1 一/m 棵/q 二/m 叉树/n 与/p 之/rz 对应/vi ，/wd 从/p 物理/n 结构/n 来看/u ，/wd 它们/rr 的/ude1 二/m 叉/n 链/ng 表/n 是/vshi 相同/a 的/ude1 ，/wd 只是/d 解释/v 不同/a 而已/y 。/wj 图/n 6．16/m 直观/a 地/ude2 展示/v 了/ule 树/n 与/p 二/m 叉树/n 之间/f 的/ude1 对应/vn 关系/n 。/wj 
    从/p 树/n 的/ude1 二/m 叉/n 链/ng 表表示/n 的/ude1 定义/n 可知/v ，/wd 任何/rz 一/m 棵/q 和/cc 树/n 对应/vi 的/ude1 二/m 叉树/n ，/wd 其/rz 右/f 子/ng 树/n 必/d 空/a 。/wj 若/c 把/pba 森林/n 中/f 第二/m 棵/q 树/n 的/ude1 根/n 结点/n 看成/v 是/vshi 第一/m 棵/q 树/n 的/ude1 根/n 结点/n 的/ude1 兄弟/n ，/wd 则/c 同样/d 可/v 导出/v 森林/n 和/cc 二/m 叉树/n 的/ude1 对应/vn 关系/n 。/wj 
例如/v ．/w 图/n 6．17/m 展示/v 了/ule 森林/n 与/p 二/m 叉树/n 之间/f 的/ude1 对应/vn 关系/n 。/wj 
图/n 6．15/m 图/n 6．13/m 中/f 树/v 的/ude1 二/m 叉/n 链/ng 表表示/n 法/n 
二/m 叉树/n 
图/n 6．16/m 树/n 与/p 二/m 叉树/n 的/ude1 对应/vn 关系/n 示例/n     
树/n 与/p 二/m 叉树/n 对应/vi 
    图/n 6．17/m 森林/n 与/p 二/m 叉树/n 的/ude1 对应/vn 关系/n 示例/n 
    这个/rz --/wp 对应/vi 的/ude1 关系/n 导致/v 森林/n 或/c 树/v 与/p 二/m 叉树/n 可以/v 相互/d 转换/v ，/wd 其/rz 形式/n 定义/n 如下/vi ：/wp 
    一/m 、/wn 森林/n 转换/v 成/v 二/m 叉树/n 
    如果/c F：/x {/n T1/x ，/wd T2/x ，/wd …/ws ，/wd T/x 。/wj }/n 是/vshi 森林/n ，/wd 则/c 可/v 按/p 如下/vn 规则/n 转换/v 成/v 一/m 棵/q 二/m 叉树/n B=/x (/wkz ，/wd "/n oot/x ，/wd LB/x ，/wd RB/x )/wky 。/wj     
    (/wkz 1/m )/wky 若/v F/x 为/v 空/ng ，/wd 即/v m=0/x ，/wd 则/d B/x 为/p 空/a 树/n ；/wf 
    (/wkz 2/m )/wky 若/v F/x 非空/n ，/wd 即/v m≠0/x ，/wd 则/d B/x 的/ude1 根/n root/x 即/v 为/p 森林/n 中/f 第一/m 棵/q 树/n 的/ude1 根/n 00T/x (/wkz T1/x )/wky ；/wf B/x 的/ude1 左子树/nr LB/x 是/vshi 从/p T1/x 中/b 根/n 结点/n 的/ude1 子/ng 树/v 森林/n F1=/x {/n 丁/ng 1l/x '/n T12/x ，/wd …/ws ，/wd T1/x 。/wj 1/m }/n 转换/vn 而/cc 成/v 的/ude1 二/m 叉树/n ；/wf 其/rz 右/f 子/ng 树/n ．/w RB/x 是/vshi 从/p 森林/n F/x ’/wyy =/m {/n T2/x ，/wd T3/x ，/wd …/ws ，/wd L/x }/n 转换/vn 而/cc 成/v 的/ude1 二/m 叉树/n 。/wj 
  二/m 、/wn 二/m 叉树/n 转换/v 成/v 森林/n 
  如果/c B=/x (/wkz root/x ，/wd LB/x ，/wd RB/x )/wky 是/vshi 一/m 棵/q 二/m 叉树/n ，/wd 则/c 可/v 按/p 如下/vn 规则/n 转换/v 成/v 森林/n 
F=/x {/n Tl/x ，/wd 2/m ，/wd …/ws ，/wd 。/wj }/n ：/wp 
    (/wkz 1/m )/wky 若/v B/x 为/v 空/ng ，/wd 则/d F/x 为/p 空/a ；/wf 
    (/wkz 2/m )/wky 若/v B/x 非空/n ，/wd 则/d F/x 中/f 第一/m 棵/q 树/n T1/x 的/ude1 根/n RO/x (/wkz )/wky T/x (/wkz T1/x )/wky 即/d 为/v 二/m 叉树/n B/x 的/ude1 根/n root/x ；/wf T/x 中/b 根/n 结点/n 的/ude1 子/ng 树/v 森林/n F1/x 是/vshi 由/p B/x 的/ude1 左子树/nr LB/x 转换/vn 而/cc 成/v 的/ude1 森林/n ；/wf F/x 中/f 除/p T1/x 之外/f 其余/rz 树/n 组成/v 的/ude1 森林/n F/x ’/wyy =/m {/n T：/x ，/wd 丁/Mg 3/m ，/wd …/ws ，/wd 丁/o 。/wj }/n 是/vshi 由/p B/x 的/ude1 右/f 子/ng 树/n RB/x 转换/vn 而/cc 成/v 的/ude1 森林/n 。/wj 
    从/p 上述/b 递归/n 定义/n 容易/ad 写/v 出/vf 相互/d 转换/v 的/ude1 递归/n 算法/n 。/wj 同时/c ，/wd 森林/n 和/cc 树/n 的/ude1 操作/vn 亦/d 可/v 转换/v 成/v 二/m 叉树/n 的/ude1 操作/vn 来/f 实现/v 。/wj 
  6．4．3/m 树/n 和/cc 森林/n 的/ude1 遍历/n 
  由/p 树结构/n 的/ude1 定义/n 可/v 引出/v 两/m 种/q 次序/n 遍历/n 树/n 的/ude1 方法/n ：/wp 一/m 种/q 是/vshi 先根/nr2 (/wkz 次/qv 序/n )/wky 遍历/n 树/n ，/wd 即/v ：/wp 先/d 访问/v 树/n 的/ude1 根/n 结点/n ，/wd 然后/c 依次/d 先/d 根/q 遍历/n 根/n 的/ude1 每/rz 棵子/n 树/n ；/wf 另/rz 一/m 种/q 是/vshi 后/f 根/n (/wkz 次/qv 序/n )/wky 遍历/n ，/wd 即/v ：/wp 先/d 依次/d 后/f 根/n 遍历/n 每/rz 棵子/n 树/n ，/wd 然后/c 访问/v 根/n 结点/n 。/wj 
    例如/v ，/wd 对/p 图/n 6．16/m 的/ude1 树/n 进行/vx 先/d 根/q 遍历/n ，/wd 可/v 得/ude3 树/n 的/ude1 先/d 根/q 序列/n 为/v     A/x  B/x  C/x  D/x  E/x 
若/c 对/p 此/rzs 树/n 进行/vx 后/f 根/n 遍历/n ，/wd 则/c 得/v 树/n 的/ude1 后/f 根/q 序列/n 为/v ：/wp     B/x  D/x  C/x  E/x  A/x 
　　按照/p 森林/n 和/cc 树/n 相互/d 递归/n 的/ude1 定义/n ，/wd 我们/rr 可以/v 推出/v 森林/n 的/ude1 两/m 种/q 遍历/n 方法/n ：/wp 
　　 一/m 、/wn 先/d 序/n 遍历/n 森林/n 
    若/c 森林/n 非空/n ，/wd 则/c 可/v 按/p 下/f 述/vg 规则/n 遍历/n 之/rz ：/wp 
    (/wkz 1/m )/wky 访问/v 森林/n 中/f 第一/m 棵/q 树/n 的/ude1 根/n 结点/n ；/wf 
    (/wkz 2/m )/wky 先/d 序/n 遍历/n 第一/m 棵/q 树/n 中/b 根/n 结点/n 的/ude1 子/ng 树/v 森林/n ；/wf 
    (/wkz 3/m )/wky 先/d 序/n 遍历/n 除去/v 第一/m 棵/q 树/n 之后/f 剩余/v 的/ude1 树/n 构成/v 的/ude1 森林/n 。/wj 
    二/m 、/wn 中/b 序/n 遍历/n 森林/n 
    若/c 森林/n 非空/n ，/wd 则/c 可/v 按/p 下/f 述/vg 规则/n 遍历/n 之/rz ：/wp 
    (/wkz 1/m )/wky 中/f 序/n 遍历/n 森林/n 中/f 第一/m 棵/q 树/n 的/ude1 根/n 结点/n 的/ude1 子/ng 树/v 森林/n ；/wf 
    (/wkz 2/m )/wky 访问/v 第一/m 棵/q 树/n 的/ude1 根/n 结点/n ；/wf 
    (/wkz 3/m )/wky 中/f 序/n 遍历/n 除去/v 第一/m 棵/q 树/n 之后/f 剩余/v 的/ude1 树/n 构成/v 的/ude1 森林/n 。/wj     ．/w 
    若/c 对/p 图/n 6．17/m 中/b 森林/n 进行/vx 先/d 序/n 遍历/n 和/cc 中/b 序/n 遍历/n ，/wd 则/c 分别/d 得到/v 森林/n 的/ude1 先/d 序/vg 序列/n 为/v A/x  B/x  C/x  D/x  E/x  F/x  G/x  H/x  I/x  J/x 
中/b 序/n 序列/n 为/v     B/x  C/x  D/x  A/x  F/x  E/x  H/x  J/x  I/x  G/x 
    由/p 上/f 节/q 森林/n 与/p 二/m 叉树/n 之间/f 转换/v 的/ude1 规则/n 可知/v ，/wd 当/p 森林/n 转换/v 成/v 二/m 叉树/n 时/ng ，/wd 其/rz 第一/m 棵/q 树/n 的/ude1 子/ng 树/v 森林/n 转换/v 成/v 左子树/nr ，/wd 剩余/vn 树/n 的/ude1 森林/n 转换/v 成/v 右/f 子/ng 树/n ，/wd 则/c 上述/b 森林/n 的/ude1 先/d 序/n 和/cc 中/b 序/n 遍历/n 即/v 为/p 其/rz 对应/vi 的/ude1 二/m 叉树/n 的/ude1 先/d 序/n 和/cc 中/b 序/n 遍历/n 。/wj 若/c 对/p 图/n 6．17/m 中/f 和/cc 森林/n 对应/vi 的/ude1 二/m 叉树/n 分别/d 进行/vx 先/d 序/n 和/cc 中/b 序/n 遍历/n ，/wd 可/c 得/v 和/cc 上述/b 相同/a 的/ude1 序列/n 。/wj 
    由此可见/c ，/wd 当/v 以/p 二/m 叉/n 链/ng 表/n 作/v 树/n 的/ude1 存储/vn 结构/n 时/ng ，/wd 树/v 的/ude1 先/d 根/q 遍历/n 和/cc 后/f 根/n 遍历/n 可/v 借用/v 二/m 叉树/n 的/ude1 先/d 序/n 遍历/n 和/cc 中/b 序/n 遍历/n 的/ude1 算法/n 实现/v 之/uzhi 。/wj 
6．5/m 树/n 与/cc 等价/vn 问题/n 
    在/p 离散/b 数学/n 中/f ，/wd 对/p 等价/vn 关系/n 和/cc 等价/vn 类/n 的/ude1 定义/n 是/vshi ：/wp 
    如果/c 集合/v S/x 中/f 的/ude1 关系/n R/x 是/vshi 自/p 反/vi 的/ude1 、/wn 对称/a 的/ude1 和/cc 传递/v 的/ude1 ，/wd 则/c 称/v 它/rr 为/v 一个/mq 等价/vn 关系/n 。/wj 
    设/v R/x 是/vshi 集合/v s/x 的/ude1 等价/vn 关系/n 。/wj 对/p 任何/rz z∈S/x ，/wd 由/p [/wkz z/x ]/wky R=/x {/n y/x  1/m  3/m ，/wd ∈SzRy/x }/n 给/v 出/vf 的/ude1 集合/n [/wkz z/x ]/wky R∈s/x 称为/v 由/p z∈S/x 生成/v 的/ude1 一个/mq R/x 等价/n 类/q 。/wj 
    若/v R/x 是/vshi 集合/v S/x 上/f 的/ude1 一个/mq 等价/vn 关系/n ，/wd 则/c 由/p 这个/rz 等价/vn 关系/n 可/v 产生/v 这个/rz 集合/n 的/ude1 唯一/b 划分/vn 。/wj 即/d 可以/v 按/p R/x 将/d S/x 划分为若干/n 不/d 相/d 交/v 的/ude1 子集/n S1/x ，/wd S2/x ，/wd …/ws ，/wd 它们/rr 的/ude1 并/cc 即/d 为/v S/x ，/wd 则/c 这些/rz 子集/n Si/x 便/d 称为/v S/x 的/ude1 R/x 等价/n 类/q 。/wj 
    等价/vn 关系/n 是/vshi 现实/a 世界/n 中/f 广泛/ad 存在/v 的/ude1 一/m 种/q 关系/n ，/wd 许多/m 应用/vn 问题/n 可以/v 归结/vi 为/v 按/p 给定/v 的/ude1 等价/vn 关系/n 划分/v 某/rz 集合/n 为/p 等价/n 类/q ，/wd 通常/d 称/v 这/rzv 类/q 问题/n 为/p 等价/vn 问题/n 。/wj 
    例如/v 在/p FORTRAN/x 语言/n 中/f ，/wd 可以/v 利用/v EQUIVNCE/x 语句/n 使/v 数/m 个/q 程序/n 变量/n 共享/v 同一/b 存储单位/n ，/wd 这/rzv 问题/n 实质/n 就是/v 按/p EQtJIVALANCE/x 语句/n 确定/v 的/ude1 关系/n 对/p 程序/n 中/f 的/ude1 变量/n 集合/v 进行/vx 划分/vn ，/wd 所得/n 等价/vn 类/n 的/ude1 数目/n 即/d 为/v 需要/v 分配/v 的/ude1 存储单位/n ，/wd 而/cc 同/p 一/m 等价/vn 类/n 中/f 的/ude1 程序/n 变量/n 可/v 被/pbei 分配/v 到/v 同/p 一/m 存储单位/n 中/f 去/vf 。/wj 此外/c ，/wd 划分/v 等价/vn 类/n 的/ude1 算法/n 思想/n 也/d 可/v 用于/v 求/v 网络/n 的/ude1 最/d 小/a 生成/vn 树/n 等/udeng 图/n 的/ude1 算法/n 中/f 。/wj 
    应/v 如何/ryv 划分/v 等价/vn 类/n 呢/y ?/ww 假设/v 集合/v s/x 有/vyou n/x 个/q 元素/n ，/wd m/x 个/q 形/ng 如/v (/wkz z/x ，/wd y/x )/wky (/wkz z/x ，/wd y∈s/x )/wky 的/ude1 等价/vn 偶/d 对/p 确定/v 了/ule 等价/vn 关系/n R/x ，/wd 需求/n S/x 的/ude1 划分/vn 。/wj 
    确定/v 等价/vn 类/n 的/ude1 算法/n 可/v 如/v 下/f 进行/vx ：/wp 
    (/wkz 1/m )/wky 令/v s/x 中/f 每个/r 元素/n 各自/rr 形成/v 一个/mq 只/d 含/v 单个/b 成员/n 的/ude1 子集/n ，/wd 记/v 作/v S1/x ，/wd S2/x ，/wd …/ws ，/wd S/x 。/wj 
    (/wkz 2/m )/wky 重复/vd 读入/v 脚/n 个/q 偶/d 对/p ，/wd 对/p 每个/r 读入/v 的/ude1 偶/d 对/p (/wkz z/x ，/wd y/x )/wky ，/wd 判定/v z/x 和/cc y/x 所属/n 子集/n 。/wj 不/d 失/v 一般性/n ，/wd 假设/v z∈sy∈sf/x ，/wd 若/c si≠s/x ，/wd ，/wd 则/c 将/d si/x 并入/v si/x 并/cc 置/v si/x 为/v 空/ng (/wkz 或/c 将/d S/x 并入/v si/x 并/cc 置/v S/x 为/v 空/ng )/wky 。/wj 则/c 当/v n/x 个/q 偶/d 对/p 都/d 被/pbei 处理/v 过/uguo 后/f ，/wd s/x ，/wd ，/wd s2/x ，/wd …/ws S/x 。/wj 中/b 所有/b 非/b 空子/n 集/vg 即/d 为/v s/x 的/ude1 R/x 等价/n 类/q 。/wj 
    从/p 上述/b 可见/c ，/wd 划分/v 等价/vn 类/n 需/v 对/p 集合/v 进行/vx 的/ude1 操作/vn 有/vyou 三/m 个/q ：/wp 其一/rz 是/vshi 构造/n 只/d 含/v 单个/b 成员/n 的/ude1 集合/n ；/wf 其二/rz 是/vshi 判定/v 某个/rz 单/b 元素/n 所在/n 子集/n ；/wf 其三/r 是/vshi 归并/vi 两/m 个/q 互不/d 相交/vi 的/ude1 集合/n 为/v 一个/mq 集合/n 。/wj 由此/d ，/wd 需要/v 一个/mq 包含/v 上述/b 三/m 种/q 操作/vn 的/ude1 抽象数据/n 类型/n MFSet/x 。/wj 
ADTFSet/x {/n 
　　数据/n 对象/n ：/wp 若/c 设/v s/x 是/vshi MFSet/x 型/k 的/ude1 集合/n ，/wd 则/c 它/rr 由/p n/x (/wkz n/x >/n 0/m )/wky 个/q 子集/n si/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 构成/v ，/wd 每个/r 子集/n 的/ude1 成员/n 都/d 是/vshi 子/ng 界/n [/wkz 。/wj mLumber/x ]/wky 内/f 的/ude1 整数/n ；/wf 
　　数据/n 关系/n ：/wp s1U/x  S2U/x …/ws Us/x 。/wj =s/x  sics/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 
    基本/ad 操作/v ：/wp 
  Initial/x (/wkz &/n S/x ，/wd n/x ，/wd 。/wj l/x ，/wd X2/x ，/wd …/ws ，/wd )/wky ；/wf 
    操作/v 结果/n ：/wp 初始化操作/n 。/wj 构造/n ～/ws 个/q 由/p n/x 个/q 子集/n (/wkz 每个/r 子集/n 只/d 含/v 单个/b 成员/n x/x 。/wj )/wky 构成/v 的/ude1 集合/n s/x 。/wj   Fiha/x (/wkz s/x ，/wd x/x )/wky ；/wf 
    初始条件/n ：/wp s/x 是/vshi 已/d 存在/v 的/ude1 集合/n ，/wd x/x 是/vshi s/x 中/f 某个/rz 子集/n 的/ude1 成员/n 。/wj 
    操作/v 结果/n ：/wp 查找/v 函数/n 。/wj 确定/v s/x 中/f x/x 所属/n 子集/n s：/x 。/wj 
  Merge/x (/wkz &/n s/x ，/wd i/x ，/wd j/x )/wky ；/wf     
    初始条件/n ：/wp s/x 。/wj 和/cc s/x 。/wj 是/vshi s/x 中/f 的/ude1 两/m 个/q 互不/d 相交/vi 的/ude1 非空/n 集合/v 。/wj 
    操作/v 结果/n ：/wp 归并/vi 操作/v 。/wj 将/p s/x 。/wj 和/cc s/x 、/wn 中/f 的/ude1 一个/mq 并入/v 另/rz 一个/mq 中/f 。/wj 
I/x ^/n MFSet/x ；/wf 
    以/p 集合/v 为/p 基础/n (/wkz 结构/n )/wky 的/ude1 抽象数据/n 类型/n 可/v 用/p 多种/m 实现/v 方法/n ，/wd 如/c 用/v 位/q 向量/n 表示/v 集合/v 或/c 用/p 有序/a 表表示/n 集合/v 等/udeng 。/wj 如何/ryv 高效/d 地/ude2 实现/v 以/p 集合/v 为/p 基础/n 的/ude1 抽象数据/n 类型/n ，/wd 则/c 取决于/v 该/rz 集合/n 的/ude1 大小/n 以及/cc 对/p 此/rzs 集合/v 所/usuo 进行/vx 的/ude1 操作/vn 。/wj 根据/p MFSeT/x 类型/n 中/f 定义/v 的/ude1 操作/vn FIND/x (/wkz S/x ，/wd x/x )/wky 和/cc MERGE/x (/wkz si/x ，/wd sj/x )/wky 的/ude1 特点/n ，/wd 我们/rr 可/v 利用/v 树/n 型/k 结构/n 表示/v 集合/v 。/wj 约定/v ：/wp 以/p 森林/n F=/x (/wkz T1/x ，/wd 2/m ，/wd …/ws ，/wd T/x 。/wj )/wky 表示/v MFSet/x 型/k 的/ude1 集合/n s/x ，/wd 森林/n 中/f 的/ude1 每/rz 一/m 棵/q 树/n Ti/x (/wkz i：l/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 表示/v s/x 中/f 的/ude1 一个/mq 元素/n 子集/n Si/x (/wkz SicS/x ，/wd 卢/b 1/m ，/wd 2/m ，/wd …/ws ，/wd ”/wyy )/wky ，/wd 树/n 中/f 每个/r 结点/n 表示/v 子/ng 集中/v 的/ude1 一个/mq 成员/n z/x ，/wd 为/p 操作方便/n 起见/u ，/wd 令/v 每个/r 结点/n 中/f 含有/v 一个/mq 指向/v 其/rz 双亲/n 的/ude1 指针/n ，/wd 并/cc 约定/vn 根/n 结点/n 的/ude1 成员/n 兼作/n 子集/n 的/ude1 名称/n 。/wj 例如/v ，/wd 图/n 6．18/m (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 中/f 的/ude1 两/m 棵/q 树/n 分别/d 表示/v 子集/n S/x 】/wky =/m {/n 1/m ，/wd 3/m ，/wd 6/m ，/wd 9/m }/n 和/cc S2：/x {/n 2/m ，/wd 8/m ，/wd 10/m }/n 。/wj 
显然/a ，/wd 这样/rzv 的/ude1 树形/n 结构/n 易于/vd 实现/v 上述/b 两/m 种/q 集合/n 的/ude1 操作/vn 。/wj 由于/p 各/rz 子/ng 集中/v 的/ude1 成员/n 均/d 不/d 相同/a ，/wd 则/c 实现/v 集合/v 的/ude1 “/wyz 并/d ”/wyy 操作/vn ，/wd 只要/c 将/p 一/m 棵/q 子集/n 树/n 的/ude1 根/n 指向/v 另/rz 一/m 棵/q 子集/n 树/n 的/ude1 根/n 即可/v 。/wj 例如/v ：/wp 图/n 6．18/m (/wkz c/x )/wky 中/f s3=s/x ，/wd U/x  S2/x 。/wj 同时/c ，/wd 完成/v 找/v 某个/rz 成员/n 所在/n 集合/v 的/ude1 操作/vn ，/wd 只要/c 从/p 该/rz 成员/n 结点/n 出发/vi ，/wd 顺/v 链/ng 而/cc 进/vf ，/wd 直至/v 找到/v 树/n 的/ude1 根/n 结点/n 为止/u 。/wj 
    图/n 6．18/m 集合/n 的/ude1 一/m 种/q 表示法/n 
    (/wkz a/x )/wky S1=/x {/n 1/m ，/wd 3/m ，/wd 6/m ，/wd 9/m }/n ；/wf (/wkz b/x )/wky S2=/x {/n 2/m ，/wd 8/m ，/wd 10/m }/n ；/wf (/wkz c/x )/wky S3：SlU/x  S2/x 。/wj 
为/p 便于实现/n 这样/rzv 两/m 种/q 操作/vn ，/wd 应/v 采用/v 双亲/n 表示法/n 作/v 存储/vn 结构/n ，/wd 如/v 下/f 所/usuo 示/vg 
∥/w …/ws ADT/x  MFSet/x 的/ude1 树/n 的/ude1 双亲/n 表存储/n 表示/v …/ws 
typedef/x  PTree/x   MFSet：/x 
此时/r ，/wd 查找/v 函数/n 和/cc 归并/vi 操作/v 的/ude1 实现/v 如/v 算法/n 6．8/m 和/cc 算法/n 6．9/m 所/usuo 示/vg 。/wj 
int/x  findmfset/x (/wkz MFSet/x  s/x 。/wj int/x  i/x )/wky {/n 
  ∥/w 找/v 集合/v s/x 中/f i/x 所在/n 子集/n 的/ude1 根/n 。/wj 
  if/x (/wkz i/x </n 1/m  ll/x  i/x >/n s．n/x )/wky return/x   1/m ；/wf     ∥/w i/x 不/d 属/v s/x 中/f 任/v 一/m 子集/n 
  for/x (/wkz j=i/x ；/wf s．nodes/x [/wkz j/x ]/wky ．/w parent/x >/n 0/m ；/wf j=s．rlodes/x [/wkz j/x ]/wky ．/w parent/x )/wky ；/wf 
  return/x  j/x ；/wf 
}/n ∥/w findmfset/x 
    算法/n 6．8/m 
Status/x  mergemfset/x (/wkz MFSet/x &/n s/x ，/wd int/x  i/x ，/wd int/x  j/x )/wky {/n 
  ∥/w s．nodes/x [/wkz i/x ]/wky 和/cc s．nodes/x [/wkz j/x ]/wky 分别/d 为/v s/x 的/ude1 互不/d 相交/vi 的/ude1 两/m 个/q 子集/n si/x 和/cc sj/x 的/ude1 根/n 结点/n 。/wj 
  ∥/w 求/v 并/cc 集/vg siUsj/x 。/wj 
  if/x (/wkz i/x </n 1/m  ll/x  i/x >/n s．n/x  ll/x  j/x </n 1/m 《/wkz j/x >/n s．n/x )/wky return/x  ERROR/x ；/wf 
  s．nodes/x [/wkz i/x ]/wky ．/w parent：j/x ；/wf 
  return/x  OK/x ；/wf 
＼l/x }/n merge-mfset/x 
    算法/n 6．9/m 
    算法/n 6．8/m 和/cc 算法/n 6．9/m 的/ude1 时间/n 复杂度/n 分别/d 为/v 0/m (/wkz d/x )/wky 和/cc 0/m (/wkz 1/m )/wky ，/wd 其中/rz d/x 是/vshi 树/n 的/ude1 深度/n 。/wj 从/p 前面/f 的/ude1 讨论/vn 可知/v ，/wd 这种/r 表示/v 集合/v 的/ude1 树/n 的/ude1 深度/n 和/cc 树/n 形成/v 的/ude1 过程/n 有关/vn 。/wj 试看/v 一个/mq 极端/n 的/ude1 例子/n 。/wj 假设/n 有/vyou n/x 个/q 子集/n s1/x ，/wd s2/x ，/wd …/ws ，/wd &/n ，/wd 每个/r 子集/n 只/d 有/vyou 一个/mq 成员/n si=/x {/n i/x }/n 1/m ，/wd …/ws ，/wd n/x ，/wd 可/c 用/v n/x 棵/q 只/d 有/vyou 一个/mq 根/n 结点/n 的/ude1 树/n 表示/v ，/wd 如/v 图/n 6．21/m (/wkz a/x )/wky 表示/v 。/wj 现/tg 作/v n-1/x 次/qv “/wyz 并/d ”/wyy 操作/vn ，/wd 并/cc 假设/n 每次/r 都/d 是/vshi 含/v 成员/n 多/a 的/ude1 根/n 结点/n 指向/v 含/v 成员/n 少/a 的/ude1 根/n 结点/n ，/wd 则/c 最后/f 得到/v 的/ude1 集合/n 树/n 的/ude1 深度/n 为/v n/x ，/wd 如/v 图/n 6．19/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 如果/c 再/d 加上/v 在/p 每/rz 次/qv “/wyz 并/d ”/wyy 操作/vn 之后/f 都/d 要/v 进行/vx 查找/vn 成员/n “/wyz 1/m ”/wyy 所/usuo 在/v 子集/n 的/ude1 操作/vn ，/wd 则/c 全部/m 操作/vn 的/ude1 时间/n 便/d 是/vshi 0/m (/wkz n0/x )/wky 了/y 。/wj 
　　改进/v 的/ude1 办法/n 是/vshi 在/p 作/v “/wyz 并/d ”/wyy 操作/vn 之前/f 先/d 判别/v 子集/n 中/f 所/usuo 含/v 成员/n 的/ude1 数目/n ，/wd 然后/c 令/v 含/v 成员/n 少/a 的/ude1 子集/n 树根/n 结点/n 指向/v 含/v 成员/n 多/a 的/ude1 子集/n 的/ude1 根/n 。/wj 为此/bl ，/wd 需/v 相应/vi 地/ude2 修改/v 存储/vn 结构/n ：/wp 令/v 根/n 结点/n 的/ude1 parent/x 域/n 存储/vn 子集/n 中/f 含/v 成员/n 数目/n 的/ude1 负值/n 。/wj 修改/v 后/f 的/ude1 “/wyz 并/d ”/wyy 操作/vn 算法/n 如/v 算法/n 6.10/m 所/usuo 示/vg 。/wj 
　　void/x …/ws mfset/x (/wkz ~/n IFSet：/x ＆/n s/x ，/wd int/x  1．int/x ]/wky )/wky {/n 
  ∥/w S/x  nos/x [/wkz ，/wd ]/wky S/x  nodes/x [/wkz ]/wky ]/wky 分别/d 为/v S/x 的/ude1 互不/d 相交/vi 
  ∥/w 的/ude1 两/m 个/q 子集/n s1/x 和/cc 0/m ]/wky 的/ude1 根/n 结点/n 。/wj 求/v 并/cc 集/vg siUs3/x 
  if/x (/wkz 1/m </n 1/m  l/x  1/m >/n S/x  n11/x ]/wky </n 1/m 【/wkz I/x  J/x >/n S/x  n1/x 
    rBturn/x  ERR/x ]/wky R：/x 
if/x (/wkz s/x  nodes/x [/wkz 1/m ]/wky i/x ~/n x/x ,/wd ent/x >/n s/x  rms/x [/wkz ]/wky ]/wky 
∥/w si/x 所/usuo 含/v 成员/n 数/n 比/p s/x ]/wky 少/v 
    S/x  nodes/x [/wkz j/x ]/wky parerS/x  nodes/x [/wkz 1/m ]/wky parer/x ；/wf 
    算法/n 6/m  10/m 
图/n 6/m  19/m “/wyz 并/d ”/wyy 操作/vn 的/ude1 一/m 种/q 极端/n 情形/n 
    可以/v 证明/v ，/wd 按/p 算法/n 6/m  10/m 进行/vx “/wyz 并/d ”/wyy 操作/v 得到/v 的/ude1 集合/n 树/n ，/wd 其/rz 深度/n 不/d 超过/v log2/x 。/wj 其中/rz n/x 为/p 集合/v S/x 中/b 所有/b 子集/n 所/usuo 含/v 成员/n 数/n 的/ude1 总和/n 。/wj 
    由此/d ，/wd 利用/v 算法/n find/x  mfset/x 和/cc mix/x  mfset/x 解/v 等价/vn 问题/n 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz ，/wd Jlog/x ”/wyy )/wky (/wkz 当/v 集合/v 中/f 有/vyou ”/wyy 个/q 元素/n 时/ng ，/wd 至多/d 进行/vx ”/wyy 1/m 次/qv mix/x 操作/v )/wky 。/wj 
    例/n 6/m 。/wj 1/m 假设/n 集合/v S=1z/x  l≤/x _/n ≤/m ，/wd j/x 是/vshi 正/b 整数/n }/n ，/wd R/x 是/vshi S/x  l/x 的/ude1 一个/mq 等价/vn 关系/n 。/wj 
    R=/x {/n (/wkz 1/m ，/wd 2/m )/wky ，/wd (/wkz 3/m ，/wd 4/m )/wky ，/wd (/wkz 5/m ，/wd 6/m )/wky ，/wd (/wkz 7/m ，/wd 8/m )/wky ，/wd (/wkz 1/m ，/wd 3/m )/wky ，/wd (/wkz 5/m ，/wd 7/m )/wky ，/wd (/wkz 1/m ，/wd 5/m )/wky ，/wd }/n 
现/tg 求/v s/x 的/ude1 等价/vn 类/n 。/wj 
　　以/p MFSet/x 类型/n 的/ude1 变/v 世/ng S/x 表示/v 集合/v S/x ，/wd S/x 中/b 成员/n 个/q 数/n 为/v S/x  n/x 。/wj 开始/v 时/ng ，/wd 由于/c 每个/r 成员/n 自/rr 成/v 一个/mq 等价/n 类/q ，/wd 则/d S/x  nodes/x [/wkz i/x ]/wky l/x ~/n arent/x 的/ude1 值/n 均/d 为/v ～/ws I/x 。/wj 之后/f ，/wd 每/rz 处理/v 一个/mq 等价/n 偶/d 对/p (/wkz i/x ，/wd J/x )/wky ，/wd 首先/c 必须/d 确定/v i/x 和/cc 各自/rr 所/usuo 属/v 集合/v ，/wd 若/c 这/rzv 两/m 个/q 集合/v 相同/a ．/w 则/c 说明/v 此/rzs 等价/vn 关系/n 足/d 多余/a 的/ude1 ，/wd 无需/v 作/v 处理/v ；/wf 否则/c 就/d 合并/v 这/rzv 两/m 个/q 集合/n 。/wj 图/n 6/m  20/m 展示/v 了/ule 处理/v R/x 中/b 前/f 七/m 个/q 等价/vn 关系/n 时/ng S/x 的/ude1 变化/vn 状况/n (/wkz 图/n 中/f 省去/v T/x 结点/n 的/ude1 数据/n 域/ng )/wky ，/wd 图/n 到/v 6/m  21/m (/wkz a/x )/wky 所/usuo 示/vg 为/v 最后/f 一个/mq S/x 状态/n 相应/vi 的/ude1 树/n 的/ude1 形态/n 。/wj 显然/a ，/wd 随着/p 子集/n 逐/vg 对/p 合并/v ，/wd 树/v 的/ude1 深度/n 也/d 越来越/d 大/a ，/wd 为了/p 进一步/d 减少/v 确定/v 元素/n 所在/n 集合/v 的/ude1 时间/n ，/wd 我们/rr 还/d 可/v 进一步/d 将/p 算法/n 6/m  8/m 改进/v 为/p 算法/n 6/m  ll/x 。/wj 当/p 所/usuo 查/v 元素/n i/x 不/d 在/p 树/n 的/ude1 笫/n 二/m 层/qv 时/ng ，/wd 在/p 算法/n 中/f 增加/v 一个/mq “/wyz 压缩/v 路径/n ”/wyy 的/ude1 功能/n ，/wd 即/d 将/p 所有/b 从/p 根/n 到/v 元素/n i/x 路径/n 上/f 的/ude1 元素/n 都/d 变成/v 树根/n 的/ude1 孩子/n 。/wj 
　　Int/x  fix/x _/n mfset/x (/wkz  MFSet/x  &/n S/x ,/wd  int/x  i/x )/wky  {/n 
  int/x  fix―mfset/x (/wkz MFSet/x ＆/n s/x 。/wj int/x  i/x )/wky {/n 
    ∥/w 确定/v i/x 所在/n 子集/n ，/wd 并/cc 将/d 从/p i/x 至/p 根/n 路径/n 上/f 所有/b 结点/n 都/d 变成/v 根/n 的/ude1 孩子/n 结点/n 。/wj 
    if/x (/wkz i/x </n I．1/x  i/x >/n §．n/x )/wky return-l/x ；/wf     ∥/w i/x 不/d 是/vshi S/x 中/f 任/v 一/m 子集/n 的/ude1 成员/n 
    for/x (/wkz j=i/x ；/wf S．nodes/x [/wkz j/x ]/wky ．/w parent/x >/n 0/m ；/wf j：S．nodes/x [/wkz j/x ]/wky ．/w parent/x )/wky ；/wf 
    for/x (/wkz k=i/x ；/wf k/x !/wt =J/x ；/wf k=t/x )/wky {/n 
    t=S．nodes/x [/wkz k/x ]/wky ．/w parent/x ；/wf S．nodes/x [/wkz k/x ]/wky ．/w parent：J/x ；/wf 
    }/n 
    return/x  J/x ；/wf 
    }/n ∥/w fix-mfset/x 
    算法/n 6．II/x 
S．nodes/x     S．nodes/x     S．nodes/x 
图/n 6．20/m 求/v 等价/n 类/q 过程/n 示例/n ．/w 
    图/n 6．21/m 表示/v 集合/v 的/ude1 树/n 
    (/wkz a/x )/wky 压缩/v 路径/n 之前/f ；/wf (/wkz b/x )/wky 压缩/v 路径/n 之后/f 。/wj 
    假设/v 例/n 6．1/m 中/f R/x 的/ude1 第8/m 个/q 等价/n 偶/d 对/p 为/v (/wkz 8/m ，/wd 9/m )/wky ，/wd 则/c 在/p 执行/v fix/x (/wkz s/x ，/wd 8/m )/wky 的/ude1 操作/vn 之后/f 图/n 6．21/m 
(/wkz a/x )/wky 的/ude1 树/n 就/d 变成/v 图/n 6．21/m (/wkz b/x )/wky 的/ude1 树/n 。/wj 
    已经/d 证明/v ，/wd 利用/v 算法/n fix-mfset/x 和/cc mix-mfset/x 划分/vn 大小/n 为/v t／/x 的/ude1 集合/n 为/p 等价/vn 类/n 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz (/wkz n/x )/wky )/wky 。/wj 其中/rz a/x (/wkz ”/wyy )/wky 是/vshi 一个/mq 增长/v 极其/d 缓慢/a 的/ude1 函数/n ，/wd 若/c 定义/v 单/b 变量/n 的/ude1 阿克曼/nrf 函数/n 为/v A/x (/wkz z/x )/wky ：/wp A/x (/wkz z．/x 。/wj )/wky ，/wd 则/c 函数/n a/x (/wkz n/x )/wky 定义/n 为/v A/x (/wkz z/x )/wky 的/ude1 拟/v 逆/ng ，/wd 即/v a/x (/wkz n/x )/wky 的/ude1 值/n 是/vshi 使/v A/x (/wkz z/x )/wky ≥Y/x 成立/vi 的/ude1 最/d 小/a z/x 。/wj 所以/c ，/wd 对于/p 通常/d 所/usuo 见到/v 的/ude1 正/b 整数/n r／/x 而言/uls ，/wd a/x (/wkz n/x )/wky ≤4/m 。/wj 
    
6．6/m 赫夫曼/nrf 树/n 及其/cc 应用/vn 
    赫夫曼/nrf (/wkz 14uffman/x )/wky 树/n ，/wd 又/d 称/v 最/d 优/ag 树/n ，/wd 是/vshi 一/m 类/q 带权/n 路径长度/n 最/d 短/a 的/ude1 树/n ，/wd 有着/v 广泛/a 的/ude1 应用/vn 。/wj 本/rz 节/n 先/d 讨论/v 最/d 优/ag 二/m 叉树/n 。/wj 
  6．6．1/m 最/d 优/ag 二/m 叉树/n (/wkz 赫夫曼/nrf 树/n )/wky 
  首先/c 给/v 出/vf 路径/n 和/cc 路径长度/n 的/ude1 概念/n 。/wj 从/p 树/n 中/f 一个/mq 结点/n 到/v 另/rz 一个/mq 结点/n 之间/f 的/ude1 分支/n 构成/v 这/rzv 两/m 个/q 结点/n 之间/f 的/ude1 路径/n ，/wd 路径/n 上/f 的/ude1 分支/n 数目/n 称做/v 路径长度/n 。/wj 树/n 的/ude1 路径长度/n 是/vshi 从/p 树根/n 到/v 每/rz 一/m 结点/n 的/ude1 路径长度/n 之和/n 。/wj 6．2．1/m 节/q 中/b 定义/n 的/ude1 完全/a 二/m 叉树/n 就是/v 这种/r 路径长度/n 最/d 短/a 的/ude1 二/m 叉树/n 。/wj 
    若/c 将/p 上述/b 概念/n 推广/v 到/v 一般/a 情况/n ，/wd 考虑/v 带权/n 的/ude1 结点/n 。/wj 结点/n 的/ude1 带权/n 路径长度/n 为/v 从/p 该/rz 结点/n 到/v 树根/n 之间/f 的/ude1 路径长度/n 与/cc 结点/n 上/f 权/n 的/ude1 乘积/n 。/wj 树/n 的/ude1 带权/n 路径长度/n 为/p 树/n 中/b 所有/b 叶子/n 结点/n 的/ude1 带权/n 路径长度/n 之和/n ，/wd 通常/d 记/v 作/v WPZ/x ，/wd =≥：twkl/x ＆/n 。/wj 
    假设/n 有/vyou n/x 个/q 权/n 值/v {/n 1/m ，/wd W2/x ，/wd …/ws ，/wd n/x 。/wj }/n ，/wd 试/v 构造/n 一/m 棵/q 有/vyou n/x 个/q 叶子/n 结点/n 的/ude1 二/m 叉树/n ，/wd 每个/r 叶子/n 结点/n 带权/n 为/v 叫/vi i/x ，/wd 则/c 其中/rz 带权/n 路径长度/n WPI/x ，/wd 最/d 小/a 的/ude1 二/m 叉树/n 称/v 做/v 最/d 优/ag 二/m 叉树/n 或/c 赫夫曼/nrf 树/n 。/wj 
　　例如/v ，/wd 图/n 6．22/m 中/f 的/ude1 三/m 棵/q 二/m 叉树/n ，/wd 都/d 有/vyou 4/m 个/q 叶子/n 结点/n a/x 、/wn b/x 、/wn c/x 、/wn d/x ，/wd 分别/d 带权/n 7/m 、/wn 5/m 、/wn 2/m 、/wn 4/m ，/wd 它们/rr 的/ude1 带权/n 路径长度/n 分别/d 为/v 
　　    (/wkz a/x )/wky WPI/x 。/wj =7×2+5×2+2×2+4×2=36/m 
    (/wkz b/x )/wky WPL/x ，/wd =7×3+5×3+2×1+4×2=46/m 
    (/wkz c/x )/wky WPL/x ，/wd =7×1+5×2+2×3+4×3=35/m 
其中/rz 以/p (/wkz c/x )/wky 树/n 的/ude1 为/p 最/d 小/a 。/wj 可以/v 验证/v ，/wd 它/rr 恰/d 为/v 赫夫曼/nrf 树/n ，/wd 即/v 其/rz 带权/n 路径长度/n 在/p 所有/b 带权/n 为/p 7/m 、/wn 5/m 、/wn 2/m 、/wn 4/m 的/ude1 四/m 个/q 叶子/n 结点/n 的/ude1 二/m 叉树/n 中/f 居/v 最/d 小/a 。/wj 
图/n 6．22/m 具有/v 不同/a 带权/n 路径长度/n 的/ude1 二/m 叉树/n 
　　在/p 解/v 某些/rz 判定/v 问题/n 时/ng ，/wd 利用/v 赫夫曼/nrf 树/v 可以/v 得到/v 最佳/z 判定/v 算法/n 。/wj 例如/v ，/wd 要/v 编制/n 一个/mq 将/p 百分制/n 转换/v 成/v 五/m 级/q 分/v 制/k 的/ude1 程序/n 。/wj 显然/a ，/wd 此程序/n 很/d 简单/a ，/wd 只要/c 利用条件/n 语句/n 便/d 可/v 完成/v 。/wj 如/v ：/wp 
　　if/x (/wkz a/x </n 60/m )/wky b=/x ”/wyy bad/x ”/wyy ；/wf 
else/x  if/x (/wkz a/x </n 70/m )/wky b=/x “/wyz pass/x ”/wyy ；/wf 
    else/x  if/x (/wkz a/x </n 80/m )/wky b=/x ”/wyy general/x “/wyz ：/wp 
    elseif/x (/wkz a/x </n 90/m )/wky b=/x ”/wyy gocrf-：/x 
    e18e/x  b=/x ”/wyy excellent/x ”/wyy ：/wp 
这个/rz 判定/v 过程/n 可以/v 图/n 6．23/m (/wkz a/x )/wky 的/ude1 判定/vn 树来/nr2 表示/v 。/wj 如果/c 上述/b 程序/n 需/v 反复/d 使用/v ，/wd 而且/c 每/rz 次/qv 的/ude1 输入/vn 量/n 很/d 大/a ，/wd 则/c 应/v 考虑/v 上述/b 程序/n 的/ude1 质量/n 问题/n ，/wd 即/v 其/rz 操作/v 所/usuo 需/v 时间/n 。/wj 因为/c 在/p 实际/n 生活/vn 中/f ，/wd 学生/n 的/ude1 成绩/n 在/p 五/m 个/q 等级/n 上/f 的/ude1 分布/vn 是/vshi 不/d 均匀/a 的/ude1 。/wj 假设/v 其/rz 分布规律/n 如下/vn 表/n 所/usuo 示/vg ：/wp 
则/c 80％/m 以上/f 的/ude1 数据/n 需/v 进行/vx 三/m 次/qv 或/c 三/m 次/qv 以上/f 的/ude1 比较/d 才/d 能/v 得/ude3 出/vf 结果/n 。/wj 假定/n 以/p 5/m ，/wd 15/m ，/wd 40/m ，/wd 30/m 和/cc 10/m 为/p 权/n 构造/v 一/m 棵/q 有/vyou 五/m 个/q 叶子/n 结点/n 的/ude1 赫夫曼/nrf 树/n ，/wd 则/c 可/v 得到/v 如/v 图/n 6．23/m (/wkz b/x )/wky 所/usuo 示/vg 的/ude1 判定/vn 过程/n ，/wd 它/rr 可/v 使/v 大部分/m 的/ude1 数据/n 经过/p 较/d 少/a 的/ude1 比较/vn 次数/n 得出/v 结果/n 。/wj 但/c 由于/p 每个/r 判定/v 框/ng 都/d 有/vyou 两/m 次比较/n ，/wd 将/d 这/rzv 两/m 次比较/n 分开/vi ，/wd 我们/rr 得到/v 如/v 图/n 6．23/m (/wkz c/x )/wky 所/usuo 示/vg 的/ude1 判定/vn 树/n ，/wd 按/p 此/rzs 判定/v 树/n 可/v 写/v 出/vf 相应/vi 的/ude1 程序/n 。/wj 假设/v 现有/v 10000/m 个/q 输入/vn 数据/n ，/wd 若/c 按/p 图/n 6．23/m (/wkz a/x )/wky 的/ude1 判定/vn 过程/n 进行/vx 操作/vn ，/wd 则/c 总共/d 需/v 进行/vx 31500/m 次比较/n ；/wf 而/cc 若/c 按/p 图/n 6．23/m (/wkz c/x )/wky 的/ude1 判定/vn 过程/n 进行/vx 操作/vn ，/wd 则/c 总共/d 仅/d 需/v 进行/vx 22000/m 次比较/n 。/wj 
图/n 6．23/m 转换/v 五/m 级/q 分/v 制/k 的/ude1 判定/vn 过程/n 
    那末/c ，/wd 如何/ryv 构造/v 赫/q 夫曼/n 树/n 呢/y ?/ww 赫夫曼/nrf 最/d 早/ad 给/v 出/vf 了/ule 一个/mq 带有/v 一般/a 规律/n 的/ude1 算法/n ，/wd 俗称/v 赫/q 夫曼/n 算法/n 。/wj 现/tg 叙述/v 如下/vi ：/wp 
　　(/wkz 1/m )/wky 根据/p 给定/v 的/ude1 n/x 个/q 权/n 值/v {/n l/x ，/wd 7/m ,/wd 02/m ，/wd …/ws ，/wd 。/wj }/n 构成/v n/x 棵/q 二/m 叉树/n 的/ude1 集合/n F=/x {/n T/x ，/wd ，/wd ，/wd ，/wd …/ws ，/wd T/x 。/wj }/n ，/wd 其中/rz 每/rz 棵/q 二/m 叉树/n Ti/x 中/f 只/d 有/vyou 一个/mq 带权/n 为/v wi/x 的/ude1 根/n 结点/n ，/wd 其/rz 左右/m 子/q 树/n 均/d 空/a 。/wj 
    (/wkz 2/m )/wky 在/p F/x 中/f 选取/v 两/m 棵/q 根/n 结点/n 的/ude1 权/n 值/n 最/d 小/a 的/ude1 树/n 作为/v 左右/m 子/q 树/n 构造/v 一/m 棵/q 新/a 的/ude1 二/m 叉树/n ，/wd 且/c 置/v 新/a 的/ude1 二/m 叉树/n 的/ude1 根/n 结点/n 的/ude1 权/n 值/v 为/p 其/rz 左/a 、/wn 右/f 子/ng 树上/s 根/n 结点/n 的/ude1 权/n 值/v 之和/n 。/wj 
    (/wkz 3/m )/wky 在/p F/x 中/f 删除/v 这/rzv 两/m 棵/q 树/n ，/wd 同时/c 将/d 新/a 得到/v 的/ude1 二/m 叉树/n 加入/v F/x 中/f 。/wj 
    (/wkz 4/m )/wky 重复/v (/wkz 2/m )/wky 和/cc (/wkz 3/m )/wky ，/wd 直到/v F/x 只/d 含/v 一/m 棵/q 树/n 为止/u 。/wj 这/rzv 棵/q 树/n 便是/v 赫夫曼/nrf 树/n 。/wj 
    例如/v ，/wd 图/n 6．24/m 展示/v 了/ule 图/n 6．20/m (/wkz c/x )/wky 的/ude1 赫夫曼/nrf 树/n 的/ude1 构造/vn 过程/n 。/wj 其中/rz ，/wd 根/n 结点/n 上/f 标注/v 的/ude1 数字/n 是/vshi 所/usuo 赋/v 的/ude1 权/n 。/wj 
图/n 6．24/m 赫夫曼/nrf 树/n 的/ude1 构造/vn 过程/n 
  算法/n 的/ude1 具体/a 描述/vn 和/cc 实际/a 问题/n 所/usuo 采用/v 的/ude1 存储/vn 结构/n 有关/vn ，/wd 将/d 留/v 在/p 下/f 节/n 进行/vx 讨论/vn 。/wj 
  6．6．2/m 赫夫曼/nrf 编码/n 
  目前/t ，/wd 进行/vx 快速/d 远/a 距离通信/n 的/ude1 主要/b 手段/n 是/vshi 电报/n ，/wd 即将/d 需/v 传送/v 的/ude1 文字/n 转换/v 成/v 由/p 二进制/n 的/ude1 字符/n 组成/v 的/ude1 字符串/n 。/wj 例如/v ，/wd 假设/v 需/v 传送/v 的/ude1 电文/n 为/v ’/wyy A/x  B/x  AC/x  C/x  D/x  A/x ’/wyy ，/wd 它/rr 只/d 有/vyou 四/m 种/q 字符/n ，/wd 只/d 需/v 两/m 个/q 字符/n 的/ude1 串/n 便/d 可/v 分辨/v 。/wj 假设/n A/x 、/wn B/x 、/wn C/x 、/wn D/x 的/ude1 编码/n 分别/d 为/v 00/m 、/wn 01/m 、/wn 10/m 和/cc 11/m ，/wd 则/c 上述/b 七/m 个/q 字符/n 的/ude1 电文/n 便/d 为/v ’/wyy 00010010101100/m ’/wyy ，/wd 总长/n 14/m 位/q ，/wd 对方/n 接收/v 时/ng ，/wd 可/v 按/p 二/m 位/q 一分/t 进行/vx 译码/n 。/wj 
    当然/d ．/w 在/p 传送/v 电文/n 时/ng ，/wd 希望/v 总长/n 尽可能/d 地/ude2 短/a 。/wj 如果/c 对/p 每个/r 字符/n 设计/vn 长度/n 不等/vi 的/ude1 编码/n ，/wd 且/c 让/v 电文/n 中/f 出现/v 次数较/n 多/a 的/ude1 字符/n 采用/v 尽可能短/n 的/ude1 编码/n ，/wd 则/c 传送/v 电文/n 的/ude1 总长/n 便/d 可/v 减少/v 。/wj 如果/c 设计/v A/x 、/wn B/x 、/wn C/x 、/wn D/x 的/ude1 编码/n 分别/d 为/v 0/m 、/wn 00/m 、/wn 1/m 和/cc 01/m ，/wd 则/c 上述/b 七/m 个/q 字符/n 的/ude1 电文/n 可/v 转换/v 成/v 总长/n 为/p 9/m 的/ude1 字符串/n ’/wyy 000011010/m ’/wyy 。/wj 但是/c ，/wd 这样/rzv 的/ude1 电文/n 无法/vd 翻译/v ，/wd 例如/v 传送/v 过去/vf 的/ude1 字符串/n 中/f 前/f 四/m 个/q 字符/n 的/ude1 子/ng 串/v ’/wyy 0000/m ’/wyy 就/d 可/v 有/vyou 多种/m 译/v 法/n ，/wd 或是/c ’/wyy AAAA/x ’/wyy ，/wd 或是/c ’/wyy ABA/x ’/wyy ，/wd 也/d 可以/v 是/vshi ’/wyy BB/x ’/wyy 等/udeng 。/wj 因此/c ，/wd 若/c 要/v 设计/vn 长短/n 不等/vi 的/ude1 编码/n ，/wd 则/c 必须/d 是/vshi 任/v 一个/mq 字符/n 的/ude1 编码/n 都/d 不/d 是/vshi 另/rz 一个/mq 字符/n 的/ude1 编码/n 的/ude1 前缀/n ，/wd 这种/r 编码/n 称做/v 前缀/n 编码/n 。/wj 
    可以/v 利用/v 二/m 叉树/n 来/vf 设计/v 二进制/n 的/ude1 前缀/n 编码/n 。/wj 假设/n 有/vyou 一/m 棵/q 如/v 图/n 6．25/m 所/usuo 示/vg 的/ude1 二/m 叉树/n ，/wd 其/rz 四/m 个/q 叶子/n 结点/n 分别/d 表示/v A/x 、/wn B/x 、/wn c/x 、/wn D/x 四/m 个/q 字符/n ，/wd 且/c 约定/v 左/a 分支/n 表示字符/n ’/wyy 0/m ’/wyy ，/wd 右/f 分支/n 表示字符/n ’/wyy 1/m ’/wyy ，/wd 则/c 可以/v 从/p 根/n 结点/n 到/v 叶子/n 结点/n 的/ude1 路径/n 上/f 分支/n 字符/n 组成/v 的/ude1 字符串/n 作为/p 该/rz 叶子/n 结点/n 字符/n 的/ude1 编码/n 。/wj 读者/n 可以/v 证明/v ，/wd 如此/rzv 得到/v 的/ude1 必/d 为/v 二进制/n 前缀/n 编码/n 。/wj 如/c 由/p 图/n 6．25/m 所/usuo 得/v A/x 、/wn B/x 、/wn C/x 、/wn D/x 
的/ude1 二进制/n 前缀/n 编码/n 分别/d 为/v 0/m 、/wn 10/m 、/wn 110/m 和/cc 111/m 。/wj 
    又/d 如何/ryv 得到/v 使/v 电文/n 总长/n 最/d 短/a 的/ude1 二进制/n 前缀/n 编码/n 呢/y ?/ww 假设/n 每种/r 字符/n 在/p 电文/n 中/f 出现/v 的/ude1 次数/n 为/v wi/x ，/wd 其/rz 编码长度/n 为/v zi/x ，/wd 电/n 文/ng 中/f 只/d 有/vyou n/x 种/q 字符/n ，/wd 则/c 电文/n 总长/n 为/v ∑wili/x 。/wj 对/p 应/v 到/v 二/m 叉/n 树上/s ，/wd 若/c 置/v wi/x 为/p 叶子/n 结点/n 的/ude1 权/n ，/wd zi/x 恰/d 为/v 从/p 根/n 到/v 叶子/n 的/ude1 路径长度/n 。/wj 则/c ∑wili/x 恰/d 为/v 二/m 叉/n 树上/s 带权/n 路径长度/n 。/wj 由此可见/c ，/wd 设计/v 电文/n 总长/n 最/d 短/a 的/ude1 二进制/n 前缀/n 编码/n 即/d 为/v 以/p n/x 种/q 字符/n 出现/v 的/ude1 频率/n 作/v 权/n ，/wd 设计/v 一/m 棵/q 赫/q 夫曼/n 树/n 的/ude1 问题/n ，/wd 由此/d 得/ude3 到/v 的/ude1 二进制/n 前缀/n 编码/n 便/d 称为/v 赫夫曼/nrf 编码/n 。/wj 
图/n 6．25/m 前缀/n 编码/vn 示例/n 
  下面/f 讨论/v 具体/a 做法/n 。/wj 
  由于/p 赫夫曼/nrf 树/n 中/f 没/d 有/vyou 度/ng 为/v 1/m 的/ude1 结点/n (/wkz 这/rzv 类/q 树/n 又/d 称/v 严格/a 的/ude1 (/wkz strict/x )/wky (/wkz 或/c 正/d 则/d 的/ude1 )/wky 二/m 叉树/n )/wky ，/wd 则/c 一/m 棵/q 有/vyou n/x 个/q 叶子/n 结点/n 的/ude1 赫夫曼/nrf 树/n 共/d 有/vyou 2n/x 一/m 1/m 个/q 结点/n ，/wd 可以/v 存储/v 在/p 一个/mq 大/a 小/a 为/v 2n/x ～/ws 1/m 的/ude1 一/m 维/q 数组/n 中/f 。/wj 如何/ryv 选定/v 结点/n 结构/n ?/ww 由于/c 在/p 构成/v 赫/q 夫曼/n 树/n 之后/f ，/wd 为/p 求/v 编码/n 需/v 从/p 叶子/n 结点/n 出发/vi 走/v 一/m 条/q 从/p 叶子/n 到/v 根/n 的/ude1 路径/n ；/wf 而/cc 为/p 译码/n 需/v 从/p 根/n 出发/vi 走/v 一/m 条/q 从/p 根/n 到/v 叶子/n 的/ude1 路径/n 。/wj 则/c 对/p 每个/r 结点/n 而言/uls ，/wd 既/c 需/v 知/v 双亲/n 的/ude1 信息/n ，/wd 又/d 需/v 知/v 孩子/n 结点/n 的/ude1 信息/n 。/wj 由此/d ，/wd 设/v 定下/v 述/vg 存储/vn 结构/n ：/wp 
∥/w ～/ws 赫/q 夫曼/n 树/n 和/cc 赫夫曼/nrf 编码/n 的/ude1 存储表示/n 
t/x ~/n pedef/x  struct/x {/n 
  unsigned/x  int/x  weight/x ；/wf 
  unsigned/x  int/x  parent/x ，/wd ichild/x ，/wd rchild/x ；/wf 
}/n HTNode/x ，/wd */n HuffmanTree/x ；/wf     ∥/w 动态分配/n 数组/n 存储/vn 赫/q 夫曼/n 树/n 
t/x ~/n oedef/x  char/x */n */n HuffmanCode/x ；/wf ／／/m 动态分配/n 数组/n 存储/vn 赫/q 夫曼编码/n 表/n 
求赫/nr2 夫曼编码/n 的/ude1 算法/n 如/v 算法/n 6．12/m 所/usuo 示/vg 。/wj 
void/x  HuffmanCodinq/x (/wkz HuffmanTree/x &/n HT/x ，/wd HuffmanCode/x &/n HC/x ，/wd int/x */n w/x ，/wd ／nt/x  n/x )/wky {/n 
  ∥/w W/x 存放/v n/x 个/q 字符/n 的/ude1 权/n 值/n (/wkz 均/d >/n 0/m )/wky ，/wd 构造/v 赫/q 夫曼/n 树/n HT/x ，/wd 并/cc 求/v 出/vf n/x 个/q 字符/n 的/ude1 赫夫曼/nrf 编码/n HC/x 。/wj 
  if/x (/wkz n/x </n =1/m )/wky return/x ；/wf 
  m=2/x */n n/x 一/m 1：/m 
  }/n rr=/x (/wkz HuffmanTree/x )/wky malloc/x (/wkz (/wkz m+1/x )/wky */n sizeof/x (/wkz HTNode/x )/wky )/wky ；/wf   ∥/w 0/m 号/q 单元未/n 用/v 
  for/x (/wkz P=HT/x ，/wd i=1/x ；/wf i/x </n =n/x ；/wf ++i/x ，/wd ++P/x ，/wd ++w/x )/wky   */n P=/x {/n */n W/x ，/wd 0/m ，/wd 0/m ，/wd 0/m }/n ；/wf 
  for/x (/wkz ；/wf i/x </n =m/x ；/wf ++i/x ，/wd +/m ’/wyy P/x )/wky   ”/wyy P=/x {/n 0/m ，/wd 0/m ，/wd 0/m ，/wd 0/m }/n ；/wf 
  for/x (/wkz i=n+I/x ；/wf i/x </n =m/x ；/wf +十i/x )/wky {/n     ∥/w 建/v 赫/q 夫曼/n 树/n 
    ∥/w 在/p HT/x [/wkz 1．．i-I/x ]/wky 选择/v parent/x 为/p 0/m 且/c weight/x 最/d 小/a 的/ude1 两/m 个/q 结点/n ，/wd 其/rz 序号/n 分别/d 为/v s1/x 和/cc s2/x 。/wj 
    Select/x (/wkz HT/x ，/wd i-l/x 。/wj sl/x ，/wd s2/x )/wky ；/wf 
    HTl/x  s1/x  J．parent：i/x ；/wf HT/x [/wkz s2/x ]/wky ．/w parent=i/x ；/wf 
    HT/x 【/wkz i/x  J．ichild=sl/x ；/wf HT/x [/wkz ij．rchild=s2/x ；/wf 
    HIr/x [/wkz i/x ]/wky ．/w weight=HT/x [/wkz s1/x ]/wky ．/w Weight+/x [/wkz s2/x ]/wky ．/w weight/x ；/wf 
  l/x 
  //n //n 从/p 叶子/n 到/v 根/n 逆向/d 求/v 每个/r 字符/n 的/ude1 赫夫曼/nrf 编码/n 
  HC：/x (/wkz HuffmanCede/x )/wky malloc/x (/wkz (/wkz n+1/x )/wky */n sizeof/x (/wkz char/x */n )/wky )/wky ；/wf   ∥/w 分配/v n/x 个/q 字符/n 编码/n 的/ude1 头/n 指针/n 向量/n 
  cd=/x (/wkz char/x */n )/wky malloc/x (/wkz n/x */n sizeof/x (/wkz char/x )/wky )/wky ；/wf     ∥/w 分配/v 求/v 编码/n 的/ude1 工作空间/n 
  cd/x [/wkz n-1/x ]/wky =/m ”/wyy ＼0/m ”/wyy ；/wf     ／／/m 编码/n 结束符/n 。/wj 
  for/x (/wkz i=1/x ；/wf i/x </n =n/x ；/wf ++i/x )/wky I/x     ∥/w 逐个/d 字符/n 求/v 赫/q 夫曼编码/n 
    start=n-1/x ；/wf     ∥/w 编码/n 结束符/n 位置/n 
    for/x (/wkz c/x 。/wj i/x ，/wd f=HT/x [/wkz i/x ]/wky ．/w parent/x ；/wf f/x !/wt =0/m ；/wf C=f/x ，/wd f=HT/x [/wkz f/x ]/wky ．/w parent/x )/wky ∥/w 从/p 叶子/n 到/v 根/n 逆向/d 求/v 编码/n 
    if/x (/wkz HT/x [/wkz f/x ]/wky ．/w ichild=/x ；/wf C/x )/wky cd/x [/wkz --/wp start/x ]/wky =/m ”/wyy 0/m “/wyz ；/wf 
    else/x  cd/x [/wkz --/wp start/x ]/wky ：/wp “/wyz 1/m ”/wyy ；/wf 
    HC/x [/wkz ij/x 。/wj (/wkz char/x */n )/wky malloc/x (/wkz (/wkz n-start/x )/wky */n sizeof/x (/wkz char/x )/wky )/wky ；/wf ／／/m 为/p 第/m i/x 个/q 字符/n 编码分配/n 空间/n 
    strcpy/x (/wkz HC/x [/wkz i/x ]/wky ，/wd &/n cd/x [/wkz start/x ]/wky )/wky ；/wf     ∥/w 从/p cd/x 复制/vn 编码/n (/wkz 串/q )/wky 到/v Hc/x 
  }/n 
  free/x (/wkz cd/x )/wky ；/wf     ／／/m 释放/v 工作空间/n 
、/wn f/x ?/ww HuffanCoding/x 
    算法/n 6．12/m 
向量/n HT/x 的/ude1 前/f ”/wyy 个/q 分量/n 表示/v 叶子/n 结点/n ，/wd 最后/f 一个/mq 分量/n 表示/v 根/n 结点/n 。/wj 各/rz 字符/n 的/ude1 编码长度/n 不等/vi ，/wd 所以/c 按/p 实际/n 长度/n 动态分配/n 空间/n 。/wj 在/p 算法/n 6．12/m 中/f ，/wd 求/v 每个/r 字符/n 的/ude1 赫夫曼/nrf 编码/n 是/vshi 从/p 叶子/n 到/v 根/n 逆向/d 处理/v 的/ude1 。/wj 也/d 可以/v 从/p 根/n 出发/vi ，/wd 遍历/n 整/m 棵/q 赫/q 夫曼/n 树/n ，/wd 求得/v 各个/rz 叶子/n 结点/n 所/usuo 表示/v 的/ude1 字符/n 的/ude1 赫夫曼/nrf 编码/n ，/wd 如/v 算法/n 6．13/m 所/usuo 示/vg 。/wj 
∥/w 无/v 栈/ng 非/b 递归/n 遍历/n 赫/q 夫曼/n 树/n ，/wd 求/v 赫/q 夫曼编码/n 
HC=/x (/wkz HuffmanCode/x )/wky malloc/x (/wkz (/wkz n+1/x )/wky */n sizeof/x (/wkz char/x */n )/wky )/wky ；/wf 
P：m/x ；/wf cdlen=0/x ；/wf 
for/x (/wkz i=1/x ；/wf i/x </n =m/x ；/wf ++i/x )/wky HT/x [/wkz i/x ]/wky ．/w weight：0/x ；/wf ∥/w 遍历/n 赫/q 夫曼/n 树/n 时/ng 用作/v 结点/n 状态/n 标志/n 
while/x (/wkz P/x )/wky {/n 
  if/x (/wkz HT/x [/wkz p/x ]/wky ．/w weight==0/x )/wky {/n     ∥/w 向/p 左/a 
    HT/x [/wkz Pj．weight=1/x ；/wf 
    if/x (/wkz }/n rr/x [/wkz p/x ]/wky ．/w ichild/x !/wt =0/m )/wky {/n P=HT/x [/wkz p/x ]/wky ．/w ichild/x ；/wf cd/x [/wkz cdlen++/x ]/wky =/m ”/wyy 0/m ”/wyy ；/wf }/n 
    else/x  if/x (/wkz HT/x [/wkz p/x ]/wky ．/w rchild：=0/x )/wky {/n     ∥/w 登记/vn 叶子/n 结点/n 的/ude1 字符/n 的/ude1 编码/n 
    HC/x [/wkz p/x ]/wky ：/wp (/wkz char/x */n )/wky aalloc/x (/wkz (/wkz cdlen+1/x )/wky */n sizeof/x (/wkz char/x )/wky )/wky ；/wf 
    cd/x [/wkz cdlen/x ]/wky =/m ”/wyy ＼0/m ”/wyy ；/wf strcpy/x (/wkz HC/x [/wkz p/x ]/wky ，/wd cd/x )/wky ；/wf     ∥/w 复制/v 编码/n (/wkz 串/q )/wky 
    I/x 
    }/n 
    else/x  if/x (/wkz HT/x [/wkz p/x ]/wky ．/w weight：：1/x )/wky {/n     ∥/w 向/p 右/f 
   [/wkz pJ．weight=2/x ；/wf 
    if/x (/wkz }/n rr/x [/wkz p/x ]/wky ．/w rchild/x !/wt =0/m )/wky {/n P=HT/x [/wkz p/x ]/wky ．/w rchild/x ；/wf cd/x [/wkz cdlen++/x ]/wky =/m ”/wyy 1/m “/wyz ；/wf }/n 
    }/n else/x {/n     ∥/w HT/x [/wkz p/x ]/wky ．/w weight==2/x ，/wd 退回/v 
    }/n rr/x [/wkz p/x ]/wky ．/w weight=0/x ；/wf P=HT/x [/wkz p/x ]/wky ．/w parent/x ；/wf --/wp cdlen/x ；/wf ∥/w 退/v 到/v 父/ng 结点/n ，/wd 编码长度/n 减/v 1/m 
    ＼/m |/n }/n else/x     
}/n ∥/w While/x 
    算法/n 6．13/m 
    图/n 6．26/m 例/q 6-2/m 的/ude1 赫夫曼/nrf 树/n 
    译码/n 的/ude1 过程/n 是/vshi 分解/v 电/n 文中/s 字符串/n ，/wd 从/p 根/n 出发/vi ，/wd 按/p 字符/n ～/ws 0/m 或/c ～/ws 1/m 确定/v 找/v 左/a 孩子/n 或/c 右/f 孩子/n ，/wd 直至/v 叶子/n 结点/n ，/wd 便/d 求得/v 该/rz 子/ng 串/v 相应/vi 的/ude1 字符/n 。/wj 具体/a 算法/n 留给/v 读者/n 去/vf 完成/v 。/wj 
    例/n 6-2/m   已/d 知/v 某/rz 系统/n 在/p 通信/vn 联络/vn 中/f 只/d 可能/v 出现/v 八/m 种/q 字符/n ，/wd 其/rz 频率/n 分别/d 为/v 0．05/m ，/wd 0．29/m ，/wd 0．07/m ，/wd 0．08/m ，/wd 0．14/m ，/wd 0．23/m ，/wd 0．03/m ，/wd 0．11/m ，/wd 试/v 设计/v 赫/q 夫曼编码/n 。/wj 
    设/v 权/n =/m (/wkz 5/m ，/wd 29/m ，/wd 7/m ，/wd 8/m ，/wd 14/m ，/wd 23/m ，/wd 3/m ，/wd 11/m )/wky ，/wd ：/wp 8/m ，/wd 则/d 优/ag =15/m ，/wd 按/p 上述/b 算法/n 可/v 构造/n 一/m 棵/q 赫/q 夫曼/n 树/n 如/v 图/n 6．26/m 所/usuo 示/vg 。/wj 其/rz 存储/vn 结构/n HT/x 的/ude1 初始状态/n 如/v 图/n 6．27/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 其/rz 终结/vn 状态/n 如/v 图/n 6．27/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 所得/n 赫/q 夫曼编码/n 如/v 图/n 6．27/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 
图/n 6．27/m 例/q 6-2/m 的/ude1 存储/vn 结构/n 
    (/wkz a/x )/wky HT/x 的/ude1 初态/n ；/wf 
    (/wkz b/x )/wky HT/x 的/ude1 终/vg 态/ng ；/wf 
    (/wkz c/x )/wky 赫夫曼/nrf 编码/n HC/x 
6．7/m 回溯/vn 法/n 与/cc 树/n 的/ude1 遍历/n 
    在/p 程序设计/n 中/f ，/wd 有/vyou 相当/d 一/m 类/q 求/v 一/m 组/q 解/v 、/wn 或/c 求/v 全部/m 解/v 或/c 求/v 最/d 优/ag 解/v 的/ude1 问题/n ，/wd 例如/v 读者/n 熟悉/v 的/ude1 八/m 皇后/n 问题/n 等/udeng ，/wd 不/d 是/vshi 根据/p 某种/rz 确定/v 的/ude1 计算/vn 法则/n ，/wd 而是/c 利用/v 试探/v 和/cc 回溯/v (/wkz Backtracking/x )/wky 的/ude1 搜索/vn 技术/n 求解/vi 。/wj 回溯/v 法/n 也/d 是/vshi 设计/v 递归/n 过程/n 的/ude1 一/m 种/q 重要/a 方法/n ，/wd 它/rr 的/ude1 求解/vi 过程/n 实质/n 上/f 是/vshi 一个/mq 先/d 序/n 遍历/n 一/m 棵/q “/wyz 状态/n 树/n ”/wyy 的/ude1 过程/n ，/wd 只/d 是/vshi 这/rzv 棵/q 树/n 不/d 是/vshi 遍历/n 前/f 预先/d 建立/v 的/ude1 ，/wd 而是/c 隐含/v 在/p 遍历/n 过程/n 中/f ，/wd 但/c 如果/c 认识/v 到/v 这/rzv 点/qt ，/wd 很多/m 问题/n 的/ude1 递归/n 过程/n 设计/vn 也/d 就/d 迎刃而解/vl 了/y 。/wj 为了/p 说明/v 问题/n ，/wd 先/d 看/v 一个/mq 简单/a 例子/n 。/wj 
    例/n 6．3/m 求/v 含/v n/x 个/q 元素/n 的/ude1 集合/n 的/ude1 幂/n 集/vg 。/wj 
    集合/v A/x 的/ude1 幂/n 集/vg 是/vshi 由/p 集合/v A/x 的/ude1 所有/b 子集/n 所/usuo 组成/v 的/ude1 集合/n 。/wj 如/v ：/wp A=f1/x ，/wd 2/m ，/wd 3/m }/n ，/wd 则/d A/x 的/ude1 幂/n 集/vg 
    p/x (/wkz A/x )/wky =/m {/n {/n l/x ，/wd 2/m ，/wd 3/m }/n ，/wd {/n 1/m ，/wd 2/m }/n ，/wd {/n 1/m ，/wd 3/m }/n ，/wd {/n 1/m }/n ，/wd {/n 2/m ，/wd 3/m }/n ，/wd {/n 2/m }/n ，/wd {/n 3/m }/n ，/wd }/n     (/wkz 6―6/m )/wky 
　　当然/d ，/wd 可以/v 用/p 5．7/m 节/q 介绍/v 的/ude1 分治/vn 法/n 来/vf 设计/v 这个/rz 求/v 幂/n 集/vg 的/ude1 递归/n 过程/n 。/wj 在/p 此/rzs ，/wd 从/p 另/rz 一/m 角度/n 分析/vn 问题/n 。/wj 幂/n 集/vg 的/ude1 每个/r 元素/n 是/vshi 一个/mq 集合/n ，/wd 它/rr 或/c 是/vshi 空/a 集/ng ，/wd 或/c 含/v 集合/v A/x 中/f 一个/mq 元素/n ，/wd 或/c 含/v 集合/v A/x 中/f 两/m 个/q 元素/n ，/wd 或/c 等于/v 集合/v A/x 。/wj 反之/c ，/wd 从/p 集合/v A/x 的/ude1 每个/r 元素/n 来看/u ，/wd 它/rr 只/d 有/vyou 两/m 种/q 状态/n ：/wp 它/rr 或/c 属/v 幂/n 集/vg 的/ude1 元素/n 集/vg ，/wd 或/c 不/d 属/v 幂/n 集元素/n 集/vg 。/wj 则/c 求/v 幂/n 集/vg iD/x (/wkz A/x )/wky 的/ude1 元素/n 的/ude1 过程/n 可/v 看成/v 是/vshi 依次/d 对/p 集合/v A/x 中/b 元素/n 进行/vx “/wyz 取/v ”/wyy 或/c “/wyz 舍/v (/wkz 弃/vg )/wky ”/wyy 的/ude1 过程/n ，/wd 并且/c 可以/v 用/p 一/m 棵/q 如/v 图/n 6．28/m 所/usuo 示/vg 的/ude1 二/m 叉树/n ，/wd 来/vf 表示/v 过程/n 中/b 幂/n 集元素/n 的/ude1 状态/n 变化/vn 状况/n ，/wd 树/n 中/f 的/ude1 根/n 结点/n 表示/v 幂/n 集元素/n 的/ude1 初始状态/n (/wkz 为/v 空/ng 集/vg )/wky ；/wf 叶子/nr 结点/n 表示/v 它/rr 的/ude1 终结/vn 状态/n (/wkz 如/v 图/n 6．28/m 中/f 8/m 个/q 叶子/n 结点/n 表示/v 式/k (/wkz 6．6/m )/wky 中/f 幂/n 集/vg fD/x (/wkz A/x )/wky 的/ude1 8/m 个/q 元素/n )/wky ；/wf 而/cc 第/m i/x (/wkz 1/m ，/wd 2/m ，/wd 3/m ，/wd …/ws ，/wd n-1/x )/wky 层/n 的/ude1 分支/n 结点/n ，/wd 则/c 表示/v 已/d 对/p 集合/v A/x 中/b 前/f i-1/x 个/q 元素/n 进行/vx 了/ule 取/v ／/w 舍/v 处理/v 的/ude1 当前/t 状态/n (/wkz 左/f 分支/n 表示/v “/wyz 取/v ”/wyy ，/wd 右/f 分支/n 表示/v “/wyz 舍/v ”/wyy )/wky 。/wj 因此/c 求/v 幂/n 集元素/n 的/ude1 过程/n 即/d 为/v 先/ag 序/n 遍历/n 这/rzv 棵/q 状态/n 树/n 的/ude1 过程/n ，/wd 如/v 算法/n 6．14/m 所/usuo 描述/v 。/wj 
6．28/m 幂/n 集元素/n 在/p 生成/v 过程/n 中/f 的/ude1 状态/n 图/n 
vold/x  Powerset/x (/wkz 如/v ．/w t/x  i/x ，/wd int/x  n/x )/wky {/n 
  ∥/w 求/v 含/v n/x 个/q 元素/n 的/ude1 集合/n A/x 的/ude1 幂/n 集/vg P/x (/wkz A/x )/wky 。/wj 进入/v 函数/n 时/ng 已/d 对/p A/x 中/b 前/f i/x 一/m 1/m 个/q 元素/n 作/v 了/ule 取舍/vn 处理/vn ，/wd 
  ∥/w 现/tg 从/p 第/m i/x 个/q 元素/n 起/vf 进行/vx 取舍/vn 处理/vn 。/wj 若/v i/x >/n n/x ，/wd 则/c 求得/v 幂/n 集/vg 的/ude1 一个/mq 元素/n ，/wd 并/cc 输出/v 之/uzhi 。/wj 
  ∥/w 初始/t 调用/v ：/wp PowerSet/x (/wkz 1/m ，/wd n/x )/wky ；/wf 
  if/x (/wkz i/x >/n n/x )/wky 输出/v 幂/n 集/vg 的/ude1 一个/mq 元素/n ；/wf 
  else/x  j/x 取/v 第/m i/x 个/q 元素/n ；/wf PowerSet/x (/wkz i+1/x ，/wd n/x )/wky ；/wf 
    舍/v 第/m i/x 个/q 元素/n ；/wf PowerSet：/x (/wkz i+1/x ，/wd n/x )/wky ；/wf 
    }/n 
＼fI/x  PowerSet/x 
    算法/n 6．14/m ‘/wyz 
    对/p 算法/n 6．14/m 求/v 精/ad 需/v 确定/v 数据/n 结构/n 。/wj 假设/v 以/p 线性/n 表表示/n 集合/v ，/wd 则/c 求/v 精/a 后/f 的/ude1 算法/n 如/v 算法/n 6．15/m 所/usuo 示/vg 。/wj 
Vold/x  GetPowerSet/x (/wkz int/x  i/x ，/wd List/x  A/x ，/wd L1st/x ＆/n B/x )/wky {/n 
    ∥/w 线性/n 表/n A/x 表示/v 集合/v A/x ，/wd 线性/n 表/n B/x 表示/v 幂/n 集/vg p/x (/wkz A/x )/wky 的/ude1 一个/mq 元素/n 。/wj 
    ∥/w 局部/n 量/n k/x 为/p 进入/v 函数/n 时/ng 表/n B/x 的/ude1 当前/t 长度/n 。/wj 第一/m 次/qv 调用/v 本/rz 函数/n 时/ng ，/wd B/x 为/p 空/a 表/n 。/wj i=1/x 。/wj 
    if/x (/wkz i/x >/n ListLength/x (/wkz A/x )/wky )/wky Output/x (/wkz B/x )/wky ；/wf   ∥/w 输出/v 当前/t B/x 值/n 。/wj 即/v p/x (/wkz A/x )/wky 的/ude1 一个/mq 元素/n 
    e18e/x {/n GetEl/x (/wkz A/x ，/wd i/x ，/wd x/x )/wky ；/wf     k：ListLength/x (/wkz B/x )/wky ；/wf 
    Listlnserlt/x (/wkz B/x ，/wd k+1/x ，/wd x/x )/wky ；/wf     GetPowerSet/x (/wkz i+1/x ，/wd A/x ，/wd B/x )/wky ；/wf 
    ListDelete/x (/wkz B/x ，/wd k+l/x ，/wd x/x )/wky ；/wf     GetPowerSet/x (/wkz i+1/x ，/wd A/x ，/wd B/x )/wky ；/wf 
    }/n 
  }/n ∥/w Get：P0werset/x 
    算法/n 6/m 。/wj 15/m 
    图/n 6．28/m 中/f 的/ude1 状态/n 变化/vn 树/n 是/vshi 一/m 棵/q 满/a 二/m 叉树/n ，/wd 树/n 中/f 每个/r 叶子/n 结点/n 的/ude1 状态/n 都/d 是/vshi 求解/vi 过程/n 中/f 可能/v 出现/v 的/ude1 状态/n (/wkz 即/v 问题/n 的/ude1 解/v )/wky 。/wj 然而/c 很多/m 问题/n 用/p 回溯/vn 和/cc 试探/v 求解/vi 时/ng ，/wd 描述/v 求解/vi 过程/n 的/ude1 状态/n 树/n 不/d 是/vshi 一/m 棵/q 满/a 的/ude1 多/a 叉树/n 。/wj 当/p 试探/v 过程/n 中/f 出现/v 的/ude1 状态/n 和/cc 问题/n 所/usuo 求解/vi 产生/v 矛盾/an 时/ng ，/wd 不再/d 继续/v 试探/v 下去/vf ，/wd 这时/rzt 出现/v 的/ude1 叶子/n 结点/n 不/d 是/vshi 问题/n 的/ude1 解/v 的/ude1 终结/vn 状态/n 。/wj 这/rzv 类/q 问题/n 的/ude1 求解/vi 过程/n 可/v 看成/v 是/vshi 在/p 约束/vn 条件/n 下/f 进行/vx 先/d 序/n (/wkz 根/n )/wky 遍历/n ，/wd 并/cc 在/p 遍历/n 过程/n 中/f 剪/v 去/vf 那些/rz 不/d 满足条件/n 的/ude1 分支/n 。/wj 
　　例/n 6―4/m 求/v 四/m 皇后/n 问题/n 的/ude1 所有/b 合法/a 布局/n (/wkz 作为/v 例子/n ，/wd 我们/rr 将/d 八/m 皇后/n 问题/n 简化/v 为/p 四/m 皇后/n 问题/n )/wky 。/wj 
　　6．29/m   四/m 皇后/n 问题/n 的/ude1 棋盘/n 状态/n 树/n 
    图/n 6．29/m 展示/v 求解/vi 过程/n 中/b 棋盘/n 状态/n 的/ude1 变化情况/n j/x 这/rzv 是/vshi 一/m 棵/q 四/m 又/d 树/v ，/wd 树/n 上/f 每个/r 结点/n 表示/v 一个/mq 局部/n 布局/n 或/c 一个/mq 完整/a 的/ude1 布局/n 。/wj 根/n 结点/n 表示/v 棋盘/n 的/ude1 初始状态/n ：/wp 棋盘/n 上/f 任何/rz 棋子/n ，/wd 每个/r (/wkz 皇后/n )/wky 棋子/n 都/d 有/vyou 四/m 个/q 可/v 选择/v 的/ude1 位置/n ，/wd 但/c 在/p 任何/rz 时刻/n ，/wd 棋盘/n 的/ude1 合法/a 布局/n 都/d 必须/d 满足/v 三/m 个/q 约束/vn 条件/n ，/wd 即/v 任何/rz 两/m 个/q 棋子/n 都/d 不/d 占据/v 棋盘/n 上/f 的/ude1 同/p 一/m 行/q 、/wn 或者/c 同/p 一/m 列/q 、/wn 或者/c 同一/b 对角线/n 。/wj 图/n 6．29/m 中/f 除/p 结点/n a/x 之外/f 的/ude1 叶子/n 结点/n 都/d 是/vshi 不/d 合法/a 的/ude1 布局/n 。/wj 
    求/v 所有/b 合法/a 布局/n 的/ude1 过程/n 即/d 为/v 在/p 上述/b 约束/vn 条件/n 下/f 先/d 根/q 遍历/n 图/n 6．29/m 的/ude1 状态/n 树/n 的/ude1 过程/n ，/wd 遍历/n 中/f 访问/v 结点/n 的/ude1 操作/vn 为/v ，/wd 判别/v 棋盘/n 上/f 是否/v 已/d 得到/v 一个/mq 完整/a 的/ude1 布局/n (/wkz 即/v 棋盘/n 上/f 是否/v 已/d 摆/v 上/vf 四/m 个/q 棋子/n )/wky ，/wd 若/c 是/vshi ，/wd 则/c 输出/v 该/rz 布局/n ；/wf 否则/c 依次/d 先/d 根/n 遍历/n 满足约束条件/n 的/ude1 各/rz 棵子/n 树/n ，/wd 即/d 首先/d 判断/v 该/rz 子/ng 树根/n 的/ude1 布局/n 是否/v 合法/a ，/wd 若/c 合法/a ，/wd 则/c 先/d 根/q 遍历/n 该/rz 子/ng 树/n ，/wd 否则/c 剪/v 去/vf 该/rz 子/ng 树/v 分支/n 。/wj 算法/n 6．16/m 为/p 求/v 所有/b 合法/a 布局/n 的/ude1 伪/ag 码算法/n ：/wp 
void/x  Trial/x (/wkz int/x  i/x ，/wd int/x  n/x )/wky {/n 
  ∥/w 进入/v 本/rz 函数/n 时/ng ，/wd 在/p n×n/x 棋盘/n 前/f i-1/x 行/ng 已/d 放置/v 了/ule 互不/d 攻击/v ①/m 的/ude1 i-1/x 个/q 棋子/n ：/wp 
  ∥/w 现/tg 从/p 第/m i/x 行/ng 起/vf 继续/v 为/p 后续/vn 棋/n f/x 选择/v 合适/a ①/m 位置/n 。/wj 
  ∥/w 当/v i/x >/n n/x 时/ng ，/wd 求得/v 个/q 合法/a 布局/n ，/wd 输出/v 之/uzhi 。/wj 
  if/x (/wkz i/x >/n n/x )/wky 输出/v 棋盘/n 的/ude1 当前/t 布局/n ；/wf     ∥/w n/x 为/p 4时/t ，/wd 即/d 为/v 4/m 皇后/n 问题/n 
  elBefoz/x (/wkz j=l/x ；/wf j/x </n ：/wp n/x ；/wf ++j/x )/wky {/n 
    在/p 第/m i/x 行/ng 第/m j/x 列/n 放置/v 一个/mq 棋/n f/x ；/wf 
}/n ∥/w Trial/x 
if/x (/wkz 当前/t 布局/n 合法/a )/wky Trial/x (/wkz i/x 十/m 1/m ，/wd n/x )/wky ；/wf 
移/v 走/v 第/m i/x 行/ng 第/m j/x 列/n 的/ude1 棋子/n ；/wf 
算法/n 6．16/m 
  算法/n 6．16/m 可/v 进一步/d 求/v 精/a ，/wd 在/p 此/rzs 从略/vi 。/wj 算法/n 6．16/m 可/v 作为/v 回溯/vn 法/n 求解/vi 的/ude1 一般/a 模式/n ，/wd 类似/v 问题/n 有/vyou 骑士/n 游历/v 、/wn 迷宫/n 问题/n 、/wn 选/v 最/d 优/ag 解/v 问题/n 等等/udeng 。/wj 
6．8/m 树/n 的/ude1 计数/vi 
    本/rz 节/n 将/d 讨论/v 的/ude1 树/n 的/ude1 计数/vi 问题/n 的/ude1 提法/n 是/vshi ：/wp 具有/v n/x 个/q 结点/n 的/ude1 不同/a 形态/n 的/ude1 树/n 有/vyou 多少/ry 棵/q ?/ww 下面/f 我们/rr 先/d 讨论/v 二/m 叉树/n 的/ude1 情况/n ，/wd 然后/c 可/v 将/d 结果/d 推广/v 到/v 树/n 。/wj 
    在/p 讨论/v 二/m 叉树/n 的/ude1 计数/vi 之前/f 应/v 先/d 明确/v 两/m 个/q 不同/a 的/ude1 概念/n 。/wj 
    称/v 二/m 叉树/n T/x 和/cc T/x ’/wyy 相似/a 是/vshi 指/v ：/wp 二者/rzv 都/d 为/v 空/a 树/n 或者/c 二者/rzv 均/d 不/d 为/v 空/a 树/n ，/wd 且/c 它们/rr 的/ude1 左右/m 子/q 树/n 分别/d 相似/a 。/wj 
    称/v 二/m 叉树/n T/x 和/cc T/x ’/wyy 等价/n 是/vshi 指/v ：/wp 二者/rzv 不仅/c 相似/a ，/wd 而且/c 所有/b 对应/vi 结点/n 上/f 的/ude1 数据/n 元素/n 均相同/n 。/wj 
    二/m 叉树/n 的/ude1 计数/vi 问题/n 就/d 是/vshi 讨论/v 具有/v ”/wyy 个/q 结点/n 、/wn 互不/d 相似/a 的/ude1 二/m 叉树/n 的/ude1 数目/n 6/m 。/wj 
    在/p n/x 值/n 很/d 小/a 的/ude1 情况/n 下/f ，/wd 可/v 直观/a 地/ude2 得到/v ：/wp 60=1/m 为/v 空/a 树/n ；/wf 6l=1/x 是/vshi 只/d 有/vyou 一个/mq 根/n 结点/n 的/ude1 树/n ；/wf 62=2/m 和/cc 63=5/m ，/wd 它们/rr 的/ude1 形态/n 分别/d 如/v 图/n 6．30/m (/wkz a/x )/wky 和/cc 图/n 6．30/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 那末/c ，/wd 在/p n/x >/n 3时/t 又/d 如何/ryv 呢/y ?/ww 
    图/n 6．30/m 二/m 叉树/n 的/ude1 形态/n 
。/wj (/wkz a/x )/wky n=2/x ，/wd (/wkz b/x )/wky n=3/x ；/wf (/wkz c/x )/wky 一般/a 情形/n n/x >/n 1/m 。/wj 
    一般/a 情况/n 下/f ，/wd 一/m 棵/q 具有/v ”/wyy (/wkz ”/wyy >/n 1/m )/wky 个/q 结点/n 的/ude1 二/m 叉树/n 可以/v 看成/v 是/vshi 由/p 一个/mq 根/n 结点/n 、/wn 一/m 棵/q 具有/v i/x 个/q 结点/n 的/ude1 左子树/nr 、/wn 和/cc 一/m 棵/q 具有/v ，/wd z―i/x 一/m 1/m 个/q 结点/n 的/ude1 右/f 子/ng 树/v 组成/v (/wkz 如/v 图/n 6．30/m (/wkz c/x )/wky 所/usuo 示/vg )/wky ，/wd 其中/rz 0≤i≤n/x 一/m 1/m 。/wj 由此/d 可/v 得/ude3 下列/b 递推/n 公式/n ：/wp 
    可以/v 利用/v 生成/v 函数/n 来/vf 讨论/v 这个/rz 递推/n 公式/n 。/wj 
    对/p 序列/n  b0/x ，/wd b1/x ，/wd …/ws bn/x 定义/n 生成/vn 函数/n 
因为/p 
根据/p (/wkz 6．7/m )/wky 
由此/d 得/v 
即/v 
60/m ，/wd 61/m ，/wd …/ws ，/wd b/x 。/wj ，/wd …/ws 
B/x (/wkz z/x )/wky =b0+61z+6222+/x …/ws +6nz/x “/wyz +/m ‘/wyz ’/wyy 
B2/x (/wkz z/x )/wky =b060+/x (/wkz 60b1+blb0/x )/wky z+/x (/wkz 60b2+bl/x  b1+bEbo/x )/wky Z2+/x …/ws 
解/v 此/rzs 二/m 次方程/n 得/v 
B/x 。/wj (/wkz g/x )/wky 
由/p 初值/n 60/m 。/wj l/x ，/wd 应/v 有/vyou B/x (/wkz z/x )/wky =bo/x 。/wj 
所以/c 
利用/v 二项式/n 展开/v 
    当/p k=0/x 时/ng ，/wd 式/ng (/wkz 6―10/m )/wky 的/ude1 第一/m 项/q 为/v 1/m ，/wd 故/c 有/vyou 
对照/v (/wkz 6―8/m )/wky 和/cc (/wkz 6．11/m )/wky 而/cc 得/v 
因此/c ，/wd 含有/v ”/wyy 个/q 结点/n 的/ude1 不/d 相似/a 的/ude1 二/m 叉树/n 有/vyou ■/n 鲁/b c/x !/wt 。/wj 棵/q 。/wj 
    我们/rr 还/d 可以/v 从/p 另/rz 一个/mq 角度/n 来/vf 讨论/v 这个/rz 问题/n 。/wj 从/p 二/m 叉树/n 的/ude1 遍历/n 已经/d 知道/v ，/wd 任意/d 一/m 棵/q 二/m 叉树/n 结点/n 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n 是/vshi 唯一/b 的/ude1 。/wj 反过来/d ，/wd 给定/v 结点/n 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n ，/wd 能否/v 确定/v 一/m 棵/q 二/m 叉树/n 呢/y ?/ww 又/d 是否/v 唯一/b 呢/y ?/ww 
    由/p 定义/n ，/wd 二/m 叉树/n 的/ude1 前/f 序/n 遍历/n 是/vshi 先/d 访问/v 根/n 结点/n D/x ，/wd 其次/c 遍历/n 左/a 子/ng 树/n L/x ，/wd 最后/f 遍历/n 右/f 子/ng 树/n R/x 。/wj 即/v 在/p 结点/n 的/ude1 前/f 序/n 序列/n 中/f ，/wd 第一/m 个/q 结点/n 必/d 是/vshi 根/n D/x ；/wf 而/cc 另一方面/c ，/wd 由于/c 中/b 序/n 遍历/n 是/vshi 先/d 遍历/n 左/f 于/p 树/n I．/x ，/wd 然后/c 访问/v 根/n D/x ，/wd 最后/f 遍历/n 右/f 子/ng 树/n R/x ，/wd 则/c 根/n 结点/n D/x 将/p 中/b 序/n 序列/n 分割/v 成/v 两/m 部分/m ：/wp 在/p D/x 之前/f 是/vshi 左子树/nr 结点/n 的/ude1 中/b 序/n 序列/n ，/wd 在/p D/x 之后/f 是/vshi 各/rz 子/ng 树/v 结点/n 的/ude1 中/b 序/n 序列/n 。/wj 反过来/d ，/wd 根据/p 左子树/nr 的/ude1 中/b 序/n 序列/n 中/f 结点/n 个/q 数/n ，/wd 又/d 可/v 将/p 前/f 序/n 序列/n 除根/vi 以外/f 分成/vi 左/f 子/ng 树/n 的/ude1 前/f 序/n 序列/n 和/cc 右/f 子/ng 树/n 的/ude1 前/f 序/n 序列/n 两/m 部分/n 。/wj 依次/d 类推/vi ，/wd 便/d 可/v 递归/n 得到/v 整/m 棵/q 二/m 叉树/n 。/wj 
    例/n 6―5/m   已/d 知/v 结点/n 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n 分别/d 为/v ：/wp 
    前/f 序/n 序列/n U：A/x  B/x  C/x  D/x  E/x  F/x  G/x 
    中/b 序/n 序列/n ：/wp C/x  B/x  E/x  D/x  A/x  F/x  G/x 
则/c 可/v 按/p 上述/b 分解/v 求得/v 整/m 棵/q 二/m 叉树/n 。/wj 其/rz 构造/n 过程/n 如/v 图/n 6．31/m 所/usuo 示/vg 。/wj 首先/c 由/p 前/f 序/n 序列/n 得知/v 二/m 叉树/n 的/ude1 根/n 为/v A/x ，/wd 则/c 其/rz 左/a 子/ng 树/n 的/ude1 中/b 序/n 序列/n 为/v (/wkz CBED/x )/wky ，/wd 又/d 右/f 子/ng 树/n 的/ude1 中/b 序/n 序列/n 为/v (/wkz FG/x )/wky 。/wj 反/vi 过来/vf 得知/v 其/rz 左/a 子/ng 树/n 的/ude1 前/f 序/n 序列/n 必/d 为/v (/wkz BcDE/x )/wky ，/wd 右/f 子/ng 树/n 的/ude1 前/f 序/n 序列/n 为/v (/wkz FG/x )/wky 。/wj 类似/a 地/ude2 ，/wd 可/v 由/p 左子树/nr 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n 构造/n 得/v A/x 的/ude1 左子树/nr ，/wd 由/p 右/f 子/ng 树/n 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n 构造/n 得/v A/x 的/ude1 右/f 子/ng 树/n 。/wj 
图/n 6．3l/x   由/p 前/f 序/n 和/cc 中/b 序/n 序列/n 构造/v 一/m 棵/q 二/m 叉树/n 的/ude1 过程/n 
    上述/b 构造/n 过程/n 说明/v 了/ule 给定/vn 结点/n 的/ude1 前/f 序/n 序列/n 和/cc 中/b 序/n 序列/n ，/wd 可/c 确定/v 一/m 棵/q 二/m 叉树/n 。/wj 至于/p 它/rr 的/ude1 唯一性/n ，/wd 读者/n 可/v 试用/v 归纳法/n 证明/v 之/uzhi 。/wj 
    我们/rr 可/v 由/p 此/rzs 结论/n 来/vf 推论/vi 具有/v ”/wyy 个/q 结点/n 的/ude1 不同/a 形态/n 的/ude1 二/m 叉树/n 的/ude1 数目/n 。/wj 
图/n 6．32/m 具有/v 不同/a 中/b 序/n 序列/n 的/ude1 二/m 叉树/n 
　　假设/v 对/p 二/m 叉树/n 的/ude1 n/x 个/q 结点/n 从/p 1/m 到/v n/x 加以/vx 编号/n ，/wd 且/c 令/v 其/rz 前/f 序/n 序列/n 为/p 1/m ，/wd 2/m ，/wd …/ws ，/wd ”/wyy ，/wd 则/c 由/p 前面/f 的/ude1 讨论/vn 可知/v ，/wd 不同/a 的/ude1 二/m 叉树/n 所得/n 中/b 序/n 序列/n 不同/a 。/wj 如/v 图/n 6．32/m 所/usuo 示/vg 两/m 棵/q 有/vyou 8/m 个/q 结点/n 的/ude1 二/m 叉树/n ，/wd 它们/rr 的/ude1 前/f 序/n 序列/n 都/d 是/vshi 12345678/m ，/wd 而/cc (/wkz a/x )/wky 树/n 的/ude1 中/b 序/n 序列/n 为/p 32465178/m ，/wd (/wkz b/x )/wky 树/n 的/ude1 中/b 序/n 序列/n 为/p 23147685/m 。/wj 因此/c ，/wd 不同/a 形态/n 的/ude1 二/m 叉树/n 的/ude1 数目/n 恰好/d 是/vshi 前/f 序/n 序列/n 均/d 为/v 12/m …/ws 竹/ng 的/ude1 二/m 叉树/n 所/usuo 能/v 得到/v 的/ude1 中/b 序/n 序列/n 的/ude1 数目/n 。/wj 而/cc 中/b 序/n 遍历/n 的/ude1 过程/n 实质/n 上/f 是/vshi 一个/mq 结点/n 进/vf 栈/ng 和/cc 出/vf 栈/ng 的/ude1 过程/n 。/wj 二/m 叉树/n 的/ude1 形态/n 确定/v 了/ule 其/rz 结点/n 进/vf 栈/ng 和/cc 出/vf 栈/ng 的/ude1 顺序/n ，/wd 也/d 确定/v 了/ule 其/rz 结点/n 的/ude1 中/b 序/n 序列/n 。/wj 
    图/n 6．33/m 中/b 序/n 遍/qv 历时/vi 进/vf 战和/vi 出/vf 栈/ng 的/ude1 过程/n     
　　例如/v 图/n 6．33/m 中/f 所/usuo 示/vg (/wkz a/x )/wky     (/wkz b/x )/wky     (/wkz c/x )/wky     (/wkz d/x )/wky     (/wkz e/x )/wky 
为/p ”/wyy =3/m 时/ng 不/d 同/p 形态/n 的/ude1 二/m 叉树/n 在/p 中/b 序/n 遍/qv 历时/vi 栈/ng 的/ude1 状态/n 和/cc 访问/v 结点/n 次序/n 的/ude1 关系/n 。/wj 由此/d ，/wd 由/p 前/f 序/n 序列/n 12/m …/ws ，/wd z/x 所/usuo 能/v 得到/v 的/ude1 中/b 序/n 序列/n 的/ude1 数目/n 恰/d 为/v 数/m 列/q 12/m …/ws ，/wd z/x 按/p 不同/a 顺序/n 进/vf 栈/ng 和/cc 出/vf 栈/ng 所/usuo 能/v 得到/v 的/ude1 排列/vn 的/ude1 数目/n 。/wj 这个/rz 数目/n 为/v 
图/n 6．34/m 具有/v 不同/a 形态/n 的/ude1 树/n 和/cc 二/m 叉树/n 

    由/p 二/m 叉树/n 的/ude1 计数/vi 可/v 推/v 得/ude3 树/n 的/ude1 计数/vi 。/wj 由/p “/wyz 6．4．2/m 森林/n 与/p 二/m 叉树/n 的/ude1 转换/vn ”/wyy 中/f 可知/v 一/m 棵/q 树/n 可/v 转换/v 成/v 唯一/b 的/ude1 一/m 棵/q 没有/v 右/f 子/ng 树/n 的/ude1 二/m 叉树/n ，/wd 反之亦然/vl 。/wj 则/c 具有/v n/x 个/q 结点/n 有/vyou 不同/a 形态/n 的/ude1 树/n 的/ude1 数目/n t/x 。/wj 和/cc 具有/v n-1/x 个/q 结点/n 互不/d 相似/a 的/ude1 二/m 叉树/n 的/ude1 数目/n 相同/a 。/wj 即/v ￡/m 。/wj =6/m 。/wj -/wp 1/m 。/wj 图/n 6．34/m 展示/v 了/ule 具有/v 4/m 个/q 结点/n 的/ude1 树/n 和/cc 具有/v 3/m 个/q 结点/n 的/ude1 二/m 叉树/n 的/ude1 关系/n 。/wj 从/p 图/n 中/f 可见/v ，/wd 在/p 此/rzs 讨论/v 树/n 的/ude1 计数/vi 是/vshi 指/v 有序/a 树/n ，/wd 因此/c (/wkz c/x )/wky 和/cc (/wkz d/x )/wky 是/vshi 两/m 棵/q 有/vyou 不同/a 形态/n 的/ude1 树/n (/wkz 在/p 无序/b 树/n 中/f ，/wd 它们/rr 被/pbei 认为/v 是/vshi 相同/a 的/ude1 )/wky 。/wj 
①/m  参考/v 书目/n [/wkz 3/m ]/wky 中译本/n 第457/m 页/q 。/wj 

第7/m 章/q   图/n 
    图/n (/wkz Graph/x )/wky 是/vshi 一/m 种/q 较/d 线性/n 表/n 和/cc 树/n 更为/d 复杂/a 的/ude1 数据/n 结构/n 。/wj 在/p 线性/n 表/n 中/f ，/wd 数据/n 元素/n 之间/f 仅/d 有/vyou 线性/n 关系/n ，/wd 每个/r 数据/n 元素/n 只/d 有/vyou 一个/mq 直接/a 前驱/n 和/cc 一个/mq 直接/a 后/f 继/vg ；/wf 在/p 树形/n 结构/n 中/f ，/wd 数据/n 元素/n 之间/f 有着/v 明显/a 的/ude1 层次关系/n ，/wd 并且/c 每/rz 一/m 层/qv 上/f 的/ude1 数据/n 元素/n 可能/v 和/cc 下/vf 一/m 层/qv 中/f 多/m 个/q 元素/n (/wkz 即/v 其/rz 孩子/n 结点/n )/wky 相关/vi ，/wd 但/c 只/d 能/v 和/cc 上/f 一/m 层/qv 中/f 一个/mq 元素/n (/wkz 即/v 其/rz 双亲/n 结点/n )/wky 相关/vi ；/wf 而/cc 在/p 图形/n 结构/n 中/f ，/wd 结点/n 之间/f 的/ude1 关系/n 可以/v 是/vshi 任意/b 的/ude1 ，/wd 图/n 中/f 任意/d 两/m 个/q 数据/n 元素/n 之间/f 都/d 可能/v 相关/vi 。/wj 由此/d ，/wd 图/n 的/ude1 应用/vn 极为/d 广泛/a ，/wd 特别/d 是/vshi 近年来/dl 的/ude1 迅速/ad 发展/v ，/wd 已/d 渗入/v 到/v 诸如/v 语言学/n 、/wn 逻辑学/n 、/wn 物理/n 、/wn 化学/n 、/wn 电讯/n 工程/n 、/wn 计算机科学/n 以及/cc 数学/n 的/ude1 其它/rz 分支/n 中/f 。/wj 
    读者/n 在/p “/wyz 离散/vn 数学/n ”/wyy 课程/n 中/f 已/d 学习/v 了/ule 图/n 的/ude1 理论/n ，/wd 在/p 此/rzs 仅/d 应用/v 图/n 论/k 的/ude1 知识/n 讨论/v 如何/ryv 在/p 计算机/n 上/f 实现/v 图/n 的/ude1 操作/vn ，/wd 因此/c 主要/d 学习/v 图/n 的/ude1 存储/vn 结构/n 以及/cc 若干/m 图/n 的/ude1 操作/vn 的/ude1 实现/vn 。/wj 
7．1/m   图/n 的/ude1 定义/n 和/cc 术语/n 
    图/n 是/vshi 一/m 种/q 数据/n 结构/n ，/wd 加上/v 一/m 组/q 基本/a 操作/vn ，/wd 就/d 构成/v 了/ule 抽象数据/n 类型/n 。/wj 抽象数据/n 类型/n 图/n 的/ude1 定义/n 如下/vi ：/wp 
^/n DT/x  Graph/x {/n 
    数据/n 对象/n V：v/x 是/vshi 具有/v 相同/a 特性/n 的/ude1 数据/n 元素/n 的/ude1 集合/n ，/wd 称为/v 顶点/n 集/vg 。/wj 
    数据/n 关系/n R：/x 
    R=/x {/n VR/x }/n 
    VR=/x {/n </n v/x ，/wd w/x >/n l/x 、/wn r/x ，/wd w∈v/x 且/d P/x (/wkz v/x ，/wd w/x )/wky ，/wd </n v/x ，/wd w/x >/n 表示/v 从/p v/x 到/v w/x 的/ude1 弧/n ，/wd 
    谓词/n P/x (/wkz v/x ，/wd w/x )/wky 定义/v 了/ule 弧/n </n v/x ，/wd w/x >/n 的/ude1 意义/n 或/c 信息/n   }/n 
  基本/ad 操作/v ：/wp 
    CreateGraph/x (/wkz ＆/n G/x ，/wd V/x ，/wd vR/x )/wky ；/wf 
    初始条件/n ：/wp v/x 是/vshi 图/n 的/ude1 顶点/n 集/vg ，/wd VR/x 是/vshi 图/n 中/b 弧/n 的/ude1 集合/n 。/wj 
    操作/v 结果/n ：/wp 按/p v/x 和/cc 1l/x ，/wd R/x 的/ude1 定义/n 构造/vn 图/n G/x 。/wj 
    DestroyGraph/x (/wkz &/n G/x )/wky ；/wf 
    初始条件/n ：/wp 图/n G/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 图/n G/x 。/wj 
    LocateVex/x (/wkz G/x ，/wd u/x )/wky ；/wf 
    初始条件/n ：/wp 图/n G/x 存在/v ，/wd u/x 和/cc G/x 中/b 顶点/n 有/vyou 相同/a 特征/n 。/wj 
    操作/v 结果/n ：/wp 若/v G/x 中/f 存在/v 顶点/n u/x ，/wd 则/c 返回/v 该/rz 顶点/n 在/p 图/n 中/b 位置/n ；/wf 否则/c 返回/v 其它/rz 信息/n 。/wj 
    GetVex/x (/wkz G/x ，/wd v/x )/wky ；/wf 
    初始条件/n ‘/wyz ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n 。/wj 
    操作/v 结果/n ：/wp 返回/v v/x 的/ude1 值/n 。/wj 
    PutVex/x (/wkz &/n G/x ，/wd v/x ，/wd value/x )/wky ；/wf 
    初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n 。/wj 
    操作/v 结果/n ：/wp 对/p v/x 赋值/v value/x 。/wj 
    FirstAd/x [/wkz jVe/x )/wky 【/wkz (/wkz G/x ，/wd v/x )/wky ；/wf 
    初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n 。/wj 
  操作/v 结果/n ：/wp 返回/v v/x 的/ude1 第一/m 个/q 邻接/v 顶点/n 。/wj 若/c 顶点/n 在/p G/x 中/f 没有/d 邻接/v 顶点/n ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
NextAdjVe/x 】/wky 【/wkz (/wkz G/x ，/wd v/x ，/wd w/x )/wky ；/wf     
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n ，/wd w/x 是/vshi v/x 的/ude1 邻接/v 顶点/n 。/wj 
  操作/v 结果/n ：/wp 返回/v v/x 的/ude1 (/wkz 相对/d 于/p w/x 的/ude1 )/wky 下/f 一个/mq 邻接/v 顶点/n 。/wj 若/v w/x 是/vshi v/x 的/ude1 最后/f 一个/mq 邻接/v 点/qt ，/wd 则/c 返回/v “/wyz 空/ng ”/wyy 。/wj 
InsettVex/x (/wkz ＆/n G/x ，/wd v/x )/wky ；/wf 
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 和/cc 图/n 中/b 顶点/n 有/vyou 相同/a 特征/n 。/wj 
  操作/v 结果/n ：/wp 在/p 图/n G/x 中/f 增添/v 新/a 顶点/n v/x 。/wj 
DeleteVex/x (/wkz ＆/n G/x ，/wd v/x )/wky ；/wf 
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n 。/wj 
  操作/v 结果/n ：/wp 删除/v G/x 中/b 顶点/n v/x 及其/cc 相关/vn 的/ude1 弧/n 。/wj 
Insez/x “/wyz tArc/x (/wkz ＆/n Gi/x  v/x ，/wd w/x )/wky ；/wf 
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 和/cc w/x 是/vshi G/x 中/f 两/m 个/q 顶点/n 。/wj 
  操作/v 结果/n ：/wp 在/p G/x 中/f 增添/v 弧/n </n v/x ，/wd w/x >/n ，/wd 若/c G/x 是/vshi 无/v 向/p 的/ude1 ，/wd 则/c 还/d 增添/v 对称/a 弧/n </n w/x ，/wd v/x >/n 。/wj 
DeleteArc/x (/wkz ＆/n G/x ，/wd v/x ，/wd w/x )/wky ；/wf 
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 和/cc w/x 是/vshi G/x 中/f 两/m 个/q 顶点/n 。/wj 
  操作/v 结果/n ：/wp 在/p G/x 中/f 删除/v 弧/n </n v/x ，/wd w/x >/n ，/wd 若/c G/x 是/vshi 无/v 向/p 的/ude1 ，/wd 则/c 还/d 删除/v 对称/a 弧/n </n w/x ，/wd v/x >/n 。/wj 
DFSTraverse/x (/wkz G/x ，/wd v/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf     
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n ，/wd visit/x 是/vshi 顶点/n 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 从/p 顶点/n v/x 起/q 深度/n 优先/vd 遍历/n 图/n G/x ，/wd 并/cc 对/p 每个/r 顶点/n 调用函数/n visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d vis/x 北/f (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
BFSTraverse/x (/wkz G/x ，/wd v/x ，/wd visit/x (/wkz )/wky )/wky ；/wf 
  初始条件/n ：/wp 图/n G/x 存在/v ，/wd v/x 是/vshi G/x 中/f 某个/rz 顶点/n ，/wd visit/x 是/vshi 顶点/n 的/ude1 应用/vn 函数/n 。/wj 
  操作/v 结果/n ：/wp 从/p 顶点/n v/x 起/q 广度/n 优先/vd 遍历/n 图/n G/x ，/wd 并/cc 对/p 每个/r 顶点/n 调用函数/n visit/x 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
    }/n ADT/x  Graph/x 
在/p 图/n 中/f 的/ude1 数据/n 元素/n 通常/d 称做/v 顶点/n (/wkz Vertex/x )/wky ，/wd V/x 是/vshi 顶点/n 的/ude1 有/vyou 穷非/nr 空/d 集合/v ；/wf VR/x 是/vshi 两/m 个/q 顶点/n 之间/f 
的/ude1 关系/n 的/ude1 集合/n 。/wj 若/v (/wkz a/x ，/wd b/x )/wky ∈VR/x ，/wd 则/d (/wkz a/x ，/wd b/x )/wky 表示/v 从/p 口/n 到/v 叫/vi 的/ude1 一/m 条/q 弧/n (/wkz 心/n c/x )/wky ，/wd 且/c 称/v a/x 为/p 弧/n 尾/ng (/wkz Tail/x )/wky 或/c 初始/b 点/n (/wkz Initial/x  nocle/x )/wky ，/wd 称/v 叫/vi 为/p 弧/n 头/n (/wkz Head/x )/wky 或/c 终端/n 点/qt (/wkz Terrninal/x  node/x )/wky ，/wd 此时/r 的/ude1 图/n 称为/v 有/vyou 向/p 图/n (/wkz Digraph/x )/wky 。/wj 若/v (/wkz 。/wj ，/wd a/x )/wky ∈/m Ⅷ/m 必/d 有/vyou (/wkz a/x ，/wd v/x )/wky ∈c/x ，/wd 即/v VR/x 是/vshi 对称/a 的/ude1 ，/wd 则/c 以/p 无序/b 对/p (/wkz a/x ，/wd a/x )/wky 代替/v 这/rzv 两/m 个/q 有序/a 对/p ，/wd 表示/v a/x 和/cc b/x 之间/f 的/ude1 一/m 条/q 边/n (/wkz Edge/x )/wky ，/wd 此时/r 的/ude1 图/n 称为/v 无/v 向/p 图/n (/wkz Undigrap/x ’/wyy rt/x )/wky 。/wj 例如/v 图/n 7．1/m (/wkz a/x )/wky 中/f G/x 。/wj 是/vshi 有/vyou 向/p 图/n ，/wd 定义/n 此图/n 的/ude1 谓词/n P/x (/wkz v/x ，/wd w/x )/wky 则/d 表示/v 从/p v/x 到/v w/x 的/ude1 一/m 条/q 单向/d 通/v 路/n 。/wj 
(/wkz a/x )/wky     (/wkz b/x )/wky 
    图/n 7．1/m 图/n 的/ude1 示例/n   
(/wkz a/x )/wky 有/vyou 向/p 图/n G1/x ；/wf (/wkz b/x )/wky 无/v 向/p 图/n G2/x 。/wj 
      G1=/x (/wkz V1/x ，/wd {/n A1/x }/n )/wky 
    其中/rz V2=/x {/n Vl/x ，/wd V2/x ，/wd 7J3/x ，/wd U4/x ，/wd 7J5÷・/x 
    E2=：/x (/wkz l/x ，/wd 2/m )/wky ，/wd (/wkz u1/x ，/wd u4/x )/wky (/wkz V2/x ，/wd 3/m )/wky ，/wd (/wkz V2/x ，/wd 口/q 5/m )/wky ，/wd (/wkz "/n 03/m ，/wd 734/m )/wky ，/wd (/wkz 733/m ，/wd V5/x )/wky }/n 
    我们/rr 用/v ”/wyy 表示/v 图/n 中/b 顶点/n 数目/n ，/wd 用/v e/x 表示/v 边/k 或/c 弧/n 的/ude1 数目/n 。/wj 在/p 下面/f 的/ude1 讨论/vn 中/f ，/wd 我们/rr 不/d 考虑/v 顶点/n 到/v 其/rz 自身/rr 的/ude1 弧/n 或/c 边/d ，/wd 即/d 若/v (/wkz u/x ，/wd u/x ，/wd )/wky ∈VR/x ，/wd 则/c 可/v i≠u/x ，/wd ，/wd 那末/c ，/wd 对于/p 无/v 向/p 图/n ，/wd e/x 的/ude1 取值/v 范围/n 是/vshi 0/m 到/v {/n ”/wyy (/wkz n-1/x )/wky 。/wj 有/vyou 寺/ng n/x (/wkz ”/wyy -/wp 1/m )/wky 条/q 边/k 的/ude1 无/v 向/p 图/n 称为/v 完全/ad 图/v (/wkz Completed/x  graph/x )/wky 。/wj 对于/p 有/vyou 向/p 图/n ，/wd 。/wj 的/ude1 取值/v 范围/n 是/vshi 0/m 到/v n/x (/wkz n-1/x )/wky 。/wj 具有/v n/x (/wkz ”/wyy -/wp 1/m )/wky 条/q 弧/n 的/ude1 有/vyou 向/p 图/n 称为/v 有/vyou 向/p 完全/a 图/n 。/wj 
有/vyou 很/d 少/a 条/q 边/n 或/c 弧/n (/wkz 如/v B/x </n ”/wyy log/x ”/wyy )/wky 的/ude1 图/n 称为/v 稀疏/a 图/n (/wkz Sparse/x  graph/x )/wky ，/wd 反之/c 称为/v 稠密/a 图/n (/wkz Densegraph/x )/wky 。/wj 
    有时/d 图/v 的/ude1 边/n 或/c 弧/n 具有/v 与/p 它/rr 相关/vi 的/ude1 数/n ，/wd 这种/r 与/p 图/n 的/ude1 边/n 或/c 弧/n 相关/vi 的/ude1 数/n 叫做/v 权/n (/wkz Weight/x )/wky 。/wj 这些/rz 权/n 可以/v 表示/v 从/p 一个/mq 顶/v 点/qt 到/v 另/rz 一个/mq 顶点/n 的/ude1 距离/n 或/c 耗费/v 。/wj 这种/r 带权/n 的/ude1 图/n 通常/d 称为/v 网/n  (/wkz Network/x )/wky 。/wj 
    假设/n 有/vyou 两/m 个/q 图/n G=/x (/wkz V/x ，/wd {/n E/x }/n )/wky 和/cc G/x ’/wyy =/m (/wkz V/x ’/wyy ，/wd {/n E/x ，/wd }/n )/wky ，/wd 如果/c V/x ’/wyy ∈V/x 且/d E/x ’/wyy ∈E/x ，/wd 则/c 称/v G/x ’/wyy 为/v G/x 的/ude1 子图/nr2 (/wkz Subgraph/x )/wky ?/ww 例如/v ，/wd 图/n 7．2/m 是/vshi 子/ng 图/n 的/ude1 一些/mq 例子/n 。/wj 
    图/n 7．2/m 子/ng 图示/v 例/n 
(/wkz a/x )/wky G1/x 的/ude1 子/ng 图/n ；/wf (/wkz b/x )/wky G2/x 的/ude1 子/ng 图/n 。/wj 
    对于/p 无/v 向/p 图/n G=/x (/wkz V/x ，/wd {/n E/x }/n )/wky ，/wd 如果/c 边/d (/wkz V/x ，/wd b/x ’/wyy )/wky ∈E/x ，/wd 则/c 称/v 顶点/n 口/n 和/cc u/x ’/wyy 互为/d 邻接/v 点/qt (/wkz Adja．cent/x )/wky ，/wd 即/v ”/wyy ’/wyy 相邻/vi 接/v 。/wj 边/n (/wkz u/x ，/wd u/x ’/wyy )/wky 依附/v (/wkz Incident/x )/wky 于/p 顶点/n u/x 和/cc g/x ’/wyy ，/wd 或者/c 说/v (/wkz u/x ，/wd g/x ’/wyy )/wky 和/cc 顶点/n u/x 和/cc u/x ’/wyy 相/d 关联/vi 。/wj 顶点/n u/x 的/ude1 度/qv (/wkz Degree/x )/wky 是/vshi 和/p u/x 相/d 关联/vi 的/ude1 边/n 的/ude1 数目/n ，/wd 记/v 为/v TD/x (/wkz V/x )/wky 。/wj 例如/v ，/wd G2/x 中/b 顶点/n V3/x 的/ude1 度/qv 是/vshi 3/m 。/wj 对于/p 有/vyou 向/p 图/n G=/x (/wkz V/x ，/wd {/n A/x }/n )/wky ，/wd 如果/c 弧/n (/wkz u/x ，/wd ’/wyy )/wky ∈A/x ，/wd 则/c 称/v 顶点/n u/x 邻接/v 到顶/vi 点/v u/x ’/wyy ，/wd 顶点/n 73/m ’/wyy 邻接/v 自/p 顶点/n u/x 。/wj 弧/n (/wkz 73/m ，/wd f/x ’/wyy )/wky 和/cc 顶点/n ”/wyy ，/wd f/x ’/wyy 相/d 关联/vi 。/wj 以/p 顶点/n 口/n 为/p 头/n 的/ude1 弧/n 的/ude1 数目/n 称为/v V/x 的/ude1 入/v 度/qv (/wkz InDegree/x )/wky ，/wd 记/v 为/v ID/x (/wkz 73/m )/wky ；/wf 以/p 73/m 为/v 尾/ng 的/ude1 弧/n 的/ude1 数目/n 称为/v 7J/x 的/ude1 出/vf 度/v (/wkz Outde．/x 
gree/x )/wky ，/wd 记/v 为/v OD/x (/wkz )/wky ；/wf 顶点/n 7．3/m 的/ude1 度/qv 为/v TD/x (/wkz u/x )/wky ：/wp ID/x (/wkz ”/wyy )/wky +OD/x (/wkz )/wky 。/wj 例如/v ，/wd 图/n G1/x 中/b 顶点/n ，/wd 的/n 入/v 度/qv 119/m (/wkz 731/m )/wky =1/m ，/wd 出/vf 度/v OF/x )/wky (/wkz 1/m )/wky =2/m ，/wd 度/qv TD/x (/wkz 1/m )/wky =11/m )/wky (/wkz 7．31/m )/wky +OD/x (/wkz 1/m )/wky =3/m 。/wj 一般/a 地/ude2 ，/wd 如果/c 顶点/n ”/wyy i/x 的/ude1 度/qv 记/v 为/v TD/x (/wkz 。/wj 。/wj )/wky ，/wd 那么/rz 一个/mq 有/vyou ”/wyy 个/q 顶点/n ，/wd e/x 条/q 边/n 或/c 弧/n 的/ude1 图/n ，/wd 满足/v 如下/vn 关系/n ：/wp TD/x (/wkz i/x )/wky 
    无/v 向/p 图/n G=/x (/wkz V/x ，/wd {/n E/x }/n )/wky 中/f 从/p 顶点/n a/x 到/v 顶点/n u/x ’/wyy 的/ude1 路径/n (/wkz Path/x )/wky 是/vshi 一个/mq 顶点/n 序列/n (/wkz =/m "/n Ui/x 。/wj ，/wd ”/wyy a/x ，/wd …/ws ，/wd ”/wyy i/x ，/wd 。/wj =u/x ，/wd )/wky ，/wd 其中/rz (/wkz 可/v ¨/n 一/m l/x ，/wd u/x ¨/n )/wky ∈E/x ，/wd 1≤a≤a/x 。/wj 如果/c G/x 是/vshi 有/vyou 向/p 图/n ，/wd 则/c 路径/n 也/d 是/vshi 有/vyou 向/p 的/ude1 ，/wd 顶点/n 序列/n 应/v 满足/v (/wkz u/x ¨/n 1/m ，/wd 让/v ．/w i/x )/wky ∈E/x ，/wd l≤/x 歹/ag ≤m/x 。/wj 路径/n 的/ude1 长度/n 是/vshi 路径/n 上/f 的/ude1 边/n 或/c 弧/n 的/ude1 数目/n 。/wj 第一/m 个/q 顶点/n 和/cc 最后/f 一个/mq 顶点/n 相同/a 的/ude1 路径/n 称为/v 回路/n 或/c 环/v (/wkz c/x )/wky ycle/x )/wky 。/wj 序列/n 中/b 顶点/n 不/d 重复/vd 出现/v 的/ude1 路径/n 称为/v 简单/a 路径/n 。/wj 除了/p 第一/m 个/q 顶点/n 和/cc 最后/f 一个/mq 顶点/n 之外/f ，/wd 其余/rz 顶点/n 不/d 重复/vd 出现/v 的/ude1 回路/n ，/wd 称为/v 简单/a 回路/n 或/c 简单/a 环/n 。/wj 
    在/p 无/v 向/p 图/n G/x 中/f ，/wd 如果/c 从/p 顶点/n 口/q 到/v 顶点/n u/x ’/wyy 有/vyou 路径/n ，/wd 则/c 称/v a/x 和/cc ’/wyy 是/vshi 连通/v 的/ude1 。/wj 如果/c 对于/p 图/n 中/f 任意/d 两/m 个/q 顶点/n i/x 、/wn ui∈V/x ，/wd 让/v 和/cc u/x ，/wd 都/d 是/vshi 连通/v 的/ude1 ，/wd 则/c 称/v G/x 是/vshi 连通/v 图/n (/wkz (/wkz ]/wky onnected/x  Graph/x )/wky 。/wj 图/n 7．1/m (/wkz b/x )/wky 中/f 的/ude1 G2/x 就/d 是/vshi 一个/mq 连通/v 图/n ，/wd 而/cc 图/n 7．3/m (/wkz a/x )/wky 中/f 的/ude1 G3/x 则/q 是非/n 连通/v 图/n ，/wd 但/c G3/x 有/vyou 三/m 个/q 连通/v 分量/n ，/wd 如/v 图/n 7．3/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 所谓/v 连通/v 分量/n (/wkz (/wkz ]/wky onnected/x  Component/x )/wky ，/wd 指/v 的/ude1 是/vshi 无/v 向/p 图/n 中/f 的/ude1 极大/a 连通/v 子/ng 图/n 。/wj 
    在/p 有/vyou 向/p 图/n G/x 中/f ，/wd 如果/c 对于/p 每/rz 一/m 对/p f/x ，/wd u/x 、/wn ，/wd r/x ，/wd i≠f/x ，/wd 从/p i/x 到/v ，/wd 和/cc 从/p uf/x 到/v 矾/n 都/d 存在/v 路径/n ，/wd 则/c 称/v G/x 是/vshi 强/ad 连通/v 图/n 。/wj 有/vyou 向/p 图/n 中/f 的/ude1 极大/a 强/ng 连通/v 子/ng 图/n 称作/v 有/vyou 向/p 图/n 的/ude1 强/a 连通/v 分量/n 。/wj 例如/v 图/n 7．1/m (/wkz a/x )/wky 中/f 的/ude1 G/x ，/wd 不/d 是/vshi 强/ad 连通/v 图/n ，/wd 但/c 它/rr 有/vyou 两/m 个/q 强/a 连通/v 分量/n ，/wd 如/v 图/n 7．4/m 所/usuo 示/vg 。/wj 
    图/n 7．3/m 无/v 向/p 图/n 及其/cc 连通/v 分量/n 
(/wkz a/x )/wky 无/v 向/p 图/n G3/x ；/wf     (/wkz b/x )/wky G3/x 的/ude1 三/m 个/q 连通/v 分量/n 。/wj 
    图/n 7．4/m   G-/x 的/ude1 两/m 个/q 强/a 连通/v 分量/n     图/n 7．5/m  G/x ，/wd 的/n 最/d 大/a 连通/v 分量/n 的/ude1 一/m 棵/q 生成/vn 树/n 
    一个/mq 连通/v 图/n 的/ude1 生成/vn 树/n 是/vshi 一个/mq 极/d 小/a 连通/v 子/ng 图/n ，/wd 它/rr 含有/v 图/n 中/f 全部/m 顶点/n ，/wd 但/c 只有/c 足以/d 构成/v 一/m 棵/q 树/n 的/ude1 n-1/x 条/q 边/n 。/wj 图/n 7．5/m 是/vshi G/x ，/wd 中/f 最/d 大/a 连通/v 分量/n 的/ude1 一/m 棵/q 生成/vn 树/n 。/wj 如果/c 在/p 一/m 棵/q 生成/v 树上/s 添加/v 一/m 条/q 边/k ，/wd 必定/d 构成/v 一个/mq 环/n ，/wd 因为/c 这/rzv 条/q 边/d 使得/vi 它/rr 依附/v 的/ude1 那/rzv 两/m 个/q 顶点/n 之间/f 有/vyou 了/ule 第二/m 条/q 路径/n 。/wj 一/m 棵/q 有/vyou ，/wd z/x 个/q 顶点/n 的/ude1 生成/vn 树/n 有/vyou 且/c 仅/d 有/vyou n-1/x 条/q 边/n 。/wj 如果/c 一个/mq 图/n 有/vyou 。/wj 个/q 顶点/n 和/cc 小于/v 。/wj -/wp 1/m 条/q 边/k ，/wd 则/c 是非/n 连通/v 图/n 。/wj 如果/c 它/rr 多/d 于/p n-1/x 条/q 边/k ，/wd 则/c 一定/d 有/vyou 环/n 。/wj 但是/c ，/wd 有/vyou n-1/x 条/q 边/k 的/ude1 图/n 不/d 一定/d 是/vshi 生成/v 树/n 。/wj 
    如果/c 一个/mq 有/vyou 向/p 图/n 恰/d 有/vyou 一个/mq 顶点/n 的/ude1 入/v 度/qv 为/v 0/m ，/wd 其余/rz 顶点/n 的/ude1 入/v 度/qv 均/d 为/v 1/m ，/wd 则/c 是/vshi 一/m 棵/q 有/vyou 向/p 树/n 。/wj 一个/mq 有/vyou 向/p 图/n 的/ude1 生成/vn 森林/n 由/p 若干/m 棵/q 有/vyou 向/p 树/n 组成/v ，/wd 含有/v 图/n 中/f 全部/m 顶点/n ，/wd 但/c 只有/c 足以/d 构成/v 若干/m 棵/q 不/d 相/d 交/v 的/ude1 有/vyou 向/p 树/n 的/ude1 弧/n 。/wj 图/n 7．6/m 所/usuo 示/vg 为/p 其/rz 一/m 例/q 。/wj 
    图/n 7．6/m 一个/mq 有/vyou 向/p 图/n 及其/cc 生成/vn 森林/n 
    在/p 前述/b 图/n 的/ude1 基本/a 操作/vn 的/ude1 定义/n 中/f ，/wd 关于/p “/wyz 顶点/n 的/ude1 位置/n ”/wyy 和/cc “/wyz 邻接/v 点/qt 的/ude1 位置/n ”/wyy 只/d 是/vshi 一个/mq 相对/vi 的/ude1 概念/n 。/wj 因为/c ，/wd 从/p 图/n 的/ude1 逻辑/n 结构/n 的/ude1 定义/n 来看/u ，/wd 图/n 中/f 的/ude1 顶点/n 之间/f 不/d 存在/v 全/a 序/n 的/ude1 关系/n (/wkz 即/v 无法/v 将/p 图/n 中/b 顶点/n 排列/v 成/v 一个/mq 线性/n 序列/n )/wky ，/wd 任何/rz 一个/mq 顶/v 点/qt 都/d 可/v 被/pbei 看成/v 是/vshi 第一/m 个/q 顶点/n ；/wf 另一方面/c ，/wd 任/v 一/m 顶/q 点/qt 的/ude1 邻接/v 点/qt 之间/f 也/d 不/d 存在/v 次序/n 关系/n 。/wj 但/c 为了/p 操作方便/n ，/wd 我们/rr 需要/v 将/p 图/n 中/b 顶点/n 接任/v 意/b 的/ude1 顺序/n 排列/v 起来/vf (/wkz 这个/rz 排列/v 和/cc 关系/n VR/x 无关/v )/wky 。/wj 由此/d ，/wd 所谓/v “/wyz 顶点/n 在/p 图/n 中/f 的/ude1 位置/n ”/wyy 指/v 的/ude1 是/vshi 该/rz 顶点/n 在/p 这个/rz 人为/b 的/ude1 随意/ad 排列/v 中/f 的/ude1 位置/n (/wkz 或/c 序号/n )/wky 。/wj 同/p 理/n ，/wd 可/v 对/p 某个/rz 顶点/n 的/ude1 所有/b 邻接/v 点/n 进行/vx 排队/vi ，/wd 在/p 这个/rz 排队/vi 中/f 自然/d 形成/v 了/ule 第一/m 个/q 或/c 第/m 点/qt 个/q 邻接/v 点/qt 。/wj 若/c 某个/rz 顶点/n 的/ude1 邻接/v 点/qt 的/ude1 个数/n 大/a ，/wd 于是/cc ，/wd 则/c 称/v 第/m n+1/x 个/q 邻接/v 点/qt 为/v 第五/m 个/q 邻接/v 点/qt 的/ude1 下/vf 一个/mq 邻接/v 点/qt ，/wd 而/cc 最后/f 一个/mq 邻接/v 点/qt 的/ude1 下/vf 一个/mq 邻接/v 点/qt 为/v “/wyz 空/ng ”/wyy 。/wj 
7．2/m 图/n 的/ude1 存储/vn 结构/n 
在/p 前面/f 几/m 章/q 讨论/vn 的/ude1 数据/n 结构/n 中/f ，/wd 除了/p 广义/n 表/n 和/cc 树/n 以外/f ，/wd 都/d 可以/v 有/vyou 两/m 类/q 不同/a 的/ude1 存储/vn 结构/n ，/wd 它们/rr 是/vshi 由/p 不同/a 的/ude1 映象/n 方法/n (/wkz 顺序/n 映象/n 和/cc 链式/n 映象/n )/wky 得到/v 的/ude1 。/wj 由于/p 图/n 的/ude1 结构/n 比较/d 复杂/a ，/wd 任意/d 两/m 个/q 顶点/n 之间/f 都/d 可能/v 存在/v 联系/v ，/wd 因此/c 无法/v 以/p 数据/n 元素/n 在/p 存储区/n 中/f 的/ude1 物理/n 位置/n 来/vf 表示元素/n 之间/f 的/ude1 关系/n ，/wd 即/v 图/n 没有/v 顺序/n 映象/n 的/ude1 存储/vn 结构/n ，/wd 但/c 可以/v 借助/v 数组/n 的/ude1 数据/n 类型/n 表示元素/n 之间/f 的/ude1 关系/n 。/wj 另一方面/c ，/wd 用/p 多重/b 链/ng 表表示/n 图/n 是/vshi 自然/a 的/ude1 事/n ，/wd 它/rr 是/vshi 一/m 种/q 最/d 简单/a 的/ude1 链式/n 映象/n 结构/n ，/wd 即/d 以/p 一个/mq 由/p 一个/mq 数据/n 域/ng 和/cc 多/m 个/q 指针/n 域/ng 组成/v 的/ude1 结点/n 表示/v 图/n 中/f 一个/mq 顶/v 点/qt ，/wd 其中/rz 数据/n 域/ng 存储/v 该/rz 顶点/n 的/ude1 信息/n ，/wd 指针/n 域/ng 存储/v 指向/v 其/rz 邻接/v 点/qt 的/ude1 指针/n ，/wd 如/v 图/n 7．7/m 所/usuo 示/vg 为/p 图/n 7．1/m 中/f 有/vyou 向/p 图/n G/x ，/wd 和/cc 无/v 向/p 图/n G2/x 的/ude1 多重/b 链/ng 表/n 。/wj 但是/c ，/wd 由于/c 图/n 中/f 各个/rz 结点/n 的/ude1 度数/n 各/rz 不/d 相同/a ，/wd 最/d 大/a 度数/n 和/cc 最/d 小/a 度数/n 可能/v 相差/v 很/d 多/a ，/wd 因此/c ，/wd 若/c 按/p 度数/n 最/d 大/a 的/ude1 顶点/n 设计/v 结点/n 结构/n ，/wd 则/c 会/v 浪费/v 很多/m 存储单元/n ；/wf 反之/c ，/wd 若/c 按/p 每/rz 个/q 顶点/n 自己/rr 的/ude1 度数/n 设计/v 不同/a 的/ude1 结点/n 结构/n ，/wd 又/d 会/v 给/p 操作/v 带来/v 不便/an 。/wj 因此/c ，/wd 和/cc 树/n 类似/a ，/wd 在/p 实际/n 应用/vn 中/f 不宜/v 采用/v 这种/r 结构/n ，/wd 而/cc 应/v 根据/p 具体/a 的/ude1 图/n 和/cc 需要/v 进行/vx 的/ude1 操作/vn ，/wd 设计/v 恰当/a 的/ude1 结点/n 结构/n 和/cc 表/n 结构/n 。/wj 常用/a 的/ude1 有/vyou 邻接/v 表/n 、/wn 邻接/v 多重/b 表/n 和/cc 十字/n 链/ng 表/n 。/wj 下面/f 分别/d 讨论/v 。/wj 
    图/n 7．7/m 图/n 的/ude1 多重/b 链/ng 表/n 
(/wkz a/x )/wky Gl/x 的/ude1 多重/b 链/ng 表/n ；/wf (/wkz b/x )/wky G2/x 的/ude1 多重/b 链/ng 表/n 。/wj 7．2．1/m 数组/n 表示法/n 
  用/p 两/m 个/q 数组/n 分别/d 存储数据/n 元素/n (/wkz 顶点/n )/wky 的/ude1 信息/n 和/cc 数据/n 元素/n 之间/f 的/ude1 关系/n (/wkz 边/n 或/c 弧/n )/wky 的/ude1 信息/n 。/wj 其/rz 形式/n 描述/v 如下/vi ：/wp 
例如/v ，/wd 图/n 7．1/m 中/f G1/x 和/cc G2/x 的/ude1 邻接/v 矩阵/n 如/v 图/n 7．8/m 所/usuo 示/vg 。/wj 以/p 二/m 维/q 数组/n 表示/v 有/vyou ”/wyy 个/q 顶点/n 的/ude1 图/n 时/ng ，/wd 需/v 存放/v n/x 个/q 顶点/n 信息/n 和/cc n/x 。/wj 个/q 弧/n 信息/n 的/ude1 存储量/n 。/wj 若/c 考虑/v 无/v 向/p 图/n 的/ude1 邻接/v 矩阵/n 的/ude1 对称性/n ，/wd 则/c 可/v 采用/v 压缩/v 存储/vn 的/ude1 方式/n 只/d 存入/v 矩阵/n 的/ude1 下/vf 三/m 角/q (/wkz 或/c 上/f 三/m 角/q )/wky 元素/n 。/wj 
    借助于/v 邻接/v 矩阵/n 容易/ad 判定/v 任意/d 两/m 个/q 顶点/n 之间/f 是否/v 有/vyou 边/n (/wkz 或/c 弧/n )/wky 相连/vi ，/wd 并/cc 容易/ad 求得/v 各个/rz 顶点/n 的/ude1 度/qv 。/wj 对于/p 无/v 向/p 图/n ，/wd 顶点/n q/x 的/ude1 度/qv 是/vshi 邻接/v 矩阵/n 中/f 第/m {/n 行/ng (/wkz 或/c 第/m i/x 列/n )/wky 的/ude1 元素/n 之和/n ，/wd 即/v     TD/x (/wkz Vi/x )/wky =∑A/x [/wkz i/x ]/wky [/wkz J/x ]/wky (/wkz ”/wyy =MAX―VERTEX―NUM/x )/wky 对于/p 有/vyou 向/p 图/n ，/wd 第/m i/x 行/ng 的/ude1 元素/n 之和/n 为/p 顶点/n q/x 的/ude1 出/vf 度/v OD/x (/wkz a/x )/wky ，/wd 第/m J/x 列/n 的/ude1 元素/n 之和/n 为/p 顶点/n ai/x 的/ude1 。/wj 例如/v ，/wd 图/n 7．9/m 列出/v 了/ule 一个/mq 有/vyou 向/p 网/n 和/cc 它/rr 的/ude1 邻接/v 矩阵/n 。/wj 
    图/n 7．9/m  网/n 及其/cc 邻接/v 矩阵/n 
    (/wkz a/x )/wky 网/n N/x ；/wf (/wkz b/x )/wky 邻接/v 矩阵/n 。/wj 
    算法/n 7．1/m 是/vshi 在/p 邻接/v 矩阵/n 存储/vn 结构/n MGraph/x 上/f 对/p 图/n 的/ude1 构造/n 操作/vn 的/ude1 实现/vn 框架/n ，/wd 它/rr 根据/p 图/n G/x 的/ude1 种类/n 调用/v 具体/a 构造/n 算法/n 。/wj 如果/c G/x 是/vshi 无/v 向/p 网/n ，/wd 则/c 调用/v 算法/n 7．2/m 。/wj 构造/n 一个/mq 具有/v n/x 个/q 顶点/n 和/cc e/x 条/q 边/k 的/ude1 无/v 向/p 网/n G/x 的/ude1 时间/n 复杂度/n 是/vshi O/x (/wkz n/x 。/wj +e・n/x )/wky ，/wd 其中/rz 对/p 邻接/v 矩阵/n G．arcs/x 的/ude1 初始化/v 耗费/v 了/ule O/x (/wkz n2/x )/wky 的/ude1 时间/n 。/wj 
  Status/x  CreateGraph/x (/wkz MGraph/x ＆/n G/x )/wky {/n 
    ∥/w 采用/v 数组/n (/wkz 邻接/v 矩阵/n )/wky 表示法/n ，/wd 构造/v 图/n G/x 。/wj 
    8canf/x (/wkz ＆/n G．kind/x )/wky ；/wf 
    Hitch/x (/wkz G．kind/x )/wky l/x 
    ∞8e/x  DG：return/x  Creat/x ~/n G/x (/wkz G/x )/wky ；/wf   ∥/w 构造/n 有/vyou 向/p 图/n G/x 
    case/x  DN：return/x  CreateDN/x (/wkz G/x )/wky ；/wf   ∥/w 构造/n 有/vyou 向/p 网/n G/x 
    case/x  UDG：return/x  CreateUDG/x (/wkz G/x )/wky ；/wf   ∥/w 构造/n 无/v 向/p 图/n G/x 
    ∞/m 的/ude1 UDN：return/x  CreateUDN/x (/wkz G/x )/wky ；/wf   ∥/w 构造/n 无/v 向/p 网/n G/x 
    default：return/x  ERROR/x ；/wf 
    }/n 
＼fl/x  CreateGraph/x 
    算法/n 7．1/m 
 Status/x  CreateUDN/x (/wkz MGraph/x &/n G/x )/wky {/n 
    ∥/w 采用/v 数组/n (/wkz 邻接/v 矩阵/n )/wky 表示法/n ，/wd 构造/v 无/v 向/p 网/n G/x 。/wj 
　　SC．aDf/x (/wkz ＆/n G．vexnum/x ，/wd ＆/n G．arcnum/x ，/wd &/n Inclnfo/x )/wky ；/wf     ／／Inclnfo/x 为/p 0/m 则/c 各/rz 弧/n 不/d 含/v 其它/rz 信息/n 
　　for/x (/wkz i=0/x ；/wf i/x </n G．vexntm/x ；/wf ++i/x )/wky s∞nf/x (/wkz &/n G．vexs/x [/wkz i/x ]/wky )/wky ；/wf   ∥/w 构造/n 顶点/n 向量/n 
    for/x (/wkz i=0/x ；/wf i/x </n G．vexnum/x ；/wf ++i/x )/wky     ∥/w 初始化/v 邻接/v 矩阵/n 
    for/x (/wkz J=0/x ；/wf J/x </n G．v/x ~/n num/x ；/wf ++J/x )/wky G．arcs/x [/wkz i/x ]/wky [/wkz J/x ]/wky =/m {/n INFINITY/x ，/wd NULL/x }/n ；/wf   ∥/w {/n adj/x ，/wd info/x 
    for/x (/wkz k=0/x ；/wf k/x </n G．arcnum/x ；/wf ++k/x )/wky {/n     ∥/w 构造/n 邻接/v 矩阵/n 
    8csnf/x (/wkz &/n vl/x ，/wd ＆/n v2/x ，/wd &/n w/x )/wky ；/wf     ／／/m 输入/v 一/m 条/q 边/k 依附/v 的/ude1 顶点/n 及/cc 权/n 值/n 
    i=LocateVex/x (/wkz G/x ，/wd v1/x )/wky ；/wf J=LocateVex/x (/wkz G/x ，/wd v2/x )/wky ；/wf   ∥/w 确定/v vl/x 和/cc v2/x 在/p G/x 中/b 位置/n 
    G．arcs/x [/wkz i/x ]/wky [/wkz J/x ]/wky ．/w adj=w/x ；/wf     ∥/w 弧/n </n v1/x ，/wd v2/x >/n 的/ude1 权/n 值/n 
    if/x (/wkz IncInfo/x )/wky Input/x (/wkz */n G．arCS/x [/wkz i/x ]/wky [/wkz j/x ]/wky ．/w info/x )/wky ；/wf   ∥/w 若/c 弧/n 含有/v 相关/vn 信息/n ，/wd 则/c 输入/v 
    G．arcs/x [/wkz j/x ]/wky [/wkz i/x ]/wky =G．arCS/x [/wkz i/x ]/wky [/wkz J/x ]/wky ；/wf     ／／/m 置/v </n v1/x ，/wd v2/x >/n 的/ude1 对称/a 弧/n </n V2/x ，/wd v1/x >/n 
    }/n     。/wj 
    return/x  OK/x ；/wf 
・/w   162・/m 
、/wn ff/x  CreateUDN/x 
算法/n 7．2/m 
　　在/p 这个/rz 存储/vn 结构/n 上/f 也/d 易于/v 实现/v 7．2/m 节/q 所/usuo 列/v 的/ude1 基本/a 操作/vn 。/wj 如/c ，/wd FIRS/x "/n r―ADJ/x (/wkz G/x ，/wd v/x )/wky 找/v a/x 的/ude1 第一/m 个/q 邻接/v 点/qt 。/wj 首先/c ，/wd 由/p LOC―VERTEX/x (/wkz G/x ，/wd 秒/qt )/wky 找到/v 口/n 在/p 图/n G/x 中/f 的/ude1 位置/n ，/wd 即/v a/x 在/p 一/m 维/q 数组/n vexs/x 中/f 的/ude1 序号/n i/x ，/wd 则/c 二/m 维/q 数组/n arcs/x 中/f 第/m i/x 行/ng 上/f 第一/m 个/q adj/x 域/n 的/ude1 值/n 为/v “/wyz 1/m ”/wyy 的/ude1 分量/n 所在/n 列/v 号/n j/x ，/wd 便/d 为/v t/x ，/wd 的/ude1 第一/m 个/q 邻接/v 点/qt 在/p 图/n G/x 中/f 的/ude1 位置/n 。/wj 同/p 理/n ，/wd 下/vf 一个/mq 邻接/v 点/qt 在/p 图/n G/x 中/f 的/ude1 位置/n 便/d 为/v j/x 列/n 之后/f 第一/m 个/q adj/x 域/n 的/ude1 值/n 为/v “/wyz 1/m ”/wyy 的/ude1 分量/n 所在/n 列/v 号/q 。/wj 
　　7．2．2/m 邻接/v 表/n 
    邻接/v 表/n (/wkz Adjacency/x  IAst/x )/wky 是/vshi 图/n 的/ude1 一/m 种/q 链式/n 存储/v 结构/n 。/wj 在/p 邻接/v 表/n 中/f ，/wd 对/p 图/n 中/f 每个/r 顶点/n 建立/v 一个/mq 单链/n 表/n ，/wd 第/m i/x 个/q 单链/n 表/n 中/f 的/ude1 结点/n 表示/v 依附/v 于/p 顶点/n 功/n 的/ude1 边/n (/wkz 对/p 有/vyou 向/p 图/n 是/vshi 以/p 顶点/n q/x 为/v 尾/ng 的/ude1 弧/n )/wky 。/wj 每个/r 结点/n 由/p 三/m 个/q 域/ng 组成/v ，/wd 其中/rz 邻/ng 接点/n 域/ng (/wkz adjvex/x )/wky 指示/n 与/cc 顶点/n 口/q ；/wf 邻接/v 的/ude1 点/qt 在/p 图/n 中/f 的/ude1 位置/n ，/wd 链/ng 域/ng (/wkz nextarc/x )/wky 指示/n 下/f 一/m 条/q 边/n 或/c 弧/n 的/ude1 结点/n ；/wf 数据/n 域/ng (/wkz info/x )/wky 存储/vn 和/cc 边/n 或/c 弧/n 相关/vi 的/ude1 信息/n ，/wd 如/v 权/n 值/n 等/udeng 。/wj 每个/r 链/ng 表/n 上/f 附设/v 一个/mq 表头/n 结点/n 。/wj 在/p 表头/n 结点/n 中/f ，/wd 除了/p 设有/v 链/ng 域/ng (/wkz firstarc/x )/wky 指向/v 链/ng 表/n 中/f 第一/m 个/q 结点/n 之外/f ，/wd 还/d 设有/v 存储/vn 顶点/n 矶/n 的/ude1 名/q 或/c 其它/rz 有关/vn 信息/n 的/ude1 数据/n 域/ng (/wkz data/x )/wky 。/wj 如/v 下/vf 图/n 所/usuo 示/vg 
    表/n 结点/n 
adjvex/x [/wkz nextarc/x  info/x 
    头/n 结点/n 
这些/rz 表头/n 结点/n (/wkz 可以/v 链/ng 相接/vi )/wky 通常/d 以/p 顺序/n 结构/n 的/ude1 形式/n 存储/vn ，/wd 以便/d 随机/d 访问/v 任/v 一/m 顶/q 点/qt 的/ude1 链/ng 表/n 。/wj 例如/v 图/n 7．10/m (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 所/usuo 示/vg 分别/d 为/v 图/n 7．1/m 中/f G/x 。/wj 和/cc Gz/x 的/ude1 邻接/v 表/n 。/wj 一个/mq 图/n 的/ude1 邻接/v 表存储/n 结构/n 可/v 形式/n 地/ude2 说明/v 如下/vi ：/wp 
∥/w …/ws 图/n 的/ude1 邻接/v 表存储/n 表示/v …/ws 
#/n define/x  MAX-VERTE-NDM/x  20/m 
td/x |/n I：t/x  ArcNode/x  1/m 
  int/x     adjvex/x ；/wf 。/wj     ∥/w 该/rz 弧/n 所/usuo 指向/v 的/ude1 顶点/n 的/ude1 位置/n 
  struct/x  ArcNode/x   */n nextarc/x ；/wf     ∥/w 指向/v 下/vf 一/m 条/q 弧/n 的/ude1 指针/n 
  InfoType/x     */n info/x ；/wf     ∥/w 该/rz 弧/n 相关/vn 信息/n 的/ude1 指针/n 
IArcNode/x ；/wf     
typed/x 《/wkz 8truer/x  VNode/x {/n 
  VertexType/x  data/x ；/wf 
  ArcNode/x     */n firstarc：/x 
IYNode/x ，/wd AdjList/x [/wkz MAX―VERTEX―NUM/x ]/wky ；/wf 
typedef/x  struct/x {/n 
  AdjList/x  veIrices：/x 
  i/x |/n It/x     vex21um．arcnum/x ；/wf 
  int/x   kind/x ~/n 
f/x  ALGraph/x ；/wf 
∥/w 顶点/n 信息/n 
∥/w 指向/v 第一/m 条/q 依附/v 该/rz 顶点/n 的/ude1 弧/n 的/ude1 指针/n 
∥/w 图/n 的/ude1 当前/t 顶点/n 数/n 和/cc 弧/n 数/m 
∥/w 图/n 的/ude1 种类/n 标志/n 
    图/n 7．10/m 邻接/v 表/n 和/cc 逆/vg 邻接/v 表/n 
(/wkz a/x )/wky G1/x 的/ude1 邻接/v 表/n ；/wf (/wkz b/x )/wky G2/x 的/ude1 邻接/v 表/n ；/wf (/wkz c/x )/wky G1/x 的/ude1 逆/vg 邻接/v 表/n 。/wj 	
若/c 无/v 向/p 图/n 中/f 有/vyou n/x 个/q 顶点/n 、/wn e/x 条/q 边/k ，/wd 则/c 它/rr 的/ude1 邻接/v 表/vg 需/v n/x 个头/n 结点/n 和/cc 2/m 。/wj 个/q 表/n 结点/n 。/wj 显然/a ，/wd 在/p 边/d 稀疏/a (/wkz e/x 《/wkz ＼/m 的/ude1 情况/n 下/f ，/wd 用/p 邻接/v 表表示/n 图/n 比/p 邻接/v 矩阵/n 节省存储/n 空间/n ，/wd 当/v 和/cc 边/d 相关/vi 的/ude1 信息/n 较/d 多/a 时/ng 更/d 是/vshi 如此/rzv 。/wj 
    在/p 无/v 向/p 图/n 的/ude1 邻接/v 表/n 中/f ，/wd 顶点/n t/x ，/wd i/x 的/ude1 度/qv 恰/d 为/v 第/m i/x 个/q 链/ng 表/n 中/f 的/ude1 结/v 点数/n ；/wf 而/cc 在/p 有/vyou 向/p 图/n 中/f ，/wd 第/m i/x 个/q 链/ng 表/n 中/f 的/ude1 结点/n 个数/n 只是/c 顶点/n q/x 的/ude1 出/vf 度/ng ，/wd 为/p 求/v 入/v 度/qv ，/wd 必须/d 遍历/n 整个/b 邻接/v 表/n 。/wj 在/p 所有/b 链/ng 表/n 中/f 其/rz 邻/ng 接点/n 域/ng 的/ude1 值/n 为/v i/x 的/ude1 结点/n 的/ude1 个数/n 是/vshi 顶点/n n/x 的/ude1 入/v 度/qv 。/wj 有时/d ，/wd 为了/p 便于/v 确定/v 顶点/n 的/ude1 入/v 度/qv 或/c 以/p 顶点/n 让/v 为/p 头/n 的/ude1 弧/n ，/wd 可以/v 建立/v 一个/mq 有/vyou 向/p 图/n 的/ude1 逆/vg 邻接/v 表/n ，/wd 即/d 对/p 每个/r 顶点/n n/x 建立/v 一个/mq 链接/n 以/p u/x ；/wf 为/p 头/n 的/ude1 
弧/n 的/ude1 表/n ，/wd 例如/v 图/n 7．10/m (/wkz c/x )/wky 所/usuo 示/vg 为/v 有/vyou 向/p 图/n G1/x 的/ude1 逆/vg 邻接/v 表/n j/x 
    在/p 建立/v 邻接/v 表/n 或/c 逆/vg 邻接/v 表/vg 时/ng ，/wd 若/c 输入/v 的/ude1 顶点/n 信息/n 即/d 为/v 顶点/n 的/ude1 编号/n ，/wd 则/c 建立/v 邻接/v 表/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz ，/wd z+e/x )/wky ，/wd 否则/c 。/wj 需要/v 通过/p 查找/v 才/d 能/v 得到/v 顶点/n 在/p 图/n 中/b 位置/n ，/wd 则/c 时间/n 复杂度/n 为/v o/x (/wkz n・e/x )/wky 。/wj 
　　在/p 邻接/v 表/n 上/f 容易/ad 找到/v 任/v 一/m 顶/q 点/qt 的/ude1 第一/m 个/q 邻接/v 点/qt 和/cc 下/vf 一个/mq 邻接/v 点/qt ，/wd 但/c 要/v 判定/v 任意/d 两/m 个/q 顶点/n (/wkz q/x 和/cc q/x )/wky 之间/f 是否/v 有/vyou 边/d 或/c 弧/n 相连/vi ，/wd 则/c 需/v 搜索/v 第/m i/x 个/q 或/c 第/m j/x 个/q 链/ng 表/n ，/wd 因此/c ，/wd 不及/vi 邻接/v 矩阵/n 方便/an 。/wj 
　　7．2．3十/m 字/n 链/ng 表/n 
    十字/n 链/ng 表/n (/wkz Orthogonal/x  List/x )/wky 是/vshi 有/vyou 向/p 图/n 的/ude1 另/rz 一/m 种/q 链式/n 存储/v 结构/n 。/wj 可以/v 看成/v 是/vshi 将/d 有/vyou 向/p 图/n 的/ude1 邻接/v 表/n 和/cc 逆/vg 邻接/v 表/vg 结合/v 起来/vf 得到/v 的/ude1 一/m 种/q 链/ng 表/n 。/wj 在/p 十字/n 链/ng 表/n 中/f ，/wd 对/p 应/v 于/p 有/vyou 向/p 图/n 中/f 每/rz 一/m 条/q 弧/n 有/vyou 一个/mq 结点/n ，/wd 对/p 应/v 于/p 每个/r 顶点/n 也/d 有/vyou 一个/mq 结点/n 。/wj 这些/rz 结点/n 的/ude1 结构/n 如下/vi 所/usuo 示/vg ：/wp 
    弧/n 结点/n     顶点/n 结点/n ~/n 
    data-firstin/x  firstout/x 
在/p 弧/n 结点/n 中/f 有/vyou 五/m 个/q 域/n ：/wp 其中/rz 尾/ng 域/ng (/wkz tailvex/x )/wky 和/cc 头/n 域/ng (/wkz I/x ~/n eadvex/x )/wky 分别/d 指示/v 弧/n 尾/ng 和/cc 弧/n 头/n 这/rzv 两/m 个/q 顶点/n 在/p 图/n 中/f 的/ude1 位置/n ，/wd 链/ng 域/n hlink/x 指向/v 弧/n 头/q 相同/a 的/ude1 下/vf 一/m 条/q 弧/n ，/wd 而/cc 链/ng 域/n tlink/x 指向/v 弧/n 尾/ng 相同/a 的/ude1 下/vf 一/m 条/q 弧/n ，/wd inlo/x 域/ng 指向/v 该/rz 弧/n 的/ude1 相关/vn 信息/n 。/wj 弧/n 头/q 相同/a 的/ude1 弧/n 在/p 同一/b 链/ng 表/n 上/f ，/wd 弧/n 尾/ng 相同/a 的/ude1 弧/n 也/d 在/p 同一/b 链/ng 表/n 上/f 。/wj 它们/rr 的/ude1 头/n 结点/n 即/d 为/v 顶点/n 结点/n ，/wd 它/rr 由/p 三/m 个/q 域/ng 组成/v ：/wp 其中/rz data/x 域/n 存储/vn 和/cc 顶点/n 相关/vi 的/ude1 信息/n ，/wd 如/v 顶点/n 的/ude1 名称/n 等/udeng ；/wf firstin/x 和/cc firstout/x 为/p 两/m 个/q 链/ng 域/ng ，/wd 分别/d 指向/v 以/p 该/rz 顶点/n 为/p 弧/n 头/n 或/c 弧/n 尾/ng 的/ude1 第一/m 个/q 弧/n 结点/n 。/wj 例如/v ，/wd 图/n 7．1l/x (/wkz a/x )/wky 中/f 所/usuo 示/vg 图/n 的/ude1 十字/n 链/ng 表/n 如/v 图/n 7．1l/x (/wkz b/x )/wky 所/usuo 示/vg 。/wj 若/c 将/d 有/vyou 向/p 图/n 的/ude1 邻接/v 矩阵/n 看成/v 是/vshi 稀疏/a 矩阵/n 的话/udh ，/wd 则/c 十字/n 链/ng 表/n 也/d 可以/v 看成/v 是/vshi 邻接/v 矩阵/n 的/ude1 链/ng 表存储/n 结构/n ，/wd 在/p 图/n 的/ude1 十字/n 链/ng 表/n 中/f ，/wd 弧/n 结点/n 所在/n 的/ude1 链/ng 表/vg 非/b 循环/vn 链/ng 表/n ，/wd 结点/n 之间/f 相对/b 位置/n 自然/d 形成/v ，/wd 不/d 一定/d 按/p 顶点/n 序号/n 有序/a ，/wd 表头/n 结点/n 即/v 顶点/n 结点/n ，/wd 它们/rr 之间/f 而是/c 顺序/n 存储/vn 。/wj 
图/n 7．11/m 有/vyou 向/p 图/n 的/ude1 十字/n 链/ng 表/n 
    有/vyou 向/p 图/n 的/ude1 十字/n 链/ng 表存储/n 表示/v 的/ude1 形式/n 说明/v 如下/vi 所/usuo 示/vg ：/wp 
    ∥/w 有/vyou 向/p 图/n 的/ude1 十字/n 链/ng 表存储/n 表示/v 
    #/n d/x 《/wkz iMAX．VERTEX/x 一/m Ⅻ/m JM/x  20/m 
    t/x ’/wyy 『/wyz P．d81I/x 、/wn 1ct/x  Arcl/x ~/n x/x {/n 
    in/x 七/m tailvex/x ，/wd headvex/x ；/wf ∥/w 该/rz 弧/n 的/ude1 尾/ng 和/cc 头顶/n 点/qt 的/ude1 位置/n 
    8truct/x  ArcBox/x   */n hl／nk/x ，/wd */n tlLnk/x ；/wf   ／／/m 分别/d 为/v 弧/n 头/q 相同/a 和/cc 弧/n 尾/ng 相同/a 的/ude1 弧/n 的/ude1 链/ng 域/ng 
    InfoType/x     */n info/x ；/wf     ／／/m 该/rz 弧/n 相关/vn 信息/n 的/ude1 指针/n 
    }/n ArcBox/x ；/wf 
    typ/x |/n ld．f/x  8tZ％1/x ~/n '/n t/x  VexNode/x {/n 
    VertexType/x  data/x ；/wf 
    Axe．Box/x     */n firstin/x ，/wd '/n ．/w firstout/x ；/wf //n //n 分别/d 指向/v 该/rz 顶点/n 第一/m 条/q 入/v 弧/n 和/cc 出/vf 弧/n 
    }/n VexNode/x ；/wf 
    tl・d・f/x  struct/x {/n 
    VexNode/x  xlist/x [/wkz MAX―VERTEX―NUM/x ]/wky ；/wf ∥/w 表头/n 向量/n 
        vexnum/x ，/wd arcnum/x ；/wf     ∥/w 有/vyou 向/p 图/n 的/ude1 当前/t 顶点/n 数/n 和/cc 弧/n 数/m 
    }/n OLGraph/x ；/wf 
    只要/c 输入/v ，/wd z/x 个/q 顶点/n 的/ude1 信息/n 和/cc e/x 条/q 弧/n 的/ude1 信息/n ，/wd 便/d 可/v 建立/v 该/rz 有/vyou 向/p 图/n 的/ude1 十字/n 链/ng 表/n ，/wd 其/rz 算法/n 如/v 算法/n 7．3/m 所/usuo 示/vg 。/wj 
Status/x  CreateDG/x (/wkz OLGraph/x ＆/n G/x )/wky {/n 
  ∥/w 采用/v 十字/n 链/ng 表存储/n 表示/v ，/wd 构造/v 有/vyou 向/p 图/n G/x (/wkz G．kind=DG/x )/wky 。/wj 
  sc-nf/x (/wkz ＆/n G．vexnl/x ~/n ，/wd ＆/n G．arcnum/x ，/wd &/n IncInfo/x )/wky ；/wf     ∥/w IncInfo/x 为/p 0/m 则/c 各/rz 弧/n 不/d 含/v 其它/rz 信息/n 
  for/x (/wkz i/x 。/wj 0/m ；/wf i/x </n G．vex/x ~/n um/x ；/wf ++i/x )/wky {/n     ∥/w 构造/n 表头/n 向量/n 
    。/wj ∞f/x (/wkz &/n G．xlist/x [/wkz i/x ]/wky ．/w data/x )/wky ；/wf     ／／/m 输入/vn 顶点/n 值/n 
    G・xlist/x 【/wkz iJ．firstin=NULL/x ；/wf G．xlist/x [/wkz i/x ]/wky ．/w firstout=BT／LL/x ；/wf ∥/w 初始化/v 指针/n 
}/n 
for/x (/wkz k：0/x ；/wf k/x </n G．arcnum/x ；/wf ++k/x )/wky {/n 
  ec∞f/x (/wkz &/n vl/x ，/wd ＆/n v2/x )/wky ；/wf 
  i=LocateVex/x (/wkz G/x ，/wd v1/x )/wky ；/wf   J=LocateVex/x (/wkz G/x ，/wd v2/x )/wky ；/wf 
  P=/x (/wkz ArcBox/x */n )/wky ulloc/x (/wkz sizeof/x (/wkz ArcBox/x )/wky )/wky ；/wf 
∥/w 输入/v 各/rz 弧/n 并/cc 构造/n 十字/n 链/ng 表/n 
∥/w 输入/v 一/m 条/q 弧/n 的/ude1 始/vg 点/n 和/cc 终点/n 
∥/w 确定/v v1/x 和/cc v2/x 在/p G/x 中/b 位置/n 
∥/w 假定/n 有/vyou 足够/vn 空间/n 
    。/wj p=/x {/n i/x ，/wd j/x ，/wd G．xlist/x [/wkz j/x ]/wky ．/w firstin/x ，/wd G．xlist/x [/wkz i/x ]/wky ．/w firstout/x ，/wd NuLL/x }/n   ∥/w 对/p 弧/n 结点/n 赋值/v 
    ∥/w {/n tail・vex/x ，/wd headvex/x ，/wd hl/x  ink/x ，/wd tlinJ/x 【/wkz ，/wd info/x }/n 
    G．xlist/x [/wkz j/x ]/wky ．/w firstin：G．xlist/x [/wkz i/x ]/wky ．/w firstout=p/x ；/wf     ∥/w 完成/v 在/p 入/v 弧/n 和/cc 出/vf 弧/n 链/ng 头/n 的/ude1 插入/v 
    if/x (/wkz IncInfo/x )/wky Input/x (/wkz ‘/wyz p-/x >/n info/x )/wky ；/wf     ∥/w 若/c 弧/n 含有/v 相关/vn 信息/n ，/wd 则/c 输入/v 
  }/n 
＼l/x }/n CreateDG/x 
    算法/n 7．3/m 
    在/p 十字/n 链/ng 表/n 中/f 既/c 容易/ad 找到/v 以/p 让/v 为/v 尾/ng 的/ude1 弧/n ，/wd 也/d 容易/ad 找到/v 以/p ui/x 为/p 头/n 的/ude1 弧/n ，/wd 因而/c 容易/ad 求得/v 顶点/n 的/ude1 出/vf 度/v 和/cc 入/v 度/qv (/wkz 或/c 需要/v ，/wd 可/v 在/p 建立/v 十字/n 链/ng 表/n 的/ude1 同时/c 求/v 出/vf )/wky 。/wj 同时/c ，/wd 由/p 算法/n 7．3/m 可知/v ，/wd 建立/v 十字/n 链/ng 表/n 的/ude1 时间/n 复杂度/n 和/cc 建立/v 邻接/v 表/n 是/vshi 相同/a 的/ude1 。/wj 在/p 某些/rz 有/vyou 向/p 图/n 的/ude1 应用/vn 中/f ，/wd 十字/n 链/ng 表/n 是/vshi 很/d 有/vyou 用/v 的/ude1 工具/n 。/wj     
7．2．4/m 邻接/v 多重/b 表/n 
    邻接/v 多重/b 表/n (/wkz ．/w Adjacency/x  Multilist/x )/wky 是/vshi 无/v 向/p 图/n 的/ude1 另/rz 一/m 种/q 链式/n 存储/v 结构/n 。/wj 虽然/c 邻接/v 表/n 是/vshi 无/v 向/p 图/n 的/ude1 一/m 种/q 很/d 有效/a 的/ude1 存储/vn 结构/n ，/wd 在/p 邻接/v 表/n 中/f 容易/ad 求得/v 顶点/n 和/cc 边/n 的/ude1 各种/rz 信息/n 。/wj 但是/c ，/wd 在/p 邻接/v 表/n 中/f 每/rz 一/m 条/q 边/n (/wkz ％u/x ，/wd )/wky 有/vyou 两/m 个/q 结点/n ，/wd 分别/d 在/p 第/m i/x 个/q 和/cc 第/m 歹/ag 个/ng 链/ng 表/n 中/f ，/wd 这/rzv 给/p 某些/rz 图/n 的/ude1 操作/vn 带来/v 不便/an 。/wj 例如/v 在/p 某些/rz 图/n 的/ude1 应用/vn 问题/n 中/f 需要/v 对/p 边/n 进行/vx 某种/rz 操作/vn ，/wd 如/c 对/p 已/d 被/pbei 搜索/v 过/uguo 的/ude1 边/d 作/v 记号/n 或/c 删除/v 一/m 条/q 边/n 等/udeng ，/wd 此时/r 需要/v 找到/v 表示/v 同/p 一/m 条/q 边/k 的/ude1 两/m 个/q 结点/n 。/wj 因此/c ，/wd 在/p 进行/vx 这/rzv 一/m 类/q 操作/vn 的/ude1 无/v 向/p 图/n 的/ude1 问题/n 中/f 采用/v 邻接/v 多重/b 表/n 作/v 存储/vn 结构/n 更/d 为/v 适宜/v 。/wj 
    邻接/v 多重/b 表/n 的/ude1 结构/n 和/cc 十字/n 链/ng 表/vg 类似/a 。/wj 在/p 邻接/v 多重/b 表/n 中/f ，/wd 每/rz 一/m 条/q 边/k 用/v 一个/mq 结点/n 表示/v ，/wd 它/rr 由/p 如下/vi 所/usuo 示/vg 的/ude1 六/m 个/q 域/ng 组成/v ：/wp 
maTk/x  l/x   |/n v/x “/wyz   1/m   i/x |/n ink/x   l/x   jvex/x   1/m   ilink/x   l/x   in/x {/n o/x 
其中/rz ，/wd mark/x 为/p 标志/n 域/ng ，/wd 可/c 用/v 以/p 标记/n 该/rz 条/q 边/k 是否/v 被/pbei 搜索/v 过/uguo ；/wf ivex/x 和/cc ivex/x 为/p 该/rz 边/d 依附/v 的/ude1 两/m 个/q 顶点/n 在/p 图/n 中/f 的/ude1 位置/n ；/wf ilink/x 指向/v 下/vf 一/m 条/q 依附/v 于/p 顶点/n ivex/x 的/ude1 边/n ；/wf jlink/x 指向/v 下/vf 一/m 条/q 依附/v 于/p 顶点/n jvex/x 的/ude1 边/n ，/wd info/x 为/p 指向/v 和/cc 边/d 相关/vi 的/ude1 各种/rz 信息/n 的/ude1 指针/n 域/ng 。/wj 每/rz 一个/mq 顶/v 点/qt 也/d 用/v 一个/mq 结点/n 表示/v ，/wd 它/rr 由/p 如下/vi 所/usuo 示/vg 的/ude1 两/m 个/q 域/ng 组成/v ：/wp 
其中/rz ，/wd data/x 域/n 存储/vn 和/cc 该/rz 顶点/n 相关/vi 的/ude1 信息/n ，/wd firstedge/x 域/ng 指示/v 第一/m 条/q 依附/v 于/p 该/rz 顶点/n 的/ude1 边/n 。/wj 例如/v ，/wd 图/n 7．12/m 所/usuo 示/vg 为/p 无/v 向/p 图/n G2/x 的/ude1 邻接/v 多重/b 表/n 。/wj 在/p 邻接/v 多重/b 表/n 中/f ，/wd 所有/b 依附/v 于/p 同/p 一/m 顶/q 点/qt 的/ude1 边/d 串联/v 在/p 同一/b 链/ng 表/n 中/f ，/wd 由于/c 每/rz 条/q 边/k 依附/v 于/p 两/m 个/q 顶点/n ，/wd 则/c 每个/r 边/d 结点/n 同时/n 链接/n 在/p 两/m 个/q 链/ng 表/n 中/f 。/wj 可见/c ，/wd 对/p 无/v 向/p 图/n 而言/uls ，/wd 其/rz 邻接/v 多重/b 表/n 和/cc 邻接/v 表/n 的/ude1 差别/n ，/wd 仅仅/d 在于/v 同/p 一/m 条/q 边/k 在/p 邻接/v 表/n 中/f 用/v 两/m 个/q 结点/n 表示/v ，/wd 而/cc 在/p 邻接/v 多重/b 表/n 中/f 只/d 有/vyou 一个/mq 结点/n 。/wj 因此/c ，/wd 除了/p 在/p 边/k 结点/n 中/f 增加/v 一个/mq 标志/n 域/ng 外/f ，/wd 邻接/v 多重/b 表/n 所/usuo 需/v 的/ude1 存储量/n 和/cc 邻接/v 表/vg 相同/a 。/wj 在/p 邻接/v 多重/b 表/n 上/f ，/wd 各种/rz 基本/a 操作/vn 的/ude1 实现/vn 亦/d 和/cc 邻接/v 表/vg 相似/a 。/wj 邻接/v 多重/b 表/n 的/ude1 类型/n 说明/v 如下/vi ：/wp 
图/n 7/m  12/m 无/v 向/p 囤/v G：/x 的/ude1 邻接/v 多重/b 表/n 
∥/w     无/v 向/p 图/n 的/ude1 邻接/v 多重/b 表存储/n 表示/v 
#/n “/wyz fi/x …/ws MAX/x  v/x Ⅷ/m 20/m 
typedef/x  emnu/x  junviglted．/x ～/ws ited/x }/n V1sltIf/x {/n 
typedf/x  Bt/x Ⅲ/m E‰I/x 
  vlsitlf/x     ma/x ；/wf     ∥/w 访/v 同/p 标记/n 
  int/x     …/ws ．/w ]/wky vex．/x     ∥/w 该/v 边/k 依附/v 的/ude1 两/m 个/q 顶点/n 的/ude1 位置/n 
  Btruct/x  EBo11nk/x ，/wd 。/wj ]/wky link/x ；/wf ∥/w 分别/d 指向/v 依附/v 这/rzv 两/m 个/q 顶点/n 的/ude1 下/vf 一/m 条/q 边/n 
  Inf00e/x     */n it0/x ；/wf     ∥/w 该/rz 边/n 信息/n 指针/n 
lEB0/x */n ：/wp 
‘/wyz ypedef/x  8tnlct/x  v/x 【/wkz B/x 。/wj x/x  I/x 
  Verteml/x Ⅶ/m e/x   data/x ；/wf 
  EB/x 。/wj x/x     */n flrstedge．/x     ∥/w 指向/v 第一/m 条/q 依附/v 该/rz 顶点/n 的/ude1 边/n 
{/n ve/x )/wky ∞ox：/x 
t/x “/wyz “/wyz f/x  8tfuct/x  I/x 
  ve/x 心/n Dx/x  ad/x ]/wky list/x 【/wkz MA/x 】/wky (/wkz ．/w VERx．NUMJ/x {/n 
  i/x     um/x ，/wd eem/x 皿/x ；/wf     ∥/w 无/v 向/p 图/n 的/ude1 当前/t 顶点/n 数/n 和/cc 边/d 数/v 
lAMLm∞/x ；/wf 
7．3/m 图/n 的/ude1 遍历/n 
  和/cc 树/n 的/ude1 遍历/n 类似/a ，/wd 在/p 此/rzs ．/w 我们/rr 希望/v 从/p 图/n 中/f 某/rz 一/m 顶点/n 出发/vi 访/v 遍/qv 图/n 中/f 其余/rz 顶点/n ，/wd 且/c 使/v 每/rz 一个/mq 顶点/n 仅/d 被/pbei 访问/v 一/m 次/qv 。/wj 这/rzv 一/m 过程/n 就/d 叫做/v 图/n 的/ude1 遍历/n (/wkz Travers・ng/x  Graph/x )/wky 。/wj 图/n 的/ude1 遍历/n 算法/n 是/vshi 求解/vi 图/n 的/ude1 连/ulian 通性/n 问题/n 、/wn 拓扑/n 排序/vn 和/cc 求/v 关键路径/n 等/udeng 算法/n 的/ude1 基础/n 。/wj 
  然而/c ，/wd 图/n 的/ude1 遍历/n 要/v 比/p 树/n 的/ude1 遍历/n 复杂/a 得/ude3 多/a 。/wj 因为/p 图/n 的/ude1 任/v 一/m 顶/q 点/qt 都/d 可能/v 和/cc 其余/rz 的/ude1 顶点/n 相邻/vd 接/v 。/wj 所以/c 在/p 访问/v 了/ule 某个/rz 顶点/n 之后/f ，/wd 可能/v 沿着/p 某/rz 条/q 路径搜索/n 之后/f ，/wd 又/d 回到/v 该/rz 顶点/n 上/f 。/wj 例如/v 图/n 7．1/m (/wkz b/x )/wky 中/f 的/ude1 G2/x ，/wd 由于/c 图/n 中/f 存在/v 回路/n ，/wd 因此/c 在/p 访问/v 了/y 。/wj l/x ，/wd ％/wb "/n ，/wd 。/wj 4/m 之后/f ，/wd 沿着/p 边/n (/wkz ”/wyy 4/m ，/wd ”/wyy 1/m )/wky 又/d 可/v 访问/v 到/v ”/wyy -/wp 。/wj 为了/p 避免/v 同一/b 顶点/n 被/pbei 访/v 间/f 多/m 次/qv ，/wd 在/p 遍历/n 图/n 的/ude1 过程/n 中/f ，/wd 必须/d 记/v 下/vf 每个/r 已/d 访问/v 过/uguo 的/ude1 顶点/n 。/wj 为此/bl ，/wd 我们/rr 可以/v 设/v 一个/mq 辅助/vn 数组/n vts・L/x 【/wkz O/x  n-1/x ]/wky ，/wd 它/rr 的/ude1 初始值/n 置/v 为/v ”/wyy 假/a ”/wyy 或者/c 零/m ，/wd 一旦/d 访问/v 了/ule 顶点/n ％/wb 便/d 置/v vtedn/x ]/wky 为/p “/wyz 真/a ”/wyy 或者/c 为/v 被/pbei 访问/v 时/ng 的/ude1 次序/n 号/q 。/wj 
　  通常/d 有/vyou 两/m 条/q 遍历/n 图/n 的/ude1 路径/n ：/wp 深度/n 优先/vd 搜索/v 和/cc 广度/n 优先/vd 搜索/v 。/wj 它们/rr 对/p 无/v 向/p 图/n 和/cc 有/vyou 向/p 图/n 都/d 适用/vi 。/wj 
7．3．1/m 深度/n 优先/vd 搜索/v 
    深度/n 优先/vd 搜索/v (/wkz [/wkz )/wky epth―First/x  Search/x )/wky 遍历/n 类似/v 于/p 树/n 的/ude1 先/d 根/q 遍历/n ，/wd 是/vshi 树/n 的/ude1 先/d 根/q 遍历/n 的/ude1 推广/vn 。/wj 
　　假设/v 初始状态/n 是/vshi 图/n 中/b 所有/b 顶点/n 未曾/d 被/pbei 访问/v ，/wd 则/c 深度/n 优先/vd 搜索/v 可/v 从/p 图/n 中/f 某个/rz 顶点/n 可/v 出发/vi ，/wd 访问此/n 顶点/n ，/wd 然后/c 依次/d 从/p n/x 的/ude1 未/d 被/pbei 访问/v 的/ude1 邻接/v 点/qt 出发/vi 深度/n 优先/vd 遍历/n 图/n ，/wd 直至/v 图/n 中/b 所有/b 和/cc u/x 有/vyou 路径/n 相通/vi 的/ude1 顶点/n 都/d 被/pbei 访问/v 到/v ；/wf 若/c 此时/r 图/n 中/f 尚/d 有/vyou 顶点/n 未/d 被/pbei 访问/v ，/wd 则/c 另选/v 图/n 中/f 一个/mq 未曾/d 被/pbei 访问/v 的/ude1 顶点/n 作/v 起始/v 点/qt ，/wd 重复/v 上述/b 过程/n ，/wd 直至/v 图/n 中/b 所有/b 顶点/n 都/d 被/pbei 访问/v 到/v 为止/u 。/wj 
　　    图/n 7．13/m 遍历/n 图/n 的/ude1 过程/n 
　　(/wkz a/x )/wky 无/v 向/p 图/n G/x 。/wj ；/wf (/wkz b/x )/wky 深度/n 优先/vd 搜索/v 的/ude1 过程/n ；/wf (/wkz c/x )/wky 广度/n 优先/vd 搜索/v 的/ude1 过程/n 。/wj 
    以/p 图/n 7．13/m (/wkz a/x )/wky 中/f 无/v 向/p 图/n G/x 。/wj 为/p 例/n ，/wd 深度/n 优先/vd 搜索/v 遍历/n 图/n 的/ude1 过程/n 如/v 图/n 7．13/m (/wkz b/x )/wky 所/usuo 示/vg ①/m 。/wj 假设/v 从/p 顶点/n u/x ，/wd 出发/vi 进行/vx 搜索/vn ，/wd 在/p 访问/v 了/ule 顶点/n u/x 。/wj 之后/f ，/wd 选择/v 邻接/v 点/n u2/x 。/wj 因为/p 口/n 2/m 未曾/d 访问/v ，/wd 则/c 从/p wz/x 出发/vi 进行/vx 搜索/vn 。/wj 依次/d 类推/vi ，/wd 接着/c 从/p z/x ，/wd 。/wj ，/wd u8/x 、/wn tU5/x  L/x 出/vf I/x 发/v 进行/vx 搜索/vn 。/wj 在/p 访问/v 了/ule u5/x 之后/f ，/wd 由于/p ”/wyy 5/m 的/ude1 邻接/v 点/qt 都/d 已/d 被/pbei 访问/v ，/wd 则/c 搜索/v 回到/v u/x 。/wj 。/wj 由于/p 同样/b 的/ude1 理由/n ，/wd 搜索/v 继续/v 回到/v ”/wyy 。/wj u：/x 直至/v 。/wj 。/wj ，/wd 此时/r 由于/p 口/n 1/m 的/ude1 另/rz 一个/mq 邻接/v 点/qt 未/d 被/pbei 访问/v ，/wd 则/c 搜索/v 又/d 从/p u/x 。/wj 到/v u/x 。/wj ，/wd 再/d 继续/v 进行/vx 下去/vf 。/wj 由此/d ，/wd 得到/v 的/ude1 顶点/n 访问/vn 序列/n 为/v ：/wp 
    ①/m   图/n 中/f 以/p 带/v 箭头/n 的/ude1 粗/a 实线/n 表示/v 遍/qv 历时/vi 的/ude1 访问/vn 路径/n ，/wd 以/p 带/v 箭头/n 的/ude1 虚线/n 表示/v 回溯/v 的/ude1 路径/n 。/wj 图/n 中/f 的/ude1 小/a 圆圈/n 表示/v 已/d 被/pbei 访问/v 过/uguo 的/ude1 邻接/v 点/qt ，/wd 大/a 圆圈/n 表示/v 访问/v 的/ude1 邻接/v 点/qt 。/wj 
    显然/a ，/wd 这/rzv 是/vshi 一个/mq 递归/n 的/ude1 过程/n 。/wj 为了/p 在/p 遍历/n 过程/n 中/f 便于/v 区分/v 顶点/n 是否/v 已/d 被/pbei 访问/v ，/wd 需/v 附设/v 访问/vn 标志/n 数组/n visited/x [/wkz 0：n-1/x ]/wky ，/wd 其/rz 初值/n 为/v “/wyz false/x '/n ’/wyy ，/wd 一旦/c 某个/rz 顶点/n 被/pbei 访问/v ，/wd 则/c 其/rz 相应/vi 的/ude1 分量/n 置/v 为/v “/wyz true/x ”/wyy 。/wj 整个/b 图/n 的/ude1 遍历/n 如/v 算法/n 7．4/m 和/cc 7．5/m 所/usuo 示/vg 。/wj 
∥/w 算法/n 7．4/m 和/cc 7．5/m 使用/v 的/ude1 全局/n 变量/n 
    Boolean/x  visited/x [/wkz MAX/x ]/wky ；/wf     ∥/w 访问/v 标志/n 数组/n 
    Status/x (/wkz */n visitFunc/x )/wky (/wkz int/x  v/x )/wky ；/wf   ∥/w 函数/n 变量/n 
void/x  DFSTraverse/x (/wkz Graph/x  G/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz int/x  v/x )/wky )/wky {/n 
    ∥/w 对/p 图/n G/x 作/v 深度/n 优先/vd 遍历/n 。/wj 
  visitFunc=visit/x ；/wf     ∥/w 使用/v 全局/n 变量/n visitFi／nc/x ，/wd 使/v DFS/x 不必/d 设/v 函数指针/n 参数/n 
  for/x (/wkz v=0/x ；/wf v/x </n G．vexnum/x ；/wf ++v/x )/wky visited/x [/wkz v/x ]/wky =FALSE/x ；/wf   ∥/w 访问/v 标志/n 数组/n 初始化/v 
  for/x (/wkz v=0/x ；/wf v/x </n G．vexnum/x ；/wf ++v/x )/wky 
    if/x (/wkz !/wt visited/x [/wkz v/x ]/wky )/wky DFS/x (/wkz G/x ，/wd v/x )/wky ；/wf   ∥/w 对/p 尚未/d 访问/v 的/ude1 顶点/n 调用/v DFS/x 
}/n 
    算法/n 7．4/m 
void/x  DFS/x (/wkz Graph/x  G/x ，/wd int/x  v/x )/wky {/n 
  ∥/w 从/p 第/m v/x 个/q 顶点/n 出发/vi 递归/n 地/n 深度/n 优先/vd 遍历/n 图/n G/x 。/wj 
  visitea/x [/wkz v/x ]/wky =TRUE/x ；/wf   visitFunc/x (/wkz v/x )/wky ；/wf   ∥/w 访问/v 第/m v/x 个/q 顶点/n 
  for/x (/wkz w=FirstAdJVex/x (/wkz G/x ，/wd v/x )/wky ；/wf   w/x ；/wf   w=NextAdjVex/x (/wkz G/x ，/wd v/x ，/wd w/x )/wky )/wky 
    if/x (/wkz !/wt visited/x [/wkz w/x ]/wky )/wky DFS/x (/wkz G/x ，/wd w/x )/wky ；/wf     ∥/w 对/p v/x 的/ude1 尚未/d 访问/v 的/ude1 邻接/v 顶点/n w/x 递归/n 调用/v DFS/x 
}/n 
    算法/n 7．5/m 
    分析/v 上述/b 算法/n ，/wd 在/p 遍历/n 图/n 时/ng ，/wd 对/p 图/n 中/f 每个/r 顶点/n 至多/d 调用/v 一/m 次/qv 【/wkz )/wky FS/x 函数/n ，/wd 因为/c 一旦/d 某个/rz 顶点/n 被/pbei 标志/v 成/v 已/d 被/pbei 访问/v ，/wd 就/d 不再/d 从/p 它/rr 出发/vi 进行/vx 搜索/vn 。/wj 因此/c ，/wd 遍历/n 图/n 的/ude1 过程/n 实质/n 上/f 是/vshi 对/p 每个/r 顶点/n 查找/v 其/rz 邻接/v 点/qt 的/ude1 过程/n 。/wj 其/rz 耗费/v 的/ude1 时间/n 则/d 取决于/v 所/usuo 采用/v 的/ude1 存储/vn 结构/n 。/wj 当/p 用/v 二/m 维/q 数组/n 表示/v 邻接/v 矩阵/n 作图/v 的/ude1 存储/vn 结构/n 时/ng ，/wd 查找/v 每个/r 顶点/n 的/ude1 邻接/v 点/qt 所/usuo 需/v 时间/n 为/p 0/m (/wkz n/x 。/wj )/wky ，/wd 其中/rz n/x 为/p 图/n 中/b 顶点/n 数/n 。/wj 而/cc 当/v 以/p 邻接/v 表/vg 作图/v 的/ude1 存储/vn 结构/n 时/ng ，/wd 找/v 邻接/v 点/qt 所/usuo 需/v 时间/n 为/v O/x (/wkz e/x )/wky ，/wd 其中/rz e/x 为/p 无/v 向/p 图/n 中/f 边/k 的/ude1 数/n 或/c 有/vyou 向/p 图/n 中/b 弧/n 的/ude1 数/n 。/wj 由此/d ，/wd 当/v 以/p 邻接/v 表/vg 作/v 存储/vn 结构/n 时/ng ，/wd 深度/n 优先/vd 搜索/v 遍历/n 图/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n+F/x )/wky 。/wj     
7．3．2/m 广度/n 优先/vd 搜索/v 
    广度/n 优先/vd 搜索/v (/wkz Breadth―First/x  Search/x )/wky 遍历/n 类似/v 于/p 树/n 的/ude1 按/p 层次/n 遍历/n 的/ude1 过程/n 。/wj 
    假设/v 从/p 图/n 中/f 某/rz 顶点/n 。/wj 出发/vi ，/wd 在/p 访问/v 了/ule u/x 之后/f 依次/d 访问/v 可/v 的/ude1 各个/rz 未曾/d 访问/v 过/uguo 的/ude1 邻接/v 点/qt ，/wd 然后/c 分别/d 从/p 这些/rz 邻接/v 点/qt 出发/vi 依次/d 访问/v 它们/rr 的/ude1 邻接/v 点/qt ，/wd 并/cc 使/v “/wyz 先/d 被/pbei 访问/v 的/ude1 顶点/n 的/ude1 邻接/v 点/qt ”/wyy 先/d 于/p “/wyz 后/f 被/pbei 访问/v 的/ude1 顶点/n 的/ude1 邻接/v 点/qt ”/wyy 被/pbei 访问/v ，/wd 直至/v 图/n 中/b 所有/b 已/d 被/pbei 访问/v 的/ude1 顶点/n 的/ude1 邻接/v 点/qt 都/d 被/pbei 访问/v 到/v 。/wj 若/c 此时/r 图/n 中/f 尚/d 有/vyou 顶点/n 未/d 被/pbei 访问/v ，/wd 则/c 另选/v 图/n 中/f 一个/mq 未曾/d 被/pbei 访问/v 的/ude1 顶点/n 作/v 起始/v 点/qt ，/wd 重复/v 上述/b 过程/n ，/wd 直至/v 图/n 中/b 所有/b 顶点/n 都/d 被/pbei 访问/v 到/v 为止/u 。/wj 换句话说/c ，/wd 广度/n 优先/vd 搜索/v 遍历/n 图/n 的/ude1 过程/n 是/vshi 以/p u/x 为/p 起始/n 点/qt ，/wd 由/p 近/v 至/p 远/a ，/wd 依次/d 访问/v 和/cc u/x 有/vyou 路径/n 相通/vi 且/c 路径长度/n 为/p 1/m ，/wd 2/m ，/wd …/ws 的/ude1 顶点/n 。/wj 例如/v ，/wd 对/p 图/n G/x 。/wj 进行/vx 广度/n 优先/vd 搜索/v 遍历/n 的/ude1 过程/n 如/v 图/n 7．13/m (/wkz c/x )/wky 所/usuo 示/vg ，/wd 首先/d 访问/v n/x ，/wd 和/cc n/x ，/wd 的/n 邻接/v 点/n u2/x 和/cc a3/x ，/wd 然后/c 依次/d 访问/v a2/x 的/ude1 邻接/v 点/n a4/x 和/cc u5/x 及/cc a3/x 的/ude1 邻接/v 点/n a6/x 和/cc a7/x ，/wd 最后/f 访问/v a4/x 的/ude1 邻接/v 点/n a/x 。/wj 由于/p 这些/rz 顶点/n 的/ude1 邻接/v 点/qt 均/d 已/d 被/pbei 访问/v ，/wd 并且/c 图/n 中/b 所有/b 顶点/n 都/d 被/pbei 访问/v ，/wd 由此/d 完成/v 了/ule 图/n 的/ude1 遍历/n 。/wj 得到/v 的/ude1 顶点/n 访问/vn 序列/n 为/v a/x 和/cc 深度/n 优先/vd 搜索/v 类似/a ，/wd 在/p 遍历/n 的/ude1 过程/n 中/f 也/d 需要/v 一个/mq 访问/vn 标志/n 数组/n 。/wj 并且/c ，/wd 为了/p 次访问/n 路径长度/n 为/p 2/m 、/wn 3/m 、/wn …/ws 的/ude1 顶点/n ，/wd 需/v 附设/v 队列/n 以/p 存储/vn 已/d 被/pbei 访问/v 的/ude1 路径长度/n 为/p 1/m ，/wd 2/m ，/wd …/ws 的/ude1 顶点/n 。/wj 
广度/n 优先/vd 遍历/n 的/ude1 算法/n 如/v 算法/n 7．6/m 所/usuo 示/vg 。/wj 
    void/x  BFSTraverse/x (/wkz Graph/x  G/x ，/wd Status/x (/wkz */n Visit/x )/wky (/wkz int/x  v/x )/wky )/wky {/n 
    ∥/w 按/p 广度/n 优先/v 非/b 递归/n 遍历/n 图/n G/x 。/wj 使用/v 辅助/vn 队列/n Q/x 和/cc 访问/vn 标志/n 数组/n visited/x 。/wj 
    for/x (/wkz v=0/x ；/wf v/x </n G．vexnum/x ；/wf ++v/x )/wky   visited/x [/wkz v/x ]/wky =FALSE/x ；/wf 
    InitQueue/x (/wkz Q/x )/wky ；/wf     ∥/w 置/v 空/a 的/ude1 辅助/vn 队列/n Q/x 
    for/x (/wkz v=O/x ；/wf   v/x </n G．vexilum/x ；/wf   ++v/x )/wky 
    if/x (/wkz !/wt visited/x [/wkz v/x ]/wky )/wky {/n     ／／v/x 尚未/d 访问/v 
    EnQueue/x (/wkz Q/x ，/wd v/x )/wky ；/wf     ∥/w v/x 入/v 队列/n 
    ．/w hile/x (/wkz !/wt QueueEmpty/x (/wkz Q/x )/wky )/wky   {/n 
    DeQueue/x (/wkz Q/x ，/wd u/x )/wky ；/wf     ∥/w 队头/n 元素/n 出/vf 队/n 并/cc 置/v 为/v u/x 
    vi/x 。/wj 。/wj Slted/x [/wkz u/x ]/wky =TRUE/x ；/wf   Visit/x (/wkz u/x )/wky ；/wf   ∥/w 访问/v u/x 
    for/x (/wkz w=FirstAdjVex/x (/wkz G/x ，/wd u/x )/wky ；/wf   w/x ；/wf   w=NextAdjVex/x (/wkz G/x ，/wd u/x ，/wd w/x )/wky )/wky 
    if/x (/wkz !/wt visited/x [/wkz w/x ]/wky )/wky EnQueue/x (/wkz Q/x ，/wd w/x )/wky ；/wf ∥/w u/x 的/ude1 尚未/d 访问/v 的/ude1 邻接/v 顶点/n w/x 入队/vn 列/n Q/x 
    l/x ∥/w while/x 
    }/n ∥/w if/x 
    ＼/m }/n }/n BFSTraverse/x 
    算法/n 7．6/m 
    分析/v 上述/b 算法/n ，/wd 每个/r 顶点/n 至多/d 进/vf 一/m 次/qv 队列/n 。/wj 遍历/n 图/n 的/ude1 过程/n 实质/n 上/f 是/vshi 通过/p 边/k 或/c 弧/n 找/v 邻接/v 点/qt 的/ude1 过程/n ，/wd 因此/c 广度/n 优先/vd 搜索/v 遍历/n 图/n 的/ude1 时间/n 复杂度/n 和/cc 深度/n 优先/vd 搜索/v 遍历/n 相同/a ，/wd 两者/rzv 不同/a 之/uzhi 处/n 仅仅/d 在于/v 对/p 顶点/n 访问/vn 的/ude1 顺序/n 不同/a 。/wj 
7．4/m 图/n 的/ude1 连/ulian 通性/n 问题/n 
    在/p 这/rzv 一/m 节/q 中/f ，/wd 我们/rr 将/d 利用/v 遍历/n 图/n 的/ude1 算法/n 求解/vi 图/n 的/ude1 连/ulian 通性/n 问题/n ，/wd 并/cc 讨论/vn 最/d 小/a 代价/n 生成/vn 树/n 以及/cc 重/v 连/ulian 通性/n 与/cc 通信/vn 网络/n 的/ude1 经济性/n 和/cc 可靠性/n 的/ude1 关系/n 。/wj 
7．4．1/m 无/v 向/p 图/n 的/ude1 连通/v 分量/n 和/cc 生成/vn 树/n 
    在/p 对/p 无/v 向/p 图/n 进行/vx 遍/d 历时/vi ，/wd 对于/p 连通/v 图/n ，/wd 仅/d 需/v 从/p 图/n 中/f 任/v 一/m 顶点/n 出发/vi ，/wd 进行/vx 深度/n 优先/vd 搜索/v 或/c 广度/n 优先/vd 搜索/v ，/wd 便/d 可/v 访问/v 到/v 图/n 中/b 所有/b 顶点/n 。/wj 对/p 非/b 连通/v 图/n ，/wd 则/c 需/v 从/p 多/m 个/q 顶点/n 出发/vi 进行/vx 搜索/vn ，/wd 而/cc 每/rz 一/m 次/qv 从/p 一个/mq 新/a 的/ude1 起始/vn 点/qt 出发/vi 进行/vx 搜索/vn 过程/n 中/f 得到/v 的/ude1 顶点/n 访问/vn 序列/n 恰/d 为/v 其/rz 各个/rz 连通/v 分量/n 中/f 的/ude1 顶点/n 集/vg 。/wj 例如/v ，/wd 图/n 7．3/m 中/f 的/ude1 G3/x 是非/n 连通/v 图/n ，/wd 按照/p 图/n 7．14/m 所/usuo 示/vg G3/x 的/ude1 邻接/v 表/n 进行/vx 深度/n 优先/vd 搜索/v 遍历/n ，/wd 三/m 次/qv 调用/v 【/wkz )/wky FS/x 过程/n (/wkz 分别/d 从/p 顶点/n A/x 、/wn D/x 和/cc G/x 出发/vi )/wky 得到/v 的/ude1 顶点/n 访问/vn 序列/n 为/v ：/wp 
    A/x  L/x  M/x  J/x  B/x  F/x  C/x     D/x  E/x     G/x  K/x  H/x  I/x 
图/n 7．14/m  G3/x 的/ude1 邻接/v 表/n 
别/d 为/v 连通/v 图/n G/x 。/wj 的/ude1 深度/n 优先/vd 生成/v 树/n 和/cc 广度/n 优先/vd 生成/v 树/n ，/wd 图/n 中/b 虚线/n 为/p 集合/v B/x (/wkz G/x )/wky 中/f 的/ude1 边/n 。/wj 
    对于/p 非/b 连通/v 图/n ，/wd 每个/r 连通/v 分量/n 中/f 的/ude1 顶点/n 集/vg ，/wd 和/cc 遍/v 历时/vi 走过/v 的/ude1 边/n 一起/s 构成/v 若干/m 棵/q 生成/vn 树/n ，/wd 这些/rz 连通/v 分量/n 的/ude1 生成/vn 树/n 组成/v 非/b 连通/v 图/n 的/ude1 生成/vn 森林/n 。/wj 例如/v ，/wd 图/n 7．15/m (/wkz c/x )/wky 所/usuo 示/vg 为/v G3/x 的/ude1 深度/n 优先/vd 生成/v 森林/n ，/wd 它/rr 由/p 三/m 棵/q 深度/n 优先/vd 生成/v 树/n 组成/v 。/wj 
    假设/v 以/p 孩子/n 兄弟/n 链/ng 表/n 作/v 生成/v 森林/n 的/ude1 存储/vn 结构/n ，/wd 则/c 算法/n 7．7/m 生成/v 非/b 连通/v 图/n 的/ude1 深度/n 优先/vd 生成/v 森林/n ，/wd 其中/rz DFSTree/x 函数/n 如/v 算法/n 7．8/m 所/usuo 示/vg 。/wj 显然/a ，/wd 算法/n 7．7/m 的/ude1 时间/n 复杂度/n 和/cc 遍历/n 相同/a 。/wj 
void/x  DFSForest/x (/wkz Graph/x  G/x ，/wd CSTree/x ＆/n T/x )/wky {/n 
  ∥/w 建立/v 无/v 向/p 图/n G/x 的/ude1 深度/n 优先/vd 生成/v 森林/n 的/ude1 
  ∥/w (/wkz 最/d 左/a )/wky 孩子/n (/wkz 右/f )/wky 兄弟/n 链/ng 表/n T/x 。/wj 
  T=NULL/x ；/wf 
  for/x (/wkz v：0/x ；/wf v/x </n G．vexnum/x ；/wf ++v/x )/wky 
    Visited/x [/wkz vJ=FALSE/x ；/wf 
    for/x (/wkz v=0/x ；/wf v/x </n G．vexnum/x ；/wf ++v/x )/wky 
  这/rzv 三/m 个/q 顶点/n 集/vg 分别/d 加上/v 所有/b 依附/v 于/p 这些/rz 顶点/n 的/ude1 边/n ，/wd 便/d 构成/v 了/ule 非/b 连通/v 图/n G3/x 的/ude1 三/m 个/q 连通/v 分量/n ，/wd 如/v 图/n 7．3/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 设/v E/x (/wkz G/x )/wky 为/p 连通/v 图/n G/x 中/b 所有/b 边/k 的/ude1 集合/n ，/wd 则/c 从/p 图/n 中/f 任/v 一/m 顶点/n 出发/vi 遍历/n 图/n 时/ng ，/wd 必定/d 将/d E/x (/wkz G/x )/wky 分成/vi 两/m 个/q 集合/n T/x (/wkz G/x )/wky 和/cc B/x (/wkz G/x )/wky ，/wd 其中/rz T/x (/wkz G/x )/wky 是/vshi 遍历/n 图/n 过程/n 中/f 历经/v 的/ude1 边/n 的/ude1 集合/n ；/wf B/x (/wkz G/x )/wky 是/vshi 剩余/v 的/ude1 边/n 的/ude1 集合/n 。/wj 
显然/a ，/wd T/x (/wkz G/x )/wky 和/cc 图/n G/x 中/b 所有/b 顶点/n 一起/s 构成/v 连通/v 图/n G/x 的/ude1 极/d 小/a 连通/v 子/ng 图/n ，/wd 按照/p 7．1/m 节/q 的/ude1 定义/n ，/wd 它/rr 是/vshi 连通/v 图/n 的/ude1 一/m 棵/q 生成/vn 树/n ，/wd 并且/c 称/v 由/p 深度/n 优先/vd 搜索/v 得到/v 的/ude1 为/p 深度/n 优先/vd 生成/v 树/n ；/wf 由/p 广度/n 优先/vd 搜索/v 得到/v 的/ude1 为/p 广度/n 优先/vd 生成/v 树/n 。/wj 例如/v ，/wd 图/n 7．15/m (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 所/usuo 示/vg 分/v 图/n 7．15/m 生成/vn 树/n 和/cc 生成/vn 森林/n   (/wkz a/x )/wky G/x 。/wj 的/ude1 深度/n 优先/vd 生成/v 树/n ；/wf 
  (/wkz b/x )/wky G/x 。/wj 的/ude1 广度/n 优先/vd 生成/v 树/n ；/wf 
  (/wkz c/x )/wky G/x ，/wd 的/ude1 深度/n 优先/vd 生成/v 森林/n 。/wj 
if/x (/wkz !/wt visited/x [/wkz v/x ]/wky )/wky {/n     ∥/w 第/m v/x 顶点/n 为/p 新/a 的/ude1 生成/vn 树/n 的/ude1 根/n 结点/n   p=/x (/wkz CSTree/x )/wky realloc/x (/wkz 8izeo/x ~/n (/wkz CSNede/x )/wky )/wky ；/wf   ∥/w 分配/v 根/n 结点/n 
p=/x {/n GetVex/x (/wkz G/x ，/wd v/x )/wky ，/wd NULL/x ，/wd NULL/x }/n ；/wf     ∥/w 给/p 该/rz 结点/n 赋值/v 
  if/x (/wkz !/wt T/x )/wky T=p/x ；/wf     ∥/w 是/vshi 第一/m 棵/q 生成/vn 树/n 的/ude1 根/n (/wkz T/x 的/ude1 根/n )/wky 
  else/x  q-/x >/n nextsibling=p/x ；/wf     ∥/w 是/vshi 其它/rz 生成/vn 树/n 的/ude1 根/n (/wkz 前/f 一/m 棵/q 的/ude1 根/n 的/ude1 “/wyz 兄弟/n ”/wyy )/wky 
  DFSTree/x (/wkz G/x ，/wd v/x ，/wd p/x )/wky ；/wf 
    }/n 
ff/x  DFSForest/x 
算法/n 7．7/m 
∥/w q/x 指示/n 当前/t 生成/v 树/n 的/ude1 根/n 
∥/w 建立/v 以/p p/x 为/p 根/n 的/ude1 生成/vn 树/n 
void/x  DFSTree/x (/wkz Graph/x  G．in％v/x ，/wd CSTree/x &/n T/x )/wky {/n 
  ∥/w 从/p 第/m v/x 个/q 顶点/n 出发/vi 深度/n 优先/vd 遍历/n 图/n G/x ，/wd 建立/v 以/p T/x 为/p 根/n 的/ude1 生成/vn 树/n 。/wj 
  visited/x [/wkz v/x ]/wky =TRUE/x ；/wf first=17RUE/x ；/wf 
  for/x (/wkz w=FisrtAdjVex/x (/wkz C/x ，/wd v/x )/wky ；/wf   w/x ；/wf   w=NextAdjVex/x (/wkz G/x ，/wd V/x ，/wd w/x )/wky )/wky 
    if/x (/wkz !/wt visiteatw/x ]/wky )/wky {/n 
    p=/x (/wkz CSTree/x )/wky lloc/x (/wkz 8izeof/x (/wkz CSNocIe/x )/wky )/wky ；/wf   ∥/w 分配/v 孩子/n 结点/n 
    */n p=/x !/wt GetVex/x (/wkz G/x ，/wd w/x )/wky ，/wd m/x 『/wyz u/x 一/m ，/wd NUI-L/x }/n ；/wf 
    if/x (/wkz first/x )/wky {/n     ∥/w w/x 是/vshi v/x 的/ude1 第/m --/wp 个/q 未/d 被/pbei 访问/v 的/ude1 邻接/v 顶点/n 
    T-/x >/n Ichild=p/x ；/wf   first=FALSE/x ；/wf     ∥/w 是/vshi 根/n 的/ude1 左/a 孩子/n 结点/n 
}/n ∥/w if/x 
else/x  I/x 
    q-/x >/n nextsibling：p/x 
 l/x ∥/w else/x 
∥/w w/x 是/vshi v/x 的/ude1 其它/rz 未/d 被/pbei 访问/v 的/ude1 邻接/v 顶点/n 
∥/w 是/vshi 上/f 一/m 邻接/v 顶点/n 的/ude1 右/f 兄弟/n 结点/n 
    q=p/x ；/wf 
    DFSTree/x (/wkz G/x ，/wd w/x ，/wd q/x )/wky ；/wf     ∥/w 从/p 第/m w/x 个/q 顶点/n 出发/vi 深度/n 优先/vd 遍历/n 图/n G/x ，/wd 建立/v r/x 生成/vn 树/n q/x 
    f/x ∥/w if/x 
}/n f/x  DFSTree/x 
    算法/n 7．8/m 
    7．4．2/m 有/vyou 向/p 图/n 的/ude1 强/a 连通/v 分量/n 
　　深度/n 优先/vd 搜索/v 是/vshi 求/v 有/vyou 向/p 图/n 的/ude1 强/a 连通/v 分量/n 的/ude1 一个/mq 新/a 的/ude1 有效/a 方法/n 。/wj 假设/v 以/p 十字/n 链/ng 表/n 作/v 有/vyou 向/p 图/n 的/ude1 存储/vn 结构/n ，/wd 则/c 求/v 强/ng 连通/v 分量/n 的/ude1 步骤/n 如下/vi ：/wp 
　　(/wkz 1/m )/wky 在/p 有/vyou 向/p 图/n G/x 上/f ，/wd 从/p 某个/rz 顶点/n 出发/vi 沿/p 以/p 该/rz 顶点/n 为/v 尾/ng 的/ude1 弧/n 进行/vx 深度/n 优先/vd 搜索/v 遍历/n ，/wd 并/cc 按/p 其/rz 所有/b 邻接/v 点/qt 的/ude1 搜索/vn 都/d 完成/v (/wkz 即/v 退出/v DFs/x 函数/n )/wky 的/ude1 顺序/n 将/p 顶点/n 排列/v 起来/vf 。/wj 此时/r 需/v 对/p 7．3．1/m 中/f 的/ude1 算法/n 作/v 如下/vi 两/m 点/qt 修改/v ：/wp (/wkz a/x )/wky 在/p 进入/v ．/w DF/x 、/wn sTraverse/x 函数/n 时/ng 首先/d 进行/vx 计数/vi 变量/n 的/ude1 初始化/v ，/wd 即/d 在/p 入口处/n 加上/v count=0/x 的/ude1 语句/n ；/wf (/wkz b/x )/wky 在/p 退出/v DFS/x 函数/n 之前/f 将/d 完成/v 搜索/v 的/ude1 顶点/n 号/q 记录/n 在/p 另/rz 一个/mq 辅助/vn 数组/n [/wkz inished/x [/wkz vexnum/x ]/wky 中/f ，/wd 即/d 在/p I/x )/wky FS/x 函数/n 结束/v 之前/f 加上/v finished/x [/wkz ++count/x ]/wky 。/wj v/x 的/ude1 语句/n 。/wj 
    (/wkz 2/m )/wky 在/p 有/vyou 向/p 图/n G/x 上/f ，/wd 从/p 最后/f 完成/v 搜索/v 的/ude1 顶点/n (/wkz 即/v finished/x [/wkz vexnum―1/x ]/wky 中/f 的/ude1 顶点/n )/wky 出发/vi ，/wd 沿着/p 以/p 该/rz 顶点/n 为/p 头/n 的/ude1 弧/n 作/v 逆向/a 的/ude1 深度/n 优先/vd 搜索/v 遍历/n ，/wd 若/c 此次/rz 遍历/n 不/d 能/v 访问/v 到/v 有/vyou 向/p 图/n 中/b 所有/b 顶点/n ，/wd 则/c 从/p 余下/v 的/ude1 顶点/n 中/f 最后/f 完成/v 搜索/v 的/ude1 那个/rz 顶点/n 出发/vi ，/wd 继续/v 作/v 逆向/a 的/ude1 深度/n 优先/vd 搜索/v 遍历/n ，/wd 依次/d 类推/vi ，/wd 直至/v 有/vyou 向/p 图/n 中/b 所有/b 顶点/n 都/d 被/pbei 访问/v 到/v 为止/u 。/wj 此时/r 调用/v I/x )/wky FSTraverse/x 时/ng 需/v 作/v 如下/vi 修改/v ：/wp 函数/n 中/f 第二/m 个/q 循环/vn 语句/n 的/ude1 边界条件/n 应/v 改/v 为/v 。/wj 从/p finished/x [/wkz vexrlt/x ，/wd m-1/x ]/wky 至/p finished/x [/wkz 0/m ]/wky 。/wj 
    由此/d ，/wd 每/rz 一/m 次/qv 调用/v DFs/x 作/v 逆向/b 深度/n 优先/vd 遍历/n 所/usuo 访问/v 到/v 的/ude1 顶点/n 集/vg 便/d 是/vshi 有/vyou 向/p 图/n G/x 中/f 一个/mq 强/a 连通/v 分量/n 的/ude1 顶点/n 集/vg 。/wj     
　　例如/v 图/n 7．11/m 所/usuo 示/vg 的/ude1 有/vyou 向/p 图/n ，/wd 假设/v 从/p 顶点/n 训/v ，/wd 出发/vi 作/v 深度/n 优先/vd 搜索/v 遍历/n ，/wd 得到/v finished/x 数组/n 中/f 的/ude1 顶点/n 号/q 为/v (/wkz 1/m ，/wd 3/m ，/wd 2/m ，/wd 0/m )/wky ；/wf 则/c 再/d 从/p 顶点/n u/x ，/wd 出发/vi 作/v 逆向/a 的/ude1 深度/n 优先/vd 搜索/v 遍历/n ，/wd 得到/v 两/m 个/q 顶点/n 集/vg {/n 口/q ，/wd ，/wd 抄/v ，/wd ，/wd ”/wyy 。/wj }/n 和/cc {/n 秽/n ：/wp }/n ，/wd 这/rzv 就/d 是/vshi 该/rz 有/vyou 向/p 图/n 的/ude1 两/m 个/q 强/a 连通/v 分量/n 的/ude1 顶点/n 集/vg 。/wj 
　　上述/b 求/v 强/ng 连通/v 分量/n 的/ude1 第二/m 步/qv ，/wd 其/rz 实质/n 为/v ：/wp (/wkz 1/m )/wky 构造/n 一个/mq 有/vyou 向/p 图/n G/x ，/wd ，/wd 设/v G=/x (/wkz V/x ，/wd {/n A/x }/n )/wky ，/wd 则/d G/x ，/wd =/m (/wkz V/x ，/wd {/n A/x ，/wd }/n )/wky ，/wd 对于/p 所有/b (/wkz ui/x ，/wd u/x ，/wd )/wky ∈A/x ，/wd 必/d 有/vyou (/wkz u/x ，/wd ，/wd 到/v i/x )/wky ∈A/x ，/wd 。/wj 即/v G/x ，/wd 中/f 拥有/v 和/cc (/wkz ；/wf 方向/n 相反/vi 的/ude1 弧/n ；/wf (/wkz 2/m )/wky 在/p 有/vyou 向/p 图/n G/x ，/wd 上/f ，/wd 从/p 顶点/n finished/x [/wkz vexnum-1/x ]/wky 出发/vi 作/v 深度/n 优先/vd 搜索/v 遍历/n 。/wj 可以/v 证明/v ，/wd 在/p G/x ，/wd 上/f 所/usuo 得/v 深度/n 优先/vd 生成/v 森林/n 中/f 每/rz 一/m 棵/q 树/n 的/ude1 顶点/n 集/vg 即/d 为/v G/x 的/ude1 强/a 连通/v 分量/n 的/ude1 顶点/n 集/vg ‘/wyz 引/v 。/wj 
    显然/a ，/wd 利用/v 遍历/n 求/v 强/ng 连通/v 分量/n 的/ude1 时间/n 复杂度/n 亦/d 和/cc 遍历/n 相同/a 。/wj 
    7．4．3/m 最/d 小/a 生成/vn 树/n 
    假设/v 要/v 在/p n/x 个/q 城市/n 之间/f 建立通信/n 联络网/n ，/wd 则/c 连通/v n/x 个/q 城市/n 只/d 需要/v n-l/x 条/q 线路/n 。/wj 这时/rzt ，/wd 自然/d 会/v 考虑/v 这样/rzv 一个/mq 问题/n ，/wd 如何/ryv 在/p 最/d 节省/v 经费/n 的/ude1 前提/n 下/f 建立/v 这个/rz 通信网/n 。/wj 
　　在/p 每/rz 两/m 个/q 城市/n 之间/f 都/d 可以/v 设置/v 一/m 条/q 线路/n ，/wd 相应/vi 地/ude2 都/d 要/v 付出/v 一定/b 的/ude1 经济/n 代价/n   ，/wd 。/wj 个/q 城市/n 之间/f ，/wd 最/d 多/a 可能/n 设置/v ”/wyy (/wkz ，/wd ，/wd -/wp 1/m )/wky ／2/m 条/q 线路/n ，/wd 那么/c ，/wd 如何/ryv 在/p 这些/rz 可能/n 的/ude1 线路/n 中/f 选择/v ”/wyy l/x 条/q ，/wd 以/p 使/v 总/b 的/ude1 耗费/vn 最少/d 呢/y ?/ww 
　　可以/v 用/p 连通/v 网/n 来/vf 表示/v n/x 个/q 城市/n 以及/cc ”/wyy 个/q 城市/n 间/f 可能/v 设置/v 的/ude1 通信/vn 线路/n ，/wd 其中/rz M/x 的/ude1 顶点/n 表示/v 城市/n ，/wd 边/d 表示/v 两/m 城市/n 之间/f 的/ude1 线路/n ，/wd 赋/v 于/p 边/k 的/ude1 权/n 值/v 表示/v 相应/vi 的/ude1 代价/n ．/w ．/w 对于/p ”/wyy 个/q 顶点/n 的/ude1 连通/v 网/n 可以/v 建立/v 许多/m 不同/a 的/ude1 生成/vn 树/n ，/wd 每/rz 一/m 棵/q 生成/vn 树/n 都/d 可以/v 是/vshi ・/w 个/q 通信/vn 问/v 。/wj 现在/t ，/wd 我们/rr 要/v 选择/v 这样/rzv 一/m 棵/q 生成/vn 树/n ，/wd 也/d 就是/v 使/v 总/b 的/ude1 耗费/vn 最/d 少/a 。/wj 这个/rz 问题/n 就是/v 构造/n 、/wn 代价/n 生成/vn 树/n (/wkz Minimum/x (/wkz ；/wf ost/x  Spanning/x  Tree/x )/wky (/wkz 简称/v 为/v 最/d 小/a 生成/vn 树/n )/wky 的/ude1 问题/n 。/wj 一/m 棵/q 生成/vn 树/n 的/ude1 代价/n 就/d 是/vshi 树/n 上/f 各/rz 边/k 的/ude1 代价/n 之和/n 。/wj    构造/n 最/d 小/a 生成/vn 树/n 可以/v 有/vyou 多种/m 算法/n 。/wj 其中/rz 多数/m 算法/n 利用/v 了/ule 最/d 小/a 生成/vn 书/n 寸/q 的/ude1 下列/b 一/m 种/q 简称/v 为/v MST/x 的/ude1 性质/n ：/wp 假设/v N=/x (/wkz V/x ，/wd {/n E/x }/n )/wky 是/vshi 一个/mq 连通/v 网/n ，/wd U/x 是/vshi 顶点/n 集/vg V/x 的/ude1 ～/ws 一个/mq 非/b 空子/n 集/vg 。/wj 若/v (/wkz “/wyz ，/wd 秽/n )/wky 是/vshi 一/m 条/q 具有/v 最/d 小/a 权/n 值/n (/wkz 代价/n )/wky 的/ude1 边/n ，/wd 其中/rz “/wyz ∈L/x ，/wd ，/wd 勘/vg ∈V-u/x ，/wd 则/c 必/d 存在/v 一/m 棵/q 包含/v 边/k (/wkz “/wyz ，/wd u/x )/wky 的/ude1 最/d 小/a 生成/vn 树/n 。/wj 
    可以/v 用/p 反证法/n 证明/v 之/uzhi 。/wj 假设/v 网/n N/x 的/ude1 任何/rz 一/m 棵/q 最/d 小/a 生成/vn 树/n 都/d 不/d 包含/v (/wkz “/wyz ，/wd u/x )/wky 。/wj 设/v T/x 是/vshi 连通/v 网上/s 的/ude1 一/m 棵/q 最/d 小/a 生成/vn 树/n ，/wd 当/p 将/d 边/d (/wkz “/wyz ，/wd )/wky 加入/v 到/v T/x 中/f 时/ng ，/wd 由/p 生成/v 树/n 的/ude1 定义/n ，/wd 中/f 必/d 存在/v 一/m 条/q 包含/v (/wkz “/wyz ，/wd u/x )/wky 的/ude1 回路/n 。/wj 另一方面/c ，/wd 由于/c T/x 是/vshi 生成/v 树/n ，/wd 则/c 在/p T/x 上/f 必/d 存在/v 另/rz 一/m 条/q 边/n (/wkz “/wyz ’/wyy ，/wd u/x ’/wyy )/wky ，/wd 其中/rz “/wyz ’/wyy ∈/m 【/wkz ，/wd ，/wd ’/wyy ∈V-u/x ，/wd 且/c “/wyz 和/cc “/wyz ’/wyy 之间/f ，/wd 。/wj 和/cc ’/wyy 之间/f 均/d 有/vyou 路径/n 相通/vi 。/wj 删去/v 边/k (/wkz “/wyz ’/wyy ，/wd u/x ’/wyy )/wky ，/wd 便/d 可/v 消除/v 上述/b 回路/n ，/wd 同时/c 得到/v 另/rz 一/m 棵/q 生成/vn 树/n T/x ’/wyy 。/wj 因为/p (/wkz “/wyz ，/wd )/wky 的/ude1 代价/n 不/d 高于/v (/wkz “/wyz ’/wyy ，/wd ’/wyy )/wky ，/wd 则/d T/x ’/wyy 的/ude1 代价/n 亦/d 不/d 高于/v T/x ，/wd T/x ’/wyy 是/vshi 包含/v (/wkz ，/wd 。/wj )/wky 的/ude1 一/m 棵/q 最/d 小/a 生成/vn 树/n 。/wj 由此/d 和/cc 假设/n 矛盾/an 。/wj 
    普里姆/nrf 算法/n 和/cc 克鲁/nsf 斯/b 卡尔/n 算法/n 是/vshi 两/m 个/q 利用/v MST/x 性质/n 构造/n 最/d 小/a 生成/vn 树/n 的/ude1 算法/n 。/wj     
    下面/f 先/d 介绍/v 普里姆/nrf 算法/n 。/wj 
　　假设/n N=/x (/wkz 、/wn 厂/n ，/wd {/n E/x }/n )/wky 是/vshi 连通/v 网/n ，/wd TE/x 是/vshi N/x 上/f 最/d 小/a 生成/vn 树/n 中/f 边/k 的/ude1 集合/n 。/wj 算法/n 从/p u=/x {/n “/wyz o/x }/n (/wkz “/wyz 0∈/m 、/wn ，/wd r/x )/wky ，/wd 。/wj TE=/x {/n }/n 开始/v ，/wd 重复/vd 执行/v 下/f 述/vg 操作/v ：/wp 在/p 所有/b M∈U/x ，/wd ∈vU/x 的/ude1 边/n (/wkz 。/wj ，/wd u/x )/wky ∈E/x 中/f 找/v 一/m 条/q 代价/n 最/d 小/a 的/ude1 边/n (/wkz “/wyz 0/m ，/wd 0/m )/wky 并入/v 集合/v TE/x ，/wd 同时/c 移/v 0/m 并入/v u/x ，/wd 直至/v u=/x 、/wn 为止/u 。/wj 此时/r TE/x 中/f 必/d 有/vyou ，/wd z-1/x 条/q 边/k ，/wd 则/d T：/x (/wkz V/x ，/wd {/n TE/x }/n )/wky 为/v N/x 的/ude1 最/d 小/a 生成/vn 树/n 。/wj 
图/n 7．16/m 普里姆/nrf 算法/n 构造/n 最/d 小/a 生成/vn 树/n 的/ude1 过程/n 
　　为/p 实现/v 这个/rz 算法/n 需/v 附设/v 一个/mq 辅助/vn 数组/n closedge/x ，/wd 以/p 记录/v 从/p u/x 到/v Vu/x 具有/v 最/d 小/a 代价/n 的/ude1 边/n 。/wj 对/p 每个/r 顶点/n 口/n i∈yu/x ，/wd 在/p 辅助/vn 数组/n 中/f 存在/v 一个/mq 相应/vn 分量/n closedge/x [/wkz i-1/x ]/wky ，/wd 它/rr 包括/v 两/m 个/q 域/ng ，/wd 其中/rz loweost/x 存储/vn 该/v 边上/f 的/ude1 权/n 。/wj 显然/a ，/wd closedge/x [/wkz i-1/x ]/wky ．/w |/n owcost=Min/x {/n cost/x (/wkz u/x ，/wd vi/x )/wky ①/m lu∈U/x }/n  vex/x 域/ng 存储/v 该/rz 边/d 依附/v 的/ude1 在/p u/x 中/f 的/ude1 顶点/n 。/wj 例如/v ，/wd 图/n 7．16/m 所/usuo 示/vg 为/v 按/p 普里姆/nrf 算法/n 构造/vn 网/n 的/ude1 一/m 棵/q 最/d 小/a 生成/vn 树/n 的/ude1 过程/n ；/wf 在/p 构造/n 过程/n 中/b 辅助/vn 数组/n 中/f 各/rz 分量/n 值/n 的/ude1 变化/vn 如/v 图/n 7．17/m 所/usuo 示/vg 。/wj 初始状态/n 时/ng ，/wd 由于/c U=/x {/n ”/wyy 1/m }/n ，/wd 则/c 到/v V―u/x 中/f 各/rz 顶点/n 的/ude1 最/d 小/a 边/k ，/wd 即/d 为/v 从/p 依附/v 于/p 顶点/n 1/m 的/ude1 各/rz 条/q 边/n 中/f ，/wd 找到/v 一/m 条/q 代价/n 最/d 小/a 的/ude1 边/n (/wkz “/wyz o/x ，/wd u0/x )/wky =/m (/wkz 1/m ，/wd 3/m )/wky 为/p 生成/v 树上/s 的/ude1 第一/m 条/q 边/k ，/wd 同时/c 将/p 口/n 0/m (/wkz =Z/x )/wky 3/m )/wky 并入/v 集合/v 【/wkz ，/wd 。/wj 然后/c 修改/v 辅助/vn 数组/n 中/f 的/ude1 值/n 。/wj 首先/c 将/d closedge/x [/wkz 2/m ]/wky ．/w 10wcost/x 改/v 为/v ’/wyy 0/m ’/wyy ，/wd 以/p 示/vg 顶点/n V3/x 已/d 并入/v u/x 。/wj 然后/c ，/wd 由于/c 边/d (/wkz 3/m ，/wd u2/x )/wky 上/f 的/ude1 权/n 值/v 小于/v closedge/x [/wkz 1/m ]/wky ．/w 10wcost/x ，/wd 则/c 需/v 修改/v closedge/x [/wkz 1/m ]/wky 为/p 边/n (/wkz 3/m ，/wd 2/m )/wky 及/cc 其/rz 权/n 值/n 。/wj 同/p 理/n 修改/v closedge/x [/wkz 4/m ]/wky 和/cc closedge/x [/wkz 5/m ]/wky 。/wj 依次/d 类推/vi ，/wd 直到/v U=V/x 。/wj 
    图/n 7．17/m   图/n 7．16/m 构造/n 最/d 小/a 生成/vn 树/n 过程/n 中/b 辅助/vn 数组/n 中/f 各/rz 分量/n 的/ude1 值/n 
假设/v 以/p 二/m 维/q 数组/n 表示/v 网/n 的/ude1 邻接/v 矩阵/n ，/wd 且/c 令/v 两/m 个/q 顶点/n 之间/f 不/d 存在/v 的/ude1 边/n 的/ude1 权/n 值/v 为/v 机/ng 内/f 允许/v 的/ude1 最/d 大值/n (/wkz INT―MAX/x )/wky ，/wd 则/d 普/ag 里/f 姆/x 算法/n 如/v 算法/n 7．9/m 所/usuo 示/vg 。/wj 
  void/x  MiniSpanTree―PRIM/x (/wkz MGraph/x  G/x ，/wd 7ertexType/x  U/x )/wky {/n 
    ∥/w 用/p 普里姆/nrf 算法/n 从/p 第/m u/x 个/q 顶点/n 出发/vi 构造/v 网/n G/x 的/ude1 最/d 小/a 生成/vn 树/n T/x ，/wd 输出/v T/x 的/ude1 各/rz 条/q 边/n 。/wj 
    ∥/w 记录/v 从/p 顶点/n 集/vg U/x 到/v vU/x 的/ude1 代价/n 最/d 小/a 的/ude1 边/n 的/ude1 辅助/vn 数组/n 定义/n ：/wp 
    ∥/w struet/x {/n 
    ∥/w     VertexType/x  adjvex/x ；/wf 
    ∥/w 啪/o ype/x  lowcost/x ；/wf 
    ∥/w }/n closedge/x [/wkz MAX-VERTEX-NUM/x ]/wky ；/wf 
    k=LocateVex/x (/wkz G/x ，/wd u/x )/wky ；/wf 
    ~/n or/x (/wkz J=0/x ；/wf j/x </n G．vexrl/x ~/n ,/wd N/x ；/wf ++j/x )/wky     ∥/w 辅助/vn 数组/n 初始化/v 
    if/x (/wkz j/x !/wt =k/x )/wky   closedge/x [/wkz J/x ]/wky =/m {/n u/x ，/wd G．arcs/x [/wkz k/x ]/wky [/wkz J/x ]/wky ．/w adj/x }/n ；/wf   ∥/w {/n adjvex/x ，/wd lowcost/x }/n 
    closedge/x [/wkz k/x ]/wky ．/w 10wcost=0/x ；/wf     ∥/w 初始/t ，/wd U=/x {/n u/x }/n 
    for/x (/wkz i=i/x ；/wf i/x </n G．vexnum/x ；/wf ++i/x )/wky {/n     ∥/w 选择/v 其余/rz G．vexnum-1/x 个/q 顶点/n 
    k=minimum/x (/wkz closedge/x )/wky ；/wf     ∥/w 求/v 出/vf T/x 的/ude1 下/vf 一个/mq 结点/n ：/wp 第/m k/x 顶点/n 
    ∥/w 此时/r closedge/x [/wkz k/x ]/wky ．/w 10wcost=/x 
    ∥/w     MIN/x {/n closedge/x [/wkz vi/x ]/wky ．/w 10wcost/x  l/x  closedge/x [/wkz vi/x ]/wky ．/w 10wcost/x >/n 0/m ，/wd vi∈V-U/x }/n 
    printf/x (/wkz closedge/x [/wkz k/x ]/wky ．/w adjvex/x ，/wd G．vexs/x [/wkz k/x ]/wky )/wky ；/wf     ∥/w 输出/v 生成/v 树/n 的/ude1 边/n 
    closedge/x [/wkz k/x ]/wky ．/w 10weost：0/x ；/wf     ∥/w 第/m k/x 顶点/n 并入/v U/x 集/ng 
    for/x (/wkz j=0/x ；/wf j/x </n G．vexnum/x ；/wf ++j/x )/wky 
    if/x (/wkz G．arcs/x [/wkz k/x ]/wky [/wkz j/x ]/wky ．/w adj/x </n closedge/x [/wkz j/x ]/wky ．/w 10weost/x )/wky     ∥/w 新/a 顶点/n 并入/v U/x 后/f 重新/d 选择/v 最/d 小/a 边/n 
    、/wn     closedge/x [/wkz j/x ]/wky ：/wp {/n G．vexs/x [/wkz k/x ]/wky ，/wd G．arcs/x [/wkz k/x ]/wky [/wkz j/x ]/wky ．/w adj/x ；/wf ；/wf 
    }/n 
    }/n ∥/w MiniSlE/x )/wky anTree/x 
    算法/n 7．9/m 
    例如/v ，/wd 对/p 图/n 7．16/m (/wkz a/x )/wky 中/f 的/ude1 网/n ，/wd 利用/v 算法/n 7．9/m ，/wd 将/d 输出/v 生成/v 树上/s 的/ude1 五/m 条/q 边/k 为/v ：/wp {/n (/wkz u1/x ，/wd 3/m )/wky ，/wd (/wkz 3/m ，/wd u6/x )/wky ，/wd (/wkz 6/m ，/wd 4/m )/wky ，/wd (/wkz V3/x ，/wd 2/m )/wky ，/wd (/wkz 2/m ，/wd 5/m )/wky }/n 。/wj 
    分析算法/n 7．9/m ，/wd 假设/v 网/n 中/f 有/vyou n/x 个/q 顶点/n ，/wd 则/c 第一/m 个/q 进行/vx 初始化/v 的/ude1 循环/vn 语句/n 的/ude1 频度/n 为/v n/x ，/wd 第二/m 个/q 循环/vn 语句/n 的/ude1 频度/n 为/v n-1/x 。/wj 其中/rz 有/vyou 两/m 个/q 内/f 循环/vn ：/wp 其一/rz 是/vshi 在/p closedge/x [/wkz v/x ]/wky ．/w 10wcost/x 中/f 求/v 最/d 小/a 值/n ，/wd 其/rz 频度/n 为/v n-1/x ；/wf 其二/rz 是/vshi 重新/d 选择/v 具有/v 最/d 小/a 代价/n 的/ude1 边/n ，/wd 其/rz 频度/n 为/v n/x 。/wj 由此/d ，/wd 普里姆/nrf 算法/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz rt0/x )/wky ，/wd 与/p 网/n 中/f 的/ude1 边/d 数/v 无关/v ，/wd 因此/c 适用/vi 于/p 求/v 边/k 稠密/a 的/ude1 网/n 的/ude1 最/d 小/a 生成/vn 树/n 。/wj 
    而/cc 克鲁/nsf 斯/b 卡尔/n 算法/n 恰恰相反/c ，/wd 它/rr 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz doge/x )/wky (/wkz e/x 为/p 网/n 中/f 边/k 的/ude1 数目/n )/wky ，/wd 因此/c 它/rr 相对/d 于/p 普里姆/nrf 算法/n 而言/uls ，/wd 适合/v 于/p 求/v 边/k 稀疏/a 的/ude1 网/n 的/ude1 最/d 小/a 生成/vn 树/n 。/wj 
    克鲁/nsf 斯/b 卡尔/n 算法/n 从/p 另/rz 一/m 途径/n 求/v 网/n 的/ude1 最/d 小/a 生成/vn 树/n 。/wj 假设/v 连通/v 网/n N=/x (/wkz 、/wn ，/wd r/x ，/wd {/n E/x }/n )/wky ，/wd 则/c 令/v 最/d 小/a 生成/vn 树/n 的/ude1 初始状态/n 为/v 只/d 有/vyou n/x 个/q 顶点/n 而/cc 无边/z 的/ude1 非/b 连通/v 图/n T=/x (/wkz v/x ，/wd {/n j/x )/wky ，/wd 图/n 中/f 每个/r 顶点/n 自/rr 成/v 一个/mq 连通/v 分量/n 。/wj 在/p E/x 中/f 选择/v 代价/n 最/d 小/a 的/ude1 边/n ，/wd 若/c 该/v 边/k 依附/v 的/ude1 顶点/n 落/v 在/p T/x 中/f 不同/a 的/ude1 连通/v 分量/n 上/f ，/wd 则/c 将/p 此/rzs 边/d 加入/v 到/v T/x 中/f ，/wd 否则/c 舍去/v 此/rzs 边/d 而/cc 选择/v 下/vf 一/m 条/q 代价/n 最/d 小/a 的/ude1 边/n 。/wj 依次/d 类推/vi ，/wd 直至/v T/x 中/b 所有/b 顶点/n 都/d 在/p 同一/b 连通/v 分量/n 上/f 为止/u 。/wj 
例如/v ，/wd 图/n 7．18/m 所/usuo 示/vg 为/v 依照/p 克鲁/nsf 斯/b 卡尔/n 算法/n 构造/v 一/m 棵/q 最/d 小/a 生成/vn 树/n 的/ude1 过程/n 。/wj 代价/n 分别/d 为/v 
    图/n 7．18/m 克鲁/nsf 斯/b 卡尔/n 算法/n 构造/n 最/d 小/a 生成/vn 讨/v 的/ude1 过程/n 
1/m ，/wd 2/m ，/wd 3/m ，/wd 4/m 的/ude1 四/m 条/q 边/n 由于/c 满足/v 上述/b 条件/n ，/wd 则/c 先后/d 被/pbei 加入/v 到/v 丁/ng 中/f ，/wd 代价/n 为/p 5/m 的/ude1 两/m 条/q 边/n (/wkz u-/x ，/wd 可/v 4/m )/wky 图/n 7．19/m 连通/v 图/n G/x  5/m 
和/cc (/wkz v/x ；/wf ，/wd u/x 。/wj )/wky 被/pbei 舍去/v 。/wj 因为/p 它们/rr 依附/v 的/ude1 两/m 顶/q 点/n 在/p 同一/b 连通/v 分量/n 上/f ，/wd 它们/rr 若/c 加入/v 丁/ng 中/f ，/wd 则/c 会/v 使/v T/x 中/f 产生/v 回路/n ，/wd 而/cc 下/vf 一/m 条/q 代价/n (/wkz =5/m )/wky 最/d 小/a 的/ude1 边/n (/wkz 2/m ，/wd 3/m )/wky 联结/v 两/m 个/q 连通/v 分量/n ，/wd 则/c 可/v 加入/v T/x 。/wj 由此/d ，/wd 构造/v 成/v 一/m 棵/q 最/d 小/a 生成/vn 树/n 。/wj 
    上述/b 算法/n 至多/d 对/p e/x 条/q 边/n 各/rz 扫描/v 一/m 次/qv ，/wd 假若/c 以/p 第九/m 章/q 将/d 介绍/v 的/ude1 “/wyz 堆/v ”/wyy 来/f 存放/v 网/n 中/f 的/ude1 边/n ，/wd 则/c 每次/r 选择/vn 最/d 小/a 代价/n 的/ude1 边/d 仅/d 需/v 0/m (/wkz 10ge/x )/wky 的/ude1 时间/n (/wkz 第一/m 次/qv 需/v 0/m (/wkz e/x )/wky )/wky 。/wj 又/d 生成/v 树/n T/x 的/ude1 每个/r 连通/v 分量/n 可/v 看成/v 是/vshi 一个/mq 等价/n 类/q ，/wd 则/c 构造/v T/x 加入/v 新/a 的/ude1 边/n 的/ude1 过程/n 类似/v 于/p 求/v 等价/vn 类/n 的/ude1 过程/n ，/wd 由此/d 可以/v 以/p 6．5/m 节/q 中/f 介绍/v 的/ude1 MFSet/x 类型/n 来/vf 描述/v ．/w 『/wyz ，/wd 使/v 构造/n T/x 的/ude1 过程/n 仅/d 需/v 0/m (/wkz eloge/x )/wky 的/ude1 时间/n ，/wd 由此/d ，/wd 克鲁/nsf 斯/b 卡尔/n 算法/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz eloge/x )/wky 。/wj 
  7．4．4/m 关节点/n 和/cc 重/d 连通/v 分量/n 
  假若/c 在/p 删去/v 顶点/n 可以/v 及/cc 和/cc 口/n 相/d 关联/vi 的/ude1 各/rz 边/n 之后/f ，/wd 将/p 图/n 的/ude1 一个/mq 连通/v 分量/n 分割/v 成/v 两/m 个/q 或/c 两/m 个/q 以上/f 的/ude1 连通/v 分量/n ，/wd 则/c 称/v 顶点/n 。/wj 为/p 该/rz 图/n 的/ude1 一个/mq 关节点/n (/wkz articulation/x  point/x )/wky 。/wj 一个/mq 没有/d 关节点/n 的/ude1 连通/v 图/n 称为/v 是/vshi 重/d 连通/v 图/n (/wkz I/x )/wky iconnected/x  graph/x )/wky 。/wj 在/p 重/d 连通/v 图/n 上/f ，/wd 任意/d 一对/mq 顶点/n 之间/f 至少/d 存在/v 两/m 条/q 路径/n ，/wd 则/c 在/p 删去/v 某个/rz 顶点/n 以及/cc 依附/v 于/p 该/rz 顶点/n 的/ude1 各/rz 边/n 时/ng 也/d 不/d 破坏/v 图/n 的/ude1 连/ulian 通性/n 。/wj 若/c 在/p 连通/v 图/n 上/f 至少/d 删去/v n/x 个/q 顶点/n 才/d 能/v 破坏/v 图/n 的/ude1 连通/v 性/ng ，/wd 则/c 称/v 此图/n 的/ude1 连通/v 度/qv 为/v 忌/v 。/wj 关节点/n 和/cc 重/d 连通/v 在/p 实际/n 中/f 有/vyou 较/d 多/a 应用/vn 。/wj 显然/a ，/wd 一个/mq 表示/v 通信/vn 网络/n 的/ude1 图/n 的/ude1 连通/v 度/qv 越/d 高/a ，/wd 其/rz 系统/n 越/d 可靠/a ，/wd 无论是/c 哪/ry 一/m 站点/n 出现/v 故障/n 或/c 遭到/v 外界/n 破坏/vn ，/wd 都/d 不/d 影响/v 系统/n 的/ude1 正常/a 工作/vn ；/wf 又/d 如/v ，/wd 一个/mq 航空/n 网/n 若/c 是/vshi 重/d 连通/v 的/ude1 ，/wd 则/c 当/p 某/rz 条/q 航线/n 因/p 天气/n 等/udeng 某种/rz 原因/n 关闭/v 时/ng ，/wd 旅客/n 仍/d 可/v 从/p 别的/rzv 航线/n 绕道/v 而/cc 行/vi ；/wf 再/d 如/v ，/wd 若/c 将/p 大规模/b 集成电路/n 的/ude1 关键/n 线路/n 设计/v 成/v 重/d 连通/v 的话/udh ，/wd 则/c 在/p 某些/rz 元件/n 失效/vi 的/ude1 情况/n 下/f ，/wd 整个/b 片子/n 的/ude1 功能/n 不/d 受/v 影响/vn ，/wd 反之/c ，/wd 在/p 战争/n 中/f ，/wd 若/c 要/v 摧毁/v 敌方/n 的/ude1 运输线/n ，/wd 仅/d 需/v 破坏/v 其/rz 运输网/n 中/f 的/ude1 关节点/n 即可/v 。/wj     
    例如/v ，/wd 图/n 7．．19/m 中/b 图/n G5/x 是/vshi 连通/v 图/n ，/wd 但/c 不/d 是/vshi 重/d 连通/v 图/n 。/wj 图/n 中/f 有/vyou 四/m 个/q 关节点/n A/x 、/wn B/x 、/wn D/x 和/cc G/x 。/wj 若/c 删去/v 顶点/n B/x 以及/cc 所有/b 依附/vn 顶点/n B/x 的/ude1 边/n ，/wd G5/x 就/d 被/pbei 分割/v 成/v 三/m 个/q 连通/v 分量/n {/n A/x 、/wn c/x 、/wn F/x 、/wn L/x 、/wn J/x Ⅵ/m 、/wn J/x }/n 、/wn {/n G/x 、/wn H/x 、/wn J/x 、/wn K/x }/n 和/cc {/n D/x 、/wn E/x }/n 。/wj 类似/a 地/ude2 ，/wd 若/c 删去/v 顶点/n A/x 或/c D/x 或/c G/x 以及/cc 所有/b 依附/v 于/p 它们/rr 的/ude1 边/n ，/wd 则/d G/x ，/wd 被/pbei 分割/v 成/v 两/m 个/q 连通/v 分量/n ，/wd 由此/d ，/wd 关节点/n 亦/d 称/v 割/v 点/qt 。/wj 利用/v 深度/n 优先/vd 搜索/v 便/d 可/v 求得/v 图/n 的/ude1 关节点/n ，/wd 并/cc 由此/d 可/v 判别/v 图/n 是否/v 是/vshi 重/d 连通/v 的/ude1 。/wj 
    图/n 7．20/m 所/usuo 示/vg 为/v 从/p 顶点/n A/x 出发/vi 深度/n 优先/vd 搜索/v 遍历/n 图/n G5/x 所得/n 深度/n 优先/vd 生成/v 树/n ，/wd 图/n 中/b 实线/n 表示/v 树/n 边/k ，/wd 虚线/n 表示/v 回/qv 边/n (/wkz 即/v 不/d 在/p 生成/v 树上/s 的/ude1 边/n )/wky 。/wj 对/p 树/n 中/f 任/v 一/m 顶点/n u/x 而言/uls ，/wd 其/rz 孩子/n 结点/n 为/v 在/p 它/rr 之后/f 搜索/v 到/v 的/ude1 邻接/v 点/qt ，/wd 而/cc 其/rz 双亲/n 结点/n 和/cc 由/p 回/v 边/k 联结/v 的/ude1 祖先/n 结点/n 是/vshi 在/p 它/rr 之前/f 搜索/v 到/v 的/ude1 邻接/v 点/qt 。/wj 由/p 深度/n 优先/vd 生成/v 树/n 可/v 得/ude3 出/vf 两/m 类/q 关节点/n 的/ude1 特性/n ：/wp 
图/n 7．20/m   (/wkz ；/wf ；/wf 的/ude1 深度/n 
    优先/vd 生成/v 树/n 
    (/wkz 1/m )/wky 若/c 生成/v 树/n 的/ude1 根/n 有/vyou 两/m 棵/q 或/c 两/m 棵/q 以上/f 的/ude1 子/ng 树/n ，/wd 则/c 此/rzs 根/q 顶点/n 必/d 为/v 关节点/n 。/wj 因为/p 图/n 中/f 不/d 存在/v 联结/v 不同/a 子/ng 树/v 中/b 顶点/n 的/ude1 边/n ，/wd 因此/c ，/wd 若/c 删去/v 根/q 顶点/n ，/wd 生成/v 树/n 便/d 变成/v 生成/v 森林/n 。/wj 如/v 图/n 7．20/m 中/f 的/ude1 顶点/n A/x 。/wj 
    (/wkz 2/m )/wky 若/c 生成/v 树/n 中/f 某个/rz 非/b 叶子/n 顶点/n ”/wyy ，/wd 其/rz 某/rz 棵子/n 树/n 的/ude1 根/n 和/cc 子树中/nr 的/ude1 其它/rz 结点/n 均/d 没有/d 指向/v n/x 的/ude1 祖先/n 的/ude1 回/v 边/k ，/wd 则/d u/x 为/p 关节点/n 。/wj 因为/c ，/wd 若/c 删/v 去/vf ”/wyy ，/wd 则/c 其/rz 子/ng 树/n 和/cc 图/n 的/ude1 其它/rz 部分/n 被/pbei 分割/v 开/v 来/vf 。/wj 如/v 图/n 7．20/m 中/f 的/ude1 顶点/n B/x 、/wn D/x 和/cc G/x 。/wj 
    若/c 对/p 图/n (/wkz ；/wf raph：/x (/wkz V/x 、/wn ；/wf Edge/x }/n )/wky 重新/d 定义/v 遍/qv 历时/vi 的/ude1 访问/vn 函数/n visited/x ，/wd 并/cc 引入/v 一个/mq 新/a 的/ude1 函数/n low/x ，/wd 则/c 由/p 一/m 次/qv 深度/n 优先/vd 搜索/v 遍历/n 便/d 可/v 求得/v 连通/v 图/n 中/f 存在/v 的/ude1 所有/b 关节点/n 。/wj 
    定义/n vted/x [/wkz v/x ]/wky 为/p 深度/n 优先/vd 搜索/v 遍历/n 连通/v 图/n 时/ng 访问/v 顶点/n 勘/vg 的/ude1 次/qv 序号/n ；/wf 定义/n     f/x     j/x  w/x 是/vshi 顶点/n v/x 在/p 深度/n 优先/vd 生成/v 树上/s 的/ude1 孩子/n 结点/n ；/wf 在/p 深度/n 优先/vd 生成/v 树上/s 由/p 回/v 边/k 联结/v 的/ude1 祖先/n 结点/n ；/wf 若/c 对于/p 某个/rz 顶点/n u/x ，/wd 存在/v 孩子/n 结点/n low/x [/wkz w/x ]/wky ≥visited/x [/wkz v/x ]/wky ，/wd 则/c 该/rz 顶点/n u/x 必/d 为/v 关节点/n 。/wj 因为/c 当/p Ⅲ/m 是/vshi a/x 的/ude1 孩子/n 结点/n 时/ng ，/wd low/x [/wkz w/x ]/wky ≥visited/x [/wkz v/x ]/wky ，/wd 表明/v ”/wyy 及其/cc 子孙/n 均/d 无/v 指向/v T/x 的/ude1 祖先/n 的/ude1 回/v 边/k 。/wj 
    由/p 定义/n 可知/v ，/wd visited/x [/wkz v/x ]/wky 值/v 即/v 为/p 副/b 在/p 深度/n 优先/vd 生成/v 树/n 的/ude1 前/f 序/n 序列/n 中/f 的/ude1 序号/n ，/wd 只/d 需/v 将/d DFS/x 函数/n 中/f 头/m 两/m 个/q 语句/n 改/vd 为/v visited/x [/wkz v0/x ]/wky =++count/x (/wkz 在/p DFSTraverlSe/x 中/f 设/v 初值/n count：1/x )/wky 即可/v ；/wf low/x [/wkz v/x ]/wky 可/v 由/p 后/f 序/n 遍历/n 深度/n 优先/vd 生成/v 树/n 求得/v ，/wd 而/cc 秒/qt 在/p 后/f 序/n 序列/n 中/f 的/ude1 次序/n 和/cc 遍/v 历时/vi 退出/v DFS/x 函数/n 的/ude1 次序/n 相同/a ，/wd 由此/d 修改/v 深度/n 优先/vd 搜索/v 遍历/n 的/ude1 算法/n 便/d 可/v 得到/v 求/v 关节点/n 的/ude1 算法/n (/wkz 见/v 算法/n 7．10/m 和/cc 算法/n 7．/m )/wky 。/wj 
void/x  Fi/x 】/wky 71dArticul/x (/wkz A/x 【/wkz ／3raph/x  G/x )/wky {/n 
  ∥/w 连通/v 图/n G/x 以/p 邻接/v 表/vg 作/v 存储/vn 结构/n ，/wd 查找/v 并/cc 输出/v G/x 上/f 全部/m 关节点/n 。/wj 全局/n 量/n count/x 
    对/p 访问/v 计数/vi 。/wj 
  count=I/x ；/wf   visited/x [/wkz O/x ]/wky =I/x ；/wf     ∥/w 设定/v 邻接/v 表/n 上/f 0/m 号/q 顶点/n 为/p 生成/v 树/n 的/ude1 根/n 
  for/x (/wkz i=i/x ；/wf   i/x </n G．vexn/x ；/wf +十i/x )/wky visited/x [/wkz i/x ]/wky =0/m ；/wf ∥/w 其余/rz 顶点/n 尚未/d 访问/v 
  P=G．vertices/x [/wkz O/x ]/wky ．/w firstarc/x ；/wf   v=P-/x >/n adjvex/x ；/wf 
  DFSArticui/x (/wkz G/x ，/wd v/x )/wky ；/wf     ∥/w 从/p 第/m v/x 顶点/n 出发/vi 深度/n 优先/vd 查找/v 关节点/n 。/wj 
  if/x (/wkz count/x </n G．vex/x ~/n um/x )/wky {/n     ∥/w 生成/v 树/n 的/ude1 根/n 有/vyou 至少/d 两/m 棵子/n 树/n 
    printf/x (/wkz 0/m ，/wd G．vertices/x [/wkz O/x ]/wky ．/w data/x )/wky ；/wf   ∥/w 根/n 是/vshi 关节点/n 。/wj 输出/v 
    while/x (/wkz P-/x >/n nextarc/x )/wky {/n 
    p=P-/x >/n nextarc/x ；/wf   V=P-/x >/n adjvex/x ；/wf 
    if/x (/wkz visited/x [/wkz v/x ]/wky ==0/m )/wky DFSArticul/x (/wkz g/x ，/wd v/x )/wky ；/wf 
    }/n ∥/w while/x 
  }/n ∥/w if/x 
＼/m #/n {/n FindArticul/x 
    算法/n 7．10/m 
void/x  DFSArticul/x (/wkz ALGraph/x  G/x ，/wd int/x  V0/x )/wky {/n 
  ∥/w 从/p 第/m v10/x 个/q 顶点/n 出发/vi 深度/n 优先/vd 遍历/n 图/n G/x ，/wd 查找/v 并/cc 输出/vn 关节点/n 。/wj 
  visited/x [/wkz v0/x ]/wky =min=++count/x ；/wf   ∥/w vO/x 是/vshi 第/m count/x 个/q 访问/vn 的/ude1 顶点/n 
  for/x (/wkz P=G．vertices/x [/wkz v0/x ]/wky ．/w firstarc/x ；/wf p/x ；/wf P=P-/x >/n nextarc/x )/wky {/n   ∥/w 对/p v0/x 的/ude1 每个/r 邻接/v 顶点/n 检查/vn 
    W=P-/x >/n adjvex/x ；/wf     ∥/w W/x 为/v Vo/x 的/ude1 邻接/v 顶点/n 
    if/x (/wkz visited/x [/wkz w/x ]/wky ==0/m )/wky {/n     ∥/w W/x 未曾/d 访问/v ，/wd 是/vshi vo/x 的/ude1 孩子/n 
    DFSArticul/x (/wkz G/x ，/wd W/x )/wky ；/wf     ∥/w 返回/v 前/f 求得/v low/x [/wkz ．/w ]/wky 
    if/x (/wkz 10w/x [/wkz w/x ]/wky </n min/x )/wky min=low/x [/wkz w/x ]/wky ；/wf 
    if/x (/wkz 10w/x [/wkz w/x ]/wky >/n =visited/x [/wkz M/x )/wky ]/wky )/wky pr／ntf/x (/wkz vO/x ，/wd G．vertices/x [/wkz vO/x ]/wky ．/w data/x )/wky ；/wf ∥/w 关节点/n 
    Ielse/x  if/x (/wkz visited/x [/wkz w/x ]/wky </n min/x )/wky   min=visited/x [/wkz w/x ]/wky ；/wf 
    ∥/w W/x 已/d 访问/v ，/wd W/x 是/vshi Vo/x 在/p 生成/v 树上/s 的/ude1 祖先/n 
    low/x [/wkz ]/wky =rain/x ；/wf 
f／／DFSArticul/x 
    算法/n 7．11/m 
例如/v ，/wd 图/n G5/x 中/f 各/rz 顶点计算/n 所得/n visited/x 和/cc low/x 的/ude1 函数值/n 如下/vi 所/usuo 列/v ：/wp 其中/rz J/x 是/vshi 第一/m 个/q 求得/v low/x 值/n 的/ude1 顶点/n ，/wd 由于/c 存在/v 回/qv 边/n (/wkz ，/wd ，/wd L/x )/wky ，/wd 则/d low/x [/wkz J/x ]/wky =Min/x {/n visited/x [/wkz J/x ]/wky 、/wn vis．ited/x [/wkz L/x ]/wky }/n =2/m 。/wj 顺便/d 提/v 一/m 句/q ，/wd 上述/b 算法/n 中将/n 指向/v 双亲/n 的/ude1 树/n 边/k 也/d 看成/v 是/vshi 回/v 边/k ，/wd 由于/c 不/d 影响/v 关节点/n 的/ude1 判别/vn ，/wd 因此/c ，/wd 为/p 使/v 算法/n 简明/a 起见/u ，/wd 在/p 算法/n 中/f 没/d 有/vyou 区别/n 之/uzhi 。/wj     
    由于/p 上述/b 算法/n 的/ude1 过程/n 就/d 是/vshi 一个/mq 遍历/n 的/ude1 过程/n ，/wd 因此/c ，/wd 求/v 关节点/n 的/ude1 时间/n 复杂度/n 仍/d 为/v 0/m (/wkz ，/wd z+e/x )/wky 。/wj 若/c 尚/d 需/v 输出/v 双/m 连通/v 分量/n ，/wd 仅/d 需/v 在/p 算法/n 中/f 增加/v 一些/mq 语句/n 即可/v ，/wd 在/p 此/rzs 不再/d 详/ag 述/vg ，/wd 留给/v 读者/n 自己/rr 完成/v 。/wj 
7．5/m 有/vyou 向/p 无/v 环/v 图/n 及其/cc 应用/vn 
一个/mq 无/v 环/n 的/ude1 有/vyou 向/p 图/n 称/v 做/v 有/vyou 向/p 无/v 环/v 图/n (/wkz directed/x  acycline/x  graph/x )/wky ，/wd 简称/v DAG/x 图/n 。/wj DAG/x 图/n 是/vshi 一/m 类/q 较/d 有/vyou 向/p 树/n 更/d 一般/a 的/ude1 特殊/a 有/vyou 向/p 图/n ，/wd 如/v 图/n 7．21/m 列/q 示/vg 了/ule 有/vyou 向/p 树/n 、/wn DAG/x 图/n 和/cc 有/vyou 向/p 图/n 的/ude1 例子/n 。/wj 
    有/vyou 向/p 无/v 环/v 图/n 是/vshi 描述/v 含有/v 公共/b 子/ng 式/k 的/ude1 表达/vn 式/k 的/ude1 有效/a 工具/n 。/wj 例如/v 下/f 述/vg 表达式/n     (/wkz (/wkz a/x 十/m b/x )/wky */n (/wkz b/x */n (/wkz c+d/x )/wky )/wky 十/m (/wkz c+d/x )/wky */n e/x )/wky */n (/wkz (/wkz c+d/x )/wky */n e/x )/wky 图/n 7．21/m 有/vyou 向/p 树/n 、/wn DAG/x 图/n 和/cc 有/vyou 向/p 图/n 一/m 例/q 
可以/v 用/p 第6/m 章/q 讨论/vn 的/ude1 二/m 叉树/n 来/vf 表示/v ，/wd 如/v 图/n 7．22/m 所/usuo 示/vg 。/wj 仔细/ad 观察/v 该/rz 表达式/n ，/wd 可/c 发现/v 有/vyou 一些/mq 相同/a 的/ude1 子/ng 表达式/n ，/wd 如/v (/wkz c+d/x )/wky 和/cc (/wkz c+d/x )/wky */n e/x 等/udeng ，/wd 在/p 二/m 叉树/n 中/f ，/wd 它们/rr 也/d 重复/vd 出现/v 。/wj 若/c 利用/v 有/vyou 向/p 无/v 图/n 7．22/m 用/p 二/m 叉树/n 描述/vn 表达式/n 环/v 图/n ，/wd 则/c 可/v 实现/v 对/p 相同/a 子/ng 式/k 的/ude1 共享/vn ，/wd 从而/c 节省存储/n 空间/n 。/wj 
   图/n 7．23/m 描述/vn 表达式/n 的/ude1 有/vyou 向/p 无/v 环/v 图/n 
例如/v 图/n 7．23/m 所/usuo 示/vg 为/p 表示/v 同一/b 表达式/n 的/ude1 有/vyou 向/p 无/v 环/v 图/n 。/wj 
　　检查/v 一个/mq 有/vyou 向/p 图/n 是否/v 存在/v 环/v 要/v 比/p 无/v 向/p 图/n 复杂/a 。/wj 对于/p 无/v 向/p 图/n 来说/uls ，/wd 若/c 深度/n 优先/vd 遍历/n 过程/n 中/f 遇到/v 回/qv 边/n (/wkz 即/v 指向/v 已/d 访问/v 过/uguo 的/ude1 顶点/n 的/ude1 边/n )/wky ，/wd 则/c 必定/d 存在/v 环/n ；/wf 而/cc 对于/p 有/vyou 向/p 图/n 来说/uls ，/wd 这/rzv 条/q 回/v 边/k 有/vyou 可能/n 是/vshi 指/v 向/p 深度/n 优先/vd 生成/v 森林/n 中/f 另/rz 一/m 棵/q 生成/v 树上/s 顶点/n 的/ude1 弧/n 。/wj 但是/c ，/wd 如果/c 从/p 有/vyou 向/p 图/n 上/f 某个/rz 顶点/n a/x 出发/vi 的/ude1 遍历/n ，/wd 在/p dfs/x (/wkz v/x )/wky 结束/v 之前/f 出现/v 一/m 条/q 从/p 顶点/n “/wyz 到/v 顶点/n 。/wj 的/ude1 回/qv 边/n (/wkz 如/v 图/n 7．24/m 所/usuo 示/vg )/wky ，/wd 由于/c tt/x 在/p 生成/v 树/n 上/f 是/vshi 。/wj 的/ude1 子孙/n ，/wd 则/c 有/vyou 向/p 图/n 中/f 必定/d 存在/v 包含/v 顶点/n 。/wj 
　　有/vyou 向/p 无/v 环/v 图/n 也/d 是/vshi 描述/v 一/m 项/q 工程/n 或/c 系统/n 的/ude1 进行/vx 过程/n 的/ude1 有效/a 工具/n 。/wj 除/p 最/d 简单/a 的/ude1 情况/n 之外/f ，/wd 几乎/d 所有/b 的/ude1 工程/n (/wkz pro．/x 图/n 7．24/m 含有环/n 的/ude1 有/vyou 向/p 图/n     的/ude1 深度/n 优先/vd 生成/v 树/n ject：/x )/wky 都/d 可/v 分为若干/n 个/q 称作/v 活动/vn (/wkz activity/x )/wky 的/ude1 子/ng 工程/n ，/wd 而/cc 这些/rz 子/ng 工程/n 之间/f ，/wd 通常/d 受/v 着/uzhe 一定/b 条件/n 的/ude1 约束/vn ，/wd 如/v 其/rz 中/f 某些/rz 子/ng 工程/n 的/ude1 开始/v 必须/d 在/p 另/rz 一些/mq 子/ng 工程/n 完成/v 之后/f 。/wj 对/p 整个/b 工程/n 和/cc 系统/n ，/wd 人们/n 关心/v 的/ude1 是/vshi 两/m 个/q 方面/n 的/ude1 问题/n ：/wp 一/m 是/vshi 工程/n 能否/v 顺利/ad 进行/vx ；/wf 二/m 是/vshi 估算/v 整个/b 工程/n 完成/v 所/usuo 必须/d 的/ude1 最/d 短时间/n ，/wd 对/p 应/v 于/p 有/vyou 向/p 图/n ，/wd 即/d 为/v 进行/vx 拓扑/n 排序/vn 和/cc 关键路径/n 的/ude1 操作/vn 。/wj 下面/f 分别/d 就/d 这/rzv 两/m 个/q 问题/n 讨论/v 之/uzhi 。/wj 
  7．5．1/m 拓扑/n 排序/vi 
  什么/ry 是/vshi 拓扑/n 排序/vi (/wkz Topological/x  Sort/x )/wky ?/ww 简单/a 地/ude2 说/v ，/wd 由/p 某个/rz 集合/n 上/f 的/ude1 一个/mq 偏/a 序/n 得到/v 该/rz 集合/n 上/f 的/ude1 一个/mq 全/a 序/n ，/wd 这个/rz 操作/v 称之为/v 拓扑/n 排序/vi 。/wj 回顾/v 离散/vn 数学/n 中/f 关于/p 偏/a 序/n 和/cc 全/a 序/n 的/ude1 定义/n ：/wp 
    若/c 集合/v X/x 上/f 的/ude1 关系/n R/x 是/vshi 自/p 反/vi 的/ude1 、/wn 反对/v 称/v 的/ude1 和/cc 传递/v 的/ude1 ，/wd 则/c 称/v R/x 是/vshi 集合/v x/x 上/f 的/ude1 偏/a 序/n 关系/n 。/wj 
　　设/v R/x 是/vshi 集合/v X/x 上/f 的/ude1 偏/a 序/n (/wkz Pat・tial/x (/wkz )/wky rder/x )/wky ，/wd 如果/c 对/p 每个/r z/x ，/wd y∈X/x 必/d 有/vyou zR/x 了/vi 或/c y／Cz/x ‘/wyz 。/wj 称/v R/x 是/vshi 集合/v x/x 上/f 的/ude1 全/a 序/n 关系/n 。/wj 
　　直观/a 地/ude2 看/v ，/wd 偏/a 序/n 指/v 集合/v 中/f 仅/d 有/vyou 部分/m 成员/n 之间/f 可/v 比较/vn ，/wd 而/cc 全/a 序/n 指/v 集合/v 中/b 全体/n 成员/n 之间/f 均/d 可/v 比较/vn 。/wj 例如/v ，/wd 图/n 7．25/m 所/usuo 示/vg 的/ude1 两/m 个/q 有/vyou 向/p 图/n ，/wd 图/n 中/b 弧/n (/wkz T/x ，/wd y/x )/wky 表示/v z≤/x 了/vi ，/wd 则/d (/wkz a/x )/wky 表示/v 偏/a 序/n ，/wd (/wkz b/x )/wky (/wkz a/x )/wky     (/wkz b/x )/wky 图/n 7．25/m 表示/v 偏/a 序/n 和/cc 全/a 序/n 的/ude1 有/vyou 向/p 图/n     (/wkz a/x )/wky 表示/v 偏/a 序/n ；/wf (/wkz b/x )/wky 表示/v 全/a 序/n 。/wj 
表示/v 全/a 序/n 。/wj 若/c 在/p (/wkz a/x )/wky 的/ude1 有/vyou 向/p 图/n 上/f 人为/d 地/ude2 加/v 一个/mq 表示/v 训/v 2≤/m 口/q 。/wj 的/ude1 弧/n (/wkz 符号/n “/wyz ≤/m ”/wyy 表示/v 口/n ：/wp 领先/vi 于/p ”/wyy ，/wd )/wky ，/wd 则/d (/wkz a/x )/wky 表示/v 的/ude1 亦/d 为/v 全/a 序/n ，/wd 且/c 这个/rz 全/a 序/n 称为/v 拓扑/n 有序/a (/wkz Topological/x (/wkz )/wky rder/x )/wky ，/wd 而/cc 由/p 偏/a 序/n 定义/n 得到/v 拓扑/n 有序/a 的/ude1 操作/vn 便是/v 拓扑/n 排序/vi 。/wj 
    一个/mq 表示/v 偏/a 序/n 的/ude1 有/vyou 向/p 图/n 可/v 用/v 来/vf 表示/v 一个/mq 流程图/n 。/wj 它/rr 或者/c 是/vshi 一个/mq 施工/vn 流程图/n ，/wd 或者/c 是/vshi 一个/mq 产品/n 生产/vn 的/ude1 流程图/n ，/wd 再/d 或/c 是/vshi 一个/mq 数据流/n 图/n (/wkz 每个/r 顶点/n 表示/v 一个/mq 过程/n )/wky 。/wj 图/n 中/f 每/rz 一/m 条/q 有/vyou 向/p 边/k 表示/v 两/m 个/q 子/ng 工程/n 之间/f 的/ude1 次序/n 关系/n (/wkz 领先/vn 关系/n )/wky 。/wj 
    例如/v ，/wd 一个/mq 软件/n 专业/n 的/ude1 学生/n 必须/d 学习/v 一/m 系列/q 基本/a 课程/n (/wkz 如/v 图/n 7．26/m 所/usuo 示/vg )/wky ，/wd 其中/rz 有些/rz 课程/n 是/vshi 基础课/n ，/wd 它/rr 独立/v 于/p 其它/rz 课程/n ，/wd 如/v 《/wkz 高/a 等/udeng 数学/n 》/wky ；/wf 而/cc 另/rz 一些/mq 课程/n 必须/d 在/p 学/v 完/vi 作为/p 它/rr 的/ude1 基础/n 的/ude1 先/d 修/v 课程/n 才/d 能/v 开始/v 。/wj 如/c ，/wd 在/p 《/wkz 程序设计/n 基础/n 》/wky 和/cc 《/wkz 离散/b 数学/n 》/wky 学/v 完/vi 之前/f 就/d 不/d 能/v 开始/v 学习/v </n 数据/n 结构/n 》/wky 。/wj 这些/rz 先决条件/n 定义/v 了/ule 课程/n 之间/f 的/ude1 领先/vn (/wkz 优先/v )/wky 关系/n 。/wj 这个/rz 关系/n 可以/v 用/v 有/vyou 向/p 图/n 更/d 清楚/a 地/ude2 表示/v ，/wd 如/v 图/n 7．27/m 所/usuo 示/vg 。/wj 图/n 中/b 顶点/n 表示/v 课程/n ，/wd 有/vyou 向/p 边/n (/wkz 弧/n )/wky 表示/v 先决条件/n 。/wj 若/c 课程/n i/x 是/vshi 课程/n j/x 的/ude1 先决条件/n ，/wd 则/c 图/n 中/f 有/vyou 弧/n (/wkz j/x ，/wd i/x )/wky 。/wj 
    这种/r 用/p 顶点/n 表示/v 活动/vn ，/wd 用/p 弧/n 表示/v 活动/vn 间/f 的/ude1 优先/vn 关系/n 的/ude1 有/vyou 向/p 图/n 称为/v 顶点/n 表示/v 活动/vn 的/ude1 网/n (/wkz Activity/x  On/x  Vertex/x  Network/x )/wky ，/wd 简称/v AOV/x 一/m 网/n 。/wj 在/p 网/n 中/f ，/wd 若/c 从/p 顶点/n i/x 到/v 顶点/n j/x 有/vyou 一/m 条/q 有/vyou 向/p 路径/n ，/wd 则/d i/x 是/vshi j/x 的/ude1 前驱/n ；/wf J/x 是/vshi i/x 的/ude1 后/f 继/vg 。/wj 若/v (/wkz i/x ，/wd J/x )/wky 是/vshi 网/n 中/f 一/m 条/q 弧/n ，/wd 则/d i/x 是/vshi J/x 的/ude1 直接/a 前驱/n ；/wf j/x 是/vshi i/x 的/ude1 直接/a 后/f 继/vg 。/wj 
图/n 7．26/m 软件/n 专业/n 的/ude1 学生/n 必须/d 学习/v 的/ude1 课程/n     
    在/p AOV．/x 网/n 中/f ，/wd 不/d 应该/v 出现/v 有/vyou 向/p 环/n ，/wd 因为/c 存在/v 环/v 意味/n 着/uzhe 某/rz 项/q 活动/vn 应/v 以/p 自己/rr 为/p 先决条件/n 。/wj 显然/a ，/wd 这/rzv 是/vshi 荒谬/a 的/ude1 。/wj 若/c 设计/v 出/vf 这样/rzv 的/ude1 流程图/n ，/wd 工程/n 便/d 无法/v 进行/vx 。/wj 而/cc 对/p 程序/n 的/ude1 数据流/n 图/n 来说/uls ，/wd 则/c 表明/v 存在/v 一个/mq 死/a 循环/vn 。/wj 因此/c ，/wd 对/p 给定/v 的/ude1 AOV．/x 网/n 应/v 首先/d 判定/v 网/n 中/f 是否/v 存在/v 环/n 。/wj 检测/v 的/ude1 办法/n 是/vshi 对/p 有/vyou 向/p 图/n 构造/n 其/rz 顶点/n 的/ude1 拓扑/n 有序/a 序列/n ，/wd 若/c 网/n 中/b 所有/b 顶点/n 都/d 在/p 它/rr 的/ude1 拓扑/n 有序/a 序列/n 中/f ，/wd 则/c 该/v ．/w AOV/x 一/m 网/n 中/f 必定/d 不/d 存在/v 环/n 。/wj 例如/v ，/wd 图/n 7．27/m 的/ude1 有/vyou 向/p 图/n 有/vyou 如下/vi 两/m 个/q 拓扑/n 有序/a 序列/n ：/wp 图/n 7．27/m 表示/v 课程/n 之间/f 优先/v 关系/n 的/ude1 有/vyou 向/p 图/n     (/wkz Cl/x ，/wd C2/x ，/wd C3/x ，/wd C4/x ，/wd C5/x ，/wd C7/x ，/wd C9/x ，/wd Clo/x ，/wd C11/x ，/wd C6/x ，/wd C12/x ，/wd C8/x )/wky 和/cc     (/wkz C9/x ，/wd Clo/x ，/wd C11/x ，/wd C6/x ，/wd Cl/x ，/wd C12/x ，/wd C4/x ，/wd C2/x ，/wd C3/x ，/wd C5/x ，/wd C7/x ，/wd C8/x )/wky (/wkz 当然/d ，/wd 对/p 此图/n 也/d 可/v 构造/n 得/ude3 其它/rz 的/ude1 拓扑/n 有序/a 序列/n )/wky 。/wj 若/c 某个/rz 学生/n 每/rz 学期/n 只/d 学/v 一/m 门/q 课程/n 的/ude1 话/n ，/wd 则/c 他/rr 必须/d 按/p 拓扑/n 有序/a 的/ude1 顺序/n 来/vf 安排/v 学习/v 计划/n 。/wj 
    如何/ryv 进行/vx 拓扑/n 排序/vi ?/ww 解决/v 的/ude1 方法/n 很/d 简单/a ：/wp 
    (/wkz 1/m )/wky 在/p 有/vyou 向/p 图/n 中/f 选/v 一个/mq 没有/v 前驱/n 的/ude1 顶点/n 且/c 输出/v 之/uzhi 。/wj 
    (/wkz 2/m )/wky 从/p 图/n 中/f 删除/v 该/rz 顶点/n 和/cc 所有/b 以/p 它/rr 为/v 尾/ng 的/ude1 弧/n 。/wj 
    重复/v 上述/b 两/m 步/qv ，/wd 直至/v 全部/m 顶点/n 均/d 已/d 输出/v ，/wd 或者/c 当前/t 图/n 中/f 不/d 存在/v 无/v 前驱/n 的/ude1 顶点/n 为止/u 。/wj 后/f 一/m 种/q 情况/n 则/d 说明/v 有/vyou 向/p 图/n 中/f 存在/v 环/n 。/wj 
    以/p 图/n 7．28/m (/wkz a/x )/wky 中/f 的/ude1 有/vyou 向/p 图/n 为/p 例/n ，/wd 图/n 中/f ，/wd ul/x 和/cc 可/v 6/m 没有/v 前驱/n ，/wd 则/c 可/v 任选/v 一个/mq 。/wj 假设/n 先/d 输出/v a6/x ，/wd 在/p 删除/v a6/x 及/cc 弧/n (/wkz a6/x ，/wd a4/x )/wky ，/wd (/wkz a6/x ，/wd V5/x )/wky 之后/f ，/wd 只有/c 顶点/n a1/x 没有/v 前驱/n ，/wd 则/c 输出/v a1/x 且/c 删去/v ul/x 及/cc 弧/n (/wkz u/x ，/wd ，/wd v2/x >/n 、/wn (/wkz a/x 。/wj ，/wd v3/x >/n 和/cc (/wkz u1/x ，/wd 734/m )/wky ，/wd 之后/f u3/x 和/cc 可/v 。/wj 都/d 没有/v 前驱/n 。/wj 依次/d 类推/vi ，/wd 可/c 从中/d 任选/v 一个/mq 继续/v 进行/vx 。/wj 整个/b 拓扑/n 排序/vi 的/ude1 过程/n 如/v 图/n 7．28/m 所/usuo 示/vg 。/wj 最后/f 得到/v 该/rz 有/vyou 向/p 图/n 的/ude1 拓扑/n 有序/a 序列/n 为/v 
图/n 7．28/m  AOV/x 一/m 网/n 及其/cc 拓扑/n 有序/a 序列/n 产生/v 的/ude1 过程/n 
  (/wkz a/x )/wky AOV/x 一/m 网/n ；/wf (/wkz b/x )/wky 输出/v "/n 6/m 之后/f ；/wf (/wkz c/x )/wky 输/v 出口/vi 1/m 之后/f ；/wf 
(/wkz d/x )/wky 输出/v ”/wyy 。/wj 之后/f ；/wf (/wkz e/x )/wky 输出/v 。/wj 3/m 之后/f ；/wf (/wkz f/x )/wky 输/v 出口/vi 2/m 之后/f 。/wj 
    如何/ryv 在/p 计算机/n 中/f 实现/v ?/ww 针对/p 上述/b 两/m 步/qv 操作/vn ，/wd 我们/rr 可/v 采用/v 邻接/v 表/vg 作/v 有/vyou 向/p 图/n 的/ude1 存储/vn 结构/n ，/wd 且/c 在/p 头/n 结点/n 中/f 增加/v 一个/mq 存放/v 顶点/n 入/v 度/qv 的/ude1 数组/n (/wkz indegree/x )/wky 。/wj 入/v 度/qv 为/v 零/m 的/ude1 顶点/n 即/d 为/v 没有/v 前驱/n 的/ude1 顶点/n ，/wd 删除/v 顶点/n 及/cc 以/p 它/rr 为/v 尾/ng 的/ude1 弧/n 的/ude1 操作/vn ，/wd 则/c 可/v 换/v 以/p 弧/n 头顶/n 点/qt 的/ude1 入/v 度/qv 减/v 1/m 来/vf 实现/v 。/wj 
    为了/p 避免重复/n 检测/v 入/v 度/qv 为/v 零/m 的/ude1 顶点/n ，/wd 可/v 另/rz 设/v 一/m 栈/ng 暂/d 存/v 所有/b 入/v 度/qv 为/v 零/m 的/ude1 顶点/n ，/wd 由此/d 可/v 得/ude3 拓扑/n 排序/vi 的/ude1 算法/n 如/v 算法/n 7．12/m 所/usuo 示/vg 。/wj 
Status/x  TopologicalSort/x (/wkz ALGraph/x  G/x )/wky I/x 
  ∥/w 有/vyou 向/p 图/n G/x 采用/v 邻接/v 表存储/n 结构/n 。/wj 
  ∥/w 若/v G/x 无/v 回路/n ，/wd 则/c 输出/v G/x 的/ude1 顶点/n 的/ude1 一个/mq 拓扑/n 序列/n 并/cc 返回/v 0K/x ，/wd 否则/c ERROR/x 。/wj 
  FindInDegree/x (/wkz G/x ，/wd indegree/x )/wky ；/wf     ∥/w 对/p 各/rz 顶点/n 求/v 入/v 度/qv indegree/x [/wkz 0．．vernum-1/x ]/wky 
  InitStack/x (/wkz S/x )/wky ；/wf 
  for/x (/wkz i=0/x ；/wf i/x </n G．vexnum/x ；/wf ++i/x )/wky     ／／/m 建/v 零/m 入/v 度/qv 顶点/n 栈/ng S/x 
    if/x (/wkz !/wt indegree/x [/wkz i/x ]/wky )/wky Push/x (/wkz S/x ，/wd i/x )/wky ；/wf     ∥/w 入/v 度/qv 为/v 0/m 者/k 进/vf 栈/ng 
  count=0/x ；/wf     ∥/w 对/p 输出/vn 顶点/n 计数/vi 
  while/x (/wkz !/wt StackEmpty/x (/wkz S/x )/wky )/wky I/x 
    Pop/x (/wkz S/x ，/wd i/x )/wky ；/wf printf/x (/wkz i/x ，/wd G．vertices/x [/wkz i/x ]/wky ．/w data/x )/wky ；/wf   ++count/x ；/wf ∥/w 输出/v i/x 号/q 顶点/n 并/cc 计数/vi 
    ~/n or/x (/wkz P=G．vertices/x [/wkz i/x ]/wky ．/w firstarc/x ；/wf p/x ；/wf P=P-/x >/n nextarc/x )/wky {/n 
    k=P-/x >/n adjvex/x ；/wf     ∥/w 对/p i/x 号/q 顶点/n 的/ude1 每个/r 邻接/v 点/qt 的/ude1 入/v 度/qv 减/v 1/m 
    if/x (/wkz !/wt (/wkz --/wp indegree/x [/wkz k/x ]/wky )/wky )/wky Push/x (/wkz S/x ，/wd k/x )/wky ；/wf ／／/m 若/c 入/v 度/qv 减/v 为/p 0/m ，/wd 则/c 入/v 栈/ng 
    }/n ／／for/x 
  ＼/m “/wyz while/x 
  if/x (/wkz count/x </n G．vexnum/x )/wky return/x  ERROR/x ；/wf     ／／/m 该/rz 有/vyou 向/p 图/n 有/vyou 回路/n 
  else/x  return/x  OK/x ；/wf 
＼/m }/n {/n TopologicalSort/x 
    算法/n 7．12/m 
    分析算法/n 7．12/m ，/wd 对/p 有/vyou 九/m 个/q 顶点/n 和/cc e/x 条/q 弧/n 的/ude1 有/vyou 向/p 图/n 而言/uls ，/wd 建立/v 求/v 各/rz 顶点/n 的/ude1 入/v 度/qv 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz e/x )/wky ；/wf 建/v 零/m 入/v 度/qv 顶点/n 栈/ng 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz n/x )/wky ；/wf 在/p 拓扑/n 排序/vn 过程/n 中/f ，/wd 若/c 有/vyou 向/p 图/n 无/v 环/n ，/wd 则/c 每个/r 顶点/n 进/vf 一/m 次/qv 栈/ng ，/wd 出/vf 一/m 次/qv 栈/ng ，/wd 入/v 度/qv 减/v 1/m 的/ude1 操作/vn 在/p WHILE/x 语句/n 中/f 总共/d 执行/v e/x 次/qv ，/wd 所以/c ，/wd 总/b 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz ”/wyy +s/x )/wky 。/wj 上述/b 拓扑/n 排序/vi 的/ude1 算法/n 亦/d 是/vshi 下/vf 节/n 讨论/vn 的/ude1 求/v 关键路径/n 的/ude1 基础/n 。/wj 
    当/p 有/vyou 向/p 图/n 中/f 无/v 环/n 时/ng ，/wd 也/d 可/v 利用/v 深度/n 优先/vd 遍历/n 进行/vx 拓扑/n 排序/vi ，/wd 因为/c 图/n 中/f 无/v 环/n ，/wd 则/c 由/p 图/n 中/f 某/rz 点/qt 出发/vi 进行/vx 深度/n 优先/vd 搜索/v 遍/qv 历时/vi ，/wd 最先/d 退出/v 【/wkz )/wky FS/x 函数/n 的/ude1 顶点/n 即/v 出/vf 度/ng 为/v 零/m 的/ude1 顶点/n ，/wd 是/vshi 拓扑/n 有序/a 序列/n 中/f 最后/f 一个/mq 顶/v 点/qt 。/wj 由此/d ，/wd 按/p 退出/v DFs/x 函数/n 的/ude1 先后/d 记录/v 下来/vf 的/ude1 顶点/n 序列/n (/wkz 如同/v 求/v 强/ng 连通/v 分量/n 时/ng finished/x 数组/n 中/f 的/ude1 顶点/n 序列/n )/wky 即/v 为/p 逆向/b 的/ude1 拓扑/n 有序/a 序列/n 。/wj 
7．5．2/m 关键路径/n 
　　与/p Aov/x 一/m 网/n 相/d 对应/vi 的/ude1 是/vshi AOE/x 一/m 网/n (/wkz Activity/x  On/x ’/wyy Edge/x )/wky 即/v 边/k 表示/v 活动/vn 的/ude1 网/n 。/wj AOE/x 一/m 网/n 是/vshi 一个/mq 带权/n 的/ude1 有/vyou 向/p 无/v 环/v 图/n ，/wd 其中/rz ，/wd 顶点/n 表示/v 事件/n (/wkz Event/x )/wky ，/wd 弧/n 表示/v 活动/vn ，/wd 权/n 表示/v 活动/vn 持续/vi 的/ude1 时间/n 。/wj 通常/d ，/wd AOE．/x 网/n 可/v 用/v 来/vf 估算/v 工程/n 的/ude1 完成/vn 时间/n 。/wj 
　　例如/v ，/wd 图/n 7．29/m 是/vshi 一个/mq 假想/b 的/ude1 有/vyou 11/m 项/q 活动/vn 的/ude1 AOE/x 一/m 网/n 。/wj 其中/rz 有/vyou 9/m 个/q 事件/n 可/v l/x ，/wd a2/x ，/wd u3/x ，/wd …/ws ，/wd u9/x ，/wd 每个/r 事件/n 表示/v 在/p 它/rr 之前/f 的/ude1 活动/vn 已经/d 完成/v ，/wd 在/p 它/rr 之后/f 的/ude1 活动/vn 可以/v 开始/v 。/wj 如/v a/x ，/wd 表示/v 整个/b 工程/n 开始/v ，/wd a/x ，/wd 表示/v 整个/b 工程/n 结束/v ，/wd a5/x 表示/v 和/cc 5/m 已经/d 完成/v ，/wd ，/wd 和/cc a/x 。/wj 可以/v 开始/v 。/wj 与/p 每个/r 活动/vn 相/d 联系/v 的/ude1 数/n 是/vshi 执行/v 该/rz 活动/vn 所/usuo 需/v 的/ude1 时间/n 。/wj 比如/v ，/wd 活动/vn a/x ，/wd 需要/v 6/m 天/qt ，/wd a2/x 需要/n 4/m 天/qt 等/udeng 。/wj 
图/n 7．29/m 一个/mq AoE/x 网/n 
    由于/p 整个/b 工程/n 只/d 有/vyou 一个/mq 开始/v 点/qt 和/cc 一个/mq 完成/v 点/qt ，/wd 故/c 在/p 正常/a 的/ude1 情况/n (/wkz 无/v 环/n )/wky 下/f ，/wd 网/n 中/f 只/d 有/vyou 一个/mq 入/v 度/qv 为/v 零/m 的/ude1 点/n (/wkz 称作/v 源/ng 点/n )/wky 和/cc 一个/mq 出/vf 度/ng 为/v 零/m 的/ude1 点/n (/wkz 叫做/v 汇点/n )/wky 。/wj 
    和/cc AOV/x 一/m 网/n 不同/a ，/wd 对/p AOE．/x 网/n 有待/v 研究/vn 的/ude1 问题/n 是/vshi ：/wp (/wkz 1/m )/wky 完成/v 整/m 项/q 工程/n 至少/d 需要/v 多少/ry 时间/n ?/ww (/wkz 2/m )/wky 哪些/ry 活动/vn 是/vshi 影响/v 工程/n 进度/n 的/ude1 关键/n ?/ww 
    由于/c 在/p AOE/x 一/m 网/n 中/f 有些/rz 活动/vn 可以/v 并行/vi 地/ude2 进行/vx ，/wd 所以/c 完成/v 工程/n 的/ude1 最/d 短时间/n 是/vshi 从/p 开始/v 点/qt 到/v 完成/v 点/qt 的/ude1 最/d 长/a 路径/n 的/ude1 长度/n (/wkz 这里/rzs 所/usuo 说/v 的/ude1 路径长度/n 是/vshi 指/v 路径/n 上/f 各/rz 活动/vn 持续/vn 时间/n 之/uzhi 和/ng ，/wd 不/d 是/vshi 路径/n 上/f 弧/n 的/ude1 数目/n )/wky 。/wj 路径长度/n 最/d 长/a 的/ude1 路径/n 叫做/v 关键路径/n (/wkz Critical/x  Path/x )/wky 。/wj 假设/v 开始/v 点/qt 是/vshi "/n 。/wj ，/wd 从/p ”/wyy 。/wj 到/p 口/n i/x 的/ude1 最/d 长/a 路径长度/n 叫做/v 事件/n 口/n i/x 的/ude1 最/d 早/ad 发生/v 时间/n 。/wj 这个/rz 时间/n 决定/v 了/ule 所有/b 以/p u/x ，/wd 为/v 尾/ng 的/ude1 弧/n 所/usuo 表示/v 的/ude1 活动/vn 的/ude1 最/d 早/ad 开始时间/n 。/wj 我们/rr 用/v e/x (/wkz i/x )/wky 表示/v 活动/vn 口/n i/x 的/ude1 最/d 早/ad 开始时间/n 。/wj 还/d 可以/v 定义/n 一个/mq 活动/vn 的/ude1 最/d 迟/ad 开始时间/n z/x (/wkz i/x )/wky ，/wd 这/rzv 是/vshi 在/p 不/d 推迟/v 整个/b 工程/n 完成/v 的/ude1 前提/n 下/f ，/wd 活动/vn n/x ，/wd 最/d 迟/a 必须/d 开始/v 进行/vx 的/ude1 时间/n 。/wj 两者/rzv 之/uzhi 差/ng ￡/m (/wkz i/x )/wky 一/m e/x (/wkz i/x )/wky 意味着/v 完成/v 活动/vn ai/x 的/ude1 时间/n 余量/n 。/wj 我们/rr 把/pba z/x (/wkz i/x )/wky =e/x (/wkz i/x )/wky 的/ude1 活动/vn 叫做/v 关键/n 活动/vn 。/wj 显然/a ，/wd 关键路径/n 上/f 的/ude1 所有/b 活动/vn 都/d 是/vshi 关键/n 活动/vn ，/wd 因此/c 提前/vd 完成/v 非关键/n 活动/vn 并/cc 不/d 能/v 加快/v 工程/n 的/ude1 进度/n 。/wj 例如/v 图/n 7．29/m 中/f 的/ude1 网/n ，/wd 从/p u/x ，/wd 到/v a/x 。/wj 的/ude1 最/d 长/a 路径/n 是/vshi (/wkz a1/x ，/wd a2/x ，/wd a5/x ，/wd a8/x ，/wd u9/x )/wky ，/wd 路径长度/n 是/vshi 18/m ，/wd 即/v 口/q 9/m 的/ude1 最/d 早/ad 发生/v 时间/n 是/vshi 18/m 。/wj 而/cc 活动/vn n6/x 的/ude1 最/d 早/ad 开始时间/n 是/vshi 5/m ，/wd 最/d 迟/ad 开始时间/n 是/vshi 8/m ，/wd 这/rzv 意味着/v ：/wp 如果/c n/x 。/wj 推迟/v 3/m 天/qt 开始/v 或者/c 延迟/v 3/m 天/qt 完成/v ，/wd 都/d 不/d 会/v 影响/v 整个/b 工程/n 的/ude1 完成/vn 。/wj 因此/c ，/wd 分析/v 关键路径/n 的/ude1 目的/n 是/vshi 辨别/v 哪些/ry 是/vshi 关键/n 活动/vn ，/wd 以便/d 争取/v 提高/v 关键/n 活动/vn 的/ude1 工效/n ，/wd 缩短/v 整个/b 工期/n 。/wj 
    由/p 上/f 分析/v 可知/v ，/wd 辨别/v 关键/n 活动/vn 就/d 是/vshi 要/v 找/v e/x (/wkz i/x )/wky =z/x (/wkz 1/m )/wky 的/ude1 活动/vn 。/wj 为了/p 求得/v AOE+/x 网/n 中/b 活动/vn 的/ude1 e/x (/wkz i/x )/wky 和/cc z/x (/wkz i/x )/wky ，/wd 首先/d 应/v 求得/v 事件/n 的/ude1 最/d 早/ad 发生/v 时间/n 伽/ng (/wkz j/x )/wky 和/cc 最/d 迟/ad 发生/v 时间/n 讲/v (/wkz 歹/ag )/wky 。/wj 如果/c 活动/vn a/x ；/wf 由/p 弧/n (/wkz J/x ，/wd )/wky 表示/v ，/wd 其/rz 持续/vn 时间/n 记/ng 为/v d．t/x (/wkz (/wkz a/x ，/wd b/x )/wky )/wky ，/wd 则/c 有/vyou 如下/vn 关系/n 
 (/wkz 7―1/m )/wky 
    Z/x (/wkz i/x )/wky =/m (/wkz ”/wyy dut/x (/wkz (/wkz J/x ，/wd )/wky )/wky 
    求/v w/x (/wkz J/x )/wky 和/cc “/wyz (/wkz )/wky 需/v 分两步/n 进行/vn ：/wp 
    (/wkz 1/m )/wky 从/p W/x (/wkz 0/m )/wky =0/m 开始/v 向/p 前/f 递推/n (/wkz j/x )/wky =Max/x {/n (/wkz i/x )/wky +dut/x (/wkz (/wkz i/x ，/wd j/x )/wky )/wky I/x     (/wkz 7・2/m )/wky 
    (/wkz i/x ，/wd J/x )/wky ∈T/x ，/wd   j：1/x ，/wd 2/m ，/wd …/ws ，/wd n-1/x 
其中/rz ，/wd T/x 是/vshi 所有/b 以/b 第/m J=/x 个/q 顶点/n 为/p 头/n 的/ude1 弧/n 的/ude1 集合/n 。/wj 
    (/wkz 2/m )/wky 从/p z/x (/wkz ～/ws 1/m )/wky =/m (/wkz n-1/x )/wky 起/f 向/p 后/f 递推/n 
    uz/x (/wkz i/x )/wky =Min/x {/n "/n z/x (/wkz j/x )/wky dut/x (/wkz (/wkz i/x ，/wd j/x )/wky )/wky }/n     (/wkz 7―3/m )/wky 
    J/x 
    (/wkz i/x ，/wd 』/wyy )/wky ∈S/x ，/wd   i：n/x 一/m 2/m ，/wd …/ws ，/wd O/x 
其中/rz ，/wd s/x 是/vshi 所有/b 以/b 第/m i/x 个/q 顶点/n 为/v 尾/ng 的/ude1 弧/n 的/ude1 集合/n 。/wj 
    这/rzv 两/m 个/q 递推/n 公式/n 的/ude1 计算/vn 必须/d 分别/d 在/p 拓扑/n 有序/an 和/cc 逆/vg 拓扑/n 有序/a 的/ude1 前提/n 下/f 进行/vx 。/wj 也就是说/vl ，/wd 化/v (/wkz j-1/x )/wky 必须/d 在/p f/x 的/ude1 所有/b 前驱/n 的/ude1 最/d 早/ad 发生/v 时间/n 求得/v 之后/f 才/d 能/v 确定/v ，/wd 而/cc "/n z/x (/wkz J-1/x )/wky 则/d 必须/d 在/p vj/x 的/ude1 所有/b 后/f 继/vg 的/ude1 最/d 迟/ad 发生/v 时间/n 求得/v 之后/f 才/d 能/v 确定/v 。/wj 因此/c ，/wd 可以/v 在/p 拓扑/n 排序/vi 的/ude1 基础/n 上/f 计算/v (/wkz 1/m )/wky 和/cc z/x (/wkz ．/w 1/m )/wky 。/wj 
    由此/d 得/ude3 到/v 如下/vi 所/usuo 述/vg 求/v 关键路径/n 的/ude1 算法/n ：/wp 
    (/wkz 1/m )/wky 输入/v P/x 条/q 弧/n (/wkz J/x ，/wd )/wky ，/wd 建立/v ．/w AOE/x 一/m 网/n 的/ude1 存储/vn 结构/n ；/wf 
    (/wkz 2/m )/wky 从/p 源/ng 点/n a/x 。/wj 出发/vi ，/wd 令/v [/wkz 0/m ]/wky =0/m ，/wd 按/p 拓扑/n 有序/ad 求/v 其余/rz 各/rz 顶点/n 的/ude1 最/d 早/ad 发生/v 时间/n i/x ]/wky (/wkz 1≤i≤n―1/x )/wky 。/wj 如果/c 得到/v 的/ude1 拓扑/n 有序/a 序列/n 中/b 顶点/n 个数/n 小于/v 网/n 中/b 顶点/n 数/n n/x ，/wd 则/c 说明/v 网/n 中/f 存在/v 环/n ，/wd 不/d 能/v 求/v 关键路径/n ，/wd 算法/n 终止/v ；/wf 否则/c 执行/v 步骤/n (/wkz 3/m )/wky 。/wj 
    (/wkz 3/m )/wky 从/p 汇点/n u/x 。/wj 出发/vi ，/wd 令/v [/wkz -/wp 1/m ]/wky ：/wp w/x [/wkz ”/wyy -/wp 1/m ]/wky ，/wd 按/p 逆/vg 拓扑/n 有序/ad 求/v 其余/rz 各/rz 顶点/n 的/ude1 最/d 迟/ad 发生/v 时间/n “/wyz [/wkz i/x ]/wky (/wkz 2≥i≥2/x )/wky ；/wf 
　　(/wkz 4/m )/wky 根据/p 各/rz 顶点/n 的/ude1 ve/x 和/cc vl/x 值/n ，/wd 求/v 每/rz 条/q 弧/n s/x 的/ude1 最/d 早/ad 开始时间/n e/x (/wkz s/x )/wky 和/cc 最/d 迟/ad 开始时间/n l/x (/wkz s/x )/wky 。/wj 若/c 某/rz 条/q 弧/n 满足条件/n e/x (/wkz s/x )/wky =z/x (/wkz s/x )/wky ，/wd 则/c 为/p 关键/n 活动/vn 。/wj 
　　如上所述/c ，/wd 计算/v 各/rz 顶点/n 的/ude1 ve/x 值/n 是/vshi 在/p 拓扑/n 排序/vi 的/ude1 过程/n 中/f 进行/vx 的/ude1 ，/wd 需/v 对/p 拓扑/n 排序/vi 的/ude1 算法/n 作/v 如下/vi 修改/v ：/wp (/wkz a/x )/wky 在/p 拓扑/n 排序/vi 之前/f 设/v 初值/n ，/wd 令/v [/wkz i/x ]/wky =0/m (/wkz 0≤i≤-1/x )/wky ；/wf (/wkz b/x )/wky 在/p 算法/n 中/f 增加/v 一个/mq 计算/v aj/x 的/ude1 直接/a 后/f 继/vg m/x 的/ude1 最/d 早/ad 发生/v 时间/n 的/ude1 操作/vn ：/wp 若/v [/wkz j/x ]/wky +dut/x (/wkz (/wkz j/x ，/wd )/wky )/wky >/n [/wkz ]/wky ，/wd 则/d [/wkz ]/wky =/m [/wkz J/x ]/wky +dut/x (/wkz (/wkz J/x ，/wd )/wky )/wky ；/wf (/wkz c/x )/wky 为了/p 能/v 按/p 逆/vg 拓扑/n 有序/a 序列/n 的/ude1 顺序/n 计算/v 各/rz 顶点/n 的/ude1 引/v 值/n ，/wd 需/v 记/v 下/f 在/p 拓扑/n 排序/vi 的/ude1 过程/n 中/f 求得/v 的/ude1 拓扑/n 有序/a 序列/n ，/wd 这/rzv 需要/v 在/p 拓扑/n 排序/vn 算法/n 中/f ，/wd 增设/v 一个/mq 栈/ng 以/p 记录/v 拓扑/n 有序/a 序列/n ，/wd 则/c 在/p 计算/v 求得/v 各/rz 顶点/n 的/ude1 伽/ng 值/v 之后/f ，/wd 从/p 栈/ng 顶/v 至/p 栈/ng 底/f 便/d 为/v 逆/vg 拓扑/n 有序/a 序列/n 。/wj 
    先/d 将/p 算法/n 7．12/m 改写/v 成/v 算法/n 7．13/m ，/wd 则/c 算法/n 7．14/m 便/d 为/v 求/v 关键路径/n 的/ude1 算法/n 。/wj S/x ~/n atun/x  TopologicalOrder/x (/wkz ALGraph/x  G/x ，/wd Stack/x ＆/n T/x )/wky {/n     ∥/w 有/vyou 向/p 网/n G/x 采用/v 邻接/v 表存储/n 结构/n ，/wd 求/v 各/rz 顶点/n 事件/n 的/ude1 最/d 早/ad 发生/v 时间/n re/x (/wkz 全局/n 变量/n )/wky 。/wj 
    ∥/w T/x 为/p 拓扑/n 序列/n 顶点/n 栈/ng ，/wd s/x 为/p 零/m 入/v 度/qv 顶点/n 栈/ng 。/wj 
∥/w 若/v G/x 无/v 回路/n ，/wd 则/c 用/v 栈/ng T/x 返回/v G/x 的/ude1 一个/mq 拓扑/n 序列/n ，/wd 且/c 函数值/n 为/v 0K/x ，/wd 否则/c 为/v ERROR/x 。/wj 
FindInDegree/x (/wkz G/x ，/wd indegree/x )/wky ；/wf ∥/w 对/p 各/rz 顶点/n 求/v 入/v 度/qv indegree/x [/wkz 0．．vernum-1/x ]/wky 
建/v 零/m 入/v 度/qv 顶点/n 栈/ng S．/x 
InitStack/x (/wkz T/x )/wky ；/wf count=0/x ；/wf ve/x [/wkz 0．．G．vexnl／m―i/x ]/wky ：/wp 0/m ；/wf   ∥/w 初始化/v 
while/x (/wkz !/wt StackEmpty/x (/wkz s/x )/wky )/wky {/n 
  Pop/x (/wkz S/x ，/wd J/x )/wky ；/wf Push/x (/wkz T/x ，/wd J/x )/wky ；/wf   ++count/x ；/wf     ∥/w J/x 号/q 顶点/n 入/v T/x 栈/ng 并/d 计数/vi 
  for/x (/wkz P=G．vertices/x [/wkz J/x  J．firstarc/x ；/wf P/x ；/wf P=P-/x >/n nextarc/x )/wky l/x 
    k=P-/x >/n adjvex/x ；/wf     ∥/w 对/p J/x 号/q 顶点/n 的/ude1 每个/r 邻接/v 点/qt 的/ude1 入/v 度/qv 减/v l/x 
    if/x (/wkz --/wp indegree/x [/wkz k/x ]/wky ==0/m )/wky Push/x (/wkz S/x 。/wj k/x )/wky ；/wf ∥/w 若/c 入/v 度/qv 减/v 为/p 0/m ，/wd 则/c 入/v 栈/ng 
    if/x (/wkz ve/x [/wkz J/x ]/wky +/m */n (/wkz P-/x >/n info/x )/wky >/n ve/x [/wkz k/x ]/wky )/wky ve/x [/wkz k/x ]/wky =ve/x [/wkz J/x ]/wky +/m */n (/wkz P-/x >/n info/x )/wky ；/wf 
    }/n ∥/w for/x   */n (/wkz p-/x >/n info/x )/wky ：/wp dut/x (/wkz </n J/x ，/wd k/x >/n )/wky 
  ＼/m {/n }/n while/x 
  if/x (/wkz count/x </n G．vexnum/x )/wky return/x  ERROR/x ；/wf ／／/m 该/rz 有/vyou 向/p 网/n 有/vyou 回路/n 
  el∞return/x  OK：/x 
}/n }/n TopologicalOrder/x 
    算法/n 7．13/m 
Status/x  CriticalPath/x (/wkz (/wkz ALGraph/x  G/x )/wky f/x 
  ∥/w G/x 为/v 有/vyou 向/p 网/n ，/wd 输出/v G/x 的/ude1 各项/r 关键/n 活动/vn 。/wj 
  if/x (/wkz !/wt TopologicalOrder/x (/wkz G/x ，/wd T/x )/wky )/wky   return/x  ERROR/x ；/wf 
  vl/x [/wkz O．．G．vexn/x ~/n l-1/x ]/wky =ve/x [/wkz O．．G．vexnLlm-1/x ]/wky ；/wf     ∥/w 初始化/v 顶点/n 事件/n 的/ude1 最/d 迟/ad 发生/v 时间/n 
  while/x (/wkz !/wt StackEmpty/x (/wkz T/x )/wky )/wky     ∥/w 按/p 拓扑/n 逆/vg 序/n 求/v 各/rz 顶点/n 的/ude1 vl/x 值/n 
  for/x (/wkz Pop/x (/wkz T/x ，/wd j/x )/wky 。/wj P=G．vertices/x [/wkz j/x ]/wky ．/w firstarc/x ；/wf p/x ；/wf P=P-/x >/n nextarc/x )/wky I/x 
    k=P-/x >/n adjvex/x ；/wf dut=/x */n (/wkz p-/x >/n info/x )/wky ；/wf     ∥/w dut/x </n j/x ，/wd k/x >/n 
    if/x (/wkz vl/x [/wkz k/x ]/wky ～/ws dut/x </n vl/x [/wkz j/x ]/wky )/wky vl/x [/wkz J/x ]/wky =vi/x [/wkz k/x ]/wky ．/w dut/x ；/wf 
    、/wn }/n ，/wd for/x 
  for/x (/wkz J=0/x ；/wf j/x </n G．vexnum/x ；/wf ++J/x )/wky     ∥/w 求/v ee/x ，/wd el/x 和/cc 关键/n 活动/vn 
    for/x (/wkz P=G．vertices/x [/wkz j/x ]/wky ；/wf p/x ；/wf P=P-/x >/n nextarc/x )/wky {/n 
    k=P-/x >/n adjvex/x ；/wf dut=/x */n (/wkz p-/x >/n info/x )/wky ；/wf 
    ee=ve/x 【/wkz J/x  J/x ；/wf el=vi/x [/wkz k/x ]/wky 一/m dut/x ；/wf 
    tag/x 。/wj (/wkz ee=/x 。/wj e1/x )/wky ?/ww ’/wyy */n ’/wyy ：/wp ～/ws ：/wp 
    printf/x (/wkz j/x ，/wd k/x ，/wd dut/x ，/wd ee/x ，/wd el/x ，/wd tag/x )/wky ；/wf   ∥/w 输出/v 关键/n 活动/vn 
    }/n 
＼/m #/n }/n CriticalPath/x 
    算法/n 7．14/m 
    由于/p 逆/vg 拓扑/n 排序/vi 必定/d 在/p 网/n 中/f 无/v 环/n 的/ude1 前提/n 下/f 进行/vx ，/wd 则/c 亦/d 可/v 利用/v DFS/x 函数/n ，/wd 在/p 退出/v DFS/x 函数/n 之前/f 按/p 式/k (/wkz 7―3/m )/wky 计算/v 顶点/n a/x 的/ude1 vl/x 值/n (/wkz 因为/p 此时/r 可/v 的/ude1 所有/b 直接/a 后/f 继/vg 的/ude1 az/x 值/n 都/d 已/d 求/v 出/vf )/wky 。/wj 
图/n 7．30/m  AOE-/x 网/n 及其/cc 关键路径/n 
  (/wkz a/x )/wky AOE．/x 网/n ；/wf (/wkz b/x )/wky 关键路径/n 。/wj 
    这/rzv 两/m 种/q 算法/n 的/ude1 时间/n 复杂度/n 均/d 为/v 0/m (/wkz ”/wyy +e/x )/wky ，/wd 显然/a ，/wd 前/f 一/m 种/q 算法/n 的/ude1 常数/n 因子/n 要/v 小/a 些/q 。/wj 由于/c 计算/v 弧/n 的/ude1 活动/vn 最/d 早/ad 开始时间/n 和/cc 最/d 迟/ad 开始时间/n 的/ude1 复杂度/n 为/v 0/m (/wkz e/x )/wky ，/wd 所以/c 总/b 的/ude1 求/v 关键路径/n 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz n+e/x )/wky 。/wj 
    例如/v ，/wd 对/p 图/n 7．30/m (/wkz a/x )/wky 所/usuo 示/vg 网/n 的/ude1 计算结果/n 如/v 图/n 7．31/m 所/usuo 示/vg ，/wd 可见/v n2/x 、/wn 口/n 5/m 和/cc n7/x 为/p 关键/n 活动/vn ，/wd 组成/v 一/m 条/q 从/p 源/ng 点/v 到/v 汇点/n 的/ude1 关键路径/n ，/wd 如/v 图/n 7．30/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    图/n 7．31/m   图/n 7．30/m (/wkz a/x )/wky 所/usuo 示/vg AOE/x 一/m 网/n 中/b 顶点/n 的/ude1 发生/vn 时间/n 和/cc 活动/vn 的/ude1 开始时间/n 对于/p 图/n 7．29/m 所/usuo 示/vg 的/ude1 网/n ，/wd 可/c 计算/v 求得/v 关键/n 活动/vn 为/v 1/m ，/wd n/x 。/wj ，/wd 7/m ，/wd 8/m ，/wd lo/x 和/cc n11/x 。/wj 如/v 图/n 7．32/m 所/usuo 示/vg ，/wd 它们/rr 构成/v 两/m 条/q 关键路径/n ：/wp (/wkz 1/m ，/wd u2/x ，/wd 5/m ，/wd 7/m ，/wd u9/x )/wky 和/cc (/wkz l/x ，/wd "/n 2/m ，/wd 5/m ，/wd 8/m ，/wd 9/m )/wky 。/wj 
    实践/v 已经/d 证明/v ：/wp 用/v AOE-/x 网/n 来/vf 估算/v 某些/rz 工程/n 完成/v 的/ude1 时间/n 是/vshi 非常/d 有/vyou 用/v 的/ude1 。/wj 实际上/d ，/wd 求/v 关键路径/n 的/ude1 方法/n 本身/rz 最初/d 就/d 是/vshi 与/p 维修/vn 和/cc 建造/v 工程/n 一起/s 发展/v 的/ude1 。/wj 但是/c ，/wd 由于/c 网/n 中/f 各项/r 活动/vn 是/vshi 互相/d 牵涉/v 的/ude1 ，/wd 因此/c ，/wd 影响/v 关键/n 活动/vn 的/ude1 因素/n 亦/d 是/vshi 多方面/n 的/ude1 ，/wd 任何/rz 一/m 项/q 活动/vn 持续/vn 时间/n 的/ude1 改变/vn 都/d 会/v 影响/vn 关键路径/n 的/ude1 改变/vn 。/wj 例如/v ，/wd 对于/p 图/n 7．30/m (/wkz a/x )/wky 所/usuo 示/vg 的/ude1 网/n 来说/uls ，/wd 若/c 口/n ，/wd 的/ude1 持续/vn 时间/n 改/v 为/p 3/m ，/wd 则/c 可/v 发现/v ，/wd 关键/n 活动/vn 数量/n 增加/v ，/wd 关键路径/n 也/d 增加/v 。/wj 若/c 同时/c 将/d a/x 。/wj 的/ude1 时间/n  图/n 7・/m 。/wj 。/wj 图/n 7・/m 。/wj 9/m 所/usuo 示/vg 网/n 的/ude1 关键路径/n   改/v 成/v 4/m ，/wd 则/d (/wkz 1/m ，/wd 3/m ，/wd u4/x ，/wd 6/m )/wky 不再/d 是/vshi 关键路径/n 。/wj 由此可见/c ，/wd 关键/n 活动/vn 的/ude1 速度/n 提高/v 是/vshi 有/vyou 限度/n 的/ude1 。/wj 只有/c 在/p 不/d 改变/v 网/n 的/ude1 关键路径/n 的/ude1 情况/n 下/f ，/wd 提高/v 关键/n 活动/vn 的/ude1 速度/n 才/d 有效/a 。/wj 
　　另一方面/c ，/wd 若/c 网/n 中/f 有/vyou 几/m 条/q 关键路径/n ，/wd 那么/c ，/wd 单/d 是/vshi 提高/v 一/m 条/q 关键路径/n 上/f 的/ude1 关键/n 活动/vn 的/ude1 速度/n ，/wd 还/d 不/d 能/v 导致/v 整个/b 工程/n 缩短/v 工期/n ，/wd 而/cc 必须/d 提高/v 同时/c 在/p 几/m 条/q 关键路径/n 上/f 的/ude1 活动/vn 的/ude1 速度/n 。/wj 7．6/m 最/d 短路径/n 
假若/c 要/v 在/p 计算机/n 上/f 建立/v 一个/mq 交通/n 咨询/vn 系统/n 则/d 可以/v 采用/v 图/n 的/ude1 结构/n 来/vf 表示/v 实际/a 的/ude1 交通网络/n 。/wj 如/v 图/n 7．33/m 所/usuo 示/vg ，/wd 图/n 中/b 顶点/n 表示/v 城市/n ，/wd 边/d 表示/v 城市/n 间/f 的/ude1 交通/n 联系/vn 。/wj 这个/rz 咨询/vn 系统/n 可以/v 回答/v 。/wj 旅客/n 提出/v 的/ude1 各种/rz 问题/n 。/wj 例如/v ，/wd 一/m 位/q 旅客/n 要/v 从/p A/x 城/n 到/v B/x 城/n ，/wd 他/rr 希望/v 选择/v 一/m 条/q 途中/s 中转/vn 次数/n 最/d 少/a 的/ude1 路线/n 。/wj 假设/v 图/n 中/f 每/rz 一/m 站/q 都/d 需要/v 换车/vi ，/wd 则/c 这个/rz 问题/n 反映/v 到/v 图/n 上/f 就是/d 要/v 找/v 一/m 条/q 从/p 顶点/n A/x 到/v B/x 所/usuo 含/v 边/k 的/ude1 数目/n 最/d 少/a 的/ude1 路径/n 。/wj 我们/rr 只/d 须/d 从/p 顶点/n A/x 出发/vi 对/p 图/n 作/v 广度/n 优先/vd 搜索/v ，/wd 一旦/d 遇到/v 顶点/n B/x 就/d 终止/v 。/wj 由此/d 所得/v 广度/n 优先/vd 生成/v 树上/s ，/wd 从/p 根/n 顶点/n A/x 到/v 顶点/n B/x 的/ude1 路径/n 就/d 是/vshi 中转/vn 次数/n 最/d 少/a 的/ude1 路径/n ，/wd 路径/n 上/f A/x 与/p B/x 之间/f 的/ude1 顶点/n 就/d 是/vshi 途径/n 的/ude1 中转站/n 数/n ，/wd 但是/c ，/wd 这/rzv 只/d 是/vshi 一/m 类/q 最/d 简单/a 的/ude1 图/n 的/ude1 最/d 短路径/n 问题/n 。/wj 有时/d ，/wd 对于/p 旅客/n 来说/uls ，/wd 可能/v 更/d 关心/v 的/ude1 是/vshi 节省/v 交通/n 费用/n ；/wf 而/cc 对于/p 司机/n 来说/uls ，/wd 里程/n 和/cc 速度/n 则/d 是/vshi 他们/rr 感/vg 兴趣/n 的/ude1 信息/n 。/wj 为了/p 在/p 图/n 上/f 表示/v 有关/vn 信息/n ，/wd 可/v 对/p 边/k 赋/v 以/p 权/n ，/wd 权/n 的/ude1 值/n 表示/v 两/m 城市/n 间/f 的/ude1 距离/n ，/wd 或/c 途中/s 所/usuo 需/v 时间/n ，/wd 或/c 交通/n 费用/n 等等/udeng 。/wj 此时/r 路径长度/n 的/ude1 度量/n 就/d 不再/d 是/vshi 路径/n 上边/f 的/ude1 数目/n ，/wd 而是/c 路径/n 上边/f 的/ude1 权/n 值/v 之和/n 。/wj 考虑/v 到/v 交通图/n 的/ude1 有/vyou 向/p 性/n (/wkz 如/v 航运/n ，/wd 逆水/v 和顺/ns 水/n 时/ng 的/ude1 船速/n 就/d 不/d 一样/a )/wky ，/wd 本/rz 节/n 将/d 讨论/v 带权/n 有/vyou 向/p 图/n ，/wd 并/cc 称/v 路径/n 上/f 的/ude1 第一/m 个/q 顶点/n 为/v 源/ng 点/n (/wkz Sourse/x )/wky ，/wd 最后/f 一个/mq 顶点/n 为/p 终点/n (/wkz 【/wkz )/wky estination/x )/wky 。/wj 下面/f 讨论/v 两/m 种/q 最/d 常见/a 的/ude1 最/d 短路径/n 问题/n 。/wj 
7．6．1/m  从/p 某个/rz 源/ng 点/v 到/v 其余/rz 各/rz 顶点/n 的/ude1 最/d 短路径/n 
    我们/rr 先/d 来/vf 讨论/v 单源点/nr 的/ude1 最/d 短路径/n 问题/n ：/wp 给定/v 带权/n 有/vyou 向/p 图/n G/x 和/cc 源/n 点/qt 。/wj ，/wd 求/v 从/p ”/wyy 到/v G/x 中/f 其余/rz 各/rz 顶点/n 的/ude1 最/d 短路径/n 。/wj 例如/v ，/wd 图/n 7．34/m 所/usuo 示/vg 带权/n 有/vyou 向/p 图/n G6/x 中/f 从/p 口/n 0/m 到/v 其余/rz 各/rz 顶点/n 之间/f 的/ude1 最/d 短路径/n ，/wd 如/v 图/n 7．35/m 图/n 7．34/m 带权/n 有/vyou 向/p 图/n G6/x     图/n 7．35/m 有/vyou 向/p 图/n G6/x 中/f 从/p v0/x 到/v 其余/rz 各/rz 点/qt 的/ude1 最/d 短路径/n 所/usuo 示/vg 。/wj 从/p 图/n 中/f 可见/v ，/wd 从/p v0/x 到/v v3/x 有/vyou 两/m 条/q 不同/a 的/ude1 路径/n ：/wp (/wkz v0/x ，/wd v2/x ，/wd v3/x )/wky 和/cc (/wkz v0/x ，/wd v4/x ，/wd v3/x )/wky ，/wd 前者/rzv 长度/n 为/p 60/m ，/wd 而/cc 后者/rzv 的/ude1 长度/n 为/p 50/m 。/wj 因此/c ，/wd 后者/rzv 是/vshi 从/p v0/x 到/v v3/x 的/ude1 最/d 短路径/n ；/wf 而/cc 从/p v0/x 到/v v1/x 没有/v 路径/n 。/wj 
    如何/ryv 求得/v 这些/rz 路径/n ?/ww 迪杰斯特拉/nrf (/wkz D/x 西/b kst-ra/x )/wky 提出/v 了/ule 一个/mq 按/p 路径长度/n 递增/vi 的/ude1 次序/n 产生/v 最/d 短路径/n 的/ude1 算法/n 。/wj 
    首先/c ，/wd 引进/v 一个/mq 辅助/vn 向量/n D/x ，/wd 它/rr 的/ude1 每个/r 分量/n D/x [/wkz i/x ]/wky 表示/v 当前/t 所/usuo 找到/v 的/ude1 从/p 始/vg 点/n u/x 到/v 每个/r 终点/n 让/v 的/ude1 最/d 短路径/n 的/ude1 长度/n 。/wj 它/rr 的/ude1 初态/n 为/v ：/wp 若/c 从/p 口/n 到/v 矾/n 有/vyou 弧/n ，/wd 则/d D/x [/wkz i/x ]/wky 为/p 弧/n 上/f 的/ude1 权/n 值/n ；/wf 否则/c 置/v D/x [/wkz i/x ]/wky 为/v o/x 。/wj 。/wj 显然/a ，/wd 长度/n 为/v     D/x [/wkz J/x ]/wky =Min/x {/n D/x [/wkz i/x ]/wky l∈V/x }/n 的/ude1 路径/n 就是/v 从/p u/x 出发/vi 的/ude1 长度/n 最/d 短/a 的/ude1 一/m 条/q 最/d 短路径/n 。/wj 此/rzs 路径/n 为/v (/wkz ，/wd )/wky 。/wj 
    那么/c ，/wd 下/vf 一/m 条/q 长度/n 次/qv 短/a 的/ude1 最/d 短路径/n 是/vshi 哪/ry 一/m 条/q 呢/y ?/ww 假设/v 该/rz 次/qv 短路径/n 的/ude1 终点/n 是/vshi ％/wb ，/wd 则/c 可想而知/vl ，/wd 这/rzv 条/q 路径/n 或者/c 是/vshi (/wkz ”/wyy ，/wd b/x )/wky ，/wd 或者/c 是/vshi (/wkz ”/wyy ，/wd ui/x ，/wd u/x )/wky 。/wj 它/rr 的/ude1 长度/n 或者/c 是/vshi 从/p v/x 到/v b/x 的/ude1 弧/n 上/f 的/ude1 权/n 值/n ，/wd 或者/c 是/vshi D/x [/wkz J/x ]/wky 和/cc 从/p q/x 到/v b/x 的/ude1 弧/n 上/f 的/ude1 权/n 值/v 之和/n 。/wj 
    一般/a 情况/n 下/f ，/wd 假设/v s/x 为/v 已/d 求得/v 最/d 短路径/n 的/ude1 终点/n 的/ude1 集合/n ，/wd 则/c 可/v 证明/v ：/wp 下/f 一/m 条/q 最/d 短路径/n (/wkz 设/v 其/rz 终点/n 为/v z/x )/wky 或者/c 是/vshi 弧/n (/wkz ，/wd z/x )/wky ，/wd 或者/c 是/vshi 中间/f 只/d 经过/p s/x 中/f 的/ude1 顶点/n 而/cc 最后/f 到达/v 顶点/n ．/w z/x 的/ude1 路径/n 。/wj 这/rzv 可用/a 反证法/n 来/vf 证明/v 。/wj 假设/n 此/rzs 路径/n 上/f 有/vyou 一个/mq 顶/v 点/qt 不/d 在/p 5/m 中/f ，/wd 则/c 说明/v 存在/v 一/m 条/q 终点/n 不/d 在/p S/x 而/cc 长度/n 比/p 此/rzs 路径/n 短/a 的/ude1 路径/n 。/wj 但是/c ，/wd 这/rzv 是/vshi 不/d 可能/v 的/ude1 。/wj 因为/p 我们/rr 是/vshi 按/p 路径长度/n 递增/vi 的/ude1 次序/n 来/vf 产生/v 各/rz 最/d 短路径/n 的/ude1 ，/wd 故/c 长度/n 比/p 此/rzs 路径/n 短/a 的/ude1 所有/b 路径/n 均/d 已/d 产生/v ，/wd 它们/rr 的/ude1 终点/n 必定/d 在/p S/x 中/f ，/wd 即/d 假设/v 不/d 成立/vi 。/wj 
    因此/c ，/wd 在/p 一般/a 情况/n 下/f ，/wd 下/vf 一/m 条/q 长度/n 次/qv 短/a 的/ude1 最/d 短路径/n 的/ude1 长度/n 必/d 是/vshi     D/x [/wkz 歹/ag ]/wky =Min/x {/n D/x [/wkz i/x ]/wky l/x  q∈V―S/x }/n 其中/rz ，/wd D/x [/wkz i/x ]/wky 或者/c 是/vshi 弧/n (/wkz ，/wd i/x )/wky 上/f 的/ude1 权/n 值/n ，/wd 或者/c 是/vshi D/x [/wkz ]/wky (/wkz {/n ∈S/x )/wky 和/cc 弧/n (/wkz ，/wd i/x )/wky 上/f 的/ude1 权/n 值/v 之和/n 。/wj 
    根据/p 以上/f 分析/v ，/wd 可以/v 得到/v 如下/vi 描述/v 的/ude1 算法/n ：/wp 
    (/wkz 1/m )/wky 假设/v 用/p 带权/n 的/ude1 邻接/v 矩阵/n nrcs/x 来/f 表示/v 带权/n 有/vyou 向/p 图/n ，/wd nrcs/x [/wkz i/x ]/wky [/wkz j/x ]/wky 表示/v 弧/n (/wkz q/x ，/wd ％/wb )/wky 上/f 的/ude1 权/n 值/n 。/wj 若/v (/wkz ui/x ，/wd uf/x )/wky 不/d 存在/v ，/wd 则/c 置/v rcs/x [/wkz i/x ]/wky [/wkz J/x ]/wky 为/p ∞/m (/wkz 在/p 计算机/n 上/f 可/v 用/p 允许/v 的/ude1 最/d 大值/n 代替/v )/wky 。/wj s/x 为/v 已/d 找到/v 从/p u/x 出发/vi 的/ude1 最/d 短路径/n 的/ude1 终点/n 的/ude1 集合/n ，/wd 它/rr 的/ude1 初始状态/n 为/v 空/ng 集/vg 。/wj 那么/c ，/wd 从/p a/x 出发/vi 到/v 图/n 上/f 其余/rz 各/rz 顶点/n (/wkz 终点/n )/wky a/x 可能/n 达到/v 的/ude1 最/d 短路径/n 长度/n 的/ude1 初值/n 为/v ：/wp 
    D/x [/wkz i/x ]/wky =rcs/x [/wkz L．ocate/x  Vex/x (/wkz G/x ，/wd )/wky [/wkz i/x ]/wky   ui∈v/x 
    (/wkz 2/m )/wky 选择/v ui/x ，/wd 使得/vi 
    D/x [/wkz 』/wyy ]/wky =Min/x {/n D/x [/wkz i/x ]/wky 『/wyz ∈V-S/x }/n 
i/x 就/d 是/vshi 当前/t 求得/v 的/ude1 一/m 条/q 从/p a/x 出发/vi 的/ude1 最/d 短路径/n 的/ude1 终点/n 。/wj 令/v  S：S/x  U/x {/n ．/w j/x }/n 
    (/wkz 3/m )/wky 修改/v 从/p a/x 出发/vi 到/v 集合/v V-S/x 上任/vi 一/m 顶点/n ％/wb 可/c 达/v 的/ude1 最/d 短路径/n 长度/n 。/wj 如果/c  D/x [/wkz ]/wky +d/x [/wkz j/x ]/wky [/wkz ]/wky </n D/x [/wkz ]/wky 
则/c 修改/v D/x [/wkz ]/wky 为/v  D/x [/wkz ]/wky =D/x [/wkz ]/wky +arc5/x [/wkz ．/w f/x ]/wky [/wkz ]/wky 
    (/wkz 4/m )/wky 重复/vd 操作/v (/wkz 2/m )/wky 、/wn (/wkz 3/m )/wky 共/d 以/p -/wp 1/m 次/qv 。/wj 由此/d 求得/v 从/p a/x 到/v 图/n 上/f 其余/rz 各/rz 顶点/n 的/ude1 最/d 短路径/n 是/vshi 依/p 路径长度/n 递增/vi 的/ude1 序列/n 。/wj 
    算法/n 7．15/m 为/p 用/v C/x 语言/n 描述/vn 的/ude1 迪杰斯特拉/nrf 算法/n 。/wj 
    VOi4/x  ShortestPath．DIJ/x (/wkz MGraph/x  G/x ，/wd int/x 、/wn ro/x ，/wd PathMatrix/x &/n P/x ，/wd ShortPathTable/x ＆/n D/x )/wky {/n 
    ∥/w 用/v Dijkstra/x 算法/n 求/v 有/vyou 向/p 网/n G/x 的/ude1 、/wn r0/x 顶点/n 到/v 其余/rz 顶点/n v/x 的/ude1 最/d 短路径/n P/x [/wkz v/x ]/wky 及其/cc 带权/n 长度/n D/x [/wkz v/x ]/wky 。/wj 
    ∥/w 若/v P/x [/wkz v/x ]/wky [/wkz w/x ]/wky 为/v TR/x 【/wkz IE/x ，/wd 则/d W/x 是/vshi 从/p 、/wn ，/wd 0/m 到/v v/x 当前/t 求得/v 最/d 短路径/n 上/f 的/ude1 顶点/n 。/wj 
    ∥/w final/x [/wkz v/x ]/wky 为/v TRUE/x 当/v 且/c 仅/d 当/v v∈S/x ，/wd 即/d 已经/d 求得/v 从/p 、/wn r0/x 到/v v/x 的/ude1 最/d 短路径/n 。/wj 
    for/x (/wkz v=0/x ；/wf v/x </n G．vexxlum/x ；/wf ++v/x )/wky {/n 
    final/x [/wkz v/x ]/wky ：/wp FALSE/x ；/wf D/x [/wkz v/x ]/wky =G．arcs/x [/wkz 、/wn ，/wd 0/m ]/wky [/wkz v/x ]/wky ；/wf 
    for/x (/wkz W=0/x ；/wf w/x </n G．vexnum/x ；/wf ++W/x )/wky P/x [/wkz v/x ]/wky [/wkz W/x ]/wky =FALSE/x ；/wf   ∥/w 设/v 空/a 路径/n 
    if/x (/wkz D/x [/wkz v/x ]/wky </n INFINITY/x )/wky {/n P/x [/wkz v/x ]/wky [/wkz vO/x ]/wky =TRUE/x ；/wf P/x [/wkz v/x ]/wky [/wkz v/x ]/wky =TRUE/x ；/wf }/n 
    }/n ／／for/x 
    D/x [/wkz 、/wn ro/x ]/wky =0/m ；/wf final/x [/wkz vO/x ]/wky =TRUE/x ；/wf     ∥/w 初始化/v ，/wd v0/x 顶点/n 属于/v S/x 集/ng 
    ∥/w 开始/v 主/ag 循环/vn ，/wd 每次/r 求得/v V0/x 到/v 某个/rz v/x 顶点/n 的/ude1 最/d 短路径/n ，/wd 并/cc 加/v v/x 到/v S/x 集/ng 
    for/x (/wkz i=I/x ；/wf i/x </n G．vexnum/x ；/wf ++i/x )/wky {/n     ∥/w 其余/rz G．vex/x ~/n um-1/x 个/q 顶点/n 
    min=INFINITY/x ；/wf     ／i/x '/n 当前/t 所/usuo 知/v 离/v 、/wn ，/wd o/x 顶点/n 的/ude1 最/d 近/a 距离/n 
    for/x  w/x 。/wj 0/m ；/wf w/x </n G．vexntlm/x ；/wf ++W/x )/wky 
    if/x (/wkz !/wt final/x [/wkz w/x ]/wky )/wky     ∥/w W/x 顶点/n 在/p V-S/x 中/f 
    if/x (/wkz D/x [/wkz w/x ]/wky </n min/x )/wky {/n v=w/x ；/wf min=D/x [/wkz w/x ]/wky ；/wf }/n     ∥/w W/x 顶点/n 离/v 、/wn ，/wd 0/m 顶点/n 更/d 近/a 
    final/x [/wkz v/x ]/wky =TRUE/x ；/wf     ∥/w 离/v vo/x 顶点/n 最近/t 的/ude1 v/x 加入/v S/x 集/ng 
    for/x (/wkz W=0/x ；/wf w/x </n G．vexnum/x ；/wf ++w/x )/wky   ∥/w 更新/v 当前/t 最/d 短路径/n 及/cc 距离/n 
    if/x (/wkz !/wt final/x [/wkz w/x ]/wky ＆/n ＆/n (/wkz min+G．arcs/x [/wkz v/x ]/wky [/wkz W/x ]/wky </n D/x [/wkz w/x ]/wky )/wky )/wky l/x ∥/w 修改/v D/x [/wkz w/x ]/wky 和/cc P/x [/wkz w/x ]/wky ，/wd w6V―S/x 
    D/x [/wkz w/x ]/wky =min+G．arcs/x [/wkz v/x ]/wky [/wkz W/x ]/wky ；/wf 
    P/x [/wkz w/x ]/wky =P/x [/wkz v/x ]/wky ；/wf P/x [/wkz w/x ]/wky [/wkz W/x ]/wky =TRUE/x ；/wf ∥/w P/x [/wkz w/x ]/wky =e/x [/wkz v/x ]/wky +/m [/wkz W/x ]/wky 
    I/x ∥/w if/x 
    }/n ∥/w for/x 
    I/x ∥/w ShortestPath―DIJ/x 
    算法/n 7．15/m     ’/wyy     、/wn 
例如/v ，/wd 图/n 7．34/m 所/usuo 示/vg 有/vyou 向/p 网/n G6/x 的/ude1 带权/n 邻接/v 矩阵/n 为/v ：/wp 
    若/c 对/p G6/x 施行/v 迪杰斯特拉/nrf 算法/n ，/wd 则/d 所/usuo 得/v 从/p v0/x 到/v 其余/rz 各/rz 顶点/n 的/ude1 最/d 短路径/n ，/wd 以及/cc 运算/vn 过程/n 中/f D/x 向量/n 的/ude1 变化/vn 状况/n ，/wd 如/v 下/f 所/usuo 示/vg ：/wp 
从/p vn/x 到/v 各/rz 终点/n 的/ude1 D/x 值/n 和/cc 最/d 短路径/n 的/ude1 求解/vi 过程/n  
    我们/rr 分析/v 这个/rz 算法/n 的/ude1 运行/vn 时间/n 。/wj 第一/m 个/q FOR/x 循环/vn 的/ude1 时间/n 复杂度/n 是/vshi O/x (/wkz )/wky ，/wd 第二/m 个/q FOR/x 循环/vn 共/d 进行/vx 以/p -/wp 1/m 次/qv ，/wd 每次/r 执行/v 的/ude1 时间/n 是/vshi 0/m (/wkz ”/wyy )/wky 。/wj 所以/c 总/b 的/ude1 时间/n 复杂度/n 是/vshi 0/m (/wkz ，/wd z0/x )/wky 。/wj 如果/c 用/p 带权/n 的/ude1 邻接/v 表/vg 作为/v 有/vyou 向/p 图/n 的/ude1 存储/vn 结构/n ，/wd 则/c 虽然/c 修改/v D/x 的/ude1 时间/n 可以/v 减少/v ，/wd 但/c 由于/c 在/p D/x 向量/n 中/f 选择/v 最/d 小/a 分量/n 的/ude1 时间/n 不/d 变/v ，/wd 所以/c 总/b 的/ude1 时间/n 仍/d 为/v 0/m (/wkz n0/x )/wky 。/wj 
    人们/n 可能/v 只/d 希望/v 找到/v 从/p 源/ng 点/v 到/v 某/rz 一个/mq 特定/b 的/ude1 终点/n 的/ude1 最/d 短路径/n ，/wd 但是/c ，/wd 这个/rz 问题/n 和/cc 求/v 源/ng 点/v 到/v 其它/rz 所有/b 顶点/n 的/ude1 最/d 短路径/n 一样/uyy 复杂/a ，/wd 其/rz 时间/n 复杂度/n 也/d 是/vshi 0/m (/wkz ”/wyy 0/m )/wky 的/ude1 。/wj 
7．6．2/m 每/rz 一/m 对/q 顶点/n 之间/f 的/ude1 最/d 短路径/n 
    解决/v 这个/rz 问题/n 的/ude1 一个/mq 办法/n 是/vshi ：/wp 每/rz 次/qv 以/p 一个/mq 顶点/n 为/v 源/ng 点/qt ，/wd 重复/vd 执行/v 迪杰斯特拉/nrf 算法/n n/x 次/qv 。/wj 这样/rzv ，/wd 便/d 可/v 求得/v 每/rz 一/m 对/q 顶点/n 之间/f 的/ude1 最/d 短路径/n 。/wj 总/b 的/ude1 执行/vn 时间/n 为/v O/x (/wkz n/x 。/wj )/wky 。/wj 
　　这里/rzs 要/v 介绍/v 由/p 弗洛伊德/nrf (/wkz f/x ?/ww loyd/x )/wky 提出/v 的/ude1 另/rz 一个/mq 算法/n 。/wj 这个/rz 算法/n 的/ude1 时间/n 复杂度/n 也/d 是/vshi 0/m (/wkz n/x 。/wj )/wky ，/wd 但/c 形式/n 上/f 简单/a 些/q 。/wj 
　　弗洛伊德/nrf 算法/n 仍/d 从/p 图/n 的/ude1 带权/n 邻接/v 矩阵/n cost/x 出发/vi ，/wd 其/rz 基本思想/n 是/vshi ：/wp 
    假设/v 求/v 从/p 顶点/n q/x 到/v v/x ，/wd 的/n 最/d 短路径/n 。/wj 如果/c 从/vg 。/wj i/x 到/v uf/x 有/vyou 弧/n ，/wd 则/c 从/p 让/v 到/v 矾/n 存在/v 一/m 条/q 长度/n 为/v n/x 懈/vg [/wkz i/x ]/wky [/wkz j/x ]/wky 的/ude1 路径/n ，/wd 该/rz 路径/n 不/d 一定/d 是/vshi 最/d 短路径/n ，/wd 尚/d 需/v 进行/vx 他/rr 次/qv 试探/vn 。/wj 首先/c 考虑/v 路径/n (/wkz u：/x ，/wd uo/x ，/wd q/x )/wky 是否/v 存在/v (/wkz 即/v 判别/v 弧/n (/wkz ”/wyy i/x ，/wd 可/v o/x )/wky 和/cc (/wkz 。/wj ，/wd f/x )/wky 是否/v 存在/v )/wky 。/wj 如果/c 存在/v ，/wd 则/c 比较/d (/wkz i/x ，/wd ，/wd )/wky 和/cc (/wkz 让/v ，/wd u0/x ，/wd )/wky 的/ude1 路径长度/n 取/v 长度较/n 短/a 者/k 为/v 从/p q/x 到/v ，/wd 的/n 中间/f 顶点/n 的/ude1 序号/n 不/d 大于/v 0/m 的/ude1 最/d 短路径/n 。/wj 假如/c 在/p 路径/n 上/f 再/d 增加/v 一个/mq 顶点/n 可/v 1/m ，/wd 也就是说/vl ，/wd 如果/c (/wkz ∥/w ，/wd 。/wj )/wky 和/cc (/wkz ”/wyy ∥/w ”/wyy ，/wd 。/wj i/x )/wky 分别/d 是/vshi 当前/t 找到/v 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不/d 大于/v 0/m 的/ude1 最/d 短路径/n ，/wd 那么/c (/wkz ∥/w --/wp ，/wd ∥/w ，/wd ；/wf )/wky 就/d 有/vyou 可能/n 是/vshi 从/p i/x 到/v q/x 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不/d 大于/v 1/m 的/ude1 最/d 短路径/n 。/wj 将/p 它/rr 和/cc 已经/d 得到/v 的/ude1 从/p ui/x 到/v 。/wj ，/wd 中间/f 顶点/n 序号/n 不/d 大于/v 0/m 的/ude1 最/d 短路径/n 相/d 比较/v ，/wd 从/p 中/f 选出/v 中间/f 顶点/n 的/ude1 序号/n 不/d 大于/v 1/m 的/ude1 最/d 短路径/n 之后/f ，/wd 再/d 增加/v 一个/mq 顶点/n 2/m ，/wd 继续/v 进行/vx 试探/vn 。/wj 依次/d 类推/vi 。/wj 在/p 一般/a 情况/n 下/f ，/wd 若/c (/wkz ∥/w ，/wd 。/wj )/wky 和/cc (/wkz …/ws ，/wd )/wky 分别/d 是/vshi 从/p ”/wyy i/x 到/v Tt/x 和/cc 从/p n/x 到/v q/x 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不大/d 于/p m-1/x 的/ude1 最/d 短路径/n ，/wd 则/c 将/d (/wkz u/x ∥/w ，/wd ”/wyy ^/n ，/wd …/ws ，/wd q/x )/wky 和/cc 已经/d 得到/v 的/ude1 从/p ui/x 到/v g/x 且/c 中间/f 顶点/n 序号/n 不大/d 于是/cc -/wp 1/m 的/ude1 最/d 短路径/n 相/d 比较/v ，/wd ≥￡/m 长度较/n 短/a 者/k 便/d 是/vshi 从/p q/x 到/v q/x 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不大/d k/x 的/ude1 最/d 短路径/n a/x 这样/rzv ，/wd 在/p 经过/p n/x 次比较/n 后/f ．/w 接/v 后/f 求得/v 的/ude1 必/d 是/vshi 从/p vi/x 到/v vj/x 的/ude1 最/d 短路径/n 。/wj 按/p 此方法/n ，/wd 可以/v 同时/c 求得/v 各/rz 对/p 顶点/n 间/f 的/ude1 最/d 短路径/n 。/wj 
  现/tg 定义/n 一个/mq ”/wyy 阶/ng 方阵/n 序列/n 。/wj 
其中/rz 
    D/x 。/wj 。/wj 。/wj ’/wyy [/wkz i/x ]/wky [/wkz i/x ]/wky =/m (/wkz ；/wf a/x Ⅲ/m [/wkz j/x ]/wky 
    从/p 上述/b 计算公式/n 可见/c ，/wd D/x [/wkz i/x ]/wky [/wkz J/x ]/wky 是/vshi 从/p v/x ，/wd 到/v v．/x 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不/d 大干/v l/x 的/ude1 最/d 短路径/n 的/ude1 长度/n ；/wf ”/wyy [/wkz J/x ]/wky 是/vshi 从/p v/x 到/v Ⅵ/m 的/ude1 中间/f 顶点/n 的/ude1 序号/n 不大/d 于/p k/x 的/ude1 最/d 短路径/n 的/ude1 K／/x ~/n ；/wf D/x ”/wyy ”/wyy [/wkz 1/m ]/wky 【/wkz j/x ]/wky 就是/v 从/p u/x 到/v v．/x 的/ude1 最/d 短路径/n 的/ude1 长度/n 
    由此/d 可/v 得/ude3 算法/n 7/m  16/m 。/wj 
    vnid/x  ShortestPath/x  F/x 【/wkz DYD/x (/wkz MGraph/x  G+PathM/x ~/n tr／x/x ＆/n P/x (/wkz ]/wky Dist/x ~/n cMetrlx/x ＆/n D/x )/wky {/n 
　　∥/w 用/v floyd/x 算法/n 求/v 有/vyou 向/p 网/n G/x 中/f 各/rz 对/p 顶点/n v/x 和/cc w/x 之间/f 的/ude1 最/d 短路径/n P/x [/wkz v/x ]/wky [/wkz wJ/x 及/cc 其/rz 
　　∥/w 带权/n 长度/n DIv/x ]/wky fw/x ]/wky 。/wj 若/v P/x [/wkz v/x ]/wky [/wkz w/x ]/wky [/wkz u/x ]/wky 为/v TRUE/x ，/wd 则/d u/x 是/vshi 从/p v/x 到/v w/x 当前/t 求得/v 最/d 短路径/n l/x 的/ude1 顶点/n 。/wj 
    f∞/x (/wkz v=0：v/x </n G/x …/ws _/n |/n v/x )/wky     ／／/m 各/rz 对/p 结点/n 之间/f 初始/v 已/d 知/v 路径/n 及/cc 距离/n 
    f/x (/wkz w：/x ”/wyy ：/wp w/x </n G/x …/ws ：/wp }/n w/x )/wky {/n 
    Ⅱ/m v/x ]/wky [/wkz w/x ]/wky =G/x …/ws [/wkz v/x ]/wky 【/wkz w1/x ；/wf 
    for/x (/wkz u=0/x  u/x </n G/x …/ws ．/w {/n 十/m u/x )/wky P/x 【/wkz v/x ]/wky [/wkz Ⅵ/m ]/wky [/wkz uj=FhtSE/x ；/wf 
    (/wkz D/x [/wkz v1/x 【/wkz w/x ]/wky </n IrrT/x )/wky {/n   ∥/w 从/p v/x 到/v “/wyz 有/vyou 直接/a 路径/n 
    v1/x (/wkz w/x ]/wky [/wkz v1=TP/x (/wkz v/x ]/wky [/wkz w/x ]/wky h/x ]/wky =T/x ；/wf 
    l/x ∥/w 
    l/x ∥/w for/x 
    forf/x …/ws 0/m  u/x </n G/x  v/x 。/wj ：/wp 。/wj “/wyz u/x )/wky 
    farf/x …/ws 0/m  v/x </n G/x …/ws m/x ；/wf 11/m  v/x )/wky 
  for/x  fwIO：w/x </n G/x …/ws LI/x 】/wky n．/x }/n +w/x )/wky 
    if/x (/wkz D/x [/wkz v/x ]/wky [/wkz u/x ¨/n Dfu/x ]/wky [/wkz w/x ]/wky </n D/x [/wkz v/x ]/wky [/wkz w/x ]/wky )/wky 
    D/x _/n v/x ]/wky [/wkz w/x ]/wky =D/x [/wkz v/x ]/wky [/wkz u/x ]/wky +D/x [/wkz u/x ]/wky [/wkz w/x ]/wky ；/wf 
    forfi=O：1/x </n G/x …/ws ；/wf }/n +1/m )/wky 
    v/x ]/wky [/wkz w/x ]/wky [/wkz ，/wd ]/wky ：/wp P/x [/wkz v/x ]/wky 【/wkz u/x ]/wky [/wkz -/wp ]/wky Il/x 
    l/x ∥/w 1f/x 
?/ww I/x  ShortestPath/x 。/wj FLOYD/x 
∥/w 从/p v/x 经/p u/x 到/v w/x 的/ude1 一/m 条/q 路径/n 更/d 短/a 
P/x [/wkz u/x ]/wky [/wkz w/x ]/wky [/wkz i/x 
算法/n 7/m  16/m 
  图/n 7/m  36/m 带/v 根/n 有/vyou 向/p 图/n 
；/wf I/x )/wky #/n 向/p 网/n G．．/x (/wkz 5/m )/wky 邻接/v 矩阵/n 
  例如/v ，/wd 利用上述/n 算法/n ，/wd 可/c 求得/v 图/n 7．36/m 所/usuo 示/vg 带权/n 有/vyou 向/p 图/n G/x ，/wd 的/ude1 每/rz 一/m 对/q 顶点/n 之间/f 的/ude1 最/d 短路径/n 及其/cc 路径长度/n 如/v 图/n 7．37/m 所/usuo 示/vg 。/wj 

图/n 7．37/m 图/n 7．36/m 中/f 有/vyou 向/p 图/n 的/ude1 各/rz 对/p 顶点/n 间/f 的/ude1 最/d 短路径/n 及其/cc 路径长度/n 

第8/m 章/q 动态存储/n 管理/vn 
8．1/m   概/d   述/vg 
    在/p 前面/f 各/rz 章/n 的/ude1 讨论/vn 中/f ，/wd 对/p 每/rz 一/m 种/q 数据/n 结构/n 虽/c 都/d 介绍/v 了/ule 它们/rr 在/p 内存储器/n 中/f 的/ude1 映象/n ，/wd 但/c 只是/d 借助/v 高级语言/n 中/f 的/ude1 变量/n 说明/v 加以/vx 描述/vn ，/wd 并/cc 没/d 涉及/v 具体/a 的/ude1 存储分配/n 。/wj 而/cc 实际上/d ，/wd 结构/n 中/f 的/ude1 每个/r 数据/n 元素/n 都/d 占有/v 一定/b 的/ude1 内存/n 位置/n ，/wd 在/p 程序执行/n 的/ude1 过程/n 中/f ，/wd 数据/n 元素/n 的/ude1 存取/vn 是/vshi 通过/p 对应/vi 的/ude1 存储单元/n 来/f 进行/vx 的/ude1 。/wj 在/p 早期/t 的/ude1 计算机/n 上/f ，/wd 这个/rz 存储管理/n 的/ude1 工作/vn 是/vshi 由/p 程序员/n 自己/rr 来/vf 完成/v 的/ude1 。/wj 在/p 程序执行/n 之前/f ，/wd 首先/d 需/v 将/d 用/p 机器语言/n 或/c 汇编语言/n 编写/v 的/ude1 程序/n 输送/v 到/v 内存/n 的/ude1 某个/rz 固定区域/n 上/f ，/wd 并/cc 预先/d 给/p 变量/n 和/cc 数据/n 分配/v 好/a 对应/vi 的/ude1 内存/n 地址/n (/wkz 绝对/a 地址/n 或/c 相对/b 地址/n )/wky 。/wj 在/p 有/vyou 了/ule 高级语言/n 之后/f ，/wd 程序员/n 不/d 需要/v 直接/a 和/cc 内存/n 地址/n 打交道/vi ，/wd 程序/n 中/f 使用/v 的/ude1 存储单元/n 都/d 由/p 逻辑/n 变量/n (/wkz 标识符/n )/wky 来/f 表示/v ，/wd 它们/rr 对应/vi 的/ude1 内存/n 地址/n 都/d 是/vshi 由/p 编译程序/n 在/p 编译/v 或/c 执行/v 时/ng 进行/vx 分配/vn 。/wj 
    另一方面/c ，/wd 当/p 计算机/n 是/vshi 被/pbei 单个/b 用户/n 使用/v 时/ng ，/wd 那末/c 整个/b 内存/n 除/p 操作系统/nl 占用/v 一部分/m 之外/f ，/wd 都/d 归/v 这个/rz 用户/n 的/ude1 程序/n 使用/v (/wkz 如/v PDP/x 一/m 1I／03/x 的/ude1 内存/n 为/v 32K/x 字/n ，/wd 系统/ad 占用/v 4K/x ，/wd 用户/n 程序/n 可/v 用/v 28K/x )/wky 。/wj 但/c 在/p 多用户分/n 时/ng 并发/v 系统/n 中/f ，/wd 多/m 个/q 用户/n 程序/n 共享/v 一个/mq 内存/n 区域/n ，/wd 此时/r 每个/r 用户/n 程序/n 使用/v 的/ude1 内存/n 就/d 由/p 操作系统/nl 来/f 进行/vx 分配/vn 了/y 。/wj 并且/c ，/wd 在/p 总/b 的/ude1 内存/n 不够/a 使用/vn 时/ng ，/wd 还/d 可/v 采用/v 自动/d 覆盖/v 技术/n 。/wj 
　　对/p 操作系统/nl 和/cc 编译程序/n 来说/uls ，/wd 存储管理/n 都/d 是/vshi 一个/mq 复杂/a 而/cc 又/d 重要/a 的/ude1 问题/n 。/wj 不同/a 语言/n 的/ude1 编译程序/n 和/cc 不同/a 的/ude1 操作系统/nl 可以/v 采用/v 不同/a 的/ude1 存储管理/n 方法/n 。/wj 它们/rr 采用/v 的/ude1 具体/a 做法/n ，/wd 读者/n 将/d 在/p 后续/vn 课程/n ――/wp 编译/v 原理/n 和/cc 操作/vn 系统/n 中/f 学习/v 。/wj 本/rz 课程/n 仅/d 就/p 动态存储/n 管理/vn 中/f 涉及/v 的/ude1 一些/mq 基本/a 技术/n 进行/vx 讨论/vn 。/wj 
　　动态存储/n 管理/vn 的/ude1 基本/a 问题/n 是/vshi 系统/n 如何/ryv 应/v 用户/n 提出/v 的/ude1 “/wyz 请求/n ”/wyy 分配内存/n ?/ww 又/d 如何/ryv 回收/v 那些/rz 用户/n 不再/d 使用/v 而/cc “/wyz 释放/v ”/wyy 的/ude1 内存/n ，/wd 以/p 备/v 新/a 的/ude1 “/wyz 请求/n ”/wyy 产生/v 时/ng 重新/d 进行/vx 分配/vn ?/ww 提出/v 请求/v 的/ude1 用户/n 可能/v 是/vshi 进入/v 系统/n 的/ude1 一个/mq 作业/n ，/wd 也/d 可能/v 是/vshi 程序执行/n 过程/n 中/f 的/ude1 一个/mq 动态/n 变量/n 。/wj 因此/c ，/wd 在/p 不同/a 的/ude1 动态存储/n 管理系统/n 中/f ，/wd 请求/v 分配/v 的/ude1 内/f 存量/n 大小/n 不同/a 。/wj 通常/d 在/p 编译程序/n 中/f 是/vshi 一个/mq 或/c 几/m 个/q 字/n ，/wd 而/cc 在/p 系统/n 中/f 则/d 是/vshi 几千/m 、/wn 几万/m ，/wd 甚至/d 是/vshi 几十万/m 。/wj 然而/c ，/wd 系统/n 每/rz 次分配/n 给/p 用户/n (/wkz 不论/c 大/d 小/a )/wky 都/d 是/vshi 一个/mq 地址/n 连续/a 的/ude1 内存/n 区/n 。/wj 为了/p 叙述/v 方便/v 起见/u ，/wd 在/p 下面/f 的/ude1 讨论/vn 中/f ，/wd 将/d 统称/v 已/d 分配给用户/n 使用/v 的/ude1 地址/n 连续/a 的/ude1 内存/n 区/n 为/v “/wyz 占用/v 块/ng ”/wyy ，/wd 称/v 未曾/d 分配/v 的/ude1 地址/n 连续/a 的/ude1 内存/n 区/n 为/v “/wyz 可/v 利用/v 空间/n 块/ng ”/wyy 或/c “/wyz 空闲/n 块/ng ”/wyy 。/wj 
    显然/a ，/wd 不管/c 什么样/ryv 的/ude1 动态存储/n 管理系统/n ，/wd 在/p 刚/d 开工/vi 时/ng ，/wd 整个/b 内存/n 区/n 是/vshi 一个/mq “/wyz 空闲/n 块/ng ”/wyy (/wkz 在/p 编译程序/n 中/f 称之为/v “/wyz 堆/v ”/wyy )/wky 。/wj 随着/p 用户/n 进入/v 系统/n ，/wd 先后/d 提出/v 存储请求/n ，/wd 系统/n 则/c 依次/d 进行/vx 分配/vn 。/wj 因此/c ，/wd 在/p 系统/n 运行/vi 的/ude1 初期/f ，/wd 整个/b 内存/n 区/n 基本上/d 分隔/vi 成/v 两/m 大/a 部分/n ：/wp 低/a 地址/n 区/n 包含/v 若干/m 占用/v 块/q ；/wf 高/a 地址/n 区/n (/wkz 即/v 分配/vn 后/f 的/ude1 剩余/vn 部分/n )/wky 是/vshi 一个/mq “/wyz 空闲/n 块/ng ”/wyy 。/wj 例如/v 图/n 8．1/m (/wkz a/x )/wky 所/usuo 示/vg 为/v 依次/d 给/v 8/m 个/q 用户/n 进行/vx 分配/vn 后/f 的/ude1 系统/n 的/ude1 内存/n 状态/n 。/wj 经过/p 一/m 段时间/n 以后/f ，/wd 有的/rz 用户/n 运行/vi 结束/v ，/wd 它/rr 所/usuo 占用/v 的/ude1 内存/n 区/n 变成/v 空闲/n 块/q ，/wd 这/rzv 就/d 使/v 整个/b 内存/n 区/n 呈现/v 出/vf 占用/v 块/q 和/cc 空闲/n 块/q 犬牙交错/vl 的/ude1 状态/n 。/wj 如/v 图/n 8．1/m 
    ・/w   1/m  93/m   ・/w 
(/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    图/n 8．1/m   动态存储/n 分配/vn 过程/n 中/f 的/ude1 内存/n 状态/n 
    (/wkz a/x )/wky 系统/n 运行/vn 初期/f ；/wf   (/wkz b/x )/wky 系统/n 运行/vi 若干/m 时间/n 之后/f 
    假如/c 此时/r 又/d 有/vyou 新/a 的/ude1 用户/n 进入/v 系统/n 请求/v 分配内存/n ，/wd 那么/c ，/wd 系统/n 将/d 如何/ryv 做/v 呢/y ?/ww 
    通常/d 有/vyou 两/m 种/q 做法/n ：/wp 一/m 种/q 策略/n 是/vshi 系统/n 继续/v 从/p 高/a 地址/n 的/ude1 空闲/n 块/q 中/f 进行/vx 分配/vn ，/wd 而/cc 不/d 理会/v 已/d 分配给用户/n 的/ude1 内存/n 区/n 是否/v 已/d 空闲/v ，/wd 直到/v 分配/v 无法/v 进行/vx (/wkz 即/v 剩余/vn 的/ude1 空闲/n 块/q 不/d 能/v 满足/v 分配/v 的/ude1 请求/n )/wky 时/ng ，/wd 系统/n 才/d 去/vf 回收/v 所有/b 用户/n 不再/d 使用/v 的/ude1 空闲/n 块/q ，/wd 并且/c 重新/d 组织/v 内存/n ，/wd 将/p 所有/b 空闲/n 的/ude1 内存/n 区/n 连接/v 在/p 一起/s 成为/v 一个/mq 大/a 的/ude1 空闲/n 块/q 。/wj 另/rz 一/m 种/q 策略/n 是/vshi 用户/n 一旦/d 运行/vi 结束/v ，/wd 便/d 将/p 它/rr 所/usuo 占/v 内存/n 区/n 释放/v 成为/v 空闲/n 块/q ，/wd 同时/c ，/wd 每当/p 新/a 的/ude1 用户/n 请求/v 分配内存/n 时/ng ，/wd 系统/ad 需要/v 巡视/v 整/m ’/wyy 。/wj r/x 内存/n 区/n 中/b 所有/b 空闲/n 块/q ，/wd 并/cc 从中/d 找/v 出/vf 一个/mq “/wyz 合适/a ”/wyy 的/ude1 空闲/n 块分配/n 之/uzhi 。/wj 由此/d ，/wd 系统/ad 需/v 建立/v 一/m 张/q 记录/n 所有/b 空闲/n 块/q 的/ude1 “/wyz 可/v 利用/v 空间/n 表/n ”/wyy ，/wd 此/rzs 表/n 的/ude1 结构/n 可以/v 是/vshi “/wyz 目录/n 表/n ”/wyy ，/wd 也/d 可以/v 是/vshi “/wyz 链/ng 表/n ”/wyy 。/wj 如/v 图/n 8．2/m 所/usuo 示/vg 为/p 某/rz     25/m  000/m     39/m  000/m 
O/x   10/m  000/m     31/m  000/m     59/m  000/m     99/m  999/m 
    (/wkz a/x )/wky 
起始/vn 地址/n     内存/n 块/q 大/a 小/a     使用/v 情况/n 
┏/n ━/n ━/n ━/n ━/n ━/n ━/n ┳/n ━/n ━/n ━/n ━/n ━/n ━/n ┳/n ━/n ━/n ━/n ━/n ━/n ┓/n 
┃/n     10．000/m  ┃/n     15．000/m  ┃/n     空闲/n   ┃/n 
┣/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ┫/n 
┃/n     31．000/m  ┃/n     8．000/m   ┃/n     空闲/n   ┃/n 
┣/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ┫/n 
┃/n     59．000/m  ┃/n     41．000/m  ┃/n     空闲/n   ┃/n 
┗/n ━/n ━/n ━/n ━/n ━/n ━/n ┻/n ━/n ━/n ━/n ━/n ━/n ━/n ┻/n ━/n ━/n ━/n ━/n ━/n ┛/n 
    图/n 8．2/m 动态存储/n 管理/vn 过程/n 中/f 的/ude1 内存/n 状态/n 和/cc 可/v 利用/v 空间/n 表/n 
    (/wkz a/x )/wky 内存/n 状态/n ；/wf (/wkz b/x )/wky 目录/n 表/n ；/wf (/wkz c/x )/wky 链/ng 表/n 。/wj 
系统/n 运行/vn 过程/n 中/f 的/ude1 内存/n 状态/n 及其/cc 两/m 种/q 结构/n 的/ude1 可/c 利用/v 空间/n 表/n 。/wj 其中/rz 图/n 8．2/m (/wkz b/x )/wky 是/vshi 目录/n 表/n ，/wd 表/n 中/f 每个/r 表目/n 包括/v 三/m 项/q 信息/n ：/wp 初始/t 地址/n 、/wn 空闲/n 块/q 大/a 小/a 和/cc 使用/v 情况/n 。/wj 图/n 8．2/m (/wkz c/x )/wky 是/vshi 链/ng 表/n ，/wd 表/n 中/f 一个/mq 结点/n 表示/v 一个/mq 空闲/n 块/q ，/wd 系统/n 每/rz 次/qv 进行/vx 分配/vn 或/c 回收/v 即/d 为/v 在/p 可/v 利用/v 空间/n 表/n 中/f 删除/v 或/c 插入/v 一个/mq 结点/n 。/wj 
    ・/w   】/wky 94・/m 
下面/f 将/d 分别/d 讨论/v 利用不同/n 策略/n 进行/vx 动态存储/n 管理/vn 的/ude1 方法/n 。/wj 
    8．2/m 可/v 利用/v 空间/n 表/n 及/cc 分配方法/n 
    这/rzv 一/m 节/q 主要/d 讨论/v 利用/v 可/v 利用/v 空间/n 表/n 进行/vx 动态存储/n 分配/vn 的/ude1 方法/n 。/wj 目录/n 表/n 的/ude1 情况/n 比较/d 简单/a ，/wd 这/rzv 类/q 系统/n 将/d 在/p 操作系统/nl 课程/n 中/f 作/v 详细/ad 介绍/v ，/wd 在/p 此/rzs 仅/d 就/d 链/ng 表/n 的/ude1 情况/n 进行/vx 讨论/vn 。/wj 
    如上所述/c ，/wd 可/c 利用/v 空间/n 表/n 中/f 包含/v 所有/b 可/v 分配/v 的/ude1 空闲/n 块/q ，/wd 每/rz 一/m 块/q 是/vshi 链/ng 表/n 中/f 的/ude1 一个/mq 结点/n 。/wj 当/p 用户/n 请求/v 分配/v 时/ng ，/wd 系统/n 从/p 可/v 利用/v 空间/n 表/n 中/f 删除/v 一个/mq 结点/n 分配/v 之/rz ；/wf 当/p 用户/n 释放/v 其/rz 所/usuo 占/v 内存/n 时/ng ，/wd 系统/n 即/d 回收/v 并/cc 将/p 它/rr 插入/v 到/v 可/v 利用/v 空间/n 表/n 中/f 。/wj 因此/c ，/wd 可/c 利用/v 空间/n 表/n 亦/d 称作/v “/wyz 存储池/n ”/wyy 。/wj 根据/p 系统/n 运行/vi 的/ude1 不同/a 情况/n ，/wd 可/c 利用/v 空间/n 表/vg 可以/v 有/vyou 下列/b 三/m 种/q 不同/a 的/ude1 结构形式/n ：/wp 
    第一/m 种/q 情况/n 是/vshi 系统/n 运行/vn 期间/f 所有/b 用户/n 请求/v 分配/v 的/ude1 存储量/n 大/a 小/a 相同/a 。/wj 对/p 此/rzs 类/q 系统/n ，/wd 通常/d 的/ude1 做法/n 是/vshi ，/wd 在/p 系统/n 开始运行/n 时/ng 将/d 归/v 它/rr 使用/v 的/ude1 内存/n 区/n 按/p 所/usuo 需/v 大小/n 分割成若干/n 大小/n 相同/a 的/ude1 块/q ，/wd 然后/c 用/p 指针/n 链接/n 成/v 一个/mq 可/v 利用/v 空间/n 表/n 。/wj 由于/p 表/n 中/f 结点/n 大小/n 相同/a ，/wd 则/c 分配/v 时/ng 无需/v 查找/v ，/wd 只要/c 将/p 第一/m 个/q 结点/n 分配给用户/n 即可/v ；/wf 同样/d ，/wd 当/p 用户/n 释放/v 内存/n 时/ng ，/wd 系统/n 只要/c 将/p 用户/n 释放/v 的/ude1 空闲/n 块/q 插入/v 在/p 表头/n 即可/v 。/wj 可见/c ，/wd 这种/r 情况/n 下/f 的/ude1 可/c 利用/v 空间/n 表/vg 实质/n 上/f 是/vshi 一个/mq 链/ng 栈/ng 。/wj 这/rzv 是/vshi 一/m 种/q 最/d 简单/a 的/ude1 动态存储/n 管理/vn 的/ude1 方式/n ，/wd 如/v 第2/m 章/q 的/ude1 “/wyz 2．3．1/m 线性/n 链/ng 表/n ”/wyy 中/f 的/ude1 静态/n 链/ng 表/n 就/d 是/vshi 一/m 例/q 。/wj 
    第二/m 种/q 情况/n ，/wd 系统/n 运行/vn 期间/f 用户/n 请求/v 分配/v 的/ude1 存储量/n 有/vyou 若干/m 种/q 大小/n 的/ude1 规格/n 。/wj 对/p 此/rzs 类/q 系统/n ，/wd 一般/a 情况/n 下/f 是/vshi 建立/v 若干/m 个/q 可/v 利用/v 空间/n 表/n ，/wd 同一/b 链/ng 表/n 中/f 的/ude1 结点/n 大小/n 相同/a 。/wj 例如/v ，/wd 某/rz 动态存储/n 管理系统/n 中/f 的/ude1 用户/n 将/d 请求/v 分配/v 2/m 个/q 字/n 、/wn 4/m 个/q 字/n 或/c 8/m 个/q 字/n 的/ude1 内存/n 块/q ，/wd 则/c 系统/n 建立/v 三/m 个/q 结点/n 大小/n 分别/d 为/v 3/m 个/q 字/n 、/wn 5/m 个/q 字/n 和/cc 9/m 个/q 字/n 的/ude1 链/ng 表/n ，/wd 它们/rr 的/ude1 表头/n 指针/n 分别/d 为/v av2/x 、/wn av4/x 和/cc av8/x 。/wj 如/v 图/n 8．3/m 所/usuo 示/vg ，/wd 每个/r 结点/n 中/f 的/ude1 第一/m 个/q 字/n 设有/v 链/ng 域/ng (/wkz 1ink/x )/wky 、/wn 标志/n 域/ng (/wkz tag/x )/wky 和/cc 结点/n 类型域/n (/wkz type/x )/wky 。/wj 
其中/rz ：/wp 类型域/n 为/p 区别/n 三/m 种/q 大小/n 不同/a 的/ude1 结点/n 而/cc 设/v ，/wd type/x 的/ude1 值/n 为/v “/wyz 0/m ”/wyy 、/wn “/wyz 1/m ”/wyy 或/c “/wyz 2/m ”/wyy ，/wd 分别/d 表示/v 结点/n 大小/n 为/p 2/m 个/q 字/n 、/wn 4/m 个/q 字/n 或/c 8/m 个/q 字/n ；/wf 标志/n 域/n tag/x 为/v “/wyz 0/m ”/wyy 或/c “/wyz 1/m ”/wyy 分别/d 表示/v 结点/n 为/p 空闲/n 块/q 或/c 占用/v 块/q ；/wf 链/ng 域/ng 中/f 存储/v 指向/v 同一/b 链/ng 表/n 中/f 下/vf 一/m 结点/n 的/ude1 指针/n ，/wd 而/cc 结点/n 中/f 的/ude1 值域/n 是/vshi 其/rz 大/a 小/a 分别/d 为/v 2/m 、/wn 4/m 和/cc 8/m 个/q 字/n 的/ude1 连续/a 空间/n 。/wj 此时/r 的/ude1 分配/vn 和/cc 回收/vn 的/ude1 方法/n 在/p 很/d 大程度/n 上/f 和/cc 第一/m 种/q 情况/n 类似/a ，/wd 只/d 是/vshi 当/p 结/v 
点/qt 大小/n 和/cc 请求/v 分配/v 的/ude1 量/n 相同/a 的/ude1 链/ng 表/n 为/v 空/ng 时/ng ，/wd 需/v 查询/v 结点/n 较/d 大/a 的/ude1 链/ng 表/n ，/wd 并/cc 从/p 中/f 取出/v 一个/mq 结点/n ，/wd 将/p 其中/rz 一部分/m 内存/n 分配给用户/n ，/wd 而/cc 将/d 剩余/v 部分/n 插入/v 到/v 相应/vi 大小/n 的/ude1 链/ng 表/n 中/f 。/wj 回收/v 时/ng ，/wd 也/d 只/d 要/v 将/d 释放/v 的/ude1 空闲/n 块/q 插入/v 到/v 相应/vi 大小/n 的/ude1 链/ng 表/n 的/ude1 表头/n 中/f 去/vf 即可/v 。/wj 然而/c ，/wd 这种/r 情况/n 的/ude1 系统/n 还/d 有/vyou 一个/mq 特殊/a 的/ude1 问题/n 要/v 处理/v ：/wp 即/v 当/p 结点/n 与/p 请求/v 相符/vi 的/ude1 链/ng 表/n 和/cc 结点/n 更/d 大/a 的/ude1 链/ng 表/n 均/d 为/v 空/ng 时/ng ，/wd 分配/v 不/d 能/v 进行/vx ，/wd 而/cc 实际上/d 内存/n 空间/n 并/cc 不/d 一定/d 不/d 存在/v 所/usuo 需/v 大小/n 的/ude1 连续/a 空间/n ，/wd 只是/c 由于/c 在/p 系统/n 运行/vn 过程/n 中/f ，/wd 频繁/ad 出现/v 小/a 块/q 的/ude1 分配/vn 和/cc 回收/vn ，/wd 使得/vi 大/d 结点/n 链/ng 表/n 中/f 的/ude1 空闲/n 块/q 被/pbei 分隔/vi 成/v 小/a 块/q 后/f 插入/v 在/p 小结/n 点/qt 的/ude1 链/ng 表/n 中/f ，/wd 此时/r 若/c 要/v 使/v 系统/n 能/v 继续运行/n ，/wd 就/d 必须/d 重新/d 组织/v 内存/n ，/wd 即/d 执行/v “/wyz 存储/vn 紧缩/vn ”/wyy 的/ude1 操作/vn 。/wj 除此之外/al ，/wd 上述/b 这个/rz 系统/n 本身/rz 的/ude1 分配/vn 和/cc 回收/vn 的/ude1 算法/n 都/d 比较/d 简单/a ，/wd 读者/n 可/c 自行/d 写/v 出/vf 。/wj 
    第三/m 种/q 情况/n ，/wd 系统/n 在/p 运行/vi 期间/f 分配给用户/n 的/ude1 内存/n 块/q 的/ude1 大小/n 不/d 固定/a ，/wd 可以/v 随/dg 请求/v 而/cc 变/v 。/wj 因此/c ，/wd 可/c 利用/v 空间/n 表/n 中/f 的/ude1 结点/n 即/v 空闲/n 块/q 的/ude1 大小/n 也/d 是/vshi 随意/a 的/ude1 。/wj 通常/d ，/wd 操作系统/nl 中/f 的/ude1 可/c 利用/v 空间/n 表/vg 属/v 这/rzv 种/q 类型/n 。/wj 
    系统/n 刚/d 开始工作/n 时/ng ，/wd 整个/b 内存/n 空间/n 是/vshi 一个/mq 空闲/n 块/q ，/wd 即/d 可/v 利用/v 空间/n 表/n 中/f 只/d 有/vyou 一个/mq 大/a 小/a 为/p 整个/b 内存/n 区/n 的/ude1 结点/n ，/wd 随着/p 分配/vn 和/cc 回收/vn 的/ude1 进行/vx ，/wd 可/c 利用/v 空间/n 表/n 中/f 的/ude1 结点/n 大小/n 和/cc 个/q 数/n 也/d 随之/d 而/cc 变/v ，/wd 上述/b 图/n 8．2/m (/wkz c/x )/wky 中/f 的/ude1 链/ng 表/n 即/d 为/v 这种/r 情况/n 的/ude1 可/c 利用/v 空间/n 表/n 。/wj 
    10/m 空闲/n 块/q 
ng/x 。/wj {/n 1/m 占用/v 块/q 
    f0/x 结点/n 大小/n 为/p 2/m 个/q 字/n 
type=/x </n 1/m 结点/n 大小/n 为/p 4/m 个/q 字/n 
    12/m 结点/n 大小/n 为/p 8/m 个/q 字/n 
    (/wkz a/x )/wky 
av2/x 
av4/x 
…/ws 
    图/n 8．3/m 有/vyou 三/m 种/q 大/a 小结/n 点/qt 的/ude1 可/c 利用/v 空间/n 表/n 
    ．/w ，/wd   (/wkz a/x )/wky 结点/n 结构/n ；/wf   (/wkz b/x )/wky 可/v 利用/v 空间/n 表/n 。/wj 
    由于/p 链/ng 表/n 中/f 结点/n 大小/n 不同/a ，/wd 则/c 结点/n 的/ude1 结构/n 与/p 前/f 两/m 种/q 情况/n 也/d 有所不同/vl ，/wd 结点/n 中/f 除/p 标志/n 域/ng 和/cc 链/ng 域/ng 之外/f ，/wd 尚/d 需/v 有/vyou 一个/mq 结点/n 大小/n 域/ng (/wkz size/x )/wky ，/wd 以/p 指示/n 空闲/n 块/q 的/ude1 存储量/n ，/wd 如/v 图/n 8．4/m 所/usuo 示/vg 。/wj 结点/n 中/f 的/ude1 space/x 域/n 是/vshi 一个/mq 地址/n 连续/a 的/ude1 内存/n 空间/n 。/wj 
    I/x  O/x 空闲/n 块/q 
妇/ng g/x 。/wj {/n 1/m 占用/v 块/q 
的/ude1 大小/n 随意/a 的/ude1 结点/n 结构/n 
    由于/c 可/v 利用/v 空间/n 表/n 中/f 的/ude1 结点/n 大小/n 不同/a ，/wd 则/c 在/p 分配/v 时/ng 就/d 有/vyou 一个/mq 如何/ryv 分配/v 的/ude1 问题/n 。/wj 假设/v 某/rz 用户/n 需/v 大小/n 为/v n/x 的/ude1 内存/n ，/wd 而/cc 可/v 利用/v 空间/n 表/n 中/f 仅/d 有/vyou 一/m 块/q 大/a 小/a 为/v ”/wyy 的/ude1 空闲/n 块/q ，/wd 则/c 只/d 需/v 将/p 其中/rz 大小/n 为/v n/x 的/ude1 一/m 部分/n 分配/v 给/p 申请/v 分配/v 的/ude1 用户/n ，/wd 同时/c 将/d 剩余/v 大小/n 为/v m-n/x 的/ude1 部分/n 作为/v 一个/mq 结点/n 留/v 在/p 链/ng 表/n 中/f 即可/v 。/wj 然而/c ，/wd 若/c 可/v 利用/v 空间/n 表/n 中/f 有/vyou 若干/m 个/q 不/d 小于/v ”/wyy 的/ude1 空闲/n 块/q 时/ng ，/wd 该/rz 分配/v 哪/ry 一/m 块/q 呢/y ?/ww 通常/d ，/wd 可/v 有/vyou 三/m 种/q 不同/a 的/ude1 分配策略/n ：/wp 
    (/wkz 1/m )/wky 首/m 次/qv 拟/v 合法/a 。/wj 从/p 表头/n 指针/n 开始/v 查找/v 可/v 利用/v 空间/n 表/n ，/wd 将/d 找到/v 的/ude1 第一/m 个/q 大/a 小/a 不/d 小于/v n/x 的/ude1 空闲/n 块/q 的/ude1 一/m 部分/n 分配给用户/n 。/wj 可/v 利用/v 空间/n 表/vg 本身/rz 既/c 不/d 按/p 结点/n 的/ude1 初始/b 地址/n 有序/a ，/wd 也/d 不/d 按/p 结点/n 的/ude1 大小/n 有序/a 。/wj 则/c 在/p 回收/v 时/ng ，/wd 只要/c 将/d 释放/v 的/ude1 空闲/n 块/q 插入/v 在/p 链/ng 表/n 的/ude1 表头/n 即可/v 。/wj 例如/v ，/wd 在/p 图/n 8．2/m (/wkz c/x )/wky 的/ude1 状态/n 时/ng 有/vyou 用户/n U9/x 进入/v 系统/n 并/cc 申请/v 7K/x 的/ude1 内存/n ，/wd 系统/n 在/p 可/v 利用/v 空间/n 表/n 中/f 进行/vx 查询/vn ，/wd 发现/v 第一/m 个/q 空闲/n 块/q 即/d 满足要求/n ，/wd 则/c 将/p 此/rzs 块/q 中/f 大/d 小/a 为/v 7K/x 的/ude1 一/m 部分/n 分配/v 之/uzhi ，/wd 剩余/v 8K/x 的/ude1 空闲/n 块/q 仍/d 在/p 链/ng 表/n 中/f ，/wd 如/v 图/n 8．5/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 图/n 8．5/m (/wkz d/x )/wky 为/p 分配给用户/n 的/ude1 占用/vn 块/q 。/wj 
　　(/wkz 2/m )/wky 最佳/z 拟/v 合法/a 。/wj 将/d 可/v 利用/v 空间/n 表/n 中/f 一个/mq 不/d 小于/v 咒/v 且/c 最/d 接近/v n/x 的/ude1 空闲/n 块/q 的/ude1 一/m 部分/n 分配给用户/n 。/wj 则/c 系统/n 在/p 分配/v 前/f 首先/d 要/v 对/p 可/v 利用/v 空间/n 表/n 从头到尾/dl 扫视/v 一/m 遍/qv ，/wd 然后/c 从/p 中/f 找/v 出/vf 一/m 块/q 不/d 小于/v n/x 且/c 最/d 接近/v 扎/v 的/ude1 空闲/n 块/q 进行/vx 分配/vn 。/wj 显然/a ，/wd 在/p 图/n 8．2/m (/wkz c/x )/wky 的/ude1 状态/n 时/ng ，/wd 系统/n 就/d 应该/v 将/p 第二/m 个/q 空闲/n 块/q 的/ude1 一/m 部分/n 分配给用户/n u/x 。/wj ，/wd 分配/v 后/f 的/ude1 可/c 利用/v 空间/n 表/vg 如/v 图/n 8．5/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 在/p 用/v 最佳/z 拟/v 合法/a 进行/vx 分配/vn 时/ng ，/wd 为了/p 避免/v 每/rz 次分配/n 都/d 要/v 扫视/v 整个/b 链/ng 表/n 。/wj 通常/d ，/wd 预先/d 设定/v 可/v 利用/v 空间/n 表/n 的/ude1 结构/n 按/p 空间/n 块/q 的/ude1 大小/n 自/p 小/a 至/p 大/a 有序/a ，/wd 由此/d ，/wd 只/d 需/v 找到/v 第一/m 块/q 大于/v ，/wd z/x 的/ude1 空闲/n 块/q 即/d 可/v 进行/vx 分配/vn ，/wd 但/c 在/p 回收/v 时/ng ，/wd 必须/d 将/d 释放/v 的/ude1 空闲/n 块/q 插入/v 到/v 合适/a 的/ude1 位置/n 上/f 去/vf 。/wj 
    图/n 8．5/m ’/wyy 结点/n 大小/n 随意/a 的/ude1 可/c 利用/v 空间/n 表/n (/wkz a/x )/wky 按/p 首/m 次/qv 拟合/n 原则/n 进行/vx 分配/vn ；/wf (/wkz b/x )/wky 按/p 最佳/z 拟合/n 原则/n 进行/vx 分配/vn   (/wkz c/x )/wky 按/p 最/d 差/a 拟合/n 原则/n 进行/vx 分配/vn ；/wf (/wkz d/x )/wky 分配给用户/n 的/ude1 占用/vn 块/q ：/wp 
    (/wkz 3/m )/wky 最/d 差/a 拟/v 合法/a 。/wj 将/d 可/v 利用/v 空间/n 表/n 中/f 不/d 小于/v 咒/v 且/c 是/vshi 链/ng 表/n 中/f 最/d 大/a 的/ude1 空闲/n 块/q 的/ude1 一/m 部分/n 分配给用户/n 。/wj 例如/v 在/p 图/n 8．2/m (/wkz c/x )/wky 的/ude1 状态/n 时/ng ，/wd 就/d 应/v 将/d 大/a 小/a 为/v 41K/x 的/ude1 空闲/n 块/q 中/f 的/ude1 一/m 部分/n 分配给用户/n ，/wd 分配/v 后/f 的/ude1 可/c 利用/v 空间/n 表/vg 如/v 图/n 8．5/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 显然/a ，/wd 为了/p 节省时间/n ，/wd 此时/r 的/ude1 可/c 利用/v 空间/n 表/n 的/ude1 结构/n 应/v 按/p 空闲/n 块/q 的/ude1 大小/n 自大/an 至/p 小/a 有序/a 。/wj 这样/rzv ，/wd 每/rz 次分配/n 无需/v 查找/v ，/wd 只/d 需/v 从/p 链/ng 表/n 中/f 删除/v 第一/m 个/q 结点/n ，/wd 并/cc 将/p 其中/rz 一部分/m 分配给用户/n ，/wd 而/cc 剩余/vn 部分/n 作为/v 一个/mq 新/a 的/ude1 结点/n 插入/v 到/v 可/v 利用/v 空间/n 表/n 的/ude1 适当/a 位置/n 上/f 去/vf 。/wj 当然/d ，/wd 在/p 回收/v 时/ng 亦/d 需/v 将/d 释放/v 的/ude1 空闲/n 块/q 插入/v 到/v 链/ng 表/n 的/ude1 适当/a 位置/n 上/f 去/vf 。/wj 
    上述/b 三/m 种/q 分配策略/n 各有所长/vl 。/wj 一般来说/vl ，/wd 最佳/z 拟/v 合法/ad 适用/vi 于/p 请求/v 分配/v 的/ude1 内存/n 大/a 小/a 范围较广/n 的/ude1 系统/n 。/wj 因为/c 按/p 最佳/z 拟合/n 的/ude1 原则/n 进行/vx 分配/vn 时/ng ，/wd 总是/d 找/v 大小/n 最/d 接近/v 请求/v 的/ude1 空闲/n 块/q ，/wd 由此/d 系统/a 中/f 可能/v 产生/v 一些/mq 存储量/n 甚/dg 小/a 而/cc 无法/v 利用/v 的/ude1 小/a 片/q 内存/n ，/wd 同时/c 也/d 保留/v 那些/rz 很/d 大/a 的/ude1 内存/n 块/q 以/p 备/v 响应/v 后面/f 将/d 发生/v 的/ude1 内/f 存量/n 特大/b 的/ude1 请求/n ，/wd 从而/c 使/v 整个/b 链/ng 表/vg 趋向/n 于/p 结点/n 大小/n 差别/n 甚/dg 远/a 的/ude1 状态/n 。/wj 反之/c ，/wd 由于/c 最/d 差/a 拟合/n 每次/r 都/d 从/p 内/f 存量/n 最/d 大/a 的/ude1 结点/n 中/f 进行/vx 分配/vn ，/wd 从而/c 使/v 链/ng 表/n 中/f 的/ude1 结点/n 大小/n 趋于/v 均匀/a ，/wd 因此/c 它/rr 适用/vi 于/p 请求/v 分配/v 的/ude1 内存/n 大/a 小/a 范围较/n 窄/a 的/ude1 系统/n 。/wj 而/cc 首/m 次/qv 拟/v 合法/a 的/ude1 分配/vn 是/vshi 随机/b 的/ude1 ，/wd 因此/c 它/rr 介于/v 两者/rzv 之间/f ，/wd 通常/d 适用/vi 于/p 系统/n 事先/d 不/d 掌握/v 运行/vi 期间/f 可能/v 出现/v 的/ude1 请求/n 分配/vn 和/cc 释放/v 的/ude1 信息/n 的/ude1 情况/n 。/wj 从/p 时间/n 上/f 来/vf 比较/v ，/wd 首/m 次/qv 拟合/n 在/p 分配/v 时/ng 需/v 查询/v 可/v 利用/v 空间/n 表/n ，/wd 而/cc 回收/v 时/ng 仅/d 需/v 插入/v 在/p 表头/n 即可/v ；/wf 最/d 差/a 拟合/n 恰/d 相反/vi ，/wd 分配/v 时/ng 无需/v 查询/v 链/ng 表/n ，/wd 而/cc 回收/v 时/ng 为/v 将/d 新/a 的/ude1 “/wyz 空闲/n 块/ng ”/wyy 插入/v 在/p 链/ng 表/n 中/f 适当/a 的/ude1 位置/n 上/f ，/wd 需/v 先/d 进行/vx 查找/vn ；/wf 最佳/z 拟合/n 无论/c 分配/v 和/cc 回收/vn ，/wd 均/d 需/v 查找/v 链/ng 表/n ，/wd 因此/c 最/d 费/v 时间/n 。/wj 
    因此/c ，/wd 不同/a 的/ude1 情景/n 需/v 采用/v 不同/a 的/ude1 方法/n ，/wd 通常/d 在/p 选择/v 时/ng 需/v 考虑/v 下列/b 因素/n ：/wp 用户/n 的/ude1 逻辑/n 要求/n ；/wf 请求/v 分配量/n 的/ude1 大小/n 分布/vi ；/wf 分配/v 和/cc 释放/v 的/ude1 频率/n 以及/cc 效率/n 对/p 系统/n 的/ude1 重要性/n 等等/udeng 。/wj 
    在/p 实际/n 使用/v 的/ude1 系统/n 中/f 回收/v 空闲/n 块/q 时/ng 还/d 需/v 考虑/v 一个/mq “/wyz 结点/n 合并/v ”/wyy 的/ude1 问题/n 。/wj 这/rzv 是/vshi 因为/p 系统/n 在/p 不断/d 进行/vx 分配/vn 和/cc 回收/vn 的/ude1 过程/n 中/f ，/wd 大/a 的/ude1 空闲/n 块/q 逐渐/d 被/pbei 分割/v 成/v 小/a 的/ude1 占用/vn 块/q ，/wd 在/p 它们/rr 重/d 又/d 成为/v 空闲/n 块/q 回收/vn 之后/f ，/wd 即使/c 是/vshi 地址/n 相邻/vi 的/ude1 两/m 个/q 空闲/n 块/q 也/d 只是/d 作为/v 两/m 个/q 结点/n 插入/v 到/v 可/v 利用/v 空间/n 表/n 中/f ，/wd 以致/c 使得/vi 后来/t 出现/v 的/ude1 大容量/n 的/ude1 请求/n 分配/v 无法/v 进行/vx ，/wd 为了/p 更/d 有效/a 地/ude2 利用/v 内存/n ，/wd 就/d 要求/v 系统/n 在/p 回收/v 时/ng 应/v 考虑/v 将/p 地址/n 相邻/vi 的/ude1 空闲/n 块/q 合并/v 成/v 尽可能/d 大/a 的/ude1 结点/n 。/wj 换句话说/c ，/wd 在/p 回收/v 空闲/n 块/q 时/ng ，/wd 首先/d 应/v 检查/vn 地址/n 与/p 它/rr 相邻/vi 的/ude1 内存/n 是否/v 是/vshi 空闲/n 块/q 。/wj 具体实现/n 的/ude1 方法/n 将/d 在/p 下面/f 两节/n 中/f 讨论/v 的/ude1 动态存储/n 管理系统/n 中/f 加以/vx 详细/ad 说明/v 。/wj 
8．3/m 边界/n 标识/n 法/n 
    边界/n 标识/n 法/n (/wkz boundary/x  tag/x  method/x )/wky 是/vshi 操作系统/nl 中/f 用/v 以/p 进行/vx 动态分区/n 分配/vn 的/ude1 一/m 种/q 存储管理/n 方法/n ，/wd 它/rr 属于/v 上/vf 一/m 节/q 讨论/vn 中/f 的/ude1 第三/m 种/q 情况/n 。/wj 系统/n 将/p 所有/b 的/ude1 空闲/n 块/q 链接/n 在/p 一个/mq 双重/b 循环/vn 链/ng 表/vg 结构/n 的/ude1 可/c 利用/v 空间/n 表/n 中/f ；/wf 分配/v 可/v 按/p 首/m 次/qv 拟合/n 进行/vx ，/wd 也/d 可/v 按/p 最佳/z 拟合/n 进行/vx 。/wj 系统/n 的/ude1 特点/n 在于/v ：/wp 在/p 每个/r 内存/n 区/n 的/ude1 头部/n 和/cc 底部/f 两/m 个/q 边界/n 上/f 分别/d 设有/v 标识/n ，/wd 以/p 标识/n 该/rz 区域/n 为/p 占用/v 块/q 或/c 空闲/v 块/q ，/wd 使得/vi 在/p 回收/v 用户/n 释放/v 的/ude1 空闲/n 块/q 时/ng 易于/v 判别/v 在/p 物理/n 位置/n 上/f 与/p 其/rz 相邻/vi 的/ude1 内存/n 区域/n 是否/v 为/p 空闲/n 块/q ，/wd 以便/d 将/p 所有/b 地址/n 连续/a 的/ude1 空闲存储/n 区/n 组合/vd 成/v 一个/mq 尽可能/d 大/a 的/ude1 空闲/n 块/q 。/wj 下面/f 分别/d 就/d 系统/a 的/ude1 可/c 利用/v 空间/n 表/n 的/ude1 结构/n 及其/cc 分配/vn 和/cc 回收/vn 的/ude1 算法/n 进行/vx 讨论/vn 。/wj 
8．3．1/m 可/v 利用/v 空间/n 表/n 的/ude1 结构/n 
可/v 利用/v 空间/n 表/n 中/f 的/ude1 结点/n 结构/n 如下/vi 所/usuo 示/vg 
・/w   198・/m 
它/rr 表示/v 一个/mq 空闲/n 块/q 。/wj 整个/b 结点/n 由/p 三/m 部分/n 组成/v 。/wj 其中/rz space/x 为/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n ，/wd 是/vshi 可以/v 分配给用户/n 使用/v 的/ude1 内存/n 区域/n ，/wd 它/rr 的/ude1 大小/n 由/p head/x 中/f 的/ude1 size/x 域/ng 指示/n ，/wd 并/cc 以/p 头部/n head/x 和/cc 底部/f foot/x 作为/p 它/rr 的/ude1 两/m 个/q 边界/n ；/wf 在/p head/x 和/cc foot/x 中/f 分别/d 设有/v 标志/n 域/n tag/x ，/wd 且/c 设定/v 空闲/n 块/q 中/f tag/x 的/ude1 值/n 为/v “/wyz 0/m ”/wyy ，/wd 占用/v 块/q 中/f tag/x 的/ude1 值/n 为/v “/wyz 1/m ”/wyy ；/wf foot/x 位于/v 结点/n 底部/f ，/wd 因此/c 它/rr 的/ude1 地址/n 是/vshi 随/p 结点/n 中/f space/x 空间/n 的/ude1 大/a 小/a 而/cc 变/v 的/ude1 。/wj 为/p 讨论/v 简便/a 起见/u ，/wd 我们/rr 假定/v 内存/n 块/q 的/ude1 大小/n 以/p “/wyz 字/n ”/wyy 为/p 单位/n 来/vf 计/vi ，/wd 地址/n 也/d 以/p “/wyz 字/n ”/wyy 为/p 单位/n 来/vf 计/vi ，/wd 结/v 点头/vi 部/n 中/f 的/ude1 si/x ‘/wyz ze/x 域/n 的/ude1 值/n 为/p 整个/b 结点/n 的/ude1 大小/n ，/wd 包括/v 头部/n head/x 和/cc 底部/f foot/x 所/usuo 占/v 空间/n ，/wd 并/cc 假设/n head/x 和/cc foot/x 各/rz 占/v 一个/mq 字/n 的/ude1 空间/n ，/wd 但/c 在/p 分配/v 时/ng 忽略/v 不/d 计/vi 。/wj 
借助/v c/x 语言/n ，/wd 在/p 此/rzs 将/d 可/v 利用/v 空间/n 表/n 的/ude1 结点/n 结构/n 定义/n 为/v 如下/vi 说明/v 的/ude1 数据/n 类型/n ：/wp 
trpedef/x  stz/x '/n uct/x  WORD/x {/n     ∥/w WORD：/x 内存/n 字/n 类型/n 
  ur/x ,/wd ion/x {/n   ∥/w head/x 和/cc foot/x 分别/d 是/vshi 结点/n 的/ude1 第一/m 个/q 字/n 和/cc 最后/f 的/ude1 字/n 
    WORD/x     */n llink/x ；/wf     ∥/w 头部/n 域/ng ，/wd 指向/v 前驱/n 结点/n 
    WORD/x     */n uplill/x 】/wky c/x ；/wf     ∥/w 底部/f 域/ng ，/wd 指向/v 本/rz 结/v 点头/vi 部/n 
  f/x ；/wf 
  int/x  tag/x ；/wf 
  int/x     size/x ；/wf 
  WORD/x     。/wj rlink：/x 
  0the―Type/x  other/x ；/wf   -/wp 
}/n WORD/x ，/wd head/x ，/wd foot/x ，/wd */n Space/x ；/wf 
∥/w 块/q 标志/n ，/wd 0：/m 空闲/n ，/wd 1：/m 占用/v ，/wd 头部/n 和/cc 尾部/n 均/d 有/vyou 。/wj 
∥/w 头部/n 域/ng ，/wd 块/q 大/a 小/a 
∥/w 头部/n 域/ng ，/wd 指向/v 后/f 继/vg 结点/n 
∥/w 字/n 的/ude1 其它/rz 部分/n 
∥/w */n Space：/x 可/v 利用/v 空间/n 指针/n 类型/n 
    #/n define/x  FootLoc/x (/wkz p/x )/wky p/x ’/wyy p/x 一/m >/n size―l/x   ∥/w 指向/v p/x 所/usuo 指/v 结点/n 的/ude1 底部/f 
    可/v 利用/v 空间/n 表/vg 设/v 为/p 双重/b 循环/vn 链/ng 表/n 。/wj head/x 中/f 的/ude1 llink/x 和/cc rlink/x 分别/d 指向/v 前驱/n 结点/n 和/cc 后/f 继/vg 结点/n 。/wj 表/n 中/f 不/d 设/v 表头/n 结点/n ，/wd 表头/n 指针/n pav/x 可以/v 指向/v 表/n 中/f 任/v 一/m 结点/n ，/wd 即/v 任何/rz 一个/mq 结点/n 都/d 可/v 看成/v 是/vshi 链/ng 表/n 中/f 的/ude1 第一/m 个/q 结点/n ；/wf 表头/n 指针/n 为/v 空/ng ，/wd 则/c 表明/v 可/v 利用/v 空间/n 表/vg 为/v 空/ng 。/wj foot/x 中/f 的/ude1 uplink/x 域/ng 也/d 为/v 指针/n ，/wd 它/rr 指向/v 本/rz 结点/n ，/wd 它/rr 的/ude1 值/n 即/d 为/v 该/rz 空闲/n 块/q 的/ude1 首/m 地址/n 。/wj 例如/v 图/n 8．6/m (/wkz a/x )/wky 是/vshi 一个/mq 占有/v 100K/x 内存/n 空间/n 的/ude1 系统/n 在/p 运行/vi 开始/v 时/ng 的/ude1 可/c 利用/v 空间/n 表/n 。/wj 
8．3．2/m 分配算法/n 
    分配/v 的/ude1 算法/n 比较/d 简单/a ，/wd 假设/v 我们/rr 采用/v 首/m 次/qv 拟/v 合法/a 进行/vx 分配/vn ，/wd 则/c 只/d 要/v 从/p 表头/n 指针/n pav/x 所/usuo 指/v 结点/n 起/f ，/wd 在/p 可/v 利用/v 空间/n 表/n 中/f 进行/vx 查找/vn ，/wd 找到/v 第一/m 个/q 容量/n 不/d 小于/v 请求/v 分配/v 的/ude1 存储量/n (/wkz ，/wd z/x )/wky 的/ude1 空闲/n 块/q 时/ng ，/wd 即/d 可/v 进行/vx 分配/vn 。/wj 为了/p 使/v 整个/b 系统/n 更/d 有效/a 地/ude2 运行/vi ，/wd 在/p 边界/n 标识/n 法/n 中/f 还/d 作/v 了/ule 如下/vi 两/m 条/q 约定/v ：/wp 
    (/wkz 1/m )/wky 假设/v 找到/v 的/ude1 此/rzs 块/q 待/vi 分配/v 的/ude1 空闲/n 块/q 的/ude1 容量/n 为/p 仇/n 个/q 字/n (/wkz 包括/v 头部/n 和/cc 底部/f )/wky ，/wd 若/c 每/rz 次分配/n 只是/d 从/p 中/f 分配/v n/x 个/q 字/n 给/p 用户/n ，/wd 剩余/v 优/ag 一/m ，/wd z/x 个/q 字/n 大小/n 的/ude1 结点/n 仍/d 留/v 在/p 链/ng 表/n 中/f ，/wd 则/c 在/p 若干/m 次分配/n 之后/f ，/wd 链/ng 表/n 中/f 会/v 出现/v 一些/mq 容量/n 极/d 小/a 总/d 也/d 分配/v 不/d 出去/vf 的/ude1 空闲/n 块/q ，/wd 这/rzv 就/d 大大/d 减慢/v 了/ule 分配/vn (/wkz 查找/v )/wky 的/ude1 速度/n 。/wj 弥补/v 的/ude1 办法/n 是/vshi ：/wp 选定/v 一个/mq 适当/a 的/ude1 常量/n e/x ，/wd 当/v 以/p ≤e/x 时/ng ，/wd 就/d 将/p 容量/n 为/v m/x 的/ude1 空闲/n 块/q 整/m 块分配/n 给/p 用户/n ；/wf 反之/c ，/wd 只/d 分配/v 其中/rz 咒/v 个/q 字/n 的/ude1 内存/n 块/q 。/wj 同时/c ，/wd 为了/p 避免/v 修改/v 指针/n ，/wd 约定/v 将/p 该/rz 结点/n 中/f 的/ude1 高/a 地址/n 部分/n 分配给用户/n 。/wj 
    (/wkz 2/m )/wky 如果/c 每/rz 次分配/n 都/d 从/p 同一个/b 结点/n 开始/v 查找/v 的话/udh ，/wd 势必/d 造成/v 存储量/n 小/a 的/ude1 结点/n 密集/a 在/p 头/n 指针/n pay/x 所/usuo 指/v 结点/n 附近/f ，/wd 这/rzv 同样/d 会/v 增加/v 查询/v 较/d 大/a 空闲/n 块/q 的/ude1 时间/n 。/wj 反之/c ，/wd 如果/c 每/rz 次分配/n 从/p     图/n 8．6/m 某/rz 系统/n 的/ude1 可/c 利用/v 空间/n 表/n 
(/wkz a/x )/wky 初始状态/n ；/wf (/wkz b/x )/wky 运行/vi 若干/m 时间/n 后/f 的/ude1 状态/n ；/wf (/wkz c/x )/wky 进行/vx 再/d 分配/v 后/f 的/ude1 状态/n 。/wj 
不同/a 的/ude1 结点/n 开始/v 进行/vx 查找/vn ，/wd 使/v 分配/vn 后/f 剩余/v 的/ude1 小/a 块/q 均匀/a 地/ude2 分布/vi 在/p 链/ng 表/n 中/f ，/wd 则/c 可/v 避免/v 上述/b 弊病/n 。/wj 实现/v 的/ude1 方法/n 是/vshi ，/wd 在/p 每/rz 次分配/n 之后/f ，/wd 令/v 指针/n pav/x 指向/v 刚/d 进行/vx 过/uguo 分配/vn 的/ude1 结点/n 的/ude1 后/f 继/vg 结点/n 。/wj 
    例如/v ，/wd 图/n 8．6/m (/wkz b/x )/wky 所/usuo 示/vg 可/v 利用/v 空间/n 表/vg 在/p 进行/vx 分配/vn 之后/f 的/ude1 状态/n 如/v 图/n 8．6/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 
    算法/n 8．1/m 是/vshi 上述/b 分配策略/n 的/ude1 算法/n 描述/vn 。/wj   ‘/wyz 
    sP/x 蛳/x e/x  AllocBoundTag/x (/wkz space/x &/n pav/x ，/wd Ant/x  n/x )/wky {/n 
    ∥/w 若/c 有/vyou 不/d 小于/v n/x 的/ude1 空闲/n 块/q ，/wd 则/c 分配相应/n 的/ude1 存储/vn 块/q ，/wd 并/cc 返回/v 其/rz 首/m 地址/n ；/wf 否则/c 返回/v     ∥/w NULL/x 。/wj 若/c 分配/v 后/f 可/v 利用/v 空间/n 表/n 不/d 空/a ，/wd 则/d pay/x 指向/v 表/n 中/f 刚/d 分配/v 过/uguo 的/ude1 结点/n 的/ude1 后/f 继/vg     n/x 锗/n 蒹/n 
    for/x (/wkz p=pav/x ；/wf p/x ＆/n ＆/n p/x ～/ws >/n size/x </n n/x ＆/n ＆/n p/x 一/m >/n rlink/x !/wt ：/wp pay/x ；/wf 
    p=p/x 一/m >/n rlink/x )/wky ；/wf     ∥/w 查找/v 不/d 小于/v n/x 的/ude1 空闲/n 块/q 
    if/x (/wkz !/wt p/x  1I/x  p/x 一/m >/n size/x </n n/x )/wky return/x  NULL/x ；/wf     ∥/w 找/v 不/d 到/v ，/wd 返回/v 空/a 指针/n 
    el/x 的/ude1 {/n     ∥/w p/x 指向/v 找到/v 的/ude1 空闲/n 块/q 
    f/x 。/wj FootLoc/x (/wkz p/x )/wky ；/wf     ∥/w 指向/v 底部/f 
    pay/x 。/wj p/x 一/m >/n rlink/x ；/wf     ∥/w pay/x 指向/v */n p/x 结点/n 的/ude1 后/f 继/vg 结点/n 。/wj 
    if/x (/wkz p/x 一/m >/n size―n/x </n =e/x )/wky {/n     ∥/w 整/m 块分配/n ，/wd 不/d 保留/v </n =e/x 的/ude1 剩余/vn 量/n 
    if/x (/wkz paV=p/x )/wky pay=/x ~/n PULL/x ；/wf     ∥/w 可/v 利用/v 空间/n 表/vg 变为/v 空/a 表/n 
    else/x {/n     ∥/w 在/p 表/n 中/f 删除/v 分配/v 的/ude1 结点/n 
    pay/x 一/m >/n llink=p/x 一/m >/n llink/x ；/wf   p/x 一/m >/n llink/x 一/m >/n rlink=pav/x ；/wf 
    }/n ∥/w if/x 
∥/w 修改/v 分配/v 结点/n 的/ude1 头部/n 和/cc 底部/f 标志/v 
田/n L/x 
：/wp 
明/ag 
t/x 
>/n 
一/m 
f/x 
=/m 
∞/m 
七/m 
>/n 
一/m   f/x 
p/x 肚/ng 
    O/x 
    O/x 
    2/m 
else/x {/n 
  f/x 一/m >/n tag=1：/x 
  p/x 一/m >/n size/x 一/m =n/x ；/wf 
  f=Footr/x ~/n c/x (/wkz p/x )/wky ：/wp 
    f/x 一/m >/n tag=0：/x 
    p/x ；/wf f+1/x ；/wf 
    p/x 一/m >/n tag=1/x ；/wf 
    l/x 
  return/x  p/x ；/wf 
  }/n ∥/w else/x 
}/n ∥/w AuocBoundTag/x 
f/x 一/m >/n uplink=p/x ；/wf 
∥/w 分配/v 该/rz 块/q 的/ude1 后/f n/x 个/q 宇/ng 
∥/w 修改/v 分配/v 块/q 的/ude1 底部/f 标志/v 
∥/w 置/v 剩余/v 块/q 大/a 小/a 
∥/w 指向/v 剩余/v 块/q 底部/f 
∥/w 设置/v 剩余/v 块/q 底部/f 
∥/w 指向/v 分配/v 块/q 头部/n 
∥/w 设置/v 分配/v 块/q 头部/n 
∥/w 返回/v 分配/v 块首/n 地址/n 
算法/n 8．1/m 
    8．3．3/m 回收/vn 算法/n 
    一旦/c 用户/n 释放/v 占用/v 块/q ，/wd 系统/ad 需/v 立即/d 回收/v 以/p 备/v 新/a 的/ude1 请求/n 产生/v 时/ng 进行/vx 再/d 分配/v 。/wj 为了/p 使/v 物理/n 地址/n 毗邻/vi 的/ude1 空闲/n 块/q 结合/v 成/v 一个/mq 尽可能/d 大/a 的/ude1 结点/n ，/wd 则/c 首先/d 需要/v 检查/vn 刚/d 释放/v 的/ude1 占用/vn 块/q 的/ude1 左/a 、/wn 右/f 紧邻/v 是否/v 为/p 空闲/n 块/q 。/wj 由于/p 本/rz 系统/n 在/p 每个/r 内存/n 区/n (/wkz 无论是/c 占用/v 块/q 或/c 空闲/v 块/q )/wky 的/ude1 边界/n 上/f 都/d 设有/v 标志值/n ，/wd 则/c 很/d 容易/a 辨/vg 明/ag 这/rzv 一点/mq 。/wj 
    假设用户/n 释放/v 的/ude1 内存/n 区/n 的/ude1 头部/n 地址/n 为/v p/x ，/wd 则/c 与/p 其/rz 低/a 地址/n 紧邻/n 的/ude1 内存/n 区/n 的/ude1 底部/f 地址/n 为/v p/x 一/m 1/m ；/wf 与/p 其/rz 高/a 地址/n 紧邻/n 的/ude1 内存/n 区/n 的/ude1 头部/n 地址/n 为/v p+p/x >/n size/x ，/wd 它们/rr 中/f 的/ude1 标志/n 域/ng 就/d 表明/v 了/ule 这/rzv 两/m 个/q 邻区/n 的/ude1 使用/vn 状况/n ：/wp 若/v (/wkz p1/x )/wky >/n tag：O/x ；/wf 则/c 表明/v 其/rz 左/a 邻/ng 为/p 空闲/n 块/q ，/wd 若/c (/wkz p+p/x >/n size/x )/wky >/n 。/wj tag=0/x ；/wf 则/c 表明/v 其/rz 右/f 邻/vg 为/p 空闲/n 块/q 。/wj 
    若/c 释放/v 块/q 的/ude1 左/a 、/wn 右/f 邻区/n 均/d 为/v 占用/v 块/q ，/wd 则/c 处理/v 最为/d 简单/a ，/wd 只要/c 将/p 此/rzs 新/a 的/ude1 空闲/n 块/q 作为/v 一个/mq 结点/n 插入/v 到/v 可/v 利用/v 空闲/n 表/n 中/f 即可/v ；/wf 若/c 只有/d 左/a 邻区/n 是/vshi 空闲/n 块/q ，/wd 则/c 应/v 与/p 左/f 邻区/n 合并/v 成/v 一个/mq 结点/n ；/wf 若/c 只有/c 右/f 邻区/n 是/vshi 空闲/n 块/q ，/wd 则/c 应/v 与/p 右/f 邻区/n 合并/v 成/v 一个/mq 结点/n ；/wf 若/c 左/a 、/wn 右/f 邻区/n 都/d 是/vshi 空闲/n 块/q ，/wd 则/c 应/v 将/p 三/m 块/q 合/v 起来/vf 成为/v 一个/mq 结点/n 留/v 在/p 可/v 利用/v 空间/n 表/n 中/f ，/wd 下面/f 我们/rr 就/d 这/rzv 四/m 种/q 情况/n 分别/d 描述/v 它们/rr 的/ude1 算法/n ：/wp 
    (/wkz 1/m )/wky 释放/v 块/q 的/ude1 左/a 、/wn 右/f 邻区/n 均/d 为/v 占用/v 块/q 。/wj 此时/r 只要/c 作/v 简单/ad 插入/v 即可/v 。/wj 由于/p 边界/n 标识/n 法/n 在/p 按/p 首/m 次/qv 拟合/n 进行/vx 分配/vn 时/ng 对/p 可/v 利用/v 空间/n 表/n 的/ude1 结构/n 没有/v 任何/rz 要求/n ，/wd 则/d 新/a 的/ude1 空闲/n 块/q 插入/v 在/p 表/n 中/f 任何/rz 位置/n 均/d 可/v 。/wj 简单/a 的/ude1 做法/n 就/d 是/vshi 插入/v 在/p pay/x 指针/n 所/usuo 指/v 结点/n 之前/f (/wkz 或/c 之后/f )/wky ，/wd 可/c 描述/v 如下/vi ：/wp     p/x >/n ’/wyy tag=0/x ；/wf   FootLoc/x (/wkz p/x )/wky >/n uplink：p/x ；/wf   Foo/x ~/n oc/x (/wkz p/x )/wky >/n tag=0/x ；/wf 
    if/x (/wkz !/wt pav/x )/wky pav=p/x >/n llink=p/x >/n rlink=p/x ；/wf 
    else/x {/n q=pay/x >/n llink/x ；/wf 
    p/x >/n rlink=pay/x ；/wf   p/x 一/m >/n llink=q/x ；/wf 
    q/x >/n rlink=payllink：p/x ；/wf 
    pay=p/x ；/wf     ∥/w 令/v 刚/d 释放/v 的/ude1 结点/n 为/v 下/f 次分配/n 时/ng 的/ude1 最先/d 查询/v 的/ude1 结点/n 
    }/n 
    (/wkz 2/m )/wky 释放/v 块/q 的/ude1 左/a 邻区/n 为/p 空闲/n 块/q ，/wd 而/cc 右/f 邻区/n 为/p 占用/v 块/q 。/wj 由于/c 释放/v 块/q 的/ude1 头部/n 和/cc 左/a 邻/vg 空闲/n 块/q 的/ude1 底部/f 毗邻/vi ，/wd 因此/c 只/d 要/v 改变/v 左/f 邻/vg 空闲/n 块/q 的/ude1 结点/n ：/wp 增加/v 结点/n 的/ude1 size/x 域/n 的/ude1 值/n 且/c 重新/d 设置/v 结点/n 的/ude1 底部/f 即可/v 。/wj 描述/v 如下/vi ：/wp 
∥/w 释放/v 块/q 的/ude1 大小/n 
    ・/w 201・/m 
    s：/x (/wkz p1/x )/wky >/n uplink/x ；/wf     ∥/w 左/f 邻/vg 空闲/n 块/q 的/ude1 头部/n 地址/n 
    s/x >/n size+=n/x ；/wf     ∥/w 设置/v 新/a 的/ude1 空闲/n 块/q 大/a 小/a 
    f=p+n1/x ；/wf   f/x >/n uplink=s/x ；/wf   f/x >/n tag=0/x ；/wf     ∥/w 设置/v 新/a 的/ude1 空闲/n 块/q 底部/f 
    (/wkz 3/m )/wky 释放/v 块/q 的/ude1 右/f 邻区/n 为/p 空闲/n 块/q ，/wd 而/cc 左/a 邻区/n 为/p 占用/v 块/q 。/wj 由于/c 释放/v 块/q 的/ude1 底部/f 和/cc 右/f 邻/vg 空闲/n 块/q 的/ude1 头部/n 毗邻/vi ，/wd 因此/c ，/wd 当/p 表/n 中/f 结点/n 由/p 原来/b 的/ude1 右/f 邻/vg 空闲/n 块/q 变成/v 合并/v 后/f 的/ude1 大/a 空闲/n 块/q 时/ng ，/wd 结点/n 的/ude1 底部/f 位置/n 不/d 变/v ，/wd 但/c 头部/n 要/v 变/v ，/wd 由此/d ，/wd 链/ng 表/n 中/f 的/ude1 指针/n 也/d 要/v 变/v 。/wj 描述/v 如下/vi ：/wp 
t=p/x ’/wyy p/x 一/m >/n size/x ；/wf     ∥/w 右/f 邻/vg 空闲/n 块/q 的/ude1 头部/n 地址/n 
p/x 一/m >/n tag=0/x ；/wf     ∥/w p/x 为/p 合并/v 后/f 的/ude1 结点/n 头部/n 地址/n 
q=t/x 一/m >/n ui/x 呔/n ；/wf     ∥/w q/x 为/p */n t/x 结点/n 在/p 可/v 利用/v 空间/n 表/n 中/f 的/ude1 前驱/n 结点/n 的/ude1 头部/n 地址/n 
p/x 一/m >/n uin/x 】/wky c：q/x ；/wf   q/x 一/m >/n rlink=p/x ；/wf     ∥/w q/x 指向/v ”/wyy p/x 的/ude1 前驱/n 
q1=t/x 一/m >/n rlink/x ；/wf     ∥/w q1/x 为/p */n t/x 结点/n 在/p 可/v 利用/v 空间/n 表/n 中/f 的/ude1 后/f 继/vg 结点/n 的/ude1 头部/n 地址/n 
p/x 一/m >/n rlink=q1/x ；/wf   q1/x 一/m >/n llink=p/x ；/wf     ∥/w ql/x 指向/v 。/wj p/x 的/ude1 后/f 继/vg 
p/x 一/m >/n size+=t/x 一/m >/n size/x ；/wf     ∥/w 新/a 的/ude1 空闲/n 块/q 的/ude1 大小/n 
FootLoc/x (/wkz t/x )/wky 一/m >/n uplink=p/x ；/wf     ∥/w 底部/f 指针/n 指向/v 新/a 结点/n 的/ude1 头部/n 
    图/n 8．7/m   回收/v 存储/v 块/q 后/f 的/ude1 可/c 利用/v 空间/n 表/n 
(/wkz a/x )/wky 释放/v 的/ude1 存储/vn 块/q ；/wf     (/wkz b/x )/wky 左/f 邻区/n 是/vshi 空闲/n 块/q 的/ude1 情况/n ；/wf 
(/wkz c/x )/wky 右/f 邻区/n 是/vshi 空闲/n 块/q 的/ude1 情况/n ；/wf (/wkz d/x )/wky 左/f 、/wn 右/f 邻区/n 均/d 是/vshi 空闲/n 块/q 的/ude1 情况/n 。/wj 
    (/wkz 4/m )/wky 释放/v 块/q 的/ude1 左/a 、/wn 右/f 邻区/n 均/d 为/v 空闲/n 块/q 。/wj 为/p 使/v 三/m 个/q 空闲/n 块连接/n 在/p 一起/s 成为/v 一个/mq 大/a 结点/n 留/v 在/p 可/v 利用/v 空间/n 表/n 中/f ，/wd 只要/c 增加/v 左/f 邻/vg 空闲/n 块/q 的/ude1 space/x 容量/n ，/wd 同时/c 在/p 链/ng 表/n 中/f 删去/v 右/f 邻/vg 空闲/n 块/q 结点/n 即可/v 。/wj 所/usuo 作/v 改变/v 可/v 描述/v 如下/vi ：/wp 
n=p/x >/n size/x 
・/w 202・/m 
∥/w 释放/v 块/q 的/ude1 大小/n 
s=/x (/wkz p1/x )/wky >/n uplink/x ；/wf 
t=p+p/x >/n size/x ；/wf 
s/x >/n size+：n+t/x >/n size：/x 
q=t/x >/n llink/x ；/wf     q1=t/x >/n rlink/x ；/wf 
q/x >/n rlink：q1/x ；/wf   q1/x >/n llink：q/x ；/wf 
FootLoc/x (/wkz t/x )/wky >/n upliI=s/x ；/wf 
∥/w 指向/v 左/f 邻/v 块/q 
∥/w 指向/v 右/f 邻/v 块/q 
∥/w 设置/v 新/a 结点/n 的/ude1 大小/n 
∥/w q/x !/wt =ql/x 
∥/w 删去/v 右/f 邻/vg 空闲/n 块/q 结点/n 
∥/w 新/d 结点/n 底部/f 指针/n 指向/v 其/rz 头部/n 
    总之/c ，/wd 边界/n 标识/n 法/n 由于/c 在/p 每个/r 结点/n 的/ude1 头部/n 和/cc 底部/f 设立/v 了/ule 标识/n 域/ng ，/wd 使得/vi 在/p 回收/v 用户/n 释放/v 的/ude1 内存/n 块/q 时/ng ，/wd 很/d 容易/ad 判别/v 与/p 它/rr 毗邻/vi 的/ude1 内存/n 区/n 是否/v 是/vshi 空闲/n 块/q ，/wd 且/c 不/d 需要/v 查询/v 整个/b 可/v 利用/v 空间/n 表/n 便/d 能/v 找到/v 毗邻/vi 的/ude1 空闲/n 块/q 与/p 其/rz 合并/v 之/rz ；/wf 再者/c ，/wd 由于/c 可/v 利用/v 空间/n 表/n 上/f 结点/n 既/c 不/d 需/v 依/v 结点/n 大小/n 有序/a ，/wd 也/d 不/d 需/v 依/v 结点/n 地址/n 有序/a ，/wd 则/c 释放/v 块/q 插入/v 时/ng 也/d 不/d 需/v 查找/v 链/ng 表/n 。/wj 由此/d ，/wd 不管/c 是/vshi 哪/ry 一/m 种/q 情况/n ，/wd 回收/v 空闲/n 块/q 的/ude1 时间/n 都/d 是/vshi 个/q 常量/n ，/wd 和/cc 可/v 利用/v 空间/n 表/n 的/ude1 大小/n 无关/v 。/wj 唯一/b 的/ude1 缺点/n 是/vshi 增加/v 了/ule 结点/n 底部/f 所/usuo 占/v 的/ude1 存储量/n 。/wj 
    在/p 上述/b 后/f 三/m 种/q 情况/n 下/f ，/wd 可/c 利用/v 空间/n 表/n 的/ude1 变化/vn 如/v 图/n 8．7/m 所/usuo 示/vg 。/wj 
8．4/m 伙伴/n 系统/n 
    伙伴/n 系统/n (/wkz Imddy/x  system/x )/wky 是/vshi 操作系统/nl 中/f 用/v 到/v 的/ude1 另/rz 一/m 种/q 动态存储/n 管理方法/n 。/wj 它/rr 和/cc 边界/n 标识/n 法/b 类似/a ，/wd 在/p 用户/n 提出/v 申请/v 时/ng ，/wd 分配/v 一/m 块/q 大/a 小/a “/wyz 恰当/a ”/wyy 的/ude1 内存/n 区/n 给/p 用户/n ；/wf 反之/c ，/wd 在/p 用户/n 释放/v 内存/n 区/n 时/ng 即/v 回收/vn 。/wj 所/usuo 不同/a 的/ude1 是/vshi ：/wp 在/p 伙伴/n 系统/n 中/f ，/wd 无论是/c 占用/v 块/q 或/c 空闲/v 块/q ，/wd 其/rz 大/a 小/a 均/d 为/v 2/m 的/ude1 走/v 次幂/n (/wkz 志/n 为/p 某个/rz 正/b 整数/n )/wky 。/wj 例如/v ；/wf 当/p 用户/n 申请/v 咒/v 个/q 字/n 的/ude1 内存/n 区/n 时/ng ，/wd 分配/v 的/ude1 占用/vn 块/q 大/a 小/a 为/p 2/m ‘/wyz 个/q 字/n (/wkz 2/m 卜/vg ’/wyy </n n≤2/x ‘/wyz )/wky 。/wj 由此/d ，/wd 在/p 可/v 利用/v 空间/n 表/n 中/f 的/ude1 空闲/n 块/q 大/a 小/a 也/d 只能/v 是/vshi 2/m 的/ude1 n/x 次幂/n 。/wj 若/c 总/b 的/ude1 可/c 利用/v 内存/n 容量/n 为/p 2/m ”/wyy 个/q 字/n ，/wd 则/c 空闲/v 块/q 的/ude1 大小/n 只/d 可能/v 为/p 20/m 、/wn 2/m ’/wyy 、/wn …/ws 、/wn 2/m ”/wyy 。/wj 下面/f 我们/rr 仍/d 和/cc 上/vf 节/n 一样/uyy ，/wd 分/qt 三/m 个/q 问题/n 来/vf 介绍/v 这个/rz 系统/n 。/wj 
8．4．1/m 可/v 利用/v 空间/n 表/n 的/ude1 结构/n 
    假设/v 系统/n 的/ude1 可/c 利用/v 内存/n 空间容量/n 为/p 2/m ”/wyy 个/q 字/n (/wkz 地址/n 从/p 0/m 到/v 2/m ”/wyy 一/m 1/m )/wky ，/wd 则/c 在/p 开始运行/n 时/ng ，/wd 整个/b 内存/n 区/n 是/vshi 一个/mq 大/a 小/a 为/p 2/m ”/wyy 的/ude1 空闲/n 块/q ，/wd 在/p 运行/vi 了/ule 一/m 段时间/n 之后/f ，/wd 被/pbei 分隔/vi 成/v 若干/m 占用/v 块/q 和/cc 空闲/n 块/q 。/wj 为了/p 再/d 分配/v 时/ng 查找方便/n 起见/u ，/wd 我们/rr 将/p 所有/b 大小/n 相同/a 的/ude1 空闲/n 块/q 建/v 于/p 一/m 张/q 子/ng 表/n 中/f 。/wj 每个/r 子/ng 表/n 是/vshi 一个/mq 双重/b 链/ng 表/n ，/wd 这样/rzv 的/ude1 链/ng 表/n 可能/v 有/vyou m+1/x 个/q ，/wd 将/d 这/rzv 优/ag +1/m 个/q 表头/n 指针/n 用/p 向量/n 结构/n 组织/v 成/v 一个/mq 表/n ，/wd 这/rzv 就是/v 伙伴/n 系统/n 中/f 的/ude1 可/c 利用/v 空间/n 表/n 。/wj 
    双重/b 链/ng 表/n 中/f 的/ude1 结点/n 结构/n 如/v 图/n 8．8/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 其中/rz head/x 为/p 结点/n 头部/n ，/wd 是/vshi 一个/mq 由/p 四/m 个/q 域/ng 组成/v 的/ude1 记录/n ，/wd 其中/rz 的/ude1 11ink/x 域/n 和/cc rlink/x 域/ng 分别/d 指向/v 同一/b 链/ng 表/n 中/f 的/ude1 前驱/n 和/cc 后/f 继/vg 结点/n ；/wf tag/x 域/ng 为/v 值/v 取/v “/wyz 0/m ”/wyy “/wyz 1/m ”/wyy 的/ude1 标志/n 域/ng ，/wd kval/x 域/n 的/ude1 值/n 为/p 2/m 的/ude1 幂/n 次/qv 忌/v ；/wf space/x 是/vshi 一个/mq 大/a 小/a 为/p 2/m ‘/wyz 一/m 1/m 个/q 字/n 的/ude1 连续/a 内存/n 空间/n (/wkz 和/cc 前面/f 类似/v ，/wd 仍/d 假设/v head/x 占/v 一个/mq 字/n 的/ude1 空间/n )/wky 。/wj 
可/v 利用/v 空间/n 表/n 的/ude1 初始状态/n 如/v 图/n 8―8/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 其中/rz 优/ag 个子/n 表/n 都/d 为/v 空/a 表/n ，/wd 只/d 有/vyou 大小/n 为/v 2m/x 的/ude1 链/ng 表/n 中/f 有/vyou 一个/mq 结点/n ，/wd 即/v 整个/b 存储空间/n 。/wj 表头/n 向量/n 的/ude1 每个/r 分量/n 由/p 两/m 个/q 域/ng 组成/v ，/wd 除/p 指针/n 域/ng 外/f 另/d 设/v nodesize/x 域/ng 表示/v 该/rz 链/ng 表/n 中/f 空闲/v 块/q 的/ude1 大小/n ，/wd 以便/d 分配/v 时/ng 查找方便/n 。/wj 此/rzs 可/v 利用/v 空间/n 表/n 的/ude1 数据/n 类型/n ，/wd 示意/v 描述/v 如下/vi ：/wp 
#/n define/x  m/x  16/m 
∥/w 可/v 利用/v 空间/n 总/b 容量/n 64K/x 字/n 的/ude1 2/m 的/ude1 幂/n 次/qv ，/wd 子表/nr2 的/ude1 个/q 数/n 为/v m+1/x 
    ・/w 203・/m 
typed・f/x  struct/x '/n 唧/v IlD/x {/n 
  WORD/x   */n llink/x ；/wf     ∥/w 指向/v 前驱/n 结点/n 
  int/x  tag/x ；/wf     ∥/w 块/q 标志/n ，/wd 0：/m 空闲/n ，/wd 1：/m 占用/v 。/wj 
  int/x     kval/x ；/wf     ∥/w 块/q 大/a 小/a ，/wd 值/v 为/p 2/m 的/ude1 幂/n 次/qv k/x 
  WORD/x     */n rlink/x ；/wf     ∥/w 头部/n 域/ng 。/wj 指向/v 后/f 继/vg 结点/n 
  ~/n herType/x  other/x ；/wf     ∥/w 字/n 的/ude1 其它/rz 部分/n 
}/n WORD/x ，/wd head/x ；/wf     ∥/w WORD：/x 内存/n 字/n 类型/n ，/wd 结点/n 的/ude1 第一/m 个/q 字/n 也/d 称/v 为/v head/x 
tlqpe/x ~/n f/x  8．zllctH/x _/n ．/w d/x 奠/vg od・/x {/n 
  int/x   nodesize/x ；/wf     ∥/w 该/rz 链/ng 表/n 的/ude1 空闲/n 块/q 的/ude1 大小/n 
  WORD/x   */n first/x ；/wf     ∥/w 该/rz 链/ng 表/n 的/ude1 表头/n 指针/n 
IFreeList/x [/wkz m+1/x ]/wky ；/wf     ∥/w 表头/n 向量/n 类型/n 
    图/n 8．8/m 伙伴/n 系统/n 中/f 的/ude1 可/c 利用/v 空间/n 表/n 
(/wkz a/x )/wky 空闲/n 块/q 的/ude1 结点/n 结构/n ；/wf (/wkz b/x )/wky 表/n 的/ude1 初始状态/n ；/wf (/wkz c/x )/wky 分配/v 前/f 的/ude1 表/n ；/wf (/wkz d/x 》/wky 分配/v 后/f 的/ude1 表/n 。/wj 
8．4．2/m 分配算法/n 
    当/p 用户/n 提出/v 大小/n 为/p 咒/v 的/ude1 内存/n 请求/v 时/ng ，/wd 首先/c 在/p 可/v 利用/v 表/n 上/f 寻找/v 结点/n 大小/n 与/p n/x 相/d 匹配/vi 的/ude1 子/ng 表/n ，/wd 若/c 此/rzs 子/ng 表/vg 非空/n ，/wd 则/c 将/d 子/ng 表/n 中/f 任意/d 一个/mq 结点/n 分配/v 之/uzhi 即可/v ；/wf 若/c 此/rzs 子/ng 表/n 为/v 空/ng ，/wd 则/c 需/v 从/p 结点/n 更/d 大/a 的/ude1 非/b 空子/n 表/n 中/f 去/vf 查找/v ，/wd 直至/v 找到/v 一个/mq 空闲/n 块/q ，/wd 则/c 将/p 其中/rz 一部分/m 分配给用户/n ，/wd 而/cc 将/d 剩余/v 部分/n 插入/v 相应/vi 的/ude1 子/ng 表/n 中/f 。/wj 
    假设/n 分配/vn 前/f 的/ude1 可/c 利用/v 空间/n 表/n 的/ude1 状态/n 如/v 图/n 8．8/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 若/v 2k/x 一/m 。/wj </n ，/wd z≤2/x ‘/wyz 一/m 1/m ，/wd 又/d 第/m k+1/x 个子/n 表/n 不/d 空/a ，/wd 则/c 只/d 要/v 删除/v 此/rzs 链/ng 表/n 中/f 第一/m 个/q 结点/n 并/d 分配给用户/n 即可/v ；/wf 若/v 
2/m 卜/vg 。/wj </n ”/wyy ≤2/m 。/wj I/x ，/wd 此时/r 由于/p 结点/n 大小/n 为/p 2/m 。/wj 的/ude1 子/ng 表/n 为/v 空/ng ，/wd 则/c 需/v 从/p 结点/n 大小/n 为/v 2k/x 的/ude1 子/ng 表/n   ・/w 204・/m 
中/f 取出/v 一/m 块/q ，/wd 将/p 其中/rz 一半/m 分配给用户/n ，/wd 测/v 余/m 的/ude1 一半/m 作为/v     p/x 一个/mq 新/a 结点/n 插入/v 在/p 结点/n 大小/n 为/p 2/m 卜/vg ’/wyy 的/ude1 子/ng 表/n 中/f ，/wd 如/v 图/n 8/m  8/m   
(/wkz d/x )/wky 所/usuo 示/vg 。/wj ．/w 若/v 2/m 。/wj 0/m </n ”/wyy ≤2/m 。/wj 1/m (/wkz z/x 为/p 小于/v ^/n 的/ude1 整/m   卅/m 步/qv 
数/m )/wky ，/wd 并/cc H/x 所有/b 结点/n 小于/v 2/m ‘/wyz 的/ude1 子/ng 裘均/nr 为/v 空/ng ，/wd 则/c 同样/d 需/v 从/p   结点/n 大小/n 为/p 20/m 的/ude1 子/ng 表/n 中/f 取出/v 一/m 块/q ，/wd 其中/rz 2/m “/wyz 。/wj 的/ude1 一/m 小/a 部分/n 分配给用户/n ，/wd 剩余/vn 部分/n 分割成若干/n 个/q 结点/n 分别/d 插入/v 大小/n 为/p 2/m ’/wyy 、/wn 2/m ‘/wyz 、/wn 、/wn 2/m ‘/wyz 的/ude1 中/f 。/wj 假设/v 从/p 第/m }/n 1/m 个子/n 表/n 中/f 删除/v 的/ude1 结点/n 的/ude1 起始/vn 地址/n 为/v p/x ，/wd 且/c 假设/v 分配给用户/n 的/ude1 r/x 用/v 块/q 的/ude1 初始/b 地址/n 为/v p/x (/wkz 占用/v 块/q 为/p 该/rz 空闲/n 块/q 的/ude1 低/a 地址/n 区/n )/wky ，/wd 则/c 插入/v 上述/b 子/ng 表/n 的/ude1 新/a 结点/n 们/k 起始/v 地址/n 分划/n 为/v p/x }/n 2/m ‘/wyz 、/wn p/x ’/wyy 2/m …/ws 、/wn   、/wn p+2/x ‘/wyz ，/wd 如/v 右/f 圈/v 所/usuo 示/vg (/wkz 翻/v 中/f i=3/x )/wky 。/wj 
    FmiJ=/x 『/wyz ]/wky 语言/n ：/wp 
WORD/x  b/x */n A11/x 。/wj cBuday/x (/wkz FreeList/x ＆/n avail/x ，/wd 打/v E/x  n/x )/wky 1/m 
  ∥/w avail/x [/wkz 0/m  m/x ]/wky 为/p 可/v 利用/v 空/ng 问/v 袁/nr1 ，/wd n/x 为/p 申请/v 分配/v 盟/ng ．/w 若/c 有/vyou 不/d 小于/v n/x 的/ude1 空/ng 闭/v 块/q ，/wd 
  ∥/w 则/c 分配/v 的/ude1 存储/vn 块/q ，/wd 并/cc 返回/v 其/rz 首/m 地址/n ；/wf 否则/c 退回/v 
  fo=/x (/wkz k=0/x ，/wd k/x </n =m/x ＆/n ＆/n (/wkz avail/x [/wkz k/x ]/wky nodesize/x </n n+1/x  l/x  J/x !/wt avail/x [/wkz k/x ]/wky first/x )/wky ；/wf 
    l/x }/n k/x )/wky ，/wd     ∥/w 查找/v 满足/v 分配/vn 要求/n 的/ude1 于/p 采/v 
  if/x (/wkz k/x >/n m/x )/wky ret/x ~/n n/x  NULL/x ；/wf     ∥/w 分配/v 失败/vi ，/wd 返回/v Nul/x 』/wyy l/x 
  else/x {/n     ∥/w 进行/vx 分配/vn 
    pa=avail/x [/wkz k/x ]/wky first/x ；/wf     ∥/w 指向/v 可/v 分/qt 配子/n 表/n 的/ude1 第一/m 个/q 结点/n 
    pre=pa/x 一/m >/n 111nk/x …/ws …/ws pa/x >/n rlink/x ；/wf ∥/w 分/v 目/ng 4/m 指向/v 前驱/n 和/cc 后/f 继/vg 
    1f/x (/wkz pa/x …/ws uc/x )/wky avail/x [/wkz k/x ]/wky first=NULL/x ；/wf   ∥/w 分配/v 后/f 该/rz 子/ng 表/n 变成/v 空/a 表/n 
    else/x  f/x     ∥/w 从/p 子/ng 表/n 删去/v */n pa/x 结点/n 
   ∥/w 将/d 剩余/v 块/q 插/v 人/n 相应/vi 于/p 表/n 
8/m  4/m  3/m 回收/vn 算法/n 
算法/n 8/m  2/m 
  用户/n 释放/v 不/d 冉/ng 使用/v 的/ude1 占用/vn 用/v 块/q 时/ng ，/wd 系统/ad 需/v 将/p 这/rzv 新/a 的/ude1 空闲/n 块/q 插/v 人/n 到/v 可/v 利用/v 空间/n 表/n 中/f 去/vf 。/wj 这里/rzs ,/wd 同样/d 有/vyou 一个/mq 地址/n 相邻/vi 的/ude1 空闲/n 块/q 归并/vi 成/v 大/a 块/q 的/ude1 问题/n 。/wj 但是/c 在/p 伙伴/n 系统/n 中/f 仅/d 考虑/v 互/d 为/v “/wyz 伙伴/n ”/wyy 的/ude1 删/v 个/q 空闲/n 块/q 的/ude1 归并/vi 。/wj 
  何谓/v ”/wyy 伙伴/n ”/wyy 如前所述/vl ，/wd 在/p 分配/v 时/ng 经常/d 需要/v 将/d 一个/mq 大/a 的/ude1 空闲/n 块/q 分裂/vi 成/v 两/m 个/q 大/a 小/a 相等/vi 的/ude1 存储区/n ，/wd 这/rzv 两/m 个/q 由/p 同/p 一/m 大/a 块/q 分裂/vi 出来/vf 的/ude1 小/a 块/q 就/d 称/v 之/uzhi “/wyz 互为/v 伙伴/n ”/wyy 。/wj 侧/vd 如/v ：/wp 假设/v p/x 为/p 大/a 小/a 为/p 2/m ‘/wyz 空闲/n 块/q 的/ude1 初始/b 地址/n ：/wp MOD/x  2/m “/wyz 。/wj ’/wyy =0/m ，/wd 则/c 初始/b 地址/n 为/v p/x 和/cc pI/x  2/m ‘/wyz 的/ude1 两/m 个/q 空闲/n 块/q 互为/v 伙伴/n 。/wj 在/p 伙伴/n 系统/n -/wp …/ws m/x 收/v 空闲/n 块/q 时/ng ，/wd 只/d 当/v 其/rz 伙伴/n 为/p 空闲/n 块/q 时/ng 才/c ¨/n 并/cc 成/v 大/a 块/q 。/wj 也就是说/vl ，/wd 若/c 有/vyou 两/m 个/q 空闲/n 块/q ，/wd 即使/c 大小/n 相同/a 且/c 地址/n 相邻/vi ，/wd 但/c 不/d 是/vshi 由/p 同/p 一/m 大/a 块/q 分裂/vi 出来/vf 的/ude1 ，/wd 也/d 不/d 归/v 并/cc 在/p 一起/s 。/wj 例如/v 图/n 中/f 的/ude1 A/x 、/wn B/x 两/m 个/q 空闲/n 块/q 不/d 是/vshi 伙伴/n 。/wj 
    由此/d ，/wd 在/p 回收/v 空闲/n 块/q 时/ng ，/wd 应/v 首先/d 判别/v 其/rz 伙伴/n 是否/v 为/p 空闲/n 块/q ，/wd 若/v 否/y ，/wd 则/c 只/d 要/v 将/d 释放/v 的/ude1 空闲/n 块/q 简单/ad 插入/v 在/p 相应/vi 子/ng 表/n 中/f 即可/v ；/wf 若/c 是/vshi ，/wd 则/c 需/v 在/p 相应/vi 子/ng 表/n 中/f 找到/v 其/rz 伙伴/n 并/cc 删除/v 之/uzhi ，/wd 然后/c 再/d 判别/v 合并/v 后/f 的/ude1 空闲/n 块/q 的/ude1 伙伴/n 是否/v 是/vshi 空闲/n 块/q 。/wj 依/p 此重复/n ，/wd 直到/v 归并/vi 所得/n 空闲/n 块/q 的/ude1 伙伴/n 不/d 是/vshi 空闲/n 块/q 时/ng ，/wd 再/d 插入/v 到/v 相应/vi 的/ude1 子/ng 表/n 中/f 去/vf 。/wj 
    起始/vn 地址/n 为/v m/x ，/wd 大小/n 为/p 2/m ‘/wyz 的/ude1 内存/n 块/q ，/wd 其/rz 伙伴/n 块/q 的/ude1 起始/vn 地址/n 为/v ：/wp 
例如/v ，/wd 假设/v 整个/b 可/v 利用/v 内存/n 区/n 大小/n 为/p 2/m 如/v =1024/m (/wkz 地址/n 从/p 0/m 到/v 1023/m )/wky ，/wd 则/d 大/a 小/a 为/p 2/m 。/wj ，/wd 起始/v 地址/n 为/p 512/m 的/ude1 伙伴/n 块/q 的/ude1 起始/vn 地址/n 为/v ’/wyy 768/m ；/wf 大小/n 为/p 2/m ’/wyy ，/wd 起始/v 地址/n 为/p 384/m 的/ude1 伙伴/n 块/q 的/ude1 起始/vn 地址/n 为/v ./wj 
    整个/b 释放/vn 算法/n 在/p 此/rzs 不再/d 详细/ad 列出/v ，/wd 请/v 读者/n 自行/d 补充/v 。/wj 
    总之/c ，/wd 伙伴/n 系统/n 的/ude1 优点/n 是/vshi 算法/n 简单/a 、/wn 速度/n 快/a ；/wf 缺点/n 是/vshi 由于/p 只/d 归并/vi 伙伴/n 而/cc 容易/ad 产生/v 碎片/n 。/wj 
8．5/m 无用/vi 单元收集/n 
    以上/f 三/m 节/q 讨论/vn 的/ude1 问题/n 都/d 是/vshi 如何/ryv 利用/v 可/v 利用/v 空间/n 表/vg 来/vf 进行/vx 动态存储/n 管理/vn 。/wj 它/rr 的/ude1 特点/n 是/vshi ：/wp 在/p 用户/n 请求/v 存储/vn 时/ng 进行/vx 分配/vn ；/wf 在/p 用户/n 释放/v 存储/vn 时/ng 进行/vx 回收/vn ，/wd 即/v 系统/n 是/vshi 应/v 用户/n 的/ude1 需求/n 来/f 进行/vx 存储分配/n 和/cc 回收/vn 的/ude1 。/wj 因此/c ，/wd 在/p 这/rzv 类/q 存储管理/n 系统/n 中/f ，/wd 用户/n 必须/d 明确/ad 给/v 出/vf “/wyz 请求/n ”/wyy 和/cc “/wyz 释放/v ”/wyy 的/ude1 信息/n 。/wj 如/c 在/p 多用户分/n 时/ng 并发/v 的/ude1 操作系统/nl 中/f ，/wd 当/p 用户/n 程序/n 进入/v 系统/n 时/ng 即/d 请求/v 分配存储/n 区/n ；/wf 反之/c ，/wd 当/p 用户/n 程序执行/n 完毕/vi 退出/v 系统/n 时/ng 即/d 释放/v 所/usuo 占/v 存储/vn 。/wj 又/d 如/v ，/wd 在/p 使用/v c/x 语言/n 编写程序/n 时/ng ，/wd 用户/n 是/vshi 通过/p malloc/x 和/cc free/x 两/m 个/q 函数/n 来/vf 表示/v 请求/v 分配/vn 和/cc 释放/v 存储/vn 的/ude1 。/wj 但/c 有时/d 会/v 因为/p 用户/n 的/ude1 疏漏/n 或/c 结构/n 本身/rz 的/ude1 原因/n 致使/v 系统/n 在/p 不/d 恰当/a 的/ude1 时候/n 或/c 没有/v 进行/vx 回收/vn 而/cc 产生/v “/wyz 无用/vi 单元/n ”/wyy 或/c “/wyz 悬挂/v 访问/v ”/wyy 的/ude1 问题/n 。/wj 
    “/wyz 无用/vi 单元/n ”/wyy 是/vshi 指/v 那些/rz 用户/n 不再/d 使用/v 而/cc 系统/n 没有/d 回收/v 的/ude1 结构/n 和/cc 变量/n 。/wj 例如/v 下列/b c/x 程序段/n 
p：maltoe/x (/wkz size/x )/wky ；/wf 
p：NJI/x ~/n ；/wf 
执行/v 的/ude1 结果/n ，/wd 是/vshi 使/v 执行/v p=malloc/x (/wkz size/x )/wky 为/p 用户/n 分配/vn 的/ude1 结点/n 成为/v 无用/vi 单元/n ，/wd 无法/v 得到/v 利用/v ；/wf 而/cc 下列/b 程序段/n p/x 。/wj Ⅻ/m lloc/x (/wkz size/x )/wky ；/wf 
q=p/x ；/wf 
・/w 206・/m 
执行/v 的/ude1 结果/n 使/v 指针/n 变量/n q/x 悬空/vi ，/wd 如果/c 所/usuo 释放/v 的/ude1 结点/n 被/pbei 再/d 分配/v 而/cc 继续访问/n 指针/n q/x 所/usuo 指/v 结点/n ，/wd 则/c 称/v 这种/r 访问/v 为/v “/wyz 悬挂/v 访问/v ”/wyy ，/wd 并且/c 由此/d 引起/v 的/ude1 恶劣/a 后果/n 是/vshi 可想而知/vl 的/ude1 。/wj 
    另一方面/c ，/wd 由于/c 结构/n 本身/rz 的/ude1 某些/rz 特性/n ，/wd 也/d 会/v 产生/v 同上/vi 类似/a 问题/n 。/wj 
    例如/v 在/p 某/rz 用户/n 程序/n 中/f 有/vyou 三/m 个/q 广义/n 表/vg 结构/n ，/wd 如/v 图/n 8．9/m 所/usuo 示/vg ，/wd L/x ，/wd 、/wn L2/x 和/cc L3/x 分别/d 为/v 它们/rr 的/ude1 表头/n 指针/n ，/wd L4/x 是/vshi L/x ，/wd 和/cc k/x 共享/v 的/ude1 子/ng 表/n ，/wd b/x 本身/rz 又/d 为/v k/x 共享/v ，/wd 则/d L5/x 为/p 三/m 个/q 广义/n 表/n 所/usuo 共享/v 。/wj 
图/n 8．9/m 含有/v 共享/v 子/ng 表/n 的/ude1 广义/n 表/n 
在/p 这种/r 情况/n 下/f ，/wd 表/vg 结点/n 的/ude1 释放/vn 就/d 成为/v 一个/mq 问题/n 。/wj 假设/v 表/n L/x ，/wd 不再/d 使用/v ，/wd 而/cc 表/n k/x 和/cc L3/x 尚/d 在/p 使用/v ，/wd 若/c 释放/v 表/n L/x 】/wky ，/wd 即/d 自/p L/x 】/wky 指针/n 起/vf ，/wd 顺/v 链/ng 将/p 所有/b 结点/n 回收/v 到/v 可/v 利用/v 空间/n 表/n 中/f (/wkz 包括/v 子/ng 表/n L4/x 和/cc L/x ，/wd 上/f 所有/b 结点/n )/wky ，/wd 这/rzv 就/d 破坏/v 了/ule 表/n k/x 和/cc L3/x ，/wd 从而/c 产生/v “/wyz 悬挂/v 访问/v ”/wyy ；/wf 反之/c ，/wd 若/c 不/d 将/p 表/n L/x 。/wj 中/f 结点/n 释放/v ，/wd 则/c 当/v k/x 和/cc L3/x 两/m 个/q 表/n 也/d 不/d 被/pbei 使用/v 时/ng ，/wd 这些/rz 结点/n 由于/c 未曾/d “/wyz 释放/v ”/wyy 无法/v 被/pbei 再/d 分配/v 而/cc 成为/v “/wyz 无用/vi 单元/n ”/wyy 。/wj 
    如何/ryv 解决/v 这个/rz 问题/n ?/ww 有/vyou 两/m 条/q 途径/n ：/wp 
    (/wkz 1/m )/wky 使用/v 访问/vn 计数器/n ：/wp 在/p 所有/b 子/ng 表/n 或/c 广义/n 表/n 上/f 增加/v 一个/mq 表头/n 结点/n ，/wd 并/cc 设立/v 一个/mq “/wyz 计数/vi 域/ng ”/wyy ，/wd 它/rr 的/ude1 值/n 为/p 指向/v 该/rz 子/ng 表/n 或/c 广义/n 表/n 的/ude1 指针/n 数目/n 。/wj 只有/c 当/p 该/rz 计数/vi 域/ng 的/ude1 值/n 为/p 零时/t ，/wd 此/rzs 子/ng 表/n 或/c 广义/n 表/n 中/f 结点/n 才/d 被/pbei 释放/v 。/wj 
    (/wkz 2/m )/wky 收集/v 无用/vi 单元/n ：/wp 在/p 程序运行/n 的/ude1 过程/n 中/f ，/wd 对/p 所有/b 的/ude1 链/ng 表/n 结点/n ，/wd 不/d 管/v 它/rr 是否/v 还有/v 用/v ，/wd 都/d 不/d 回收/v ，/wd 直到/v 整个/b 可/v 利用/v 空间/n 表/vg 为/v 空/ng 。/wj 此时/r 才/d 暂时/d 中断/v 执行/v 程序/n ，/wd 将/p 所有/b 当前/t 不/d 被/pbei 使用/v 的/ude1 结点/n 链接/n 在/p 一起/s ，/wd 成为/v 一个/mq 新/a 的/ude1 可/c 利用/v 空间/n 表/n ，/wd 而后/c 程序/n 再/d 继续执行/n 。/wj 显然/a ，/wd 在/p 一般/a 情况/n 下/f ，/wd 是/vshi 无法/v 辨别/v 哪些/ry 结点/n 是/vshi 当前/t 未/d 被/pbei 使用/v 的/ude1 。/wj 然而/c ，/wd 对于/p 一个/mq 正/d 在/p 运行/vi 的/ude1 程序/n ，/wd 哪些/ry 结点/n 正/d 在/p 使用/v 是/vshi 容易/ad 查明/v 的/ude1 ，/wd 这/rzv 只/d 要/v 从/p 所有/b 当前/t 正在/d 工作/vi 的/ude1 指针/n 变量/n 出发/vi ，/wd 顺/v 链/ng 遍历/n ，/wd 那末/c ，/wd 所有/b 链/ng 结/v 在/p 这些/rz 链/ng 上/f 的/ude1 结点/n 都/d 是/vshi 占用/v 的/ude1 。/wj 反之/c ，/wd 可/c 利用存储/n 空间/n 中/f 的/ude1 其余/rz 结点/n 就/d 都/d 是/vshi 无/v 用/v 的/ude1 了/y 。/wj 
    由此/d ，/wd 收集/v 无用/vi 单元/n 应/v 分两步/n 进行/vn ：/wp 第一/m 步/qv 是/vshi 对/p 所有/b 占用/v 结点/n 加上/v 标志/n 。/wj 回顾/v 第五/m 章/q 的/ude1 广义/n 表/n 的/ude1 存储/vn 结构/n 可/v 在/p 每个/r 结点/n 上/f 再/d 加/v 设/v 一个/mq 标志/n (/wkz mark/x )/wky 域/ng ，/wd 假/ad 设在/v 无用/vi 单元收集/n 之前/f 所有/b 结点/n 的/ude1 标志/n 域/ng 均/d 置/v 为/v “/wyz 0/m ”/wyy ，/wd 则/c 加上/v 标志/n 就/d 是/vshi 将/d 结点/n 的/ude1 标志/n 域/ng 置/v 为/v “/wyz 1/m ”/wyy ；/wf 第二/m 步/qv 是/vshi 对/p 整个/b 可/v 利用存储/n 空间/n 顺序/n 扫描/v 一/m 遍/qv ，/wd 将/p 所有/b 标志/n 域/ng 为/v “/wyz 0/m ”/wyy 的/ude1 结点/n 链接/n 成/v 一个/mq 新/a 的/ude1 可/c 利用/v 空间/n 表/n 。/wj 值得/v 注意/v 的/ude1 是/vshi ：/wp 上述/b 第二/m 步/qv 是/vshi 容易/ad 进行/vx 的/ude1 ，/wd 而/cc 第一/m 步/qv 是/vshi 在/p 极其/d 困难/a 的/ude1 条件/n (/wkz 即/v 可/v 利用存储/n 几乎/d 耗用/v 殆尽/vi )/wky 下/f 进行/vx 的/ude1 ，/wd 因此/c ，/wd 人们/n 的/ude1 精力/n 主要/d 集中/v 在/p 研究/vn 标志/n 算法/n 上/f 。/wj 下面/f 我们/rr 介绍/v 三/m 种/q 标志/n 算法/n 。/wj 
    (/wkz 1/m )/wky 递归/n 算法/n 从/p 上面/f 所/usuo 述/vg 可知/v ，/wd 加/v 标志/n 的/ude1 操作/vn 实质/n 上/f 是/vshi 遍历/n 广义/n 表/n ，/wd 将/p 广义/n 表/vg 中/b 所有/b 结点/n 的/ude1 标志/n 域/ng 赋值/v “/wyz 1/m ”/wyy 。/wj 我们/rr 可/v 写/v 出/vf 遍历/n (/wkz 加/b 标志/n )/wky 算法/n 的/ude1 递归/n 定义/n 如下/vi ：/wp 
    若/c 列表/vi 为/v 空/ng ，/wd 则/c 无/v 需/v 遍历/n ；/wf 若/c 是/vshi 一个/mq 数据/n 元素/n ，/wd 则/c 标志/v 元素/n 结点/n ；/wf 反之/c ，/wd 则/d 列表/vi 非空/n ，/wd 先/d 标志/v 表/vg 结点/n ；/wf 然后/c 分别/d 遍历/n 表头/n 和/cc 表/n 尾/ng 。/wj 
    这个/rz 算法/n 很/d 简单/a ，/wd 易于/vd 用/v 允许/v 递归/n 的/ude1 高级语言/n 描述/v 之/uzhi 。/wj 但是/c ，/wd 它/rr 需要/v 一个/mq 较/d 大/a 的/ude1 实现/v 递归/n 用/v 的/ude1 栈/ng 的/ude1 辅助内存/n ，/wd 这/rzv 部分/m 内存/n 不/d 能/v 用于/v 动态分配/n 。/wj 并且/c ，/wd 由于/c 列表/vi 的/ude1 层次/n 不/d 定/v ，/wd 使得/vi 栈/ng 的/ude1 容量/n 不易/ad 确定/v ，/wd 除非/c 是/vshi 在/p 内存/n 区/n 中/f 开辟/v 一个/mq 相当/d 大/a 的/ude1 区域/n 留作/n 栈/ng ，/wd 否则/c 就/d 有/vyou 可能/n 由于/c 在/p 标志/n 过程/n 中/f 因/p 栈/ng 的/ude1 溢出/v 而/cc 使/v 系统/n 瘫痪/vi 。/wj 
    (/wkz 2/m )/wky 非/b 递归/n 算法/n 程序/n 中/f 附设/v 栈/ng (/wkz 或/c 队列/n )/wky 实现/v 广义/n 表/n 的/ude1 遍历/n 。/wj 从/p 广义/n 表/n 的/ude1 存储/vn 结构/n 来看/u ，/wd 表/n 中/f 有/vyou 两/m 种/q 结点/n ：/wp 一/m 种/q 是/vshi 元素/n 结点/n ，/wd 结点/n 中/f 没有/v 指针/n 域/ng ；/wf 另/rz 一/m 种/q 是/vshi 表/n 结点/n ，/wd 结点/n 中/f 包含/v 两/m 个/q 指针/n 域/ng ：/wp 表头/n 指针/n 和/cc 表/n 尾/ng 指针/n ，/wd 则/c 它/rr 很/d 类似/v 于/p 二/m 叉树/n 的/ude1 二/m 叉/n 链/ng 表/n 。/wj 列表/vi 中/f 的/ude1 元素/n 结点/n 相当/d 于/p 二/m 叉树/n 中/f 的/ude1 叶子/n 结点/n ，/wd 可以/v 类似/v 于/p 遍历/n 二/m 叉树/n 写/v 出/vf 遍历/n 表/n 的/ude1 非/b 递归/n 算法/n ，/wd 只是/c 在/p 算法/n 中/f 应/v 尽量减少/n 栈/ng 的/ude1 容量/n 。/wj 
    例如/v ，/wd 类似/v 于/p 二/m 叉树/n 的/ude1 前/f 序/n 遍历/n ，/wd 对/p 广义/n 表/n 则/d 为/v ：/wp 当/p 表/n 非空/n 时/ng ，/wd 在/p 对/p 表/n 结点/n 加/v 标志/n 后/f ，/wd 先/d 顺/a 表头/n 指针/n 逐/vg 层/n 向/p 下/f 对/p 表头/n 加/b 标志/n ，/wd 同时/c 将/d 同/p 层/qv 非空/n 且/c 未/d 加/v 标志/n 的/ude1 表/n 尾/ng 指针/n 依次/d 入/v 栈/ng ，/wd 直到/v 表头/n 为/p 空/a 表/n 或/c 为/p 元素/n 结点/n 时/ng 停止/v ，/wd 然后/c 退/v 栈/ng 取出/v 上/vf 一/m 层/qv 的/ude1 表/n 尾/ng 指针/n 。/wj 反复/d 上述/b 进行/vx 过程/n ，/wd 直到/v 栈/ng 空/v 为止/u 。/wj 这个/rz 过程/n 也/d 可以/v 称作/v 深度/n 优先/vd 搜索/v 遍历/n 。/wj 因为/p 它/rr 和/cc 图/n 的/ude1 深度/n 优先/vd 搜索/v 遍历/n 很/d 相似/a 。/wj 
    显然/a ，/wd 还/d 可以/v 类似/v 于/p 图/n 的/ude1 广度/n 优先/vd 搜索/v 遍历/n ，/wd 对/p 列表/vi 进行/vx 广度/n 优先/vd 搜索/v 遍历/n ，/wd 或者/c 说是/v 对/p 列表/vi 按/p 层次/n 遍历/n 。/wj 同样/d ，/wd 为/p 实现/v 这个/rz 遍历/n 需/v 附设/v 一个/mq 队列/n (/wkz 这/rzv 两/m 个/q 算法/n 和/cc 二/m 叉树/n 或/c 图/n 的/ude1 遍历/n 极为/d 相似/a ，/wd 故/c 在/p 此/rzs 不/d 作/v 详细/ad 描述/v ，/wd 读者/n 完全/ad 可以/v 自己/rr 写/v 出/vf )/wky 。/wj 在/p 这/rzv 两/m 种/q 非/b 递归/n 算法/n 中/f ，/wd 虽然/c 附设/v 的/ude1 栈/ng 或/c 队列/n 的/ude1 容量/n 比/p 递归/n 算法/n 中/f 的/ude1 栈/ng 的/ude1 容量/n 小/a ，/wd 但/c 和/cc 递归/n 算法/n 有/vyou 同样/b 的/ude1 问题/n 仍/d 需要/v 一个/mq 不/d 确定/v 量/n 的/ude1 附加/vn 存储/vn ，/wd 因此/c 也/d 不/d 是/vshi 理想/a 的/ude1 方法/n 。/wj 
    (/wkz 3/m )/wky 利用/v 表/vg 结点/n 本身/rz 的/ude1 指针/n 域/ng 标记/n 遍历/n 路径/n 的/ude1 算法/n 无论是/c 在/p 递归/n 算法/n 中/f 还是/d 在/p 深度/n 优先/vd 搜索/v 的/ude1 非/b 递归/n 算法/n 中/f ，/wd 不难/d 看出/v ，/wd 设/v 栈/ng 的/ude1 目的/n 都/d 是/vshi 为了/p 记/v 下/f 遍/qv 历时/vi 指针/n 所/usuo 走/v 的/ude1 路径/n ，/wd 以便/d 在/p 遍历/n 表头/n 之后/f 可以/v 沿/p 原/b 路/n 退回/v ，/wd 继而/c 对/p 表/n 尾/ng 进行/vx 遍历/n 。/wj 如果/c 我们/rr 能/v 用/p 别的/rzv 方法/n 记下/v 指针/n 所/usuo 走/v 路径/n ，/wd 则/c 可以/v 免除/v 附设/v 栈/ng 。/wj 在/p 下面/f 介绍/v 的/ude1 算法/n 中/f 就/d 是/vshi 利用/v 已经/d 标志/v 过/uguo 的/ude1 表/n 结点/n 中/f 的/ude1 tag/x 、/wn hp/x 和/cc tp/x 域/n 来/vf 代替/v 栈/ng 记录/v 遍历/n 过程/n 中/f 的/ude1 路径/n 。/wj 例如/v ：/wp 对/p 图/n 8．10/m 中/f 的/ude1 广义/n 表/vg 加/b 标志/n 。/wj 假设/v 在/p 递归/n 算法/n 中/b 指针/n p/x 指向/v 刚/d 加上/v 标志/n 的/ude1 b/x 结点/n ，/wd 则/d ：/wp ①/m 当/p 指针/n p/x 由/p b/x 移/v 向/p 表头/n c/x 之前/f 需/v 将/d b/x 入/v 栈/ng (/wkz 此时/r a/x 已/d 在/p 栈/ng 中/f )/wky ；/wf ②/m 在/p 表头/n 标志/n 之后/f 需/v 退/v 栈/ng ，/wd 然后/c 指针/n p/x 在/p 由/p b/x 移/v 向/p 表/n 尾/q f/x 时/ng 需/v 再次/d 将/d b/x 入/v 栈/ng ；/wf ③/m 在/p b/x 的/ude1 表/n 尾/ng 标志/v 完/vi 之后/f 应/v 连续/a 两/m 次/qv 退/v 栈/ng ，/wd 使/v p/x 重/d 又/d 指向/v a/x 。/wj 与/p 此对应/n ，/wd 在/p 本/rz 算法/n 中/f 不/d 设/v 栈/ng 。/wj 而是/c 当/p 指针/n p/x 由/p b/x 移/v 向/p c/x 之前/f ，/wd 先/d 将/d b/x 结点/n 中/f 的/ude1 hp/x 域/n 的/ude1 值/n 改/v 为/p 指向/v a/x ，/wd 并/cc 将/d b/x 结点/n 中/f 的/ude1 tag/x 域/n 的/ude1 值/n 改/vd 为/v “/wyz 0/m ”/wyy ；/wf 而/cc 当/p 指针/n p/x 由/p b/x 移/v 向/p f/x 之前/f ，/wd 则/c 先/d 将/d b/x 结点/n 中/f 的/ude1 tp/x 域/n 的/ude1 值/n 改/v 为/p 指向/v a/x ，/wd tag/x 域/n 的/ude1 值/n 改/vd 为/v “/wyz 1/m ”/wyy 。/wj 
    下面/f 详细/ad 叙述/v 算法/n 的/ude1 基本思想/n (/wkz 注/v ：/wp 假设/v 图/n 8．10/m 中/f 的/ude1 广义/n 表/n L/x ’/wyy 已/d 加上/v 标志/n )/wky 。/wj 8．10/m 待/vi 遍历/n 的/ude1 广义/n 表/n 
    算法/n 中/f 设定/v 了/ule 三/m 个/q 互相/d 关联/vi 的/ude1 指针/n ：/wp 当/v p/x 指向/v 某个/rz 表/n 结点/n 时/ng ；/wf t/x 指向/v p/x 的/ude1 母/b 表/n 结点/n ；/wf q/x 
指向/v p/x 的/ude1 表头/n 或/c 表/vg 尾/ng 。/wj 如/v 图/n 8．11/m 中/f (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    当/p q/x 指向/v p/x 的/ude1 表头/n 结点/n 时/ng ，/wd 可能/v 有/vyou 三/m 种/q 情况/n 出现/v ：/wp ①/m 设/v p/x 的/ude1 表头/n 只是/d 一个/mq 元素/n 结点/n ，/wd 则/c 遍历/n 表头/n 仅/d 需/v 对/p 该/rz 表头/n 结点/n 打/v 上/vf 标志/n 后/f 即令/c q/x 指向/v p/x 的/ude1 表/n 尾/ng ；/wf ②/m 设/v p/x 的/ude1 表头/n 为/p 空/a 表/n 或是/c 已/d 加上/v 标志/n 的/ude1 子/ng 表/n ，/wd 则/c 无/v 需/v 遍历/n 表头/n 只要/c 令/v q/x 指向/v p/x 的/ude1 表/n 尾/ng 即可/v ；/wf ③/m 设/v p/x 的/ude1 表头/n 为/v 未/d 加/v 标志/n 的/ude1 子/ng 表/n ，/wd 则/c 需/v 先/d 遍历/n 表头/n 子/ng 表/n ，/wd 即/v p/x 应/v 赋/v q/x 的/ude1 值/n ，/wd t/x 相应/vi 往/p 下/f 移动/v 改/v 赋/v p/x 的/ude1 值/n 。/wj 为了/p 记/v 下/f t/x 指针/n 移动/vn 的/ude1 路径/n ，/wd 以便/d 在/p p/x 退回/v 原/d 结点/n 时/ng 同时/d 能/v 找到/v p/x 的/ude1 母/b 表/n 结点/n (/wkz 即/v 使/v t/x 退回/v 到/v 原来/b 的/ude1 值/n )/wky ，/wd 则/c 在/p 修改/v 这个/rz 指针/n 的/ude1 值/n 之前/f ，/wd 应/v 先/d 记/v 下/f t/x 移动/vn 的/ude1 路径/n ，/wd 即令/c p/x 所/usuo 指/v 结点/n 的/ude1 hp/x 域/n 的/ude1 值/n 为/v t/x ，/wd 且/c tag/x 域/n 的/ude1 值/n 为/v “/wyz O/x ”/wyy 。/wj 
    另一方面/c ，/wd 当/v q/x 指向/v p/x 的/ude1 表/n 尾/ng 时/ng ，/wd 也/d 可能/v 有/vyou 两/m 种/q 情况/n 出现/v ：/wp ①/m p/x 的/ude1 表/n 尾/ng 为/v 未/d 加/v 标志/n 的/ude1 子/ng 表/n ，/wd 则/c 需/v 遍历/n 表/n 尾/ng 的/ude1 子/ng 表/n ，/wd 同样/b 队/n t/x 指针/n 要/v 作/v 相应/vi 的/ude1 移动/vn 。/wj 为了/p 记/v 下/vf 当前/t 表/n 结点/n 的/ude1 母/b 表/n 结点/n ，/wd 同样/d 要/v 在/p 改动/v p/x 、/wn t/x 指针/n 的/ude1 值/n 之前/f 先/d 记下/v 路径/n ；/wf 即令/c p/x 所/usuo 指/v 结点/n 的/ude1 tp/x 域/n 的/ude1 值/n 改/vd 为/v t/x ，/wd 然后/c 令/v t/x 赋值/v p/x ，/wd p/x 赋值/v q/x ；/wf ②/m p/x 的/ude1 表/n 尾/ng 为/v “/wyz 空/ng ”/wyy 或是/c 已/d 加上/v 标志/n 的/ude1 子/ng 表/n ，/wd 此时/r 表明/v p/x 所/usuo 指/v 的/ude1 表/n 已/d 加上/v 标志/n ，/wd 则/d p/x 应/v 退回/v 到/v 其/rz 母/ng 表/n 结点/n 即/v t/x 所/usuo 指/v 结点/n ，/wd 相应/vi 地/n t/x 也/d 应/v 后退/vi 一/m 步/qv ，/wd 即/d 退/v 到/v t/x 结点/n 的/ude1 母/b 表/n 结点/n 。/wj 综上所述/c 可知/v ，/wd t/x 的/ude1 移动/vn 路径/n 已/d 记录/v 在/p t/x 结点/n 的/ude1 hp/x 域/n 或/c tp/x 域/n 中/f ，/wd 究竟/d 是/vshi 哪/ry 一个/mq ?/ww 则/c 要/v 由/p 辨别/v tag/x 域/n 的/ude1 值/n 来/vf 定/v 。/wj 它/rr 不仅/c 指示/v t/x 应/v 按/p 哪个/ry 指针/n 所/usuo 指/v 路径/n 退回/v ，/wd 而且/c 指示/v 了/ule 下/vf 一/m 步/qv 应/v 做/v 什么/ry 。/wj 若/v t/x 结点/n 是/vshi 其/rz 母/ng 表/vg 表头/n ，/wd 则/c 应/v 继续/v 遍历/n 其/rz 母/ng 表/n 的/ude1 表/n 尾/ng 。/wj 若/v t/x 结点/n 是/vshi 其/rz 母/ng 表/n 的/ude1 表/n 尾/ng ，/wd 则/c 应/v 继续/v 找/v 更/d 高/a 一/m 层/qv 的/ude1 母/b 表/n 结点/n 。/wj 整个/b 算法/n 大致/d 描述/v 如下/vi ：/wp (/wkz GL/x 为/p 广义/n 表/n 的/ude1 头/n 指针/n )/wky 
t=NULL/x ；/wf   p=GL/x ；/wf   finished=FALSE/x 
Hrhile/x (/wkz !/wt finished/x )/wky {/n 
∥/w 若/c 表头/n 是/vshi 未/d 经/p 遍历/n 的/ude1 非/b 空子/n 表/n ，/wd 则/c 修改/v 指针/n 记录/v 路径/n ，/wd 
∥/w 且/c pI/x 指向/v 表头/n ；/wf 否则/c p/x 不/d 变/v 
    if/x (/wkz q/x ＆/n &/n q/x >/n mark：=0/x )/wky MarkTa/x ~/n ．/w 1/m (/wkz p/x )/wky ；/wf   ∥/w 修改/v 指针/n 记录/v 路径/n ，/wd 且/c p/x 指向/v 表/vg 尾/ng 
    else/x  BackTrack/x (/wkz finished/x )/wky ；/wf ∥/w 若/c 从/p 表/n 尾/ng 回溯/v 到/v 第一/m 个/q 结点/n ，/wd 则/d finished/x 为/v TRUE/x 
    I/x     ’/wyy 
求/v 精/a 后/f 的/ude1 广义/n 表/n 遍历/n 算法/n 如/v 算法/n 8．3/m 所/usuo 示/vg 。/wj 
・/w 209・/m 
=/m 
M/x     =/m 
    图/n 8．/m 
(/wkz a/x )/wky 指针/n 初始化/v 。/wj q/x 指向/v 表头/n ；/wf 
(/wkz b/x )/wky 和/cc (/wkz C/x )/wky 指针/n 向/p 表头/n 方向/n 推进/vi 一/m 步/qv ；/wf 
(/wkz d/x )/wky 对/p 元素/n 结点/n 加/v 标志/n 后/f 指针/n 后退/vi ，/wd q/x 指向/v 表/vg 尾/ng ；/wf 
(/wkz e/x )/wky 指针/n 向/p 表/n 尾/ng 方向/n 推进/vi 一/m 步/qv ，/wd q/x 指向/v 表头/n ；/wf 
11/m 遍历/n 广义/n 表/n 
(/wkz f/x )/wky 指针/n 后退/vi 一/m 步/qv ；/wf 
(/wkz g/x )/wky 指针/n 继续/v 后退/vi ，/wd q/x 指向/v 表/vg 尾/ng ；/wf 
(/wkz h/x )/wky 指针/n 向/p 表/n 尾/ng 方向/n 推进/vi 一/m 步/qv ，/wd q/x 指向/v 表/vg 尾/ng (/wkz 表头/n 为/v 空/ng 表/vg )/wky 
(/wkz i/x )/wky 指针/n 继续/v 向/p 表/n 尾/ng 方向/n 推进/vi 一/m 步/qv ，/wd q/x 指向/v 表头/n 。/wj 
void/x  MarkList/x (/wkz ~/n List/x  GL/x )/wky {/n 
    ∥/w 遍历/n 非空/n 广义/n 表/n GL/x (/wkz GL/x !/wt =NULL/x 且/d GL/x 一/m >/n mark==0/x )/wky ，/wd 对/p 表/n 中/b 所有/b 未/d 加/v 标志/n 的/ude1 结点/n 加/v 标志/n 。/wj 
    t：NULL/x ；/wf P=GL/x ；/wf   finished=FALSE/x ；/wf   ∥/w t/x 指示/n P/x 的/ude1 母/b 表/n 
    while/x (/wkz !/wt finished/x )/wky {/n 
    while/x (/wkz P/x 一/m >/n mark==0/x )/wky {/n 
    P/x 一/m >/n mark=1：/x 
    ∥/w MarkHead/x (/wkz p/x )/wky 的/ude1 细化/vn ：/wp 
    q=P/x 一/m >/n P．hp/x ；/wf   ∥/w q/x 指向/v “/wyz P/x 的/ude1 表头/n 
    if/x (/wkz q/x &/n &/n q/x 一/m >/n mark==0/x )/wky {/n 
・/w 210・/m 
    ∥/w A/x |/n IDM/x ，/wd 表头/n 为/p 原子/n 结点/n 
t=p/x ；/wf p=q/x ；/wf }/n     ∥/w 继续/v 遍历/n 子/ng 表/n 
    }/n   ∥/w 完成/v 对/p 表头/n 的/ude1 标志/n 
    q=p/x >/n p．tp/x ；/wf     ∥/w q/x 指向/v */n p/x 的/ude1 表/n 尾/ng 
    if/x (/wkz q/x ＆/n ＆/n q/x >/n mark==O/x )/wky {/n p/x >/n p．tp=t/x ；/wf t=p/x ；/wf p=q/x ；/wf I/x     ∥/w 继续/v 遍历/n 表/n 尾/ng 
    else/x {/n   ∥/w Bacl/x (/wkz |/n rrack/x (/wkz flnished/x )/wky 的/ude1 细化/vn ：/wp 
    曲/n ile/x (/wkz t/x &/n &/n t/x >/n tag=：1/x )/wky {/n   ∥/w L/x 上/f sT/x ，/wd 表/vg 结点/n ，/wd 从/p 表/n 尾/ng 回溯/v 
    }/n 
    if/x (/wkz !/wt t/x )/wky finished：/x ‘/wyz tRUE/x ；/wf   ∥/w 结束/v 
    else/x {/n   ∥/w 从/p 表头/n 回溯/vn 
    }/n   ∥/w 继续/v 遍历/n 表/n 尾/ng 
    }/n 
  }/n 
f/x ∥/w MarkList/x 
    算法/n 8．3/m 
    图/n 8．11/m 展示/v 对/p 图/n 8．10/m 中/f 的/ude1 广义/n 表/n 进行/vx 遍历/n 加/b 标志/n 时/ng 各/rz 指针/n 的/ude1 变化/vn 状况/n 。/wj (/wkz a/x )/wky 为/p 算法/n 8．3/m 开始执行/n 时/ng 的/ude1 状态/n 。/wj (/wkz b/x )/wky 和/cc (/wkz c/x )/wky 为/p 指针/n 向/p 表头/n 方向/n 移动/vn 并/cc 改变/v 结点/n 的/ude1 hp/x 域/ng 指针/n 的/ude1 情形/n 。/wj (/wkz d/x )/wky 表示/v 当/p 表头/n 遍历/n 完成/v 将/d 对/p 表/n 尾/ng 进行/vx 标志/n 时/ng 的/ude1 指针/n 变化情况/n 。/wj 从/p (/wkz e/x )/wky 和/cc (/wkz f/x )/wky 读者/n 可/v 看到/v 指针/n 回溯/vn 的/ude1 情形/n 。/wj 在/p 此/rzs 省略/v 了/ule 继续/v 遍/qv 历时/vi 的/ude1 指针/n 变化/vn 状况/n ，/wd 有/vyou 兴趣/n 的/ude1 读者/n 可/v 试/v 之/uzhi 补充/vn 。/wj 
    比较/d 上述/b 三/m 种/q 算法/n 各/rz 有/vyou 利弊/n 。/wj 第三/m 种/q 算法/n 在/p 标志/n 时/ng 不/d 需要/v 附加/vn 存储/vn ，/wd 使/v 动态分配/n 的/ude1 可/c 利用/v 空间/n 得到/v 充分/ad 利用/v ，/wd 但是/c 由于/c 在/p 算法/n 中/f ，/wd 几乎/d 是/vshi 每个/r 表/n 结点/n 的/ude1 指针/n 域/ng 的/ude1 值/n 都/d 要/v 作/v 两/m 次/qv 改变/v ，/wd 因此/c 时间/n 上/f 的/ude1 开销/n 相当/d 大/a ，/wd 而且/c ，/wd 一旦/d 发生/v 中断/v ，/wd 整个/b 系统/n 瘫痪/vi ，/wd 无法/v 重新/d 启动/v 运行/vi 。/wj 而非/nr2 递归/n 算法/n 操作简单/n ，/wd 时间/n 上/f 要/v 比/p 第三/m 种/q 算法/n 省得/v 多/a ，/wd 然而/c 它/rr 需要/v 占有/v 一定/b 空间/n ，/wd 使/v 动态分配/n 所/usuo 用/v 的/ude1 存储量/n 减少/v 。/wj 总之/c ，/wd 无用/vi 单元收集/n 是/vshi 很/d 费/v 时间/n 的/ude1 ，/wd 不/d 能/v 在/p 实时/n 处理/v 的/ude1 情况/n 下/f 应用/v 。/wj 
    通常/d ，/wd 无用/vi 单元/n 的/ude1 收集/vn 工作/vn 是/vshi 由/p 编译程序/n 中/f 的/ude1 专用/vn 系统/n 来/vf 完成/v 的/ude1 ，/wd 它/rr 也/d 可以/v 作为/v 一个/mq 标准函数/n 由/p 用户/n 自行/d 调用/v (/wkz 类似/v 于/p free/x 函数/n 的/ude1 使用/vn )/wky 。/wj 不论/c 哪/ry 一/m 种/q 情况/n ，/wd 系统/n 都/d 要求/v 用户/n 建立/v 一个/mq 初始/b 变量/n 表/vg 登录/v 用户/n 程序/n 中/b 所有/b 链/ng 表/n 的/ude1 表头/n 指针/n ，/wd 以便/d 从/p 这些/rz 指针/n 出发/vi 进行/vx 标志/n 。/wj 
　　下面/f 我们/rr 可以/v 对/p 无用/vi 单元收集/n 算法/n 作/v 某种/rz 定量/n 估计/v 。/wj 如上所述/c ，/wd 整个/b 算法/n 分两步/n 进行/vn ：/wp 第一/m 步/qv 对/p 占用/v 结点/n 加/v 标志/n ，/wd 不/d 管用/a 哪/ry 一/m 种/q 算法/n ，/wd 其/rz 所/usuo 用/v 时间/n 都/d 和/cc 结/v 点数/n 成/v 正比/n 。/wj 假设/v 总/b 的/ude1 占用/vn 结/v 点数/n 为/v N/x ，/wd 则/c 标志/v 过程/n 所/usuo 需/v 时间/n 为/v c/x 。/wj N/x (/wkz 其中/rz c/x 。/wj 为/p 某个/rz 常数/n )/wky ；/wf 第二/m 步/qv 是/vshi 从/p 可/v 用/p 空间/n 的/ude1 第一/m 个/q 结点/n 起/f ，/wd 顺序/n 扫描/vn ，/wd 将/p 所有/b 未/d 加/v 标志/n 的/ude1 结点/n 链/ng 结/v 在/p 一起/s 。/wj 假设/v 可用/a 空间/n 总共/d 含有/v M/x 个/q 结点/n ，/wd 则/d 所/usuo 需/v 时间/n 为/v c2M/x (/wkz 其中/rz c2/x 为/p 某个/rz 常数/n )/wky 。/wj 由此/d ，/wd 收集/v 算法/n 总/b 的/ude1 时间/n 为/v f1N+c2M/x ，/wd 同时/c 收集/v 到/v 的/ude1 无用/vi 结点/n 个/q 数/n 为/v M/x 
显然/a ，/wd 无用/vi 单元收集/n 这项/r 工作/vn 的/ude1 效率/n 和/cc 最后/f 能/v 收集/v 到/v 的/ude1 可以/v 重新/d 分配/v 的/ude1 无用/vi 结/v 点数/n 有关/vn 。/wj 我们/rr 用/p 收集/v 一个/mq 无用/vi 结点/n 所/usuo 需/v 的/ude1 平均/a 时间/n (/wkz clN+r2M/x )/wky ／/w (/wkz M―N/x )/wky 来/f 度量/v 这个/rz 效率/n 。/wj 假设/v 以/p ID=N／M/x 表示/v 内存/n 使用/v 的/ude1 密度/n ，/wd 则/c 上述/b 平均/a 时间/n 为/v (/wkz c-lD+c2/x )/wky ／/w (/wkz 1/m ～/ws lD/x )/wky 。/wj 当/p 内存/n 中/f 3／4/m 的/ude1 结点/n 为/v 无用/vi 结点/n ，/wd 即/v 10：1／4/m 时/ng ，/wd 收集/v 一个/mq 结点/n 所/usuo 需/v 平均/a 时间/n 为/v 1／3cl+4／3c2/x 。/wj 反之/c ，/wd 当/p 内存/n 中/f 1／4/m 的/ude1 结点/n 为/v 无用/vi 结点/n ，/wd 即/v ID=3／4/x 时/ng ，/wd 收集/v 一个/mq 结点/n 所/usuo 需/v 平均/a 时间/n 为/v 3c/x ，/wd +4c：/x 。/wj 由此可见/c ，/wd 可/c 利用/v 内存/n 区/n 中/f 只/d 有/vyou 少量/m 的/ude1 结点/n 为/v 无用/vi 结点/n 时/ng ，/wd 收集/v 无用/vi 单元/n 的/ude1 操作/vn 的/ude1 效率/n 很/d 低/a 。/wj 不仅如此/bl ，/wd 而且/c 当/p 系统/n 重/d 又/d 恢复/v 运行/vi 时/ng ，/wd 这些/rz 结点/n 又/d 很快/d 被/pbei 消耗/v 掉/v ，/wd 导致/v 另/rz 一/m 次/qv 无用/vi 单元/n 的/ude1 收集/vn 。/wj 如此/rzv 下去/vf 有/vyou 可能/n 造成/v 恶性/b 循环/vn ，/wd 以至/cc 最后/f 整个/b 系统/n 瘫痪/vi 。/wj 解决/v 的/ude1 办法/n 可以/v 由/p 系统/n 事先/d 确定/v 一个/mq 常数/n 志/n ，/wd 当/p 收集/v 到/v 的/ude1 无用/vi 单元数/n 为/v 愚/an 或/c 更/d 少/a 时/ng 系统/n 就/d 不再/d 运行/vi 下去/vf 。/wj 
8．6/m 存储/vn 紧缩/vn 
　　前面/f 几/m 节/q 中/f 讨论/v 的/ude1 动态存储/n 管理方法/n 都/d 有/vyou 一个/mq 共同/b 的/ude1 特点/n ，/wd 即/d 建立/v 一个/mq “/wyz 空闲/n 块/ng ”/wyy 或/c “/wyz 无用/vi 结点/n ”/wyy 组成/v 的/ude1 可/c 利用/v 空间/n 表/n ，/wd 这个/rz 可/v 利用/v 空间/n 表/vg 采用/v 链/ng 表/vg 结构/n ，/wd 其/rz 结点/n 大小/n 可以/v 相同/a ，/wd 也/d 可以/v 不同/a 。/wj 
    图/n 8．12/m 堆/q 存储管理/n 示意图/n 
　　    (/wkz a/x )/wky 堆/v 空间/n ；/wf (/wkz b/x )/wky 串/v 的/ude1 存储/vn 映象/n ；/wf (/wkz c/x )/wky 紧缩/v 后/f 的/ude1 堆/n ；/wf (/wkz d/x )/wky 修改/v 后/f 的/ude1 存储/vn 映象/n 。/wj 
    这/rzv 一/m 节/q 将要/d 介绍/v 另/rz 一/m 种/q 结构/n 的/ude1 动态存储/n 管理方法/n 。/wj 在/p 整个/b 动态存储/n 管理/vn 过程/n 中/f ，/wd 不管/c 哪个/ry 时刻/n ，/wd 可/c 利用/v 空间/n 都/d 是/vshi 一个/mq 地址/n 连续/a 的/ude1 存储区/n ，/wd 在/p 编译程序/n 中/f 称之为/v “/wyz 堆/v ”/wyy ，/wd 每/rz 次分配/n 都/d 是/vshi 从/p 这个/rz 可/v 利用/v 空间/n 中/f 划/v 出/vf 一/m 块/q 。/wj 其/rz 实现/v 办法/n 是/vshi ：/wp 设立/v 一个/mq 指针/n ，/wd 称之为/v 堆/q 指针/n ，/wd 始终/d 指向/v 堆/k 的/ude1 最低/a (/wkz 或/c 最高/a )/wky 地址/n 。/wj 当/p 用户/n 申请/v N/x 个/q 单位/n 的/ude1 存储/vn 块/q 时/ng ，/wd 堆/v 指针/n 向/p 高/a 地址/n (/wkz 或/c 低/a 地址/n )/wky 移动/v N/x 个/q 存储单位/n ，/wd 而/cc 移动/vn 之前/f 的/ude1 堆/q 指针/n 的/ude1 值/n 就/d 是/vshi 分配给用户/n 的/ude1 占用/vn 块/q 的/ude1 初始/b 地址/n 。/wj 回顾/v 第四/m 章/q 中/f 提及/v 的/ude1 串/q 值/n 存储空间/n 的/ude1 动态分配/n 就是/d 用/v 的/ude1 这种/r 堆/v 的/ude1 存储管理/n 。/wj 例如/v ，/wd 某个/rz 串/q 处理/vn 系统/n 中/f 有/vyou A/x 、/wn B/x 、/wn C/x 、/wn D/x 四/m 个/q 串/v ，/wd 其/rz 串/q 值/n 长度/n 分别/d 为/v 12/m 、/wn 6/m 、/wn 10/m 和/cc 8/m 。/wj 假设/n 堆/q 指针/n free/x 的/ude1 初值/n 为/p 零/m ，/wd 则/c 分配/v 给/p 这/rzv 四/m 个/q 串/q 值/n 的/ude1 存储空间/n 的/ude1 初始/b 地址/n 分别/d 为/v 0/m 、/wn 12/m 、/wn 18/m 和/cc 28/m ，/wd 如/v 图/n 8．12/m (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 所/usuo 示/vg ，/wd 分配/v 后/f 的/ude1 堆/q 指针/n 的/ude1 值/n 为/p 36/m 。/wj 因此/c ，/wd 这种/r 堆/v 结构/n 的/ude1 存储管理/n 的/ude1 分配算法/n 非常简单/n 。/wj 反之/c ，/wd 回收/v 用户/n 释放/v 的/ude1 空闲/n 块/q 就/d 比较/d 麻烦/an 。/wj 由于/p 系统/n 的/ude1 可/c 利用/v 空间/n 始终/d 是/vshi 一个/mq 地址/n 连续/a 的/ude1 存储/vn 块/q ，/wd 因此/c 回收/v 时/ng 必须/d 将/d 所/usuo 释放/v 的/ude1 空闲/n 块/q 合并/v 到/v 整个/b 堆/n 上/f 去/vf 才/d 能/v 重新/d 使用/v ，/wd 这/rzv 就是/v “/wyz 存储/vn 紧缩/vn ”/wyy 的/ude1 任务/n 。/wj 通常/d ，/wd 有/vyou 两/m 种/q 做法/n ：/wp 一/m 种/q 是/vshi 一旦/d 有/vyou 用户/n 释放/v 存储/v 块/q 即/v 进行/vx 回收/vn 紧缩/vn ，/wd 例如/v ，/wd 图/n 8．12/m (/wkz a/x )/wky 的/ude1 堆/n ，/wd 在/p c/x 串/v 释放/v 存储/v 块/q 时/ng 即/d 回收/v 紧缩/v 成为/v 图/n 8．12/m (/wkz c/x )/wky 的/ude1 堆/n ，/wd 同时/c 修改/v 串/v 的/ude1 存储/vn 映象/n 成/v 图/n 8．12/m (/wkz d/x )/wky 的/ude1 状态/n ；/wf 另/rz 一/m 种/q 是/vshi 在/p 程序执行/n 过程/n 中/f 不/d 回收/v 用户/n 随时/d 释放/v 的/ude1 存储/vn 块/q ，/wd 直到/v 可/v 利用/v 空间/n 不够/a 分配/vn 或/c 堆/v 指针/n 指向/v 最高/a 地址/n 时/ng 才/d 进行/vx 存储/vn 紧缩/vn 。/wj 此时/r 紧缩/vn 的/ude1 目的/n 是/vshi 将/d 堆/v 中/b 所有/b 的/ude1 空闲/n 块/q 连成一片/vl ，/wd 即/d 将/p 所有/b 的/ude1 占用/vn 块/q 都/d 集中/ad 到/v 可/v 利用/v 空间/n 的/ude1 低/a 地址/n 区/n ，/wd 而/cc 剩余/vn 的/ude1 高/a 地址/n 区/n 成为/v 一/m 整个/b 地址/n 连续/a 的/ude1 空闲/n 块/q ，/wd 如/v 图/n 8．13/m 所/usuo 示/vg ，/wd 其中/rz (/wkz a/x )/wky 为/p 紧缩/vn 前/f 的/ude1 状态/n ，/wd (/wkz b/x )/wky 为/p 紧缩/vn 后/f 的/ude1 状态/n 。/wj 
    图/n 8．13/m 紧缩/vn 前后/f 的/ude1 堆/n (/wkz 存储空间/n )/wky 
    (/wkz a/x )/wky 紧缩/v 前/f ；/wf   (/wkz b/x )/wky 紧缩/v 后/f 。/wj 
    和/cc 上/vf 节/n 讨论/vn 的/ude1 无用/vi 单元收集/n 类似/a ，/wd 为/p 实现/v 存储/vn 紧缩/vn ，/wd 首先/d 要/v 对/p 占用/v 块/q 进行/vx “/wyz 标志/n ”/wyy ，/wd 标志/v 算法/n 和/cc 上/vf 节/n 类同/v (/wkz 存储/v 块/q 的/ude1 结构/n 可能/v 不/d 同/v )/wky ；/wf 其次/c 需/v 进行/vx 下列/b 四/m 步/qv 操作/v ：/wp 
    (/wkz 1/m )/wky 计算/v 占用/v 块/q 的/ude1 新/a 地址/n 。/wj 从/p 最低/a 地址/n 始/vg 巡查/v 整个/b 存储空间/n ，/wd 对/p 每/rz 一个/mq 占用/v 块/q 找到/v 它/rr 在/p 紧缩/vn 后/f 的/ude1 新/a 地址/n 。/wj 为此/bl ，/wd 需/v 设立/v 两/m 个/q 指针/n 随/dg 巡查/v 向前/vi 移动/vn ，/wd 这/rzv 两/m 个/q 指针/n 分别/d 指示/v 占用/v 块/q 在/p 紧缩/vn 之前/f 和/cc 之后/f 的/ude1 原/b 地址/n 和/cc 新/a 地址/n 。/wj 因此/c ，/wd 在/p 每个/r 占用/v 块/q 的/ude1 第一/m 个/q 存储单位/n 中/f ，/wd 除了/p 设立/v 长度/n 域/ng (/wkz 存储/v 该/rz 占用/v 块/q 的/ude1 大小/n )/wky 和/cc 标志/n 域/ng (/wkz 存储/vn 区别/n 该/rz 存储/vn 块/q 是/vshi 占用/v 块/q 或/c 空闲/v 块/q 的/ude1 标志/n )/wky 之外/f ，/wd 还/d 需/v 设立/v 一个/mq 新/a 地址/n 域/ng ，/wd 以/p 存储/v 占用/v 块/q 在/p 紧缩/vn 后/f 应有/v 的/ude1 新/a 地址/n ，/wd 即/d 建立/v 一/m 张/q 新/a 、/wn 旧/a 地址/n 的/ude1 对照表/n 。/wj 
    (/wkz 2/m )/wky 修改/v 用户/n 的/ude1 初始/b 变量/n 表/n ，/wd 以便/d 在/p 存储/vn 紧缩/vn 后/f 用户/n 程序/n 能/v 继续正常/n 运行/vn 。/wj 
    (/wkz 3/m )/wky 检查/v 每个/r 占用/v 块中存储/n 的/ude1 数据/n 。/wj 若/c 有/vyou 指向/v 其它/rz 存储/vn 块/q 的/ude1 指针/n ，/wd 则/c 需/v 作/v 相应/vd 修改/v 。/wj     (/wkz 4/m )/wky 将/p 所有/b 占用/v 块/q 迁移/v 到/v 新/a 地址/n 去/vf 。/wj 这/rzv 实质/n 上/f 是/vshi 作/v 传送数据/n 的/ude1 工作/vn 。/wj 
    至此/d ，/wd 完成/v 了/ule 存储/vn 紧缩/vn 的/ude1 操作/vn 。/wj 最后/f ，/wd 将/d 堆/v 指针/n 赋/ng 以/p 新/a 值/n (/wkz 即/v 紧缩/vn 后/f 的/ude1 空闲存储/n 区/n 的/ude1 最低/a 地址/n )/wky 。/wj 
　　可见/c ，/wd 存储/vn 紧缩/vn 法/n 比/p 无用/vi 单元收集/n 法/n 更为/d 复杂/a ，/wd 前者/rzv 不仅/c 要/v 传送数据/n (/wkz 进行/vx 占用/vn 块/q 迁移/v )/wky ，/wd 而且/c 要/v 修改/v 所有/b 占用/v 块/q 中/f 的/ude1 指针/n 值/n 。/wj 因此/c ，/wd 存储/vn 紧缩/vn 也/d 是/vshi 一个/mq 系统/n 操作/vn ，/wd 且非/nr 不得已/vl 就/d 不/d 用/v 。/wj 
　　

第9/m 章/q 查/v     找/v 
    本书/r 在/p 第2/m 章/q 至/p 第7/m 章/q 中/f 已经/d 介绍/v 了/ule 各种/rz 线性/n 或/c 非线性/b 的/ude1 数据/n 结构/n ，/wd 在/p 这/rzv 一/m 章/q 将/d 讨论/v 另/rz 一/m 种/q 在/p 实际/n 应用/vn 中/f 大量/m 使用/v 的/ude1 数据/n 结构/n ――/wp 查找表/n 。/wj 
　　查找表/n (/wkz Search/x  Table/x )/wky   是/vshi 由/p 同一/b 类型/n 的/ude1 数据/n 元素/n (/wkz 或/c 记录/v )/wky 构成/v 的/ude1 集合/n 。/wj 由于/p “/wyz 集合/v ”/wyy 中/f 的/ude1 数据/n 元素/n 之间/f 存在/v 着/uzhe 完全/a 松散/a 的/ude1 关系/n ，/wd 因此/c 查找表/n 是/vshi 一/m 种/q 非常/d 灵便/a 的/ude1 数据/n 结构/n 。/wj 
　　对/p 查找表/n 经常/d 进行/vx 的/ude1 操作/vn 有/vyou ：/wp (/wkz 1/m )/wky 查询/v 某个/rz “/wyz 特定/b 的/ude1 ”/wyy 数据/n 元素/n 是否/v 在/p 查找表/n 中/f ；/wf (/wkz 2/m )/wky 检索/v 某个/rz “/wyz 特定/b 的/ude1 ”/wyy 数据/n 元素/n 的/ude1 各种/rz 属性/n ；/wf (/wkz 3/m )/wky 在/p 查找表/n 中/f 插入/v 一个/mq 数据/n 元素/n ；/wf (/wkz 4/m )/wky 从/p 查找表/n 中/f 删去/v 某个/rz 数据/n 元素/n 。/wj 若/c 对/p 查找表/n 只/d 作/v 前/f 两/m 种/q 统称/v 为/v “/wyz 查找/v ”/wyy 的/ude1 操作/vn ，/wd 则/c 称/v 此类/r 查找表/n 为/p 静态/n 查找表/n (/wkz static/x  Search/x  Table/x )/wky 。/wj 若/c 在/p 查找/v 过程/n 中/f 同时/d 插入/v 查找表/n 中/f 不/d 存在/v 的/ude1 数据/n 元素/n ，/wd 或者/c 从/p 查找表/n 中/f 删除/v 已/d 存在/v 的/ude1 某个/rz 数据/n 元素/n ，/wd 则/c 称/v 此类/r 表/n 为/p 动态查找表/n (/wkz 【/wkz )/wky ynamic：SearchTable/x )/wky 。/wj 
    在/p 日常/b 生活/vn 中/f ，/wd 人们/n 几乎/d 每天/r 都/d 要/v 进行/vx “/wyz 查找/v ”/wyy 工作/vn 。/wj 例如/v ，/wd 在/p 电话号码簿/n 中/f 查阅/v “/wyz 某/rz 单位/n ”/wyy 或/c “/wyz 某人/rr ”/wyy 的/ude1 电话号码/n ；/wf 在/p 字典/n 中/f 查阅/v “/wyz 某个/rz 词/n ”/wyy 的/ude1 读音/n 和/cc 含义/n 等等/udeng 。/wj 其中/rz “/wyz 电话号码簿/n ”/wyy 和/cc “/wyz 字典/n ”/wyy 都/d 可/v 视/vg 作/v 是/vshi 一/m 张/q 查找表/n 。/wj 
    在/p 各种/rz 系统/n 软件/n 或应用软件/n 中/f ，/wd 查找表/n 也/d 是/vshi 一/m 种/q 最/d 常见/a 的/ude1 结构/n 之一/rz 。/wj 如/v 编译程序/n 中/b 符号/n 表/n 、/wn 信息/n 处理/vn 系统/n 中/b 信息/n 表/n 等等/udeng 。/wj 
    由/p 上述/b 可见/c ，/wd 所谓/v ”/wyy 查找/v ”/wyy 即/d 为/v 在/p 一个/mq 含有/v 众多/m 的/ude1 数据/n 元素/n (/wkz 或/c 记录/v )/wky 的/ude1 查找表/n 中/f 找/v 出/vf 某个/rz “/wyz 特定/b 的/ude1 ”/wyy 数据/n 元素/n (/wkz 或/c 记录/v )/wky 。/wj 
    为了/p 便于/v 讨论/vn ，/wd 必须/d 给/v 出/vf 这个/rz “/wyz 特定/b 的/ude1 ”/wyy 词/n 的/ude1 确切/a 含义/n 。/wj 首先/c 需/v 引入/v 一个/mq “/wyz 关键/n 字/n ”/wyy 的/ude1 概念/n 。/wj 
    关键/n 字/n (/wkz Key/x )/wky 是/vshi 数据/n 元素/n (/wkz 或/c 记录/v )/wky 中/f 某个/rz 数据项/n 的/ude1 值/n ，/wd 用/p 它/rr 可以/v 标识/n (/wkz 识别/v )/wky 一个/mq 数据/n 元素/n (/wkz 或/c 记录/v )/wky 。/wj 若/c 此/rzs 关键字/n 可以/v 唯一/b 地/n 标识/n 一个/mq 记录/n ，/wd 则/c 称/v 此/rzs 关键字/n 为主/vi 关键字/n (/wkz Primarly/x  Key/x )/wky (/wkz 对/p 不同/a 的/ude1 记录/n ，/wd 其/rz 主/n 关键字/n 均不同/n )/wky 。/wj 反之/c ，/wd 称/v 用以/d 识别/v 若干/m 记录/n 的/ude1 关键/n 字/n 为/v 次关键字/n (/wkz Seeondary：Key/x )/wky 。/wj 当/p 数据/n 元素/n 只/d 有/vyou 一个/mq 数据项/n 时/ng ，/wd 其/rz 关键字/n 即/d 为/v 该/rz 数据/n 元素/n 的/ude1 值/n 。/wj 
    查找/v (/wkz Searching/x )/wky   根据/p 给定/v 的/ude1 某个/rz 值/n ，/wd 在/p 查找表/n 中/f 确定/v 一个/mq 其/rz 关键字/n 等于/v 给/p 定/v 值/n 的/ude1 记录/n 或/c 数据/n 元素/n 。/wj 若/c 表/n 中/f 存在/v 这样/rzv 的/ude1 一个/mq 记录/n ，/wd 则/c 称/v 查找/v 是/vshi 成功/a 的/ude1 ，/wd 此时/r 查找/v 的/ude1 结果/n 为/p 给/v 出/vf 整个/b 记录/n 的/ude1 信息/n ，/wd 或/c 指示/v 该/rz 记录/n 在/p 查找表/n 中/f 的/ude1 位置/n ；/wf 若/c 表/n 中/f 不/d 存在/v 关键字/n 等于/v 给/p 定/v 值/n 的/ude1 记录/n ，/wd 则/c 称/v 查找/v 不/d 成功/a ，/wd 此时/r 查找/v 的/ude1 结果/n 可/v 给/v 出/vf 一个/mq “/wyz 空/ng ”/wyy 记录/v 或/c “/wyz 空/ng ”/wyy 指针/n 。/wj 
    例如/v ，/wd 当/v 用/p 计算机处理/n 大学/n 入学/vn 考试/vn 成绩/n 时/ng ，/wd 全部/m 考生/n 的/ude1 成绩/n 可以/v 用/p 图/n 9．1/m 所/usuo 示/vg 表/n 的/ude1 结构/n 储存/v 在/p 计算机/n 中/f ，/wd 表/n 中/f 每/rz 一/m 行为/n 一个/mq 记录/n ，/wd 考生/n 的/ude1 准考证/n 号/q 为/p 记录/n 的/ude1 关键/n 字/n 。/wj 假设/n 给定/vn 值/n 为/p 179326/m ，/wd 则/c 通过/p 查找/v 可/v 得/ude3 考生/n 陆华/nr 的/ude1 各科/r 成绩/n 和/cc 总分/n ，/wd 此时/r 查找/v 为/p 成功/a 的/ude1 。/wj 若/c 给/p 定/v 值/v 为/p 179238/m ，/wd 则/c 由于/p 表/n 中/f 没有/v 关键字/n 为/p 179238/m 的/ude1 记录/n ，/wd 则/c 查找/v 不/d 成功/a 。/wj 
    如何/ryv 进行/vx 查找/vn ?/ww 显然/a ，/wd 在/p 一个/mq 结构/n 中/f 查找/v 某个/rz 数据/n 元素/n 的/ude1 过程/n 依赖/v 于/p 这个/rz 数据/n 元素/n 在/p 结构/n 中/f 所/usuo 处/vi 的/ude1 地位/n 。/wj 因此/c ，/wd 对/p 表/n 进行/vx 查找/vn 的/ude1 方法/n 取决于/v 表/vg 中/b 数据/n 元素/n 依/v 何/ry 种/q 关系/n (/wkz 这个/rz 关系/n 是/vshi 人为/d 地/ude2 加上/v 的/ude1 )/wky 组织/v 在/p 一起/s 的/ude1 。/wj 例如/v 查/v 电话号码/n 时/ng ，/wd 由于/c 电话号码簿/n 是/vshi 按/p 用户/n (/wkz 集体/n 或/c 个人/n )/wky 的/ude1 名称/n (/wkz 或/c 姓名/n )/wky 分类/vn 且/c 依/p 笔划顺序/n 编排/vn ，/wd 则/c 查找/v 的/ude1 方法/n 就/d 是/vshi 先/d 顺序/n 查找/v 待查/v 用户/n 的/ude1 所属/vn 类别/n ，/wd 然后/c 在/p 此/rzs 类/q 中/b 顺序/n 查找/v ，/wd 直到/v 找到/v 该/rz 用户/n 的/ude1 电话号码/n 为止/u 。/wj 又/d 如/v ，/wd 查阅/v 英文/nz 单词/n 时/ng ，/wd 由于/c 字典/n 是/vshi 按/p 单词/n 的/ude1 字母/n 在/p 字母表/n 中/f 的/ude1 次序/n 编排/v 的/ude1 ，/wd 因此/c 查找/v 时/ng 不/d 需要/v 从/p 字典/n 中/f 第一/m 个/q 单词/n 比较/d 起/vf ，/wd 而/cc 只/d 要/v 根据/p 待查/v 单词/n 中/f 每个/r 字母/n 在/p 字母表/n 中/f 的/ude1 位置/n 查/v 到/v 该/rz 单词/n 。/wj 
图/n 9．1/m 高考/vn 成绩/n 表示/v 例/n 
    同样/d ，/wd 在/p 计算机/n 中/f 进行/vx 查找/vn 的/ude1 方法/n 也/d 随/v 数据/n 结构/n 不同/an 而/cc 不同/a 。/wj 正/d 如前所述/vl ，/wd 本/rz 章/n 讨论/vn 的/ude1 查找表/n 是/vshi 一/m 种/q 非常/d 灵便/a 的/ude1 数据/n 结构/n 。/wj 但/c 也/d 正是/v 由于/p 表/n 中/b 数据/n 元素/n 之间/f 仅/d 存在/v 着/uzhe “/wyz 同/p 属/v 一个/mq 集合/n ”/wyy 的/ude1 松散/a 关系/n ，/wd 给/p 查找/v 带来/v 不便/an 。/wj 为此/bl ，/wd 需/v 在/p 数据/n 元素/n 之间/f 人为/d 地/ude2 加上/v 一些/mq 关系/n ，/wd 以便/d 按/p 某种/rz 规则/n 进行/vx 查找/vn ，/wd 即/d 以/p 另/rz 一/m 种/q 数据/n 结构/n 来/vf 表示/v 查找表/n 。/wj 本章/nr2 将/d 分别/d 就/p 静态/n 查找表/n 和/cc 动态查找表/n 两/m 种/q 抽象数据/n 类型/n 讨论/v 其/rz 表示/v 和/cc 操作实现/n 的/ude1 方法/n 。/wj 
　　在/p 本/rz 章/n 以/p 后备/b 节/n 的/ude1 讨论/vn 中/f ，/wd 涉及/v 的/ude1 关键字类型/n 和/cc 数据/n 元素/n 类型/n 统一/ad 说明/v 如下/vi ：/wp 
　　    典型/n 的/ude1 关键字类型/n 说明/v 可以/v 是/vshi 
    数据/n 元素/n 类型定义/n 为/v ：/wp 
    ∥/w 实/a 型/k 
∥/w 整/m 型/k 
∥/w 字符串/n 型/k 
∥/w 关键字/n 域/ng 
∥/w 其它/rz 域/ng 
    fElemType/x ；/wf 
对/p 两/m 个/q 关键/n 字/n 的/ude1 比较/d 约定/v 为/v 如下/vi 的/ude1 宏/nz 定义/n 
  ∥/w --/wp 对/p 数值/n 型/k 关键字/n 
  #/n define/x  EQ/x (/wkz a/x ，/wd b/x )/wky   (/wkz (/wkz a/x )/wky ==/m (/wkz b/x )/wky )/wky 
  #/n define/x  LT/x (/wkz a/x ，/wd b/x )/wky (/wkz (/wkz a/x )/wky </n   (/wkz b/x )/wky )/wky 
  #/n i∞LQ/x (/wkz a/x ，/wd b/x )/wky (/wkz (/wkz a/x )/wky </n =/m (/wkz b/x )/wky )/wky 
  ∥/w 对/p 字符串/n 型/k 关键字/n 
  #/n define/x  EQ/x (/wkz a/x ，/wd b/x )/wky (/wkz !/wt strcmp/x (/wkz (/wkz a/x )/wky ，/wd (/wkz b/x )/wky )/wky )/wky 
  #/n define/x  LT/x (/wkz a/x ，/wd b/x )/wky (/wkz strcmp/x (/wkz (/wkz a/x )/wky ，/wd (/wkz b/x )/wky )/wky </n 0/m )/wky 
  #/n define/x  LQ/x (/wkz a/x ，/wd b/x )/wky (/wkz strcmp/x (/wkz (/wkz a/x )/wky ，/wd (/wkz b/x )/wky )/wky </n =0/m )/wky 
・/w 215/m   ・/w 
9．1/m 静态/n 查找表/n 
抽象数据/n 类型/n 静态/n 查找表/n 的/ude1 定义/n 为/v ：/wp 
  ADT/x  StaticSearchTable/x {/n 
    数据/n 对象/n D：D/x 是/vshi 具有/v 相同/a 特性/n 的/ude1 数据/n 元素/n 的/ude1 集合/n 。/wj 各个/rz 数据/n 元素/n 均/d 含有/v 类型/n 相同/a ，/wd 可/v 唯一/b 标识/n     数据/n 元素/n 的/ude1 关键/n 字/n 。/wj     数据/n 关系/n R：/x 数据/n 元素/n 同/p 属/v 一个/mq 集合/n 。/wj 
    基本/ad 操作/v P：/x 
    Create/x (/wkz &/n ST/x ，/wd n/x )/wky ；/wf 
    操作/v 结果/n ：/wp 构造/v 一个/mq 含/v n/x 个/q 数据/n 元素/n 的/ude1 静态/n 查找表/n sT/x 。/wj 
    Dest：roy/x (/wkz ＆/n sT/x )/wky ；/wf 
    初始条件/n ：/wp 静态/n 查找表/n sT/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 表/n ST/x 。/wj 
    Search/x (/wkz sT/x ，/wd key/x )/wky ；/wf 
    初始条件/n ：/wp 静态/n 查找表/n sT/x 存在/v ，/wd key/x 为/v 和/cc 关键字类型/n 相同/a 的/ude1 给/p 定/v 值/n 。/wj 
    操作/v 结果/n ：/wp 若/v sT/x 中/f 存在/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n ，/wd 则/c 函数值/n 为/p 该/rz 元素/n 的/ude1 值/n 或/c 在/p 表/n 中/f 的/ude1 
    位置/n ，/wd 否则/c 为/v “/wyz 空/ng ”/wyy 。/wj 
    ’/wyy traverse/x (/wkz sT/x ，/wd Visit/x (/wkz )/wky )/wky ；/wf 
    初始条件/n ：/wp 静态/n 查找表/n 钉/v 存在/v ，/wd visit/x 是/vshi 对/p 元素/n 操作/vn 的/ude1 应用/vn 函数/n 。/wj 
    操作/v 结果/n ：/wp 按/p 某种/rz 次序/n 对/p sT/x 的/ude1 每个/r 元素/n 调用函数/n visit/x (/wkz )/wky 一/m 次/qv 且/c 仅/d 一/m 次/qv 。/wj 一旦/d visit/x (/wkz )/wky 失/v     败/vi ，/wd 则/c 操作失败/n 。/wj 
    }/n ADT/x  StaticSearchTable/x 
    静态/n 查找表/n 可以/v 有/vyou 不同/a 的/ude1 表示方法/n ，/wd 在/p 不同/a 的/ude1 表示方法/n 中/f ，/wd 实现/v 查找/v 操作/v 的/ude1 方法/n 也/d 不同/a 。/wj 
  9．1．1/m 顺序/n 表/n 的/ude1 查找/vn 
  以/p 顺序/n 表/n 或/c 线性/n 链/ng 表表示/n 静态/n 查找表/n ，/wd 则/d searc/x ’/wyy I/x 、/wn 函数/n 可用/a 顺序/n 查找/v 来/vf 实现/v 。/wj 本/rz 节/n 中/f 只/d 讨论/v 它/rr 在/p 顺序/n 存储/vn 结构/n 模块/n 中/f 的/ude1 实现/vn ，/wd 在/p 线性/n 链/ng 表/vg 模块/n 中/f 实现/v 的/ude1 情况/n 留给/v 读者/n 去/vf 完成/v 。/wj     ∥/w ----/wp 一/m 静态/n 查找表/n 的/ude1 顺序/n 存储/vn 结构/n ----/wp 一/m 
    ’/wyy typedef/x  struct/x {/n 
    ElemType/x */n el/x 鲫/n ；/wf     ∥/w 数据/n 元素/n 存储空间/n 基址/n ，/wd 建/v 表/vg 时/ng 按/p 实际/n 长度/n 分配/vn ，/wd 0/m 号/q 单元/n 留/v 空/ng 
    int/x     length/x ；/wf   ∥/w 表/vg 长度/n 
    }/n sSTable/x ；/wf 
    下面/f 讨论/v 顺序/n 查找/v 的/ude1 实现/vn 。/wj 
    顺序/n 查找/v (/wkz Sequential/x  Search/x )/wky 的/ude1 查找/vn 过程/n 为/v ：/wp 从/p 表/n 中/f 最后/f 一个/mq 记录开始/n ，/wd 逐个/d 进行/vx 记录/vn 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 的/ude1 比较/vn ，/wd 若/c 某个/rz 记录/n 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 比较/d 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 找到/v 所/usuo 查/v 记录/v ；/wf 反之/c ，/wd 若/c 直至/v 第一/m 个/q 记录/n ，/wd 其/rz 关键字/n 和/cc 给/p 定/v 值/n 比较/d 都/d 不/d 等/v ，/wd 则/c 表明/v 表/n 中/f 没有/v 所/usuo 查/v 记录/v ，/wd 查找/v 不/d 成功/a 。/wj 此/rzs 查找/v 过程/n 可用/a 算法/n 9．1/m 描述/v 之/uzhi 。/wj     
int/x  Search―seq/x (/wkz SSTable/x  sT/x ，/wd Ke/x !/wt ／Type/x  key/x )/wky {/n 
  ∥/w 在/p 顺序/n 表/n ST/x 中/b 顺序/n 查找/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n 。/wj 若/c 找到/v ，/wd 则/c 函数值/n 为/v 
  ∥/w 该/rz 元素/n 在/p 表/n 中/f 的/ude1 位置/n ，/wd 否则/c 为/p 0/m 。/wj 
  ST．elem/x [/wkz 0/m ]/wky ．/w key=key/x ；/wf 
・/w 216・/m 
∥/w “/wyz 哨兵/n ”/wyy 
  for/x (/wkz i=sT．1ength/x ；/wf !/wt EQ/x (/wkz sT．elem/x [/wkz i/x ]/wky ．/w key/x ，/wd key/x )/wky ；/wf   i/x )/wky ；/wf ∥/w 从/p 后/f 往/p 前/f 找/v   refur/x ,/wd l/x  i：/x     ∥/w 找/v 不/d 到/v 时/ng ，/wd i/x 为/p 0/m 
＼I/x |/n Search―Seq/x 
    算法/n 9．1/m 
    这个/rz 算法/n 的/ude1 思想/n 和/cc 第2/m 章/q 中/f 的/ude1 函数/n LocateElbm/x  Sq/x 一致/a 。/wj 只/d 是/vshi 在/p Search―Seq/x 中/f ，/wd 查找/v 之前/f 先/d 对/p sT．elem/x [/wkz 0/m ]/wky 的/ude1 关键字/n 赋值/v key/x ，/wd 目的/n 在于/v 免去/v 查找/v 过程/n 中/f 每/rz 一/m 步/qv 都/d 要/v 检测/v 整个/b 表/n 是否/v 查找/v 完毕/vi 。/wj 在/p 此/rzs ，/wd ST．elem/x [/wkz 0/m ]/wky 起到/v 了/ule 监视哨/n 的/ude1 作用/n 。/wj 这/rzv 仅/d 是/vshi 一个/mq 程序设计/n 技巧/n 上/f 的/ude1 改进/vn ，/wd 然而/c 实践/v 证明/v ，/wd 这个/rz 改进/v 能/v 使/v 顺序/n 查找/v 在/p ST．1ength≥1000/x 时/ng ，/wd 进行/vx 一/m 次查找/n 所/usuo 需/v 的/ude1 平均/a 时间/n 几乎/d 减少/v 一半/m ，/wd (/wkz 参阅/v 参考书/n 目/ng [/wkz 1/m ]/wky 中/f 342/m 页/q 表/n 7．1/m )/wky 。/wj 当然/d ，/wd 监视哨/n 也/d 可/v 设/v 在/p 高/a 下标/n 处/vi 。/wj 
    查找/v 操作/v 的/ude1 性能/n 分析/vn 
    在/p 第1/m 章/q 中/f 曾/d 提及/v ，/wd 衡量/v 一个/mq 算法/n 好坏/n 的/ude1 量度/n 有/vyou 三/m 条/q ：/wp 时间/n 复杂度/n (/wkz 衡量/v 算法/n 执行/v 的/ude1 时间/n 量级/n )/wky 、/wn 空间/n 复杂度/n (/wkz 衡量/v 算法/n 的/ude1 数据/n 结构/n 所/usuo 占/v 存储/vn 以及/cc 大量/m 的/ude1 附加/vn 存储/vn )/wky 、/wn 和/cc 算法/n 的/ude1 其它/rz 性能/n 。/wj 对于/p 查找算法/n 来说/uls ，/wd 通常/d 只/d 需要/v 一个/mq 或/c 几/m 个/q 辅助/vn 空间/n 。/wj 又/c ，/wd 查找算法/n 中/f 的/ude1 基本/a 操作/vn 是/vshi “/wyz 将/d 记录/v 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 进行/vx 比较/vn ”/wyy ，/wd 因此/c ，/wd 通常/d 以/p “/wyz 其/rz 关键字/n 和/cc 给/p 定/v 值/n 进行/vx 过/uguo 比较/vn 的/ude1 记录/n 个/q 数/n 的/ude1 平均值/n ”/wyy 作为/v 衡量/v 查找算法/n 好坏/n 的/ude1 依据/n 。/wj 
    定义/n ：/wp 为/v 确定/v 记录/v 在/p 查找表/n 中/f 的/ude1 位置/n ，/wd 需/v 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 的/ude1 期望值/n 称为/v 查找算法/n 在/p 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n (/wkz ．/w Average/x  Search/x  Length/x )/wky 。/wj 
　　对于/p 含有/v n/x 个/q 记录/n 的/ude1 表/n ，/wd 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/p 其中/rz ：/wp Pi/x 为/p 查找表/n 中/f 第/m i/x 个/q 记录/n 的/ude1 概率/n ，/wd 且/c ∑Pi=1/x ；/wf 
　　ci/x 为/p 找到/v 表/n 中/f 其/rz 关键字/n 与/cc 给/p 定/v 值/n 相等/vi 的/ude1 第/m i/x 个/q 记录/n 时/ng ，/wd 和/cc 给/p 定/v 值/n 已/d 进行/vx 过/uguo 比较/vn 的/ude1 关键字/n 个数/n 。/wj 显然/a ，/wd Ci/x 随/p 查找/v 过程/n 不同/an 而/cc 不同/a 。/wj 
    从/p 顺序/n 查找/v 的/ude1 过程/n 可见/c ，/wd ci/x 取决于/v 所/usuo 查/v 记录/v 在/p 表/n 中/f 的/ude1 位置/n 。/wj 如/v ：/wp 查找表/n 中/f 最后/f 一个/mq 记录/n 时/ng ，/wd 仅/d 需/v 比较/d 一/m 次/qv ；/wf 而/cc 查找表/n 中/f 第一/m 个/q 记录/n 时/ng ，/wd 则/c 需/v 比较/d n/x 次/qv 。/wj 一般/a 情况/n 下/f Ci/x 等/udeng 于/p ni+1/x 。/wj 
    假设/n =sT．1ength/x ，/wd 则/c 顺序/n 查找/v 的/ude1 平均/ad 查找/v 长度/n 为/v 1+P/x 。/wj     (/wkz 9/m 
    假设/n 每个/r 记录/n 的/ude1 查找/vn 概率/n 相等/vi ，/wd 即/v 
则/c 在/v 等/udeng 概率/n 情况/n 下/vf 顺序/n 查找/v 的/ude1 平均/ad 查找/v 长度/n 为/v 
    有/vyou 叫/vi ，/wd 表/n p/x 各个/rz 记录/n 的/ude1 查找/vn 概率/n 并不/d 棚/n 等/udeng 。/wj 例如/v ：/wp 将/p 全校/n 学生/n 的/ude1 在/p 计算机/n 中/f ，/wd 则/d 体/ng 弱/a 多/a 的/ude1 病历/n 记录/v 的/ude1 查/v 哉/y 概率/n 必定/d 离/v 于/p 健/ag 埭/n 同学/n 的/ude1 病历/n 记录/n 。/wj 
  [/wkz h/x  r/x 式/k (/wkz 9．2/m )/wky 中/f 的/ude1 AsL/x 在/p j/x ，/wd 。/wj ≥/m ，/wd ’/wyy 一/m l≥≥P/x !/wt ≥P1/x 时/ng 达到/v 极小值/n 。/wj 因此/c ，/wd 对/p 融/vi 采/v fI/x {/n J/x 代/q 找/v   概率/n 不等/vi 的/ude1 查找表/n 若/c 能/v 预先/d 得知/v 每个/r 记录/n 的/ude1 查找/vn 概率/n ，/wd 则/c 应/v 先/d 列/v }/n 己/rr 录/v 的/ude1 查找/vn 概率/n 进行/vx 排/v   序/n ，/wd 使/v 表中记录/n 按/p 查找/v 概率/n 由/p 小/a 至/p 大/a 重新/d 排列/v ，/wd 以便/d 提高/v 查找效率/n 。/wj 
    然而/c ，/wd 在/p 一般/a 情况/n 下/f ，/wd }/n 己/rr 录/v 的/ude1 查找/vn 慨/ag 率/v 预先/d 无法/v 测定/vn 。/wj 为了/p 提高/v 查找/v 效宰/nr2 ，/wd 我们/rr 可以/v 在/p 每个/r 记/v 求/v 小/a 附/v |/n 殳/nr1 一个/mq 访问/vn 频度/n 域/ng ，/wd 并/cc 使/v 顺序/n 表/n 中/f 曲/ng 记录/v 始终/d 保持/v 按/p 漪/ng 问/v 频度/n 非/b 递减/vn 有/vyou   序/n 的/ude1 次序排列/n ，/wd 使得/vi 查找/v 概率/n 大/a 的/ude1 记录/n 在/p 查找/v 过程/n 中/f 不断/d 往后/t 移/v ，/wd 吼/vi 便/d 在/p “/wyz 后/f 的/ude1 逐次/d 查找/v 小/a 减少/v 比较/vn 次数/n 。/wj 或者/c 在/p 每/rz 次查找/n 之后/f 都/d 将/d 刚/d 查找/v 到/v 的/ude1 记录/n 直接/ad 移/v 至/p 表/n 尾/ng 。/wj 
    顺序/n 查找/v 和/cc 我们/rr 后/f Jn/x 】/wky 将要/d 刊/vg 论/ng 到/v 的/ude1 其它/rz 查找算法/n 相比/vi ，/wd 』/wyy t/x 缺点/n 足/d 平均/ad 查找/v 长度较/n 大/a ，/wd   特/ag {/n =/m }/n Il/x 是/vshi 当/v ”/wyy 很/d 大/a 时/ng ，/wd 查找效率/n 较/d 低/a 。/wj 然而/c ，/wd 它/rr 有/vyou 很/d 大/a 的/ude1 优点/n 是/vshi ：/wp 算法/n 简单/a 目/ng 适应/v 面/q 广/a 。/wj 它/rr 对/p 表/n 的/ude1 结构/n 无/v 任何/rz 要求/n ，/wd 无/v 沦/n 记录/v 是否/v 按/p 关键/n 宁/dg 有序/a ‘/wyz 。/wj ’/wyy 均/d 可/v 麻/n 用/v ，/wd 而/cc ‰L/x 述/vg 所有/b 训/v 论/k 对/p 线性/n ：/wp 链/ng 表/vg 电/n 同样/d 适用/vi 。/wj 
    容易/ad 看出/v ，/wd 上述/b 对/p 平均/ad 查找/v 艮/n 赏/v 的/ude1 刊/vg 沦/n 足/d 在/p ∑P．=I/x 的/ude1 前/f 挺/vi 下/f 进行/vx 的/ude1 ，/wd 换/v 句/q 活/n 说/v ，/wd 我们/rr 认为/v 每次/r 拇/n 找/v 都/d 灶/n “/wyz 成功/a ”/wyy 的/ude1 。/wj 在/p 本/rz 章/n 开始/v 时/ng 曾/d 提到/v ，/wd 查找/v 可能/v 产生/v “/wyz 成功/a ”/wyy 与/p “/wyz 不/d 成功/a   两/m 利/n -/wp 结果/n ，/wd 但/c 柱/ng 实际/ad 应/v 川/b 的/ude1 大多数/m 情况/n 下/f ，/wd 查找/v 成功/a 的/ude1 0lJ/x 能/v 性/ng ：/wp 比/p 不/d 成功/a 的/ude1 可能性/n 大/a 得/ude3 多/a ，/wd ’/wyy 特别/d 足/d 在/p 表/n t/x ”/wyy 记录/v 数/n ”/wyy 很/d 大/a 时/ng ．/w 查找/v 不/d 成功/a 的/ude1 概率/n 可/v 眦/n 忽略/v 不/d 计/vi 。/wj !/wt _/n 谯/nr1 找/v 4/m ；/wf 成功/a 的/ude1 情形/n 步/qv 缩小/v 范围/n 直到/v 找到/v 或/c 找/v 不/d 到/v 该/rz 记录/n 为止/u 。/wj 
    例如/v ：/wp 已/d 知/v 如下/vi 11/m 个/q 数据/n 元素/n 的/ude1 有序/a 表/n (/wkz 关键字/n 即/d 为/v 数据/n 元素/n 的/ude1 值/n )/wky ：/wp     (/wkz 05/m ，/wd 13/m ，/wd 19/m ，/wd 21/m ，/wd 37/m ，/wd 56/m ，/wd 64/m ，/wd 75/m ，/wd 80/m ，/wd 88/m ，/wd 92/m )/wky 
现/tg 要/v 查找/v 关键字/n 为/p 21/m 和/cc 85/m 的/ude1 数据/n 元素/n 。/wj 
    假设/v 指针/n lo/x 训/v 和/cc high/x 分别/d 指示/v 待查/v 元素/n 所在/n 范围/n 的/ude1 下/vf 界/n 和/cc 上/vf 界/n ，/wd 指针/n mid/x 指示/n 区间/n 的/ude1 中间/f 位置/n ，/wd 即/v mid=L/x (/wkz 10/m 叫/vi +high/x )/wky ／2/m  J/x 。/wj 在/p 此/rzs 例/n 中/f ，/wd low/x 和/cc high/x 的/ude1 初值/n 分别/d 为/v 1/m 
和/cc 11/m ，/wd 即/v [/wkz 1/m ，/wd 11/m ]/wky 为/p 待查/v 范围/n 。/wj 
    下面/f 先/d 看/v 给/p 定/v 值/n key=21/x 的/ude1 查找/vn 过程/n ：/wp 
    05/m   13/m   19/m  21/m   37/m   56/m  64/m   75/m  80/m  88/m  92/m 
    首先/c 令/v 查找/v 范围/n 中间/f 位置/n 的/ude1 数据/n 元素/n 的/ude1 关键/n 字/n ST/x 。/wj elem/x [/wkz mid/x ]/wky ．/w key/x 与/cc 给/p 定/v 值/n key/x 相/d 比较/v ，/wd 因为/p sT．elem/x [/wkz mid/x ]/wky ．/w key/x >/n key/x ，/wd 说明/v 待查/v 元素/n 若/c 存在/v ，/wd 必/d 在/p 区间/n [/wkz 10W/x ，/wd mid-1/x ]/wky 的/ude1 范围/n 内/f ，/wd 则/c 令/v 指针/n high/x 指向/v 第/m mid-1/x 个/q 元素/n ，/wd 重新/d 求得/v mid=l/x (/wkz 1+5/m )/wky ／2/m  j=3/x 仍/d 以/p ST．elem/x [/wkz mid/x ]/wky ．/w key/x 和/cc key/x 相比/vi ，/wd 因为/p ST．elem/x [/wkz mid/x ]/wky ．/w key/x </n key/x ，/wd 说明/v 待查/v 元素/n 若/c 存在/v ，/wd 必/d 在/p [/wkz mid/x 十/m 1/m ，/wd high/x ]/wky 范围/n 内/f ，/wd 则/c 令/v 指针/n low/x 指向/v 第/m mid+1/x 个/q 元素/n ，/wd 求得/v mid/x 的/ude1 新/a 值/n 为/p 4/m ，/wd 比较/d ST．elem/x [/wkz mid/x ]/wky ．/w key/x 和/cc key/x ，/wd 因为/c 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 所/usuo 查/v 元素/n 在/p 表/n 中/b 序号/n 等于/v 指针/n mid/x 的/ude1 值/n 。/wj 
  此时/r 因为/p 下/f 界/n low/x >/n 上/f 界/n high/x ，/wd 则/c 说明/v 表/n 中/f 没有/v 关键字/n 等于/v key/x 的/ude1 元素/n ，/wd 查找/v 不/d 成功/a 。/wj 
    从/p 上述/b 例子/n 可见/c ，/wd 折半/v 查找/v 过程/n 是/vshi 以/p 处于/v 区间/n 中间/f 位置/n 记录/v 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 比较/vn ,/wd 若/c 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 若/c 不/d 等/v ，/wd ~/n INd/x ,/wd NN/x ，/wd 直至/v 新/a 的/ude1 区间/n 中间/f 位置/n 记录/v 的/ude1 关键字/n 等于/v 给/p 定/v 值/n 或者/c 查找/v 区间/n 的/ude1 大/a 小/a 小/a 于/p 零时/t (/wkz 表明/v 查找/v 不/d 成功/a )/wky 为止/u 。/wj 
    上述/b 折半/v 查找/v 过程/n 如/v 算法/n 9．2/m 描述/v 所/usuo 示/vg 。/wj 
・/w 219/m   ・/w 
int/x  Search―Bin/x (/wkz SSTab/x ]/wky ．/w e/x  sT/x ，/wd KeyType/x  key/x )/wky j/x 
  ∥/w 在/p 有序/a 表/n sT/x 中/f 折半/v 查找/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n 。/wj 若/c 找到/v ，/wd 则/c 函数值/n 为/v 
  ∥/w 该/rz 元素/n 在/p 表/n 中/f 的/ude1 位置/n ，/wd 否则/c 为/p 0/m 。/wj 
  low：1/x ；/wf hiqh=sT．1ength/x ；/wf     ∥/w 置/v 区间/n 初值/n 
  while/x (/wkz 1/m 。/wj w/x </n =high/x )/wky {/n 
    mid=/x (/wkz 10w+high/x )/wky ／2/m ；/wf 
    if/x  EQ/x (/wkz key/x ，/wd sT．elem/x [/wkz mid/x ]/wky ．/w key/x )/wky   return/x  mid/x ；/wf     ∥/w 找到/v 待查/v 元素/n 
    elge/x  if/x  LT/x (/wkz key/x ，/wd sT．elem/x [/wkz mid/x ]/wky ．/w key/x )/wky   high=mid-1/x ；/wf   ∥/w 继续/v 在/p 前/f 半/m 区间/n 进行/vx 查找/vn 
    eIse/x  10w=mid+1/x ；/wf     ∥/w 继续/v 在/p 后/f 半/m 区间/n 进行/vx 查找/vn 
  }/n 
  ：/wp 。/wj turf/x 。/wj 0：/m     ∥/w 顺序/n 表/n 中/f 不/d 存在/v 待查/v 元素/n 
}/n ∥/w SearchBin/x 
    算法/n 9．2/m 
  折半/v 查找/v 的/ude1 性能/n 分析/vn 
  先/d 看/v 上述/b 11/m 个/q 元素/n 的/ude1 表/n 的/ude1 具体/a 例子/n 。/wj 从/p 上述/b 查找/vn 过程/n 可知/v ：/wp 
  找/v 到/v 第⑥/m 个/q 元素/n 仅/d 需/v 比较/d 1/m 次/qv ；/wf 找/v 到/v 第③/m 和/cc 第⑨/m 个/q 元素/n 需/v 比较/d 2/m 次/qv ；/wf 找/v 到/v 第①/m 、/wn ④/m 、/wn ⑦/m 和/cc ⑩/m 个/q 元素/n 需/v 比较/d 3/m 次/qv ；/wf 找/v 到/v 第②/m 、/wn ⑤/m 、/wn ⑧/m 和/cc ⑩/m 个/q 元素/n 需/v 比较/d 4/m 次/qv 。/wj 
    这个/rz 查找/v 过程/n 可用/a 图/n 9．2/m 所/usuo 示/vg 的/ude1 二/m 叉树/n 来/vf 描述/v 。/wj 树/n 中/f 每个/r 结点/n 表示/v 表/n 中/f 一个/mq 记录/n ，/wd 结点/n 中/f 的/ude1 值/n 为/p 该/rz 记录/n 在/p 表/n 中/f 的/ude1 位置/n ，/wd 通常/d 称/v 这个/rz 描述/v 查找/v 过程/n 的/ude1 二/m 叉树/n 为/p 判定/v 树/n ，/wd 从/p 判定/v 树上/s 可见/v ，/wd 查找/v 21/m 的/ude1 过程/n 恰好/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 结点/n ④/m 的/ude1 路径/n ，/wd 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 为/p 该/rz 路径/n 上/f 的/ude1 结/v 点数/n 或/c 结点/n ④/m 在/p 判定/v 树上/s 的/ude1 层次/n 数/n 。/wj 类似/a 地/ude2 ，/wd 找到/v 有序/a 表/n 中/f 任/v 一/m 记录/n 的/ude1 过程/n 就/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 结点/n 到/v 与/p 该/rz 记录/n 相应/vi 的/ude1 结点/n 的/ude1 路径/n ，/wd 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 恰/d 为/v 该/rz 结点/n 在/p 判定/v 树上/s 的/ude1 层次/n 数/n 。/wj 因此/c ，/wd 折半/v 查找/v 法/n 在/p 查找/v 成功/a 时/ng 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 最/d 多/a 不/d 超过/v 树/n 的/ude1 深度/n ，/wd 而/cc 具有/v ”/wyy 个/q 结点/n 的/ude1 判定/vn 树/n 的/ude1 深度/n 为/v L/x  lo/x ＆/n n/x  j+1/x ①/m ，/wd 所以/c ，/wd 折半/v 查找/v 法/n 在/p 查找/v 成功/a 时/ng 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 至多/d 为/v L/x |/n og2nj+1/x 。/wj 
图/n 9．2/m 描述/v 折半/v 查找/v 过程/n 的/ude1 判定/vn 树/n 及/cc 查找/v 21/m 的/ude1 过程/n 
    如果/c 在/p 图/n 9．2/m 所/usuo 示/vg 判定/v 树/n 中/b 所有/b 结点/n 的/ude1 空/a 指针/n 域/ng 上/f 加/v 一个/mq 指向/v 一个/mq 方形/n 结点/n 的/ude1 指针/n ，/wd 图/n 9．3/m 所/usuo 示/vg 。/wj 并且/c ，/wd 称/v 这些/rz 方形/n 结点/n 为/v 判定/v 树/n 的/ude1 外部/f 结点/n (/wkz 与/p 之/rz 相对/vi ，/wd 称/v 那些/rz 圆形/n 结点/n 为/v 内部/f 结点/n )/wky ，/wd 那末/c 折半/v 查找/v 时/ng 查找/v 不/d 成功/a 的/ude1 过程/n 就/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 结点/n 到/v 外部/f 结点/n 的/ude1 路径/n ，/wd 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 等于/v 该/rz 路径/n 上/f 内部/f 结点/n 个/q 数/n ，/wd 例如/v ：/wp 查找/v 85/m 的/ude1 过程/n 即/d 为/v 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 结点/n 19―10I/x 的/ude1 路径/n 。/wj 因此/c ，/wd 折半/v 查找/v 在/p 查找/v 不/d 成功/a 时/ng 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 最/d 多/a 也/d 不/d 超过/v L/x  log2j+1/x 。/wj 
  那末/c ，/wd 折半/v 查找/v 的/ude1 平均/ad 查找/v 长度/n 是/vshi 多少/ry 呢/y ?/ww 
①/m  判定/v 树非/nr 完全/ad 二/m 叉树/n ，/wd 但/c 它/rr 的/ude1 叶子/n 结点/n 所在/n 层次/n 之/uzhi 差/ng 最/d 多/ad 为/v 1/m ，/wd 则/d n/x 个/q 结点/n 的/ude1 判定/vn 树/n 的/ude1 深度/n 和/cc n/x 个/q 结点/n 的/ude1 完全/a ：/wp 叉树/n 的/ude1 深度/n 相同/a 。/wj 
②/m    图/n 9．3/m   加上/v 外部/f 结点/n 的/ude1 判定/vn 树/n 和/cc 查找/v 85/m 的/ude1 过程/n 
  为/p 讨论/v 方便/v 起见/u ，/wd 假定/v 有序/a 表/n 的/ude1 长度/n ”/wyy =2/m ‘/wyz 1/m (/wkz 反之/c ，/wd ^/n =log2/x (/wkz n+1/x )/wky )/wky ，/wd 则/c 描述/v 折半/v 查找/v 的/ude1 判定/vn 树/n 是/vshi 深度/n 为/v h/x 的/ude1 满/a 二/m 叉树/n 。/wj 树/n 中/b 层次/n 为/p 1/m 的/ude1 结点/n 有/vyou 1/m 个/q ，/wd 层次/n 为/p 2/m 的/ude1 结点/n 有/vyou 2/m 个/q ，/wd …/ws ，/wd 层次/n 为/p ^/n 的/ude1 结点/n 有/vyou 2/m “/wyz 一/m 。/wj 个/q 。/wj 假设/v 表/n 中/f 每个/r 记录/n 的/ude1 查找/vn 概率/n 相等/vi (/wkz 只/q 。/wj 专/vg )/wky ，/wd 则/c 查找/v 成功/a 时/ng 折半/v 查找/v 的/ude1 平均/ad 查找/v 长度/n 对/p 任意/b 的/ude1 ”/wyy ，/wd 当/v ”/wyy 较/d 大/a (/wkz n/x >/n 50/m )/wky 时/ng ，/wd 可/v 有/vyou 下列/b 近似/a 结果/n 可见/c ，/wd 折半/v 查找/v 的/ude1 效率/n 比/p 顺序/n 查找/v 高/a ，/wd 但/c 折半/v 查找/v 只/d 能/v 适用/vi 于/p 有序/a 表/n ，/wd 且/c 限于/v 顺序/n 存储/vn 结构/n (/wkz 对/p 线性/n 链/ng 表/n 无法/v 进行/vx 折半/v 查找/v )/wky 。/wj 
    以/p 有序/a 表表示/n 静态/n 查找表/n 时/ng ，/wd 进行/vx 查找/vn 的/ude1 方法/n 除/p 折半/v 查找/v 之外/f ，/wd 还有/v 斐/b 波/n 那/rzv 契/ng 查找/v 和/cc 插值/n 查找/v 。/wj 
    斐/b 波/n 那/rzv 契/ng 查找/v 是/vshi 根据/p 斐/b 波/n 那/rzv 契/vg 序列/n ②/m 的/ude1 特点/n 对/p 表/n 进行/vx 分割/vn 的/ude1 。/wj 假设/v 开始/v 时/ng 表中记录/n 个数/n 比/p 某个/rz 斐/b 波/n 那/rzv 契/vg 数/n 小/a 1/m ，/wd 即/v ”/wyy ：/wp F/x 。/wj -/wp 1/m ，/wd 然后/c 将/d 给/v 定/v 值/n key/x 和/cc ST．elem/x [/wkz F/x 。/wj 。/wj ]/wky ．/w key/x 进行/vx 比较/vn ，/wd 若/c 相等/vi ，/wd 则/c 查找/v 成功/an ；/wf 若/v key/x </n ST．elem/x [/wkz F/x 。/wj -/wp 1/m ]/wky ．/w key/x ，/wd 则/c 继续/v 在/p 自/p ST．elem/x [/wkz 1/m ]/wky 至/p sT．elem/x [/wkz F1/x ]/wky 的/ude1 子/ng 表/n 中/f 进行/vx 查找/vn ，/wd 否则/c 继续/v 在/p 自/p ST．elem/x [/wkz F/x 。/wj 1+1/m ]/wky 至/p ST．elem/x [/wkz Fu1/x ]/wky 的/ude1 子/ng 表/n 中/f 进行/vx 查找/vn 后/f 一/m 子/q 表/n 的/ude1 长度/n 为/v F/x 。/wj 一/m 2―1/m 。/wj 斐/b 波/n 那/rzv 契/ng 查找/v 的/ude1 平均/a 性能/n 比/p 折半/v 查找/v 好/a ，/wd 但/c 最/d 坏/a 情况/n 下/f 的/ude1 性能/n (/wkz 虽然/c 仍/d 是/vshi 0/m (/wkz 10gn/x )/wky )/wky 却/d 比/p 折半/v 查找/v 差/a 。/wj 它/rr 还有/v 一个/mq 优点/n 就/d 是/vshi 分割/v 时/ng 只/d 需/v 进行/vx 加/b 、/wn 减/v 运算/vn 。/wj 
    插值/n 查找/v 是/vshi 根据/p 给/v 定/v 值/n key/x 来/f 确定/v 进行/vx 比较/vn 的/ude1 关键/n 字/n ST．elem/x [/wkz i/x ]/wky _/n key/x 的/ude1 查找方法/n 。/wj 令/v i=/x 雨意/n e/x [/wkz yh-/x 篙/ng 寒热/n 黠/n 嚼/v (/wkz h-l+1/x )/wky ，/wd 其中/rz sT．elem/x [/wkz 1/m ]/wky 和/cc sT．elem/x [/wkz h/x ]/wky 分别/d 为/v 有序/a 表/n 中/f 具有/v 最/d 小/a 关键字/n 和/cc 最/d 大/a 关键字/n 的/ude1 记录/n 。/wj 显然/a ，/wd 这种/r 插值/n 查找/v 只/d 适于/v 关键字/n 均匀分布/n 的/ude1 表/n ，/wd 在/p 这种/r 情况/n 下/f ，/wd 对/p 表/n 长/a 较/d 大/a 的/ude1 顺序/n 表/n ，/wd 其/rz 平均/a 性能/n 比/p 折半/v 查找/v 好/a 。/wj 
9．1．3/m 静态/n 树/n 表/n 的/ude1 查找/vn 
    J/x 、/wn 节/n 对/p 有序/a 表/n 的/ude1 查找/vn 性能/n 的/ude1 讨论/vn 是/vshi 在/p “/wyz 等/udeng 概率/n ”/wyy 的/ude1 前提/n 下/f 进行/vx 的/ude1 ，/wd 即/d 当/v 有序/a 表/n 中/f 各/rz 记录/n 的/ude1 查找/vn 概率/n 相等/vi 时/ng ，/wd 按/p 图/n 9．2/m 所/usuo 示/vg 判定/v 树/n 描述/vn 的/ude1 查找/vn 过程/n 来/f 进行/vx 折半/v 查找/v ，/wd 其/rz 性能/n 最/d 优/ag 。/wj 如果/c 有序/a 表/n 中/f 各/rz 记录/n 的/ude1 查找/vn 概率/n 不等/vi ，/wd 情况/n 又/d 如何/ryv 呢/y ?/ww 
    先/d 看/v 一个/mq 具体/a 例子/n 。/wj 假设/v 有序/a 表/n 中/f 含/v 5/m 个/q 记录/n ，/wd 并且/c 已/d 知/v 各/rz 记录/n 的/ude1 查找/vn 概率/n 不等/vi ，/wd 分别/d 为/v pl=0．1/x ，/wd 户/q 2=0．2/m ，/wd 户/q 3=0．1/m ，/wd 户/q 4：0．4/m 和/cc p5=0．2/x 。/wj 则/c 按/p 式/k (/wkz 91/m )/wky 的/ude1 定义/n ，/wd 对/p 此/rzs 有序/a 表/n 进行/vx 折半/v 查找/v ，/wd 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v     5/m 
    ∑Pi/x (/wkz -/wp ?/ww ：/wp =0．1×2+0．2×3+0．1×1+0．4×2+0．2×3=2．3/m 
    j=l/x 
但是/c ，/wd 如果/c 在/p 查找/v 时令/n 给定/vn 值/n 先/d 和/cc 第4/m 个/q 记录/n 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 比较/d 不/d 相/d 等/v 时/ng 再/d 继续/v 在/p 左/a 子/ng 序列/n 或/c 右/f 子/ng 序列/n 中/f 进行/vx 折半/v 查找/v ，/wd 则/c 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v 
这/rzv 就/d 说明/v ，/wd 当/p 有序/a 表/n 中/f 各/rz 记录/n 的/ude1 查找/vn 概率/n 不等/vi 时/ng ，/wd 按/p 图/n 9．2/m 所/usuo 示/vg 判定/v 树/n 进行/vx 折半/v 查找/v ，/wd 其/rz 性能/n 未必/d 是/vshi 最/d 优/ag 的/ude1 。/wj 那末/c 此时/r 应/v 如何/ryv 进行/vx 查找/vn 呢/y ?/ww 换句话说/c ，/wd 描述/v 查找/v 过程/n 的/ude1 判定/vn 树/n 为何/ryv 类/q 二/m 叉树/n 时/ng ，/wd 其/rz 查找/v 性能/n 最佳/z ?/ww 
    如果/c 只/d 考虑/v 查找/v 成功/a 的/ude1 情况/n ，/wd 则/c 使/v 查找/v 性能/n 达最佳/n 的/ude1 判定/vn 树/n 是/vshi 其/rz 带权/n 内/f 路径长度/n 
之/rz 和/cc PH/x 值/n ①/m 
    三/m 
取/v 最/d 小/a 值/n 的/ude1 二/m 叉树/n 。/wj 其中/rz ：/wp n/x 为/p 二/m 叉/n 树上/s 结点/n 的/ude1 个数/n (/wkz 即/v 有序/a 表/n 的/ude1 长度/n )/wky ；/wf ^/n i/x 为/p 第/m i/x 个/q 结点/n 在/p 二/m 叉/n 树上/s 的/ude1 层次/n 数/n ；/wf 结点/n 的/ude1 权/n 咖/n i=/x 印/v 。/wj (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky ，/wd 其中/rz A/x 为/p 结点/n 的/ude1 查找/vn 概率/n ，/wd c/x 为/p 某个/rz 常量/n 。/wj 称/v PH/x 值/n 取/v 最/d 小/a 的/ude1 二/m 叉树/n 为/p 静态/n 最/d 优/ag 查找/v 树/n (/wkz Static/x  Optimal/x  Search/x  Tree/x )/wky 。/wj 由于/c 构造/v 静态/n 最/d 优/ag 查找/v 树/n 花费/v 的/ude1 时间/n 代价/n 较/d 高/a ，/wd 因此/c 在/p 本/rz 书/n 中/f 不/d 作/v 详细/ad 讨论/v ，/wd 有/vyou 兴趣/n 的/ude1 读者/n 可/v 查阅/v 参考/vn 书目/n [/wkz 1/m ]/wky 。/wj 在/p 此/rzs 向/p 读者/n 介绍/v 一/m 种/q 构造/n 近似/an 最/d 优/ag 查找/v 树/n 的/ude1 有效/a 算法/n 。/wj 
    已/d 知/v 一个/mq 按/p 关键字/n 有序/a 的/ude1 记录/n 序列/n 
    (/wkz r/x ，/wd ，/wd rf+1/x ，/wd …/ws ，/wd r/x ^/n )/wky     (/wkz 9．8/m )/wky 
其中/rz     。/wj l/x _/n key/x </n n1．key/x </n …/ws </n ‘/wyz h．key/x 
与/p 每个/r 记录/n 相应/vi 的/ude1 权/n 值/v 为/v 
现/tg 构造/v 一/m 棵/q 二/m 叉树/n ，/wd 使/v 这/rzv 棵/q 二/m 叉树/n 的/ude1 带权/n 内/f 路径长度/n PH/x 值/n 在/p 所有/b 具有/v 同样/b 权/n 值/n 的/ude1 二/m 叉树/n 中/f 近似/v 为/v 最/d 小/a ，/wd 称/v 这/rzv 类/q 二/m 叉树/n 为/v 次优/n 查找/v 树/n (/wkz Nearly/x  Optimal/x  Search/x  Tree/x )/wky 。/wj 
①/m PH/x 值/n 和/cc 平均/ad 查找/v 长度/n 成/v 正比/n 。/wj 
    构造/n 次优/n 查找/v 树/n 的/ude1 方法/n 是/vshi ：/wp 首先/d 在/p 式/k (/wkz 9―8/m )/wky 所/usuo 示/vg 的/ude1 记录/n 序列/n 中/f 取/v 第/m i/x (/wkz z≤i≤h/x )/wky 个/q 记录/n 构造/vn 根/n 结点/n ⑤/m ，/wd 使得/vi △/w Pi=/x (/wkz 9．10/m )/wky 
取/v 最/d 小/a 值/n (/wkz △/w Pf/x 。/wj ㈥/m M/x 、/wn in/x 。/wj t/x ,/wd SPi/x  t/x )/wky ，/wd 然后/c 分别/d 对子/n 序列/n {/n m/x  n+/x ∥/w ，/wd 1/m }/n 和/cc {/n ri+l/x ,/wd …/ws ，/wd r/x ^/n }/n 构造/v 两/m 棵/q 次优/n 查找/v 树/n ，/wd 并/cc 分别/d 设/v 为/p 根/n 结点/n ⑤/m 的/ude1 左子树/nr 和/cc 右/f 子/ng 树/n 。/wj 
    为/p 便于/v 计算/v △/w P/x ，/wd 引入/v 累计/v 权/n 值/n 和/cc 
由此/d 可/v 得/ude3 构造/v 次优/n 查找/v 树/n 的/ude1 递归/n 算法/n 如/v 算法/n 9．3/m 所/usuo 示/vg 。/wj 
(/wkz 9-11/m )/wky 
(/wkz 9．12/m )/wky 
(/wkz 9．13/m )/wky 
Status/x  SecondOptimal/x (/wkz BiTree/x &/n T/x ，/wd Elee/x  R/x 【/wkz ]/wky ，/wd float/x  SW/x [/wkz ]/wky ，/wd int/x  low/x ，/wd int/x  high/x )/wky {/n 
  ∥/w 由/p 有序/a 表/n R/x [/wkz 10w．．high/x ]/wky 及其/cc 累计/v 权/n 值/v 表/n sw/x (/wkz 其中/rz sw/x [/wkz 0/m ]/wky ==O/x )/wky 递归/n 构造/n 次优/n 查找/v 树/n T/x 。/wj 
  i=low/x ；/wf min=abs/x (/wkz sw/x [/wkz high/x ]/wky ．/w SW/x [/wkz 10w/x ]/wky )/wky ；/wf dw=sw/x [/wkz high/x ]/wky +SW/x [/wkz 10w-i/x ]/wky ；/wf 
  for/x (/wkz J=low+1/x ；/wf j/x </n ：/wp high/x ；/wf ++j/x )/wky     ∥/w 选择/v 最/d 小/a 的/ude1 △/w Pi/x 值/n 
    }/n 
  if/x (/wkz !/wt (/wkz T=/x (/wkz BiTree/x )/wky mall/x ~/n (/wkz size/x (/wkz BiTNode/x )/wky )/wky )/wky )/wky return/x  ERROR/x ；/wf 
  T-/x >/n data=R/x [/wkz i/x ]/wky ；/wf     ／／/m 生成/v 结点/n 
=NULL/x ；/wf     ∥/w 左/a 子/ng 树/n 空/ng 
  else/x  SecondOptimal/x (/wkz T/x >/n ichild/x ，/wd R/x ，/wd sw/x ，/wd low/x ，/wd i1/x )/wky ；/wf   ／／/m 构造/n 左/f 子/ng 树/n 
  if/x (/wkz i==high/x )/wky T/x >/n rchild=NULL/x ；/wf     ∥/w 右/f 子/ng 树/n 空/ng 
  '/n else/x  SecondOptimal/x (/wkz T/x >/n rchild/x ，/wd R/x ，/wd sw/x ，/wd i+1/x ，/wd high/x )/wky ；/wf ∥/w 构造/n 右/f 子/ng 树/n 
  return/x  OK/x ；/wf 
}/n ／／SecondOptimal/x 
    算法/n 9．3/m 
例/n 9-1/m   已/d 知/v 含/v 9/m 个/q 关键/n 字/n 的/ude1 有序/a 表/n 及其/cc 相应/vn 权/n 值/v 为/v 
    关键字/n   A/x   B/x   C/x  D/x   E/x   F/x   G/x  H/x   I/x 
    权/n 值/n   1/m   1/m   2/m   5/m   3/m  4/m  4/m   3/m   5/m 
则/c 按/p 算法/n 9．3/m 构造/n 次优/n 查找/v 树/n 的/ude1 过程/n 中/f 累计/v 权/n 值/n SW/x 和/p △/w P/x 的/ude1 值/n 如/v 图/n 9．4/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 构造/v 所得/n 次优/n 二/m 叉/n 查找/v 树/n 如/v 图/n 9．4/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    图/n 9．4/m 构造/n 次优/n 二/m 叉/n 查找/v 树/n 示例/n 
    (/wkz a/x )/wky 累计/v 权/n 值/n 和/cc 及/v △/w P/x 值/n ；/wf   (/wkz b/x )/wky 次优/n 查找/v 树/n 。/wj 
    由于/c 在/p 构造/n 次优/n 查找/v 树/n 的/ude1 过程/n 中/f ，/wd 没有/d 考察/v 单个/b 关键字/n 的/ude1 相应/vn 权/n 值/n ，/wd 则/c 有/vyou 可能/n 出现/v 被/pbei 选/v 为/p 根/n 的/ude1 关键/n 字/n 的/ude1 权/n 值/v 比/p 与/p 它/rr 相邻/vi 的/ude1 关键/n 字/n 的/ude1 权/n 值/v 小/a 。/wj 此时/r 应/v 作/v 适当/ad 调整/v ：/wp 选取/v 邻近/v 的/ude1 权/n 值/n 较/d 大/a 的/ude1 关键/n 字/n 作/v 次优/n 查找/v 树/n 的/ude1 根/n 结点/n 。/wj 
    例/n 9．2/m 已/d 知/v 含/v 5/m 个/q 关键/n 字/n 的/ude1 有序/a 表/n 及其/cc 相应/vn 权/n 值/v 为/v 
    关键字/n   A/x   B/x     C/x  D/x   E/x 
    权/n 值/n     1/m     30/m     2/m     29/m     3/m 
则/c 按/p 算法/n 9．3/m 构造/n 所得/n 次优/n 查找/v 树/n 如/v 图/n 9．5/m (/wkz a/x )/wky 所/usuo 示/vg ，/wd 调整处理/n 后/f 的/ude1 次优/n 查找/v 树/n 如/v 图/n 9．5/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 容易/ad 算/v 得/v ，/wd 前者/rzv 的/ude1 PH/x 值/n 为/p 132/m ，/wd 后者/rzv 的/ude1 PH/x 值/n 为/p 105/m 。/wj 
    大量/m 的/ude1 实验/vn 研究/vn 表明/v ，/wd 次优/n 查找/v 树/n 和/cc 最/d 优/ag 查找/v 树/n 的/ude1 查找/vn 性能/n 之/uzhi 差/ng 仅/d 为/v 1％/m ～/ws 2％/m ，/wd 很/d 少/ad 超过/v 3％/m ，/wd 而且/c 构造/v 次优/n 查找/v 树/n 的/ude1 算法/n 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz nlogn/x )/wky ，/wd 因此/c 算法/n 9．3/m 是/vshi 构造/n 近似/an 最/d 优/ag 二/m 叉/n 查找/v 树/n 的/ude1 有效/a 算法/n 。/wj 
图/n 9．5/m 根/q 的/ude1 权/n 小于/v 子/ng 树根/n 权/n 的/ude1 情况/n 
    (/wkz a/x )/wky 调整/v 之前/f 的/ude1 次优/n 查找/v 树/n ；/wf 
    (/wkz b/x )/wky 调整/v 之后/f 的/ude1 次优/n 查找/v 树/n 。/wj 
    从/p 次优/n 查找/v 树/n 的/ude1 结构特点/n 可见/c ，/wd 其/rz 查找/v 过程/n 类似/v 于/p 折半/v 查找/v 。/wj 若/v 次优/n 查找/v 树/n 为/v 空/ng ，/wd 则/c 查找/v 不/d 成功/a ，/wd 否则/c ，/wd 首先/c 将/d 给/v 定/v 值/n key/x 和/cc 其/rz 根/n 结点/n 的/ude1 关键字/n 相比/vi ，/wd 若/c 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 该/rz 根/n 结点/n 的/ude1 记录/n 即/d 为/v 所/usuo 求/v ；/wf 否则/c 将/d 根据/p 给/v 定/v 值/n key/x 小于/v 或/c 大于/v 根/n 结点/n 的/ude1 关键/n 字/n 而/cc 分别/d 在/p 左子树/nr 或/c 右/f 子/ng 树/n 中/f 继续/v 查找/v 直至/v 查找/v 成功/a 或/c 不/d 成功/a 为止/u (/wkz 算法/n 描述/vn 和/cc 下/vf 节/n 讨论/vn 的/ude1 二/m 叉/n 排序/vn 树/n 的/ude1 查找算法/n 类似/a ，/wd 在/p 此/rzs 省略/v )/wky 。/wj 由于/c 查找/v 过程/n 恰/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 待查/v 记录/v 所在/n 结点/n (/wkz 或/c 叶子/n 结点/n )/wky 的/ude1 一/m 条/q 路径/n ，/wd 进行/vx 过/uguo 比较/vn 的/ude1 关键/n 字/n 个/q 数/n 不/d 超过/v 树/n 的/ude1 深度/n ，/wd 因此/c ，/wd 次优/n 查找/v 树/n 的/ude1 平均/ad 查找/v 长度/n 和/cc logn/x 成/v 正比/n 。/wj 可见/c ，/wd 在/p 记录/n 的/ude1 查找/vn 概率/n 不等/vi 时/ng ，/wd 可/c 用/v 次优/n 查找/v 树/n 表示/v 静态/n 查找/v 树/n ，/wd 故/c 又/d 称/v 静态/n 树/n 表/n ，/wd 按/p 有序/a 表构造/n 次优/n 查找/v 树/n 的/ude1 算法/n 如/v 算法/n 9．4/m 所/usuo 示/vg 。/wj 
typ．d．f/x  BiTree/x  SOSTz/x '/n ee/x ；/wf     ∥/w 次优/n 查找/v 树/n 采用/v 二/m 叉/n 链/ng 表/n 的/ude1 存储/vn 结构/n 
stltu8/x  CreateSOSTree/x (/wkz SOSTree/x ＆/n T/x ，/wd SSTable/x  ST/x )/wky {/n 
    ∥/w 由/p 有序/a 表/n sT/x 构造/n 一/m 棵/q 次优/n 查找/v 树/n T/x 。/wj sT/x 的/ude1 数据/n 元素/n 含/v 有/vyou 权/n 域/n weight/x ~/n 。/wj 
    if/x (/wkz sT．1ength==0/x )/wky T=B-GLL/x ；/wf 
    el∞/x {/n 
    FindSW/x (/wkz sw/x ，/wd ST/x )/wky ；/wf     ∥/w 按照/p 由/p 有序/a 表/n ST/x 中/f 各/rz 数据/n 元素/n 的/ude1 weight/x 域/ng 求/v 累计/v 权/n 值/v 表/n sW/x 。/wj     SecondOpiamal/x (/wkz T/x ，/wd sT．elem/x ，/wd sw/x ，/wd 1/m ，/wd sT．1ength/x )/wky ；/wf 
    }/n 
    return/x  OK/x ；/wf 
    }/n ∥/w CreateSOSTree/x 
    算法/n 9．4/m 
9．1．4/m 索引/n 顺序/n 表/n 的/ude1 查找/vn 
    若/c 以/p 索引/n 顺序/n 表表示/n 静态/n 查找表/n ，/wd 则/d Search/x 函数/n 可用/v 分块/v 查找/v 来/vf 实现/v 。/wj 
    分块/v 查找/v 又/d 称/v 索引/n 顺序/n 查找/v ，/wd 这/rzv 是/vshi 顺序/n 查找/v 的/ude1 一/m 种/q 改进/v 方法/n 。/wj 在/p 此/rzs 查找/v 法/n 中/f ，/wd 除/p 表/n 本身/rz 以外/f ，/wd 尚/d 需/v 建立/v 一个/mq “/wyz 索引/n 表/n ”/wyy 。/wj 例如/v ，/wd 图/n 9．6/m 所/usuo 示/vg 为/v 一个/mq 表/n 及其/cc 索引/n 表/n ，/wd 表/n 中/f 含有/v 18/m 个/q 索引/n 表/n 
图/n 9．6/m 表/n 及其/cc 索引/n 表/n 
记录/v ，/wd 可/v 分成/vi 三/m 个/q 子表/nr2 (/wkz R1/x ，/wd R2/x ，/wd …/ws ，/wd 6/m )/wky 、/wn (/wkz R7/x ，/wd R8/x ，/wd …/ws ，/wd R12/x )/wky 、/wn (/wkz R13/x ，/wd R14/x ，/wd …/ws R18/x )/wky ，/wd 对/p 每个/r 子/ng 
表/n (/wkz 或/c 称/v 块/q )/wky 建立/v 一个/mq 索引/n 项/q ，/wd 其中/rz 包括/v 两/m 项/q 内容/n ：/wp 关键字项/n (/wkz 其/rz 值/n 为/p 该/rz 子/ng 表/n 内/f 的/ude1 最/d 大/a 关键字/n )/wky 和/cc 指针/n 项/q (/wkz 指示/n 该/rz 子/ng 表/n 的/ude1 第一/m 个/q 记录/n 在/p 表/n 中/b 位置/n )/wky 。/wj 索引/n 表/vg 按/p 关键字/n 有序/a ，/wd 则/c 表/n 或者/c 有序/a 或者/c 分块/v 有序/a 。/wj 所谓/v “/wyz 分块/v 有序/a ”/wyy 指/v 的/ude1 是/vshi 第二/m 个子/n 表/n 中/f 所/usuo 有/vyou 记录/n 的/ude1 关键/n 字/n 均/d 大于/v 第一/m 个子/n 表/n 中/f 的/ude1 最/d 大/a 关键字/n ，/wd 第三/m 个子/n 表/n 中/f 的/ude1 所有/b 关键字/n 均/d 大于/v 第二/m 个子/n 表/n 中/f 的/ude1 最/d 大/a 关键字/n ，/wd …/ws …/ws ，/wd 依次/d 类推/vi 。/wj 
　　因此/c ，/wd 分块/v 查找/v 过程/n 需/v 分两步/n 进行/vx 。/wj 先/d 确定/v 待查/v 记录/v 所在/n 的/ude1 块/q (/wkz 子表/nr2 )/wky ，/wd 然后/c 在/p 块/q 中/b 顺序/n 查找/v 。/wj 假设/n 给定/vn 值/n 忌/v 倒/vi =38/m ，/wd 则/c 先/d 将/d key・/x 依次/d 和/cc 索引/n 表/n 中/f 各/rz 最/d 大/a 关键字/n 进行/vx 比较/vn ，/wd 因为/p 22/m </n key/x </n 48/m ，/wd 则/c 关键字/n 为/p 38/m 的/ude1 记录/n 若/c 存在/v ，/wd 必定/d 在/p 第二/m 个子/n 表/n 中/f ，/wd 由于/c 同一/b 索引/n 项/q 中/f 的/ude1 指针/n 指示/n 第二/m 个子/n 表/n 中/f 的/ude1 第一/m 个/q 记录/n 是/vshi 表/n 中/f 第7/m 个/q 记录/n ，/wd 则/c 自/p 第7/m 个/q 记录/n 起/vf 进行/vx 顺序/n 查找/v ，/wd 直到/v ST．elem/x [/wkz 10/m ]/wky ．/w key=key/x 为止/u 。/wj 假如/c 此/rzs 子/ng 表/n 中/f 没有/v 关键字/n 等于/v 是/vshi 纠/vg 的/ude1 记录/n (/wkz 例如/v ：/wp key/x 。/wj 29时/t 自/p 第7/m 个/q 记录/n 起/vf 至/p 第12/m 个/q 记录/n 的/ude1 关键/n 字/n 和/cc key/x 比较/d 都/d 不/d 等/v )/wky ，/wd 则/c 查找/v 不/d 成功/a 。/wj 
　　由于/c 由/p 索引/n 项/q 组成/v 的/ude1 索引/n 表/vg 按/p 关键字/n 有序/a ，/wd 则/c 确定/v 块/q 的/ude1 查找/vn 可以/v 用/p 顺序/n 查找/v ，/wd 亦/d 可/v 用/p 折半/v 查找/v ，/wd 而/cc 块/q 中/f 记录/v 是/vshi 任意/d 排列/v 的/ude1 ，/wd 则/c 在/p 块/q 中/f 只能/v 是/vshi 顺序/n 查找/v 。/wj 
　　由此/d ，/wd 分块/v 查找/v 的/ude1 算法/n 即/d 为/v 这/rzv 两/m 种/q 查找算法/n 的/ude1 简单/a 合成/vn 。/wj 
分块/v 查找/v 的/ude1 平均/ad 查找/v 长度/n 为/v     、/wn 
其中/rz ：/wp k/x 为/p 查找/v 索引/n 表/vg 确定/v 所在/n 块/q 的/ude1 平均/ad 查找/v 长度/n ，/wd L/x 。/wj 为/p 在/p 块/q 中/f 查找/v 元素/n 的/ude1 平均/ad 查找/v 长度/n 。/wj 
    一般/a 情况/n 下/f ，/wd 为/v 进行/vx 分块/v 查找/v ，/wd 可以/v 将/p 长度/n 为/v n/x 的/ude1 表/n 均匀/a 地/ude2 分成/vi 6/m 块/q ，/wd 每块/r 含有/v s/x 个/q 记录/n ，/wd 即/v 6=n／s/x ]/wky ；/wf 又/d 假定表/n 中/f 每个/r 记录/n 的/ude1 查找/vn 概率/n 相等/vi ，/wd 则/c 每块/r 查找/v 的/ude1 概率/n 为/p 1／6/m ，/wd 块/q 中/f 每个/r 记录/n 的/ude1 查找/vn 概率/n 为/v 1／s/x 。/wj     若/c 用/p 顺序/n 查找/v 确定/v 所在/n 块/q ，/wd 则/c 分块/v 查找/v 的/ude1 平均/ad 查找/v 长度/n 为/v 可见/c ，/wd 此时/r 的/ude1 平均/ad 查找/v 长度/n 不仅/c 和/cc 表/n 长/a 竹/ng 有关/vn ，/wd 而且/c 和/p 每/rz 一/m 块/q 中/f 的/ude1 记录/n 个数/n s/x 有关/vn 。/wj 在/p 给定/vn 孢/n 的/ude1 前提/n 下/f ，/wd s/x 是/vshi 可以/v 选择/v 的/ude1 。/wj 容易/ad 证明/v ，/wd 当/v s/x 取/v 石/ng 时/ng ，/wd ASLb/x ；/wf 取/v 最/d 小/a 值/n 而/cc 十/m 1/m 。/wj 这个/rz 值/n 比/p 顺序/n 查找/v 有/vyou 了/ule 很/d 大/a 改进/vn ，/wd 但/c 远/ad 不及/vi 折半/v 查找/v 。/wj 
    若/c 用/p 折半/v 查找/v 确定/v 所在/n 块/q ，/wd 则/c 分块/v 查找/v 的/ude1 平均/ad 查找/v 长度/n 为/v 
9．2/m 动态查找表/n 
    在/p 这/rzv 一/m 节/q 和/cc 下/vf 一/m 节/q 中/f ，/wd 我们/rr 将/d 讨论/v 动态查找表/n 的/ude1 表示/vn 和/cc 实现/v 。/wj 动态查找表/n 的/ude1 特点/n 是/vshi ，/wd 表/vg 结构/n 本身/rz 是/vshi 在/p 查找/v 过程/n 中/b 动态/n 生成/v 的/ude1 ，/wd 即/d 对于/p 给/v 定/v 值/n key/x ，/wd 若/c 表/n 中/f 存在/v 其/rz 关键字/n 等于/v key/x 的/ude1 记录/n ，/wd 则/c 查找/v 成功/ad 返回/v ，/wd 否则/c 插入/v 关键字/n 等于/v ke5r/x 的/ude1 记录/n 。/wj 以下/f 是/vshi 动态查找表/n 的/ude1 定义/n ：/wp 
抽象数据/n 类型/n 动态查找表/n 的/ude1 定义/n 如下/vi ：/wp     
  数据/n 对象/n D：D/x 是/vshi 具有/v 相同/a 特性/n 的/ude1 数据/n 元素/n 的/ude1 集合/n 。/wj 各个/rz 数据/n 元素/n 均/d 含有/v 类型/n 相同/a ，/wd 可/v 唯一/b 标识/n 
    数据/n 元素/n 的/ude1 关键/n 字/n 。/wj 
  数据/n 关系/n R：/x 数据/n 元素/n 同/p 属/v 一个/mq 集合/n 。/wj 
  基本/ad 操作/v P：/x 
    InitDSTable/x (/wkz &/n DT/x )/wky ；/wf 
    操作/v 结果/n ：/wp 构造/v 一个/mq 空/a 的/ude1 动态查找表/n DT/x 。/wj 
    DestroyDSTable/x (/wkz ＆/n )/wky ；/wf 
    初始条件/n ：/wp 动态查找表/n v/x 存在/v 。/wj 
    操作/v 结果/n ：/wp 销毁/v 动态查找表/n DT/x 。/wj 
    SearchDSTable/x (/wkz ，/wd key/x )/wky ；/wf 
・/w 226・/m 
    初始条件/n ：/wp 动态查找表/n v/x 存在/v ，/wd key/x 为/v 和/cc 关键字类型/n 相同/a 的/ude1 给/p 定/v 值/n 。/wj 
    操作/v 结果/n ：/wp 若/v 册/q 中/f 存在/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n ，/wd 则/c 函数值/n 为/p 该/rz 元素/n 的/ude1 值/n 或/c 在/p 表/n 中/f 的/ude1 位置/n ，/wd 否则/c 为/v “/wyz 空/ng ”/wyy 。/wj 
    InsertDSTable/x (/wkz &/n DT/x ，/wd e/x )/wky ；/wf 
    初始条件/n ：/wp 动态查找表/n crr/x 存在/v ，/wd e/x 为/v 待/vi 插入/v 的/ude1 数据/n 元素/n 。/wj 
    操作/v 结果/n ：/wp 若/v DT/x 中/f 不/d 存在/v 其/rz 关键字/n 等于/v e．key/x 的/ude1 数据/n 元素/n ，/wd 则/c 插入/v e/x 到/v DTa/x     DeleteDSTable/x (/wkz &/n nT/x ，/wd key/x )/wky ；/wf     ．/w   ．/w 
　　初始条件/n ：/wp 动态查找表/n DT/x 存在/v ，/wd key/x 为/v 和/cc 关键字类型/n 相同/a 的/ude1 给/p 定/v 值/n 。/wj 
　　操作/v 结果/n ：/wp 若/v DT/x 中/f 存在/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n ，/wd 则/c 删除/v 之/uzhi 。/wj 
    TraverseDSTable/x (/wkz 叩/vg ，/wd vis/x 北/f (/wkz )/wky )/wky ；/wf 
    初始条件/n ：/wp 动态查找表/n DT/x 存在/v ，/wd visit/x 是/vshi 对/p 结点/n 操作/v 的/ude1 应用/vn 函数/n 。/wj 
    操作/v 结果/n ：/wp 按/p 某种/rz 次序/n 对/p DT/x 的/ude1 每个/r 结点/n 调用函数/n visit/x (/wkz )/wky 一/m 次/qv 且/c 至多/d 一/m 次/qv 。/wj 一旦/d Visit/x (/wkz )/wky 失败/vi ，/wd 则/c 操作失败/n 。/wj 
    }/n ADT/x  DynamicSearchTabl/x  e/x 
    动态查找表/n 亦/d 可/v 有/vyou 不同/a 的/ude1 表示方法/n 。/wj 在/p 本/rz 节/n 中/f 将/d 讨论/v 以/p 各种/rz 树结构/n 表示/v 时/ng 的/ude1 实现/vn 方法/n 。/wj 
9．2．1/m 二/m 叉/n 排序/vn 树/n 和/cc 平衡/a 二/m 叉树/n 
  一/m 、/wn 二/m 叉/n 排序/vn 树/n 及其/cc 查找/v 过程/n 
  什么/ry 是/vshi 二/m 叉/n 排序/vn 树/n ?/ww 
  二/m 叉/n 排序/vn 树/n (/wkz Binary/x  Sort/x  Tree/x )/wky 或者/c 是/vshi 一/m 棵/q 空/a 树/n ；/wf 或者/c 是/vshi 具有/v 下列/b 性质/n 的/ude1 二/m 叉树/n ：/wp (/wkz 1/m )/wky 若/c 它/rr 的/ude1 左子树/nr 不/d 空/a ，/wd 则/d 左/a 子/ng 树/n 上/f 所有/b 结点/n 的/ude1 值/n 均/d 小于/v 它/rr 的/ude1 根/n 结点/n 的/ude1 值/n ；/wf (/wkz 2/m )/wky 若/c 它/rr 的/ude1 右/f 子/ng 树/n 不/d 空/a ，/wd 则/c 右/f 子/ng 树/n 上/f 所有/b 结点/n 的/ude1 值/n 均/d 大于/v 它/rr 的/ude1 根/n 结点/n 的/ude1 值/n ；/wf (/wkz 3/m )/wky 它/rr 的/ude1 左/a 、/wn 右/f 子/ng 树/n 也/d 分别/d 为/v 二/m 叉/n 排序/vn 树/n 。/wj 
    例如/v 图/n 9．7/m 所/usuo 示/vg 为/p 两/m 棵/q 二/m 叉/n 排序/vn 树/n 。/wj 
　　图/n 9．7/m 二/m 叉/n 排序/vn 树/n 
 二/m 叉/n 排序/vn 树/n 又/d 称/v 二/m 叉/n 查找/v 树/n ，/wd 根据上述/n 定义/n 的/ude1 结构特点/n 可见/c ，/wd 它/rr 的/ude1 查找/vn 过程/n 和/cc 次优/n 二/m 叉树/n 类似/a 。/wj 即/v 当/p 二/m 叉/n 排序/vn 树/n 不/d 空/v 时/ng ，/wd 首先/c 将/d 给/v 定/v 值/n 和/cc 根/n 结点/n 的/ude1 关键/n 字/n 比较/vn ，/wd 若/c 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 否则/c 将/p 依据/n 给/p 定/v 值/n 和/cc 根/n 结点/n 的/ude1 关键/n 字/n 之间/f 的/ude1 大小/n 关系/n ，/wd 分别/d 在/p 左子树/nr 或/c 右/f 子/ng 树/n 上/f 继续/v 进行/vx 查找/vn 。/wj 通常/d ，/wd 可取/v 二/m 叉/n 链/ng 表/n 作为/v 二/m 叉/n 排序/vn 树/n 的/ude1 存储/vn 结构/n ，/wd 则/c 上述/b 查找/vn 过程/n 如/v 算法/n 9．5/m (/wkz a/x )/wky 所/usuo 描述/v 。/wj    
  ∥/w 在/p 根/n 指针/n T/x 所/usuo 指/v 二/m 叉/n 排序/vn 树/n 中/f 递归/n 地/ude2 查找/v 某/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n ，/wd 
  ∥/w 若/c 查找/v 成功/an ，/wd 则/c 返回/v 指向/v 该/rz 数据/n 元素/n 结点/n 的/ude1 指针/n ，/wd 否则/c 返回/v 空/a 指针/n 
  if/x (/wkz (/wkz !/wt T/x )/wky II/x  EQ/x (/wkz key/x ，/wd T-/x >/n data．key/x )/wky )/wky return/x (/wkz T/x )/wky ；/wf     ∥/w 查找/v 结束/v 
  else/x  if/x  LT/x (/wkz key/x 。/wj T/x >/n data．key/x )/wky return/x (/wkz SearchBST/x (/wkz T/x >/n ichild/x ，/wd key/x )/wky )/wky ；/wf 
    ∥/w 在/p 左子树/nr 中/f 继续/v 查找/v 
  else/x  return/x (/wkz SearchBST/x (/wkz T/x >/n rchild/x ，/wd key/x )/wky )/wky ；/wf     ∥/w 在/p 右/f 子/ng 树/n 中/f 继续/v 查找/v 
}/n ∥/w SearchBST/x 
    算法/n 9．5/m 【/wkz a/x )/wky 
    例如/v ：/wp 在/p 图/n 9．7/m (/wkz a/x )/wky 所/usuo 示/vg 的/ude1 二/m 叉/n 排序/vn 树/n 中/f 查找/v 关键字/n 等于/v 100/m 的/ude1 记录/n (/wkz 树/n 中/f 结点/n 内/f 的/ude1 数/n 均/d 为/v 记录/v 的/ude1 关键/n 字/n )/wky 。/wj 首先/c 以/p key=/x (/wkz 100/m )/wky 和/cc 根/n 结点/n 的/ude1 关键/n 字/n 作/v 比较/vn ，/wd 因为/p key/x >/n 45/m ，/wd 则/c 查找/v 以/p @/x 为/p 根/n 的/ude1 右/f 子/ng 树/n ，/wd 此时/r 右/f 子/ng 树/n 不/d 空/a ，/wd 且/c key/x >/n 53/m ，/wd 则/c 继续/v 查找/v 以/p 结点/n @/x 为/p 根/n 的/ude1 右/f 子/ng 树/n ，/wd 由于/c key/x 和/cc ⑦/m 的/ude1 右手/n 树根/n 的/ude1 关键/n 字/n 100/m 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 返回/v 指向/v 结点/n ⑩/m 的/ude1 指针/n 值/n 。/wj 
又/d 如/v 在/p 图/n 9．7/m (/wkz a/x )/wky 中/f 查找/v 关键字/n 等于/v 40/m 的/ude1 记录/n ，/wd 和/cc 上述/b 过程/n 类似/a ，/wd 在/p 给/v 定/v 值/n key/x 与/cc 关键字/n 45/m 、/wn 12/m 及/cc 37/m 相继/d 比较/d 之后/f ，/wd 继续/v 查找/v 以/p 结点/n ⑤/m 为/p 根/n 的/ude1 右/f 子/ng 树/n ，/wd 此时/r 右/f 子/ng 树/v 为/v 空/ng ，/wd 则/c 说明/v 该/rz 树/n 中/f 没有/d 待查/v 记录/v ，/wd 故/c 查找/v 不/d 成功/a ，/wd 返回/v 指针/n 值/v 为/v “/wyz NULL/x ”/wyy 。/wj 
    二/m 、/wn 二/m 叉/n 排序/vn 树/n 的/ude1 插入/v 和/cc 删除/v 
    和/p 次优/n 二/m 叉树/n 相对/vi ，/wd 二/m 叉/n 排序/vn 树/n 是/vshi 一/m 种/q 动态/n 树/n 表/n 。/wj 其/rz 特点/n 是/vshi ，/wd 树/v 的/ude1 结构/n 通常/d 不/d 是/vshi 一/m 次/qv 生成/v 的/ude1 ，/wd 而是/c 在/p 查找/v 过程/n 中/f ，/wd 当/p 树/n 中/f 不/d 存在/v 关键字/n 等于/v 给/p 定/v 值/n 的/ude1 结点/n 时/ng 再/d 进行/vx 插入/v 。/wj 新/d 插入/v 的/ude1 结点/n 一定/d 是/vshi 一个/mq 新/a 添加/vn 的/ude1 叶子/n 结点/n ，/wd 并且/c 是/vshi 查找/v 不/d 成功/a 时/ng 查找/v 路径/n 上/f 访问/v 的/ude1 最后/f 一个/mq 结点/n 的/ude1 左/a 孩子/n 或/c 右/f 孩子/n 结点/n 。/wj 为此/bl ，/wd 需/v 将/d 上/vf 一/m 小节/n 的/ude1 二/m 叉/n 排序/vn 树/n 的/ude1 查找算法/n 改写/v 成/v 算法/n 9．5/m (/wkz b/x )/wky ，/wd 以便/d 能/v 在/p 查找/v 不/d 成功/a 时/ng 返回/v 插入/v 位置/n 。/wj 插入/v 算法/n 如/v 算法/n 9．6/m 所/usuo 示/vg 。/wj 
Status/x  SearchBST/x (/wkz BiTree/x  T/x ，/wd Ke/x ~/n ype/x  key/x ，/wd BiTree/x  f/x ，/wd BiTree/x &/n p/x )/wky {/n 
  ∥/w 在/p 根/n 指针/n T/x 所/usuo 指/v 二/m 叉/n 排序/vn 树/n 中/f 递归/n 地/ude2 查找/v 其/rz 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n ，/wd 若/c 查找/v 成功/an 。/wj 
  ∥/w 则/c 指针/n P/x 指向/v 该/rz 数据/n 元素/n 结点/n ，/wd 并/cc 返回/v TRUE/x ，/wd 否则/c 指针/n P/x 指向/v 查找/v 路径/n 上/f 访问/v 的/ude1 
  ∥/w 最后/f 一个/mq 结点/n 并/d 返回/v FALSE/x ，/wd 指针/n f/x 指向/v T/x 的/ude1 双亲/n ，/wd 其/rz 初始/b 调用/v 值/v 为/v NULL/x 
  if/x (/wkz !/wt T/x )/wky {/n P=f/x ；/wf zetura/x  FALSE/x ；/wf I/x     ∥/w 查找/v 不/d 成功/a 
  else/x  if/x  EQ/x (/wkz key/x ，/wd T/x >/n data．key/x )/wky I/x  P=T/x ；/wf return/x  TRUE/x ；/wf }/n     ∥/w 查找/v 成功/an 
  else/x  if/x  LT/x (/wkz key/x ，/wd T/x >/n data．key/x )/wky SearchBST/x (/wkz T/x >/n ichild/x ，/wd key/x ，/wd T/x ，/wd p/x )/wky ；/wf   ∥/w 在/p 左子树/nr 中/f 继续/v 查找/v 
  else/x  SearchBST/x (/wkz T/x >/n rchild/x ，/wd key/x ，/wd T/x ，/wd p/x )/wky ；/wf     ∥/w 在/p 右/f 子/ng 树/n 中/f 继续/v 查找/v 
}/n ∥/w SearchBST/x 
    算法/n 9/m 。/wj 5/m (/wkz b/x )/wky 
Status/x  Insert/x  BST/x (/wkz BiTree/x ＆/n T/x ，/wd ElemType/x  e/x )/wky {/n 
  ∥/w 当/p 二/m 叉/n 排序/vn 树/n T/x 中/f 不/d 存在/v 关键字/n 等于/v e．key/x 的/ude1 数据/n 元素/n 时/ng ，/wd 插入/v e/x 并/cc 返回/v TRUE/x ，/wd 
  ∥/w 否则/c 返回/v FALSE/x 
  if/x (/wkz !/wt Searc/x ~/n T/x (/wkz T/x ，/wd e．key/x ，/wd NULL/x ，/wd P/x )/wky {/n     ∥/w 查找/v 不/d 成功/a 
    8=/m (/wkz BiTree/x )/wky mall/x ~/n (/wkz sizeof/x (/wkz BiTNode/x )/wky )/wky ；/wf 
    s/x >/n data=e/x ；/wf S/x >/n ichild=s/x >/n rchild=NULL/x ；/wf 
    if/x (/wkz !/wt P/x )/wky T=S/x ；/wf     ∥/w 被/pbei 插/v 结点/n */n S/x 为/p 新/a 的/ude1 根/n 结点/n 
    else/x  if/x  LT/x (/wkz e．key/x ，/wd P/x >/n data．key/x )/wky P/x >/n Ichild=S/x ；/wf ∥/w 被/pbei 插/v 结点/n */n s/x 为/p 左/a 孩子/n 
    eln/x  P/x >/n rchild=S/x ；/wf     ∥/w 被/pbei 插/v 结点/n */n S/x 为/v 右/f 孩子/n 
    return/x  TRUE/x ；/wf 
・/w 228・/m 
  I/x 
  else/x  retura/x  FAsE/x ；/wf     ∥/w 树/n 中/f 已/d 有/vyou 关键字/n 相同/a 的/ude1 结点/n ，/wd 不再/d 插入/v 
I/x    算法/n 9．6/m 
    若/c 从/p 空/a 树/n 出发/vi ，/wd 经过/p 一/m 系列/q 的/ude1 查找/vn 插入/v 操作/vn 之后/f ，/wd 可/c 生成/v 一/m 棵/q 二/m 叉树/n 。/wj 设/v 查找/v 的/ude1 关键字/n 序列/n 为/p {/n 45/m 。/wj 24/m ，/wd 53/m ，/wd 45/m ，/wd 12/m ，/wd 24/m 。/wj 90/m }/n ，/wd 则/c 生成/v 的/ude1 二/m 叉/n 排序/vn 树/n 如/v 图/n 9．8/m 所/usuo 示/vg 。/wj 
(/wkz a/x )/wky 
    图/n 9．8/m 二/m 叉/n 排序/vn 树/n 的/ude1 构造/vn 过程/n 
    (/wkz a/x )/wky 空/v 树/n ；/wf (/wkz b/x )/wky 插入/v 45/m ；/wf (/wkz c/x )/wky 插入/v 24/m ；/wf (/wkz d/x )/wky 插入/v 53/m ；/wf (/wkz e/x )/wky 插入/v 12/m ；/wf (/wkz f/x )/wky 插入/v 90/m 。/wj 
    容易/ad 看出/v ，/wd 中/b 序/n 遍历/n 二/m 叉/n 排序/vn 树/n 可/v 得到/v 一个/mq 关键/a 字/n 的/ude1 有序/a 序列/n (/wkz 这个/rz 性质/n 是/vshi 由/p 二/m 叉/n 排序/vn 树/n 的/ude1 定义/n 决定/v 的/ude1 ，/wd 读者/n 可以/v 自己/rr 证明/v 之/uzhi )/wky 。/wj 这就是说/c ，/wd 一个/mq 无序/b 序列/n 可以/v 通过/p 构造/n 一/m 棵/q 二/m 叉/n 排序/vn 树/n 而/cc 变成/v 一个/mq 有序/a 序列/n ，/wd 构造/v 树/n 的/ude1 过程/n 即/d 为/v 对/p 无序/b 序列/n 进行/vx 排序/vn 的/ude1 过程/n 。/wj 不仅如此/bl ，/wd 从/p 上面/f 的/ude1 插入/v 过程/n 还/d 可以/v 看到/v ，/wd 每次/r 插入/v 的/ude1 新/a 结点/n 都/d 是/vshi 二/m 叉/n 排序/vn 树/n 上/f 新/a 的/ude1 叶子/n 结点/n ，/wd 则/c 在/p 进行/vx 插入/v 操作/v 时/ng ，/wd 不必/d 移动/v 其它/rz 结点/n ，/wd 仅/d 需/v 改动/v 某个/rz 结点/n 的/ude1 指针/n ，/wd 由/p 空/ng 变为/v 非空/n 即可/v 。/wj 这/rzv 就/d 相当/d 于/p 在/p 一个/mq 有序/a 序列/n 上/f 插入/v 一个/mq 记录/n 而/cc 不/d 需要/v 移动/vn 其它/rz 记录/n 。/wj 它/rr 表明/v ，/wd 二/m 叉/n 排序/vn 树/n 既/c 拥有/v 类似/v 于/p 折半/v 查找/v 的/ude1 特性/n ，/wd 又/d 采用/v 了/ule 链/ng 表/n 作/v 存储/vn 结构/n ，/wd 因此/c 是/vshi 动态查找表/n 的/ude1 一/m 种/q 适宜/v 表示/v 。/wj 
    同样/d ，/wd 在/p 二/m 叉/n 排序/vn 树上/s 删去/v 一个/mq 结点/n 也/d 很/d 方便/a 。/wj 对于/p 一般/a 的/ude1 二/m 叉树/n 来说/uls ，/wd 删/v 去/vf 树/n 中/f 一个/mq 结点/n 是/vshi 没有/v 意义/n 的/ude1 。/wj 因为/p 它/rr 将/d 使/v 以/p 被/pbei 删/v 结点/n 为/p 根/n 的/ude1 子/ng 树/v 成为/v 森林/n ，/wd 破坏/v 了/ule 整/m 棵/q 树/n 的/ude1 结构/n 。/wj 然而/c ，/wd 对于/p 二/m 叉/n 排序/vn 树/n ，/wd 删去/v 树上/s 一个/mq 结点/n 相当于/v 删去/v 有序/a 序列/n 中/f 的/ude1 一个/mq 记录/n ，/wd 只要/c 在/p 删除/v 某个/rz 结点/n 之后/f 依旧/z 保持/v 二/m 叉/n 排序/vn 树/n 的/ude1 特性/n 即可/v 。/wj 
    那末/c ，/wd 如何/ryv 在/p 二/m 叉/n 排序/vn 树上/s 删去/v 一个/mq 结点/n 呢/y ?/ww 假设/v 在/p 二/m 叉/n 排序/vn 树上/s 被/pbei 删/v 结点/n 为/p */n p/x ①/m (/wkz 指向/v 结点/n 的/ude1 指针/n 为/v p/x )/wky ，/wd 其/rz 双亲/n 结点/n 为/p */n f/x (/wkz 结点/n 指针/n 为/v f/x )/wky ，/wd 且/c 不/d 失/v 一般性/n ，/wd 可/c 设/v */n p/x 是/vshi */n f/x 的/ude1 左/a 孩子/n (/wkz 图/n 9．9/m (/wkz a/x )/wky 所/usuo 示/vg )/wky 。/wj 
  下面/f 分/v 三/m 种/q 情况/n 进行/vx 讨论/vn ：/wp 
  (/wkz 1/m )/wky 若/v */n p/x 结点/n 为/p 叶子/n 结点/n ，/wd 即/v PL/x 和/cc PR/x 均/d 为/v 空/a 树/n 。/wj 由于/c 删去/v 叶子/n 结点/n 不/d 破坏/v 整/m 棵/q 树/n 的/ude1 结构/n ，/wd 则/c 只/d 需/v 修改/v 其/rz 双亲/n 结点/n 的/ude1 指针/n 即可/v 。/wj    
①/m   以下/f 均/d 简称/v 指针/n p/x (/wkz 或/c f/x 等/udeng )/wky 所/usuo 指/v 结点/n 为/p */n p/x (/wkz 或/c */n f/x 等/udeng )/wky 结点/n ，/wd PL/x 和/cc PR/x 分别/d 表示/v 其/rz 左/a 子/ng 树/n 和/cc 右/f 子/ng 树/n 。/wj 
    (/wkz 2/m )/wky 若/v */n P/x 结点/n 只有/c 左子树/nr PI/x ，/wd 或者/c 只/d 有/vyou 右/f 子/ng 树/n PR/x ，/wd 此时/r 只要/c 令/v P/x 。/wj 或/c P/x 。/wj 直接/ad 成为/v 其/rz 双亲/n 结点/n */n f/x 的/ude1 左/a 子/ng 树/v 即可/v 。/wj 显然/a ，/wd 作/v 此/rzs 修改/v 也/d 不/d 破坏/v 二/m 叉/n 排序/vn 树/n 的/ude1 特性/n 。/wj 
    (/wkz 3/m )/wky 若/v */n P/x 结点/n 的/ude1 左子树/nr 和/cc 右/f 子/ng 树/n 均/d 不/d 空/a 。/wj 显然/a ，/wd 此时/r 不/d 能/v 如上/d 简单/a 处理/vn 。/wj 从/p 图/n 9．9/m (/wkz b/x )/wky 可知/v ，/wd 在/p 删去/v */n P/x 结点/n 之前/f ，/wd 中/b 序/n 遍历/n 该/rz 二/m 叉树/n 得到/v 的/ude1 序列/n 为/p {/n ．/w ．/w ・/w Cl/x ，/wd C/x …/ws QLQSI/x ，/wd SPPRF/x …/ws }/n ，/wd 在/p 删去/v */n P/x 之后/f ，/wd 为/p 保持/v 其它/rz 元素/n 之间/f 的/ude1 相对/b 位置/n 不/d 变/v ，/wd 可以/v 有/vyou 两/m 种/q 做法/n ：/wp 其一/rz 是/vshi 令/v */n p/x 的/ude1 左子树/nr 为/p */n f/x 的/ude1 左子树/nr ，/wd 而/cc */n p/x 的/ude1 右/f 子/ng 树/v 为/p */n s/x 的/ude1 右/f 子/ng 树/n ，/wd 如/v 图/n 9．9/m (/wkz C/x )/wky 所/usuo 示/vg ；/wf 其二/rz 是/vshi 令/v */n P/x 的/ude1 直接/a 前驱/n (/wkz 或/c 直接/a 后/f 继/vg )/wky 替代/v */n P/x ，/wd 然后/c 再/d 从/p 二/m 叉/n 排序/vn 树/n 中/f 删/v 去/vf 它/rr 的/ude1 直接/a 前驱/n (/wkz 或/c 直接/a 后/f 继/vg )/wky 。/wj 如/v 图/n 9．9/m (/wkz d/x )/wky 所/usuo 示/vg ，/wd 当/v 以/p 直接/a 前驱/n */n S/x 替代/v */n P/x 时/ng ，/wd 由于/c */n S/x 只有/d 左子树/nr SI．/x ，/wd 则/c 在/p 删去/v */n s/x 之后/f ，/wd 只要/c 令/v SI/x ，/wd 为/p */n S/x 的/ude1 双亲/n */n q/x 的/ude1 右/f 子/ng 树/v 即可/v 。/wj 
    图/n 9．9/m 在/p 二/m 叉/n 排序/vn 树/n 中/f 删除/v */n P/x 
(/wkz a/x )/wky 以/p */n f/x 为/p 根/n 的/ude1 子/ng 树/n ；/wf (/wkz b/x )/wky 删除/v */n p/x 之前/f ；/wf (/wkz c/x )/wky 删除/v */n P/x 之后/f ，/wd 以/p P/x 。/wj 作为/p */n s/x 的/ude1 右/f 子/ng 树/n 的/ude1 情形/n 
(/wkz d/x )/wky 删除/v */n P/x 之后/f ，/wd 以/p */n s/x 替代/v */n P/x 的/ude1 情形/n 。/wj 
    在/p 二/m 叉/n 排序/vn 树上/s 删除/v 一个/mq 结点/n 的/ude1 算法/n 如/v 算法/n 9．7/m 所/usuo 示/vg ，/wd 其中/rz 由/p 前述/b 三/m 种/q 情况/n 综合/vn 所得/n 的/ude1 删除/v 操作/v 如/v 算法/n 9．8/m 所/usuo 示/vg 。/wj 
Status/x  DeleteBST/x (/wkz BiTree/x ＆/n T/x ，/wd   KeyType/x  key/x )/wky {/n 
  ／／/m 若/c 二/m 叉/n 排序/vn 树/n T/x 中/f 存在/v 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n 时/ng ，/wd 则/c 删除/v 该/rz 数据/n 元素/n 结点/n ，/wd   ∥/w 并/d 返回/v TRUE/x ；/wf 否则/c 返回/v FALSE/x 
if/x (/wkz !/wt T/x )/wky return/x  FALSE/x ；/wf 
else/x {/n 
∥/w 不/d 存在/v 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n 
  if/x  EQ/x (/wkz key/x ，/wd T/x >/n data．key/x )/wky Delete/x (/wkz T/x )/wky ；/wf     ∥/w 找到/v 关键字/n 等于/v key/x 的/ude1 数据/n 元素/n 
  e15e/x  if/x  LT/x (/wkz key/x ，/wd T/x >/n data．key/x )/wky DeleteBST/x (/wkz T/x >/n ichild/x ，/wd key/x )/wky ；/wf 
  else/x  DeleteBST/x (/wkz T/x >/n rchild/x ，/wd key/x )/wky ；/wf 
  return/x  TRUE/x ；/wf 
  }/n 
＼/m }/n f/x  DeleteBST/x 
    算法/n 9．7/m 
其/rz 中/f 删除/v 操作过程/n 如/v 算法/n 9．8/m 所/usuo 描述/v 
void/x  Delete/x (/wkz BiTree/x ＆/n p/x )/wky {/n 
  ∥/w 从/p 二/m 叉/n 排序/vn 树/n 中/f 删除/v 结点/n P/x ，/wd 并重/vd 接/v 它/rr 的/ude1 左/a 或/c 右/f 子/ng 树/n 
  J．f/x (/wkz !/wt P/x >/n rchild/x )/wky f/x   ∥/w 右/f 子/ng 树/n 空/ng 则/d 只/d 需/v 重/d 接/v 它/rr 的/ude1 左子树/nr 
    q/x 。/wj p/x ；/wf P：P/x >/n ichild/x ；/wf free/x (/wkz q/x )/wky ；/wf 
・/w 230・/m 
}/n 
el/x 舱/n if/x (/wkz !/wt P/x >/n ichild/x )/wky {/n   ∥/w 只/d 需/v 重/d 接/v 它/rr 的/ude1 右/f 子/ng 树/n 
  q=P/x ；/wf P=P/x >/n rchild/x ；/wf free/x (/wkz q/x )/wky ；/wf 
 else/x {/n   ∥/w 左右/m 子/q 树/n 均/d 不/d 空/a 
    q：p/x ；/wf   s=P/x >/n ichild/x ；/wf 
    while/x (/wkz S/x >/n rchild/x )/wky {/n q：s/x ；/wf s：s/x >/n rchild/x }/n   ∥/w 转/v 左/f ，/wd 然后/c 向/p 右/f 到/v 尽头/f 
    P/x >/n data：s/x >/n data/x ；/wf     ∥/w s/x 指向/v 被/pbei 删/v 结点/n 的/ude1 “/wyz 前驱/n ”/wyy 
    if/x (/wkz q/x !/wt =P/x )/wky q-/x >/n rchild：S/x >/n ichild/x ；/wf     ∥/w 重/d 接/v */n q/x 的/ude1 右/f 子/ng 树/n 
    elu/x  q/x >/n ichild=S/x >/n Ichild/x ；/wf     ∥/w 重/d 接/v 。/wj q/x 的/ude1 左子树/nr 
  }/n 
＼/m }/n f/x  Delete/x 
    算法/n 9．8/m 
    三/m 、/wn 二/m 叉/n 排序/vn 树/n 的/ude1 查找/vn 分析/vn 
    从/p 前述/b 的/ude1 两/m 个/q 查找/v 例子/n (/wkz key=100/x 和/cc key：40/x )/wky 可见/v ，/wd 在/p 二/m 叉/n 排序/vn 树上/s 查找/v 其/rz 关键字/n 等于/v 给/p 定/v 值/n 的/ude1 结点/n 的/ude1 过程/n ，/wd 恰/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 结点/n 到/v 该/rz 结点/n 的/ude1 路径/n 的/ude1 过程/n ，/wd 和/cc 给/p 定/v 值/n 比较/vn 的/ude1 关键字/n 个数/n 等于/v 路径长度/n 加/v 1/m (/wkz 或/c 结点/n 所在/n 层次/n 数/n )/wky ，/wd 因此/c ，/wd 和/cc 折半/v 查找/v 类似/a ，/wd 与/p 给/v 定/v 值/n 比较/vn 的/ude1 关键/n 字/n 个/q 数/n 不/d 超过/v 树/n 的/ude1 深度/n 。/wj 然而/c ，/wd 折半/v 查找/v 长度/n 为/v ”/wyy 的/ude1 表/n 的/ude1 判定/vn 树/n 是/vshi 唯一/b 的/ude1 ，/wd 而/cc 含有/v n/x 个/q 结点/n 的/ude1 二/m 叉/n 排序/vn 树/n 却/d 不/d 唯一/b 。/wj 例如/v ：/wp 图/n 9．10/m 中/f (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 的/ude1 两/m 棵/q 二/m 叉/n 排序/vn 树/n 中/f 结点/n 的/ude1 值/n 都/d 相同/a ，/wd 但/c 前者/rzv 由/p 关键字/n 序/n 到/v (/wkz 45/m ，/wd 24/m ，/wd 53/m ，/wd 12/m ，/wd 37/m ，/wd 93/m )/wky 构成/v ，/wd 而/cc 后者/rzv 由/p 关键字/n 序列/n (/wkz 12/m ，/wd 24/m ，/wd 37/m ，/wd 45/m ，/wd 53/m ，/wd 93/m )/wky 构成/v 。/wj (/wkz a/x )/wky 树/n 的/ude1 深度/n 为/p 3/m ，/wd 而/cc (/wkz b/x )/wky 树/n 的/ude1 深度/n 为/p 6/m 。/wj 再/d 从/p 平均/ad 查找/v 长度/n 来看/u ，/wd 假设/v 6/m 个/q 记录/n 的/ude1 查找/vn 概率/n 相等/vi ，/wd 为/p 1／6/m ，/wd 则/d (/wkz a/x )/wky 树/n 的/ude1 平均/ad 查找/v 长度/n 为/v 
    ASL/x (/wkz 。/wj )/wky =i1/x [/wkz 1+2+2+3+3+3/m ]/wky =14／6/m 
    而/cc (/wkz b/x )/wky 树/n 的/ude1 平均/ad 查找/v 长度/n 为/v 
       ASL/x (/wkz 6/m )/wky =i1/x [/wkz 1+2+3十4+5+6/m ]/wky =21／6/m 
    图/n 9．10/m 不同/a 形态/n 的/ude1 二/m 叉/n 查找/v 树/n 
    (/wkz a/x )/wky 关键字/n 序列/n 为/v (/wkz 45/m ，/wd 24/m ，/wd 53/m ，/wd 12/m ，/wd 37/m ，/wd 93/m )/wky 的/ude1 二/m 叉/n 排序/vn 树/n ；/wf (/wkz b/x )/wky 关键字/n 序列/n 为/v (/wkz 12/m ，/wd 24/m ，/wd 37/m ，/wd 45/m ，/wd 53/m ，/wd 93/m )/wky 的/ude1 单/d 支/q 树/n 。/wj 
因此/c ，/wd 含有/v ”/wyy 个/q 结点/n 的/ude1 二/m 叉/n 排序/vn 树/n 的/ude1 平均/ad 查找/v 长度/n 和/cc 树/n 的/ude1 形态/n 有关/vn 。/wj 当/p 先后/d 插入/v 的/ude1 关键字/n 有序/a 时/ng ，/wd 构成/v 的/ude1 二/m 叉/n 排序/vn 树/n 蜕变/vi 为/v 单/d 支/q 树/n 。/wj 
树/n 的/ude1 深度/n 为/v n/x ，/wd 其/rz 平均/ad 查找/v 长度/n 为/v !/wt !/wt 。/wj 顺序/n 查找/v 相同/a )/wky ，/wd 这/rzv 是/vshi 最/d 差/a 的/ude1 情况/n 。/wj 显然/a ，/wd 最/d 好/a 的/ude1 情况/n 是/vshi 二/m 叉/n 排序/vn 树/n 的/ude1 形态/n 和/cc 折半/v 查找/v 的/ude1 判定/vn 树/n 相同/a ，/wd 其/rz 平均/ad 查找/v 长度/n 和/cc 10/m 致以/v 成/v 正比/n 。/wj 那末/c ，/wd 它/rr 的/ude1 平均/a 性能/n 如何/ryv 呢/y ?/ww 
    假设/v 在/p 含有/v n/x (/wkz ，/wd l≥1/x )/wky 个/q 关键/n 字/n 的/ude1 序列/n 中/f ，/wd i/x 个/q 关键字/n 小于/v 第一/m 个/q 关键/n 字/n ，/wd ，/wd z1/x 个/q 关键字/n 大于/v 第一/m 个/q 关键/n 字/n ，/wd 则/c 由/p 此构造/n 而/cc 得/v 的/ude1 二/m 叉/n 排序/vn 树/n 在/p 以/p 个/q 记录/n 的/ude1 查找/vn 概率/n 相等/vi 的/ude1 情况/n 下/f ，/wd 其/rz 平均/ad 查找/v 长度/n 为/v  其中/rz P/x (/wkz i/x )/wky 为/p 含有/v i/x 个/q 结点/n 的/ude1 二/m 叉/n 排序/vn 树/n 的/ude1 平均/ad 查找/v 长度/n ，/wd 则/d P/x (/wkz i/x )/wky +1/m 为/p 查找/v 左子树/nr 中/f 每个/r 关键字/n 时/ng 所/usuo 用/v 比较/vn 次数/n 的/ude1 平均值/n ，/wd P/x (/wkz n―i-1/x )/wky +1/m 为/p 查找/v 右/f 子/ng 树/n 中/f 每个/r 关键字/n 时/ng 所/usuo 用/v 比较/vn 次数/n 的/ude1 平均值/n 。/wj 又/d 假设/v 表/n 中/f 竹/ng 个/q 关键/n 字/n 的/ude1 排列/vn 是/vshi “/wyz 随机/b ”/wyy 的/ude1 ，/wd 即/d 任/v 一个/mq 关键/a 字/n 在/p 序列/n 中/f 将/d 是/vshi 第1/m 个/q ，/wd 或/c 第2/m 个/q ，/wd …/ws ，/wd 或/c 第/m ”/wyy 个/q 的/ude1 概率/n 相同/a ，/wd 则/c 可/v 对/p 、/wn (/wkz 9．17/m )/wky 式/k 从/p i/x 等于/v 0/m 至/p n1/x 取/v 平均值/n 
    
容易/ad 看出/v 上/f 式/k 括弧/n 中/f 的/ude1 第一/m 项/q 和/cc 第二/m 项/q 对/p 称/v 。/wj 又/c ，/wd 0时/t (/wkz i/x )/wky =0/m ，/wd 则/c 上/f 式/k 可/v 改写/v 为/v 
显然/a ，/wd P/x (/wkz 0/m )/wky =0/m ，/wd P/x (/wkz 1/m )/wky =1/m 。/wj 
    由/p 式/k (/wkz 9．18/m )/wky 可/v 推/v 得/v 
由此/d 可/v 得/v 
由/p 递推/n 公式/n (/wkz 9．19/m )/wky 和/cc 初始条件/n P/x (/wkz 1/m )/wky ：/wp 1/m 可/v 推/v 得/v ：/wp 
        由此可见/c ，/wd 在/p 随机/b 的/ude1 情况/n 下/f ，/wd 二/m 叉/n 排序/vn 树/n 的/ude1 平均/ad 查找/v 长度/n 和/cc log/x 挖/v 是/vshi 等/v 数量级/n 的/ude1 。/wj 然而/c ，/wd 在/p 某些/rz 情况/n 下/f (/wkz 有/vyou 人/n 研究/v 证明/v ，/wd 这种/r 情况/n 出现/v 的/ude1 概率/n 约/d 为/v 46．5％/m )/wky [/wkz 1I/x ，/wd 尚/d 需/v 在/p 构成/v 二/m 叉/n 排序/vn 树/n 的/ude1 过程/n 中/f 进行/vx “/wyz 平衡/a 化/v ”/wyy 处理/vn ，/wd 成为/v 二/m 叉/n 平衡/a 树/n 。/wj 
  四/m 、/wn 平衡/a 二/m 叉树/n 
  平衡/a 二/m 叉树/n (/wkz Baianced/x  Binary/x  Tl/x '/n ee/x 或/c }/n {/n eight―Balanced/x  Tree/x )/wky 又/d 称/v AVL/x 树/n 。/wj 它/rr 或者/c 是/vshi 一/m 棵/q 空/a 树/n ，/wd 或者/c 是/vshi 具有/v 下列/b 性质/n 的/ude1 二/m 叉树/n ：/wp 它/rr 的/ude1 左子树/nr 和/cc 右/f 子/ng 树/n 都/d 是/vshi 平衡/a 二/m 叉树/n ，/wd 且左子树/nr 和/cc 右/f 子/ng 树/n 的/ude1 深度/n 之/uzhi 差/ng 的/ude1 绝对值/n 不/d 超过/v 1/m 。/wj 若/c 将/p 二/m 叉/n 树上/s 结点/n 的/ude1 平衡/a 因子/n BF/x (/wkz BalanceF/x 。/wj 。/wj t/x 。/wj ，/wd )/wky 定义/n 为/p 该/rz 结点/n 的/ude1 左子树/nr 的/ude1 深度/n 减去/v 它/rr 的/ude1 右/f 子/ng 树/n 的/ude1 深度/n ，/wd 则/d 平衡/a 二/m 叉/n 树上/s 所有/b 结点/n 的/ude1 平衡/a 因子/n 只/d 可能/v 是/vshi -/wp 1/m 、/wn 0/m 和/cc 1/m 。/wj 只要/c 二/m 叉/n 树上/s 有/vyou 一个/mq 结点/n 的/ude1 平衡/a 因子/n 的/ude1 绝对值/n 大于/v 1/m ，/wd 则/c 该/rz 二/m 叉树/n 就是/d 不/d 平衡/a 的/ude1 。/wj 如/v 图/n 9．11/m (/wkz a/x )/wky 所/usuo 示/vg 为/p 两/m 棵/q 平衡/a 二/m 叉树/n ，/wd 而/cc 图/n 9．1l/x (/wkz b/x )/wky 所/usuo 示/vg 为/p 两/m 棵/q 不/d 平衡/a 的/ude1 二/m 叉树/n ，/wd 结点/n 中/f 的/ude1 值/n 为/p 该/rz 结点/n 的/ude1 平衡/a 因子/n 。/wj 
    图/n 9．11/m 平衡/an 与/cc 不/d 平衡/a 的/ude1 二/m 叉树/n 及/cc 结点/n 的/ude1 平衡/a 因子/n 
    (/wkz a/x )/wky 平衡/v 二/m 叉树/n ；/wf   (/wkz b/x )/wky 不/d 平衡/a 的/ude1 二/m 叉树/n 。/wj 
    我们/rr 希望/v 由/p 任何/rz 初始序列/n 构成/v 的/ude1 二/m 叉/n 排序/vn 树/n 都/d 是/vshi AVL/x 树/n 。/wj 因为/p AVL/x 树/n 上/f 任何/rz 结点/n 的/ude1 左右/m 子/q 树/n 的/ude1 深度/n 之/uzhi 差/ng 都/d 不/d 超过/v 1/m ，/wd 则/c 可以/v 证明/v 它/rr 的/ude1 深度/n 和/cc logN/x 是/vshi 同/p 数量级/n 的/ude1 (/wkz 其中/rz N/x 为/p 结点/n 个数/n )/wky 。/wj 由此/d ，/wd 它/rr 的/ude1 平均/ad 查找/v 长度/n 也/d 和/cc logN/x 同/p 数量级/n 。/wj 
    如何/ryv 使/v 构成/v 的/ude1 二/m 叉/n 排序/vn 树/n 成为/v 平衡/a 树/n 呢/y ?/ww 先/d 看/v 一个/mq 具体/a 例子/n (/wkz 参见图/n 9．12/m )/wky 。/wj 假设/n 表/vg 中/b 关键字/n 序列/n 为/v (/wkz 13/m ，/wd 24/m ，/wd 37/m ，/wd 90/m ，/wd 53/m )/wky 。/wj 空/a 树/n 和/cc 1/m 个/q 结点/n ⑩/m 的/ude1 树/n 显然/ad 都/d 是/vshi 平衡/a 的/ude1 二/m 叉树/n 。/wj 在/p 插入/v 24/m 之/uzhi 后/f 仍/d 是/vshi 平衡/a 的/ude1 ，/wd 只是/c 根/n 结点/n 的/ude1 平衡/a 因子/n BF/x 、/wn 由/p 0/m 变为/v -/wp 1/m ；/wf 在/p 继续/v 插入/v 37/m 之后/f ，/wd 由于/c 结点/n ⑩/m 的/ude1 BF/x 值/n 由/p -/wp 1/m 变成/v 一/m 2/m ，/wd 由此/d 出现/v 了/ule 不/d 平衡/a 的/ude1 现象/n 。/wj 此时/r 好比/v 一/m 根/q 扁担/n 出现/v 一/m 头/q 重/a 一/m 头/q 轻/a 的/ude1 现象/n ，/wd 若/c 能/v 将/p 扁担/n 的/ude1 支撑点/n 由/p ⑩/m 改/v 至/p ④/m ，/wd 扁担/n 的/ude1 两/m 头/q 就/d 平衡/a 了/y 。/wj 由此/d ，/wd 可以/v 对/p 树/n 作/v 一个/mq 向/p 左/f 逆时针/d “/wyz 旋转/vi ”/wyy 的/ude1 操作/vn ，/wd 令/v 结点/n ⑦/m 为/p 根/n ，/wd 而/cc 结点/n ⑩/m 为/p 它/rr 的/ude1 左子树/nr ，/wd 此时/r ,/wd 结点/n ⑩/m 和/cc ⑦/m 的/ude1 平衡/a 因子/n 都/d 为/v 0/m ，/wd 而且/c 仍/d 保持/v 二/m 叉/n 排序/vn 树/n 的/ude1 特性/n 。/wj 在/p 继续/v 插入/v 90/m 和/cc 53/m 之后/f ，/wd 由于/c 结点/n ⑦/m 的/ude1 BF/x ’/wyy 值/v 由/p  1/m 变成/v  2/m ，/wd 排序/vn 树/n 中/f 出现/v 了/ule 新/a 的/ude1 不/d 平衡/a 的/ude1 现象/n ，/wd 需/v 进行/vx 调整/vn 。/wj 
但/c 此时/r 由于/p 结点/n ⑦/m 插/v 在/p 结点/n ④/m 的/ude1 左/a 子/ng 树上/s ，/wd 因此/c 不/d 能/v 如/v 上/f 作/v 简单/a 调整/vn 。/wj 对于/p 以/p 结点/n ⑤/m 为/p 根/n 的/ude1 子/ng 树/n 来说/uls ，/wd 既/c 要/v 保持/v 二/m 叉/n 排序/vn 树/n 的/ude1 特性/n ，/wd 又/d 要/v 平衡/an ，/wd 则/c 必须/d 以/p ⑦/m 作为/p 根/n 结点/n ，/wd 而/cc 使/v ⑦/m 成为/v 它/rr 的/ude1 左子树/nr 的/ude1 根/n ，/wd ①/m 成为/v 它/rr 的/ude1 右/f 子/ng 树/n 的/ude1 根/n 。/wj 这/rzv 好比/v 对/p 树/n 作/v 了/ule 两/m 次/qv “/wyz 旋转/vi ”/wyy 操作/v ――/wp 先/d 向/p 右/f 顺/v 时针/n ，/wd 后/f 向/p 左/f 逆时针/d (/wkz 见/v 图/n 9．12/m (/wkz f/x )/wky 一/m (/wkz h/x )/wky )/wky ，/wd 使/v 二/m 叉/n 排序/vn 树/n 由/p 不/d 平衡/a 转化/vn 为/v 平衡/an 。/wj 
  图/n 9．12/m 平衡/a 树/n 的/ude1 生成/vn 过程/n 
    (/wkz a/x )/wky 空/v 树/n ；/wf (/wkz b/x )/wky 插入/v 13/m ；/wf (/wkz c/x )/wky 插入/v 24/m ；/wf (/wkz d/x )/wky 插入/v 37/m ；/wf (/wkz e/x )/wky 向/p 左/f 逆时针/d 右/f 旋转/vi 平衡/an ；/wf 
(/wkz f/x )/wky 相继/d 插入/v 90/m 和/cc 53/m ；/wf (/wkz g/x )/wky 第一/m 次/qv 向/p 右/f 顺/v 时针/n 旋转/vi ；/wf (/wkz h/x )/wky 第二/m 次/qv 向/p 左/f 逆时针/d 旋转/vi 平衡/a 之/uzhi 。/wj 
    一般/a 情况/n 下/f ，/wd 假设/v 由于/c 在/p 二/m 叉/n 排序/vn 树上/s 插入/v 结点/n 而/cc 失去/v 平衡/a 的/ude1 最/d 小子/n 树根/n 结点/n 的/ude1 指针/n 为/v a/x (/wkz 即/v a/x 是/vshi 离/v 插入/v 结点/n 最近/t ，/wd 且/c 平衡/a 因子/n 绝对值/n 超过/v 1/m 的/ude1 祖先/n 结点/n )/wky ，/wd 则/c 失去/v 平衡/an 后/f 进行/vx 调整/vn 的/ude1 规律/n 可/v 归纳/v 为/p 下列/b 四/m 种/q 情况/n ：/wp 
    (/wkz 1/m )/wky 单向/b 右/f 旋/vg 平衡/a 处理/vn ：/wp 由于/c 在/p */n a/x 的/ude1 左子树根/nr 结点/n 的/ude1 左/a 子/ng 树上/s 插入/v 结点/n ，/wd */n a/x 的/ude1 平衡/a 因子/n 由/p 1/m 增至/v 2/m ，/wd 致使/v 以/p */n a/x 为/p 根/n 的/ude1 子/ng 树/v 失去/v 平衡/an ，/wd 则/c 需/v 进行/vx 一/m 次/qv 向/p 右/f 的/ude1 顺/a 时针/n 旋转/vi 操作/v ，/wd 如/v 图/n 9．13/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 
    (/wkz 2/m )/wky 单向/d 左/a 旋/vg 平衡/a 处理/vn ：/wp 由于/c 在/p */n a/x 的/ude1 右/f 子/ng 树根/n 结点/n 的/ude1 右/f 子/ng 树上/s 插入/v 结点/n ，/wd */n a/x 的/ude1 平衡/a 因子/n 由/p -/wp 1/m 增至/v 一/m 2/m ，/wd 致使/v 以/p */n a/x 为/p 根/n 结点/n 的/ude1 子/ng 树/v 失去/v 平衡/an ，/wd 则/c 需/v 进行/vx 一/m 次/qv 向/p 左/a 的/ude1 逆时针/d 旋转/vi 操作/v 。/wj 如/v 图/n 9．13/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 
    (/wkz 3/m )/wky 双向/d 旋转/vi (/wkz 先/d 左/a 后/f 右/f )/wky 平衡/v 处理/v ：/wp 由于/c 在/p */n a/x 的/ude1 左子树根/nr 结点/n 的/ude1 右/f 子/ng 树上/s 插入/v 结点/n ，/wd */n a/x 的/ude1 平衡/a 因子/n 由/p 1/m 增至/v 2/m ，/wd 致使/v 以/p */n a/x 为/p 根/n 结点/n 的/ude1 子/ng 树/v 失去/v 平衡/an ，/wd 则/c 需/v 进行/vx 两/m 次/qv 旋转/vi (/wkz 先左旋/nr 后右旋/nr )/wky 操作/vn 。/wj 如/v 图/n 9．13/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    (/wkz 4/m )/wky 双向/d 旋转/vi (/wkz 先/d 右/f 后/f 左/f )/wky 平衡/v 处理/v ：/wp 由于/c 在/p */n a/x 的/ude1 右/f 子/ng 树根/n 结点/n 的/ude1 左/a 子/ng 树上/s 插入/v 结点/n ，/wd */n a/x 的/ude1 平衡/a 因子/n 由/p -/wp 1/m 增至/v 一/m 2/m ，/wd 致使/v 以/p */n a/x 为/p 根/n 结点/n 的/ude1 子/ng 树/v 失去/v 平衡/an ，/wd 则/c 需/v 进行/vx 两/m 次/qv 旋转/vi (/wkz 先/d 右/f 旋/vg 后/f 左旋/nr )/wky 操作/vn 。/wj 如/v 图/n 9．13/m (/wkz d/x )/wky 所/usuo 示/vg 。/wj 
    上述/b 四/m 种/q 情况/n 中/f ，/wd (/wkz 1/m )/wky 和/cc (/wkz 3/m )/wky 对称/a ，/wd (/wkz 2/m )/wky 和/cc (/wkz 4/m )/wky 对/p 称/v 。/wj 旋转/vi 操作/v 的/ude1 正确性/n 容易/ad 由/p “/wyz 保持/v 二/m 叉/n 排序/vn 树/n 的/ude1 特性/n ：/wp 中/b 序/n 遍历/n 所得/n 关键字/n 序列/n 自/p 小/a 至/p 大/a 有序/a ”/wyy 证明/v 之/uzhi 。/wj 同时/c ，/wd 从/p 图/n 9．13/m 可见/c ，/wd 无论/c 哪/ry 一/m 种/q 情况/n ，/wd 在/p 经过/p 平衡/a 旋转/vn 处理/vn 之后/f ，/wd 以/p */n b/x 或/c */n c/x 为/p 根/n 的/ude1 新子树/nr 为/p 平衡/a 二/m 叉树/n ，/wd 而且/c 它/rr 的/ude1 深度/n 和/cc 插入/v 之前/f 以/p */n a/x 为/p 根/n 的/ude1 子/ng 树/v 相同/a 。/wj 因此/c ，/wd 当/p 平衡/a 的/ude1 二/m 叉/n 排序/vn 树/n 因/c 插入/v 结点/n 而/cc 失去/v 平衡/a 时/ng ，/wd 仅/d 需/v 对/p 最/d 小/a 不/d 平衡/a 子/ng 树/n 进行/vx 平衡/a 旋转/vi 处理/v 即可/v 。/wj 因为/c 经过/p 旋转/vi 处理/v 之后/f 的/ude1 子/ng 树/v 深度/n 和/cc 插入/v 之前/f 相同/a ，/wd 因而/c 不/d 影响/v 插入/v 路径/n 上/f 所有/b 祖先/n 结点/n 的/ude1 平衡/a 度/qv 。/wj 
    插入/v 结点/n     (/wkz c/x )/wky 
插入/v 结点/n 
    图/n 9．13/m 二/m 叉/n 排序/vn 树/n 的/ude1 平衡/a 旋转/vn 图例/n 
    (/wkz a/x )/wky LL/x 型/k ；/wf   (/wkz b/x )/wky LR/x 型/k ；/wf   (/wkz c/x )/wky RR/x 型/k ；/wf   (/wkz d/x )/wky RL/x 型/k 。/wj 
    在/p 平衡/a 的/ude1 二/m 叉/n 排序/vn 树/n BBS/x '/n I/x 、/wn 上/f 插入/v 一个/mq 新/a 的/ude1 数据/n 元素/n e/x 的/ude1 递归/n 算法/n 可/v 描述/v 如下/vi ：/wp 
    (/wkz 一/m )/wky 若/v BBST/x 为/p 空/a 树/n ，/wd 则/c 插入/v 一个/mq 数据/n 元素/n 为/v e/x 的/ude1 新/a 结点/n 作为/v BBST/x 、/wn 的/ude1 根/n 结点/n ，/wd 树/v 的/ude1 深度/n 增/v l/x ；/wf 
    (/wkz 二/m )/wky 若/v e/x 的/ude1 关键/n 字/n 和/cc BBST/x ‘/wyz 的/ude1 根/n 结点/n 的/ude1 关键字/n 相等/vi ，/wd 则/c 不/d 进行/vx 插入/v ；/wf 
    (/wkz 三/m )/wky 若/v e/x 的/ude1 关键字/n 小于/v BBST/x 的/ude1 根/n 结点/n 的/ude1 关键/n 字/n ，/wd 而且/c 在/p BBST/x ‘/wyz 的/ude1 左子树/nr 中/f 不/d 存在/v 和/cc e/x 有/vyou 相同/a 关键字/n 的/ude1 结点/n ，/wd 则/c 将/d e/x 插入/v 在/p BBST/x ‘/wyz 的/ude1 左/a 子/ng 树上/s ，/wd 并且/c 当/p 插入/v 之后/f 的/ude1 左/a 子/ng 树/v 深度/n 增加/v (/wkz +1/m )/wky 时/ng ，/wd 分别/d 就/d 下列/b 不同/a 情况/n 处理/v 之/rz ：/wp 
    (/wkz 1/m )/wky BBST/x 、/wn 的/ude1 根/n 结点/n 的/ude1 平衡/a 因子/n 为/v l/x (/wkz 右/f 子/ng 树/n 的/ude1 深度/n 大于/v 左/a 子/ng 树/n 的/ude1 深度/n )/wky ：/wp 则/c 将/p 根/n 结点/n 的/ude1 平衡/a 因子/n 更改/v 为/p 0/m ，/wd BBST/x 的/ude1 深度/n 不/d 变/v ；/wf 
    (/wkz 2/m )/wky BBST/x 、/wn 的/ude1 根/n 结点/n 的/ude1 平衡/a 因子/n 为/v O/x (/wkz 左/f 、/wn 右/f 子/ng 树/n 的/ude1 深度/n 相等/vi )/wky ：/wp 则/c 将/p 根/n 结点/n 的/ude1 平衡/a 因子/n 更改/v 为/p 1/m ，/wd BBST/x 的/ude1 深度/n 增/v l/x ；/wf 
    ・/w 235・/m 
　　(/wkz 3/m )/wky BBST/x 的/ude1 根/n 结点/n 的/ude1 平衡/a 因子/n 为/p 1/m (/wkz 左子树/nr 的/ude1 深度/n 大于/v 右/f 子/ng 树/n 的/ude1 深度/n )/wky ：/wp 则/d 若/v BBST/x 的/ude1 左子树根/nr 结点/n 的/ude1 平衡/a 因子/n 为/v l：/x 则/d 需/v 进行/vx 单向/b 右/f 旋/vg 平衡/a 处理/vn ，/wd 并且/c 在/p 右/f 旋/d 处理/v 之后/f ，/wd 将/p 根/n 结点/n 和/cc 其/rz 右/f 子/ng 树根/n 结点/n 的/ude1 平衡/a 因子/n 更改/v 为/p 0/m ，/wd 树/v 的/ude1 深度/n 不/d 变/v ；/wf 
    若/v BBST/x 的/ude1 左子树根/nr 结点/n 的/ude1 平衡/a 因子/n 为/v -/wp 1：/m 则/c 需/v 进行/vx 先/d 向/p 左/a 、/wn 后/f 向/p 右/f 的/ude1 双向/b 旋转/vi 平衡/a 处理/vn ，/wd 并且/c 在/p 旋转/vi 处理/v 之后/f ，/wd 修改/v 根/n 结点/n 和/cc 其/rz 左/a 、/wn 右/f 子/ng 树根/n 结点/n 的/ude1 平衡/a 因子/n ，/wd 树/v 的/ude1 深度/n 不/d 变/v ；/wf 
    (/wkz 四/m )/wky 若/v e/x 的/ude1 关键字/n 大于/v BBST/x 的/ude1 根/n 结点/n 的/ude1 关键/n 字/n ，/wd 而且/c 在/p BBST/x 的/ude1 右/f 子/ng 树/n 中/f 不/d 存在/v 和/cc e/x 有/vyou 相同/a 关键字/n 的/ude1 结点/n ，/wd 则/c 将/d e/x 插入/v 在/p BBST/x 的/ude1 右/f 子/ng 树上/s ，/wd 并且/c 当/p 插入/v 之后/f 的/ude1 右/f 子/ng 树/v 深度/n 增加/v (/wkz +1/m )/wky 时/ng ，/wd 分别/d 就/d 不同/a 情况/n 处理/v 之/uzhi 。/wj 其/rz 处理/vn 操作/vn 和/cc (/wkz 3/m )/wky 中/f 所/usuo 述/vg 相对/d 称/v ，/wd 读者/n 可/c 自行/d 补充/v 。/wj 
    假设/v 在/p “/wyz 6．2．3/m 二/m 叉树/n 的/ude1 存储/vn 结构/n ”/wyy 中/f 定义/v 的/ude1 二/m 叉/n 链/ng 表/n 的/ude1 结点/n 中/f 增加/v 一个/mq 存储/vn 结点/n 平衡/a 因子/n 的/ude1 域/n bf/x ，/wd 则/c 上述/b 在/p 平衡/a 的/ude1 二/m 叉/n 排序/vn 树/n BBsT/x 上/f 插入/v 一个/mq 新/a 的/ude1 数据/n 元素/n e/x 的/ude1 递归/n 算法/n 如/v 算法/n 9．11/m 所/usuo 示/vg ，/wd 其中/rz ，/wd 左/a 平衡/a 处理/vn 的/ude1 算法/n 如/v 算法/n 9．12/m 所/usuo 示/vg 。/wj 算法/n 9．9/m 和/cc 算法/n 9．10/m 分别/d 描述/v 了/ule 在/p 平衡/a 处理/vn 中/f 进行/vx 右/f 旋/vg 操作/vn 和/cc 左/a 旋/vg 操作/v 时/ng 修改/v 指针/n 的/ude1 情况/n 。/wj 右/f 平衡/a 处理/vn 的/ude1 算法/n 和/cc 左/a 平衡/a 处理/vn 的/ude1 算法/n 类似/a ，/wd 读者/n 可/v 自己/rr 补充/v 。/wj 
    二/m 叉/n 排序/vn 树/n 的/ude1 类型定义/n 为/v ：/wp 
tn/x ~/n def/x  struct/x  BSTNode/x  I/x 
  ElemType/x  data：/x 
  imt/x     bf/x ；/wf     ∥/w 结点/n 的/ude1 平衡/a 因子/n 
  struct/x  BSTNode/x */n lch／．1d/x ，/wd */n rcjild/x ；/wf ∥/w 左/a 、/wn 右/f 孩子/n 指针/n 
I/x  BSTNode/x ，/wd */n BSTree/x ；/wf 
vold/x  R―Rotate/x (/wkz BSTree/x ＆/n p/x )/wky {/n 
  ∥/w 对/p 以/p */n p/x 为/p 根/n 的/ude1 二/m 叉/n 排序/vn 树/n 作/v 右/f 旋/d 处理/v ，/wd 处理/v 之后/f p/x 指向/v 新/a 的/ude1 树根/n 结点/n ，/wd 即/d 旋转/vi   ∥/w 处理/v 之前/f 的/ude1 左子树/nr 的/ude1 根/n 结点/n 
∥/w lc/x 指向/v 的/ude1 p/x 左/f 子/ng 树根/n 结点/n 
∥/w lc/x 的/ude1 右/f 子/ng 树挂/n 接/v 为/v p/x 的/ude1 左子树/nr 
∥/w p/x 指向/v 新/a 的/ude1 根/n 结点/n 
算法/n 9．9/m 
  ∥/w 对/p 以/p */n p/x 为/p 根/n 的/ude1 二/m 叉/n 排序/vn 树/n 作/v 左/f 旋/d 处理/v ，/wd 处理/v 之后/f p/x 指向/v 新/a 的/ude1 树根/n 结点/n ，/wd 即/d 旋转/vi 
  ∥/w 处理/v 之前/f 的/ude1 右/f 子/ng 树/n 的/ude1 根/n 结点/n 
∥/w rc/x 指向/v 的/ude1 p/x 右/f 子/ng 树根/n 结点/n 
∥/w rc/x 的/ude1 左/a 子/ng 树挂/n 接/v 为/v p/x 的/ude1 右/f 子/ng 树/n 
∥/w p/x 指向/v 新/a 的/ude1 根/n 结点/n 
算法/n 9．10/m 
Status/x  InsertAVL/x (/wkz BSTree/x &/n T/x 。/wj ElemType/x  e/x ，/wd Boolean/x &/n taller/x )/wky {/n 
  ∥/w 若/c 在/p 平衡/a 的/ude1 二/m 叉/n 排序/vn 树/n T/x 中/f 不/d 存在/v 和/cc e/x 有/vyou 相同/a 关键字/n 的/ude1 结点/n ，/wd 则/c 插入/v 一个/mq 数据/n 元素/n 
  ∥/w 为/v e/x 的/ude1 新/a 结点/n ，/wd 并/cc 返回/v 1/m ，/wd 否则/c 返回/v 0/m 。/wj 若/c 因/p 插入/v 而/cc 使/v 二/m 叉/n 排序/vn 树/n 失去/v 平衡/an ，/wd 则/c 作/v 平衡/an 
  ∥/w 旋转/vi 处理/v ，/wd 布尔/n 变量/n taller/x 反映/v T/x 长/a 高/a 与否/u 
  if/x (/wkz !/wt T/x )/wky {/n ∥/w 插入/v 新/a 结点/n ，/wd 树/v “/wyz 长/a 高/a ”/wyy ，/wd 置/v taller/x 为/v TRUE/x 
>/n data．key/x )/wky {/n     ∥/w 应/v 继续/v 在/p */n T/x 的/ude1 左子树/nr 中/f 进行/vx 搜索/vn 
    if/x (/wkz !/wt InsertAVL/x (/wkz T/x >/n ichild/x ，/wd e/x ，/wd taller/x )/wky )/wky   return/x  0/m ；/wf     ∥/w 未/d 插入/v 
    if/x (/wkz taller/x )/wky     ∥/w 已/d 插入/v 到/v */n T/x 的/ude1 左子树中/nr 且左子/nr 树/v “/wyz 长/a 高/a ”/wyy 
    switch/x (/wkz T/x >/n bf/x )/wky {/n     ∥/w 检查/vn */n T/x 的/ude1 平衡/a 度/qv 
    case/x  LH：/x     ∥/w 原本/d 左/a 子/ng 树/v 比/p 右/f 子/ng 树/v 高/a ，/wd 需要/v 作/v 左/a 平衡/a 处理/vn 
    LeftBalance/x (/wkz T/x )/wky ；/wf taller=FALSE/x ；/wf brack/x ；/wf 
    case/x  EH：/x     ∥/w 原本/d 左/a 、/wn 右/f 子/ng 树/n 等/udeng 高/a ，/wd 现/tg 因/p 左/a 子/ng 树/n 增高/vi 而/cc 使/v 树/n 增高/vi 
    T/x >/n bf=LH：taller=TRUE/x ；/wf   break/x ；/wf 
    case/x  RH：/x     ∥/w 原本/n 右/f 子/ng 树/v 比/p 左子树高/nr ，/wd 现/tg 左/f 、/wn 右/f 子/ng 树/n 等/udeng 高/a 
    T/x >/n bf：EH/x ；/wf taller=FALSE/x ；/wf   break/x ；/wf 
    else/x {/n     ∥/w 应/v 继续/v 在/p */n T/x 的/ude1 右/f 子/ng 树/n 中/f 进行/vx 搜索/vn 
    if/x (/wkz !/wt InsertAVL/x (/wkz T/x >/n rchild/x ，/wd e/x ，/wd taller/x )/wky )/wky return/x  0/m ；/wf     ∥/w 未/d 插入/v 
    if/x (/wkz taller/x )/wky     ∥/w 已/d 插入/v 到/v T/x 的/ude1 右/f 子/ng 树/n 且/c 右/f 子/ng 树长高/nr 
    switch/x (/wkz T/x >/n bf/x )/wky {/n     ∥/w 检查/v T/x 的/ude1 平衡/a 度/qv 
    case/x  LH：/x     ∥/w 原本/d 左/a 子/ng 树/v 比/p 右/f 子/ng 树/v 高/a ，/wd 现/tg 左/f 、/wn 右/f 子/ng 树/n 等/udeng 高/a 
    T/x >/n bf=EH/x ；/wf taller=FALSE/x ；/wf break/x ；/wf 
    case/x  EH：/x     ∥/w 原本/d 左/a 、/wn 右/f 子/ng 树/n 等/udeng 高/a ，/wd 现/tg 因/p 右/f 子/ng 树/n 增高/vi 而/cc 使/v 树/n 增高/vi 
    T/x >/n bf=RH/x ；/wf taller=TRUE/x ；/wf   break/x ；/wf 
    case/x  RH：/x     ∥/w 、/wn 原本/n 右/f 子/ng 树/v 比/p 左子树高/nr ，/wd 需要/v 作/v 右/f 平衡/v 处理/v 
    RightBalance/x (/wkz T/x )/wky ；/wf taller=FALSE/x ；/wf   break/x ；/wf 
    }/n ∥/w switch/x (/wkz T/x >/n bf/x )/wky 
    ＼jt/x  else/x 
    、/wn ?/ww ，/wd else/x 
    return/x  1/m ；/wf 
＼f/x }/n InsertAVL/x 
    算法/n 9．II/x 
void/x  LeftBalance/x (/wkz BSTree/x ＆/n T/x )/wky {/n 
  ∥/w 对/p 以/p 指针/n T/x 所/usuo 指/v 结点/n 为/p 根/n 的/ude1 二/m 叉树/n 作/v 左/f 平衡/v 旋转/vi 处理/v ，/wd 本/rz 算法/n 结束/v 时/ng ，/wd 指针/n T/x 指向/v 
  ∥/w 新/a 的/ude1 根/n 结点/n 
  ic=T/x >/n ichild/x ；/wf     ∥/w ic/x 指向/v */n T/x 的/ude1 左子树根/nr 结点/n 
  switch/x (/wkz ic/x >/n bf/x )/wky {/n     ∥/w 检查/vn */n T/x 的/ude1 左子树/nr 的/ude1 平衡/a 度/qv ，/wd 并/cc 作/v 相应/vd 平衡/v 处理/v 
    case/x  LH：/x     ∥/w 新/d 结点/n 插入/v 在/p */n T/x 的/ude1 左/a 孩子/n 的/ude1 左/a 子/ng 树上/s ，/wd 要/v 作/v 单/b 右/f 旋/d 处理/v 
    T/x >/n bf=ic/x >/n bf=EH/x ；/wf 
    RRotate/x (/wkz T/x )/wky ；/wf break/x ；/wf 
    case/x  RH：/x     ∥/w 新/d 结点/n 插入/v 在/p */n T/x 的/ude1 左/a 孩子/n 的/ude1 右/f 子/ng 树上/s ，/wd 要/v 作/v 双/m 旋/vg 处理/v 
    rd/x 。/wj Ic/x >/n right/x ；/wf   ∥/w rd/x 指向/v */n T/x 的/ude1 左/a 孩子/n 的/ude1 右/f 子/ng 树根/n 
    ・/w 237・/m 
舯/n dtch/x (/wkz rd/x >/n bf/x >/n l/x   ∥/w 修改/v */n T/x 及/cc 其/rz 左/a 孩子/n 的/ude1 平衡/a 因子/n 
    case/x  LH：T/x >/n bf=RH/x ；/wf   lc/x >/n bf=EH/x ；/wf   break/x ；/wf 
    case/x 翻/v ：/wp T/x >/n bf=lc/x >/n bf=EH/x ；/wf     break/x ；/wf 
    case/x  RH：T/x >/n bf=EH/x ；/wf   1c/x >/n bf=LH/x ；/wf   break/x ；/wf 
l/x ∥/w switch/x (/wkz rd/x >/n bf/x )/wky 
rd/x >/n bf=EH/x ；/wf 
    LRotate/x (/wkz Thild/x )/wky 
    RRotate/x (/wkz T/x )/wky ；/wf 
  }/n ∥/w switch/x (/wkz 1c/x >/n bf/x )/wky 
＼≠/m }/n LeftBalance/x 
∥/w 对/p */n T/x 的/ude1 左子树/nr 作/v 左/f 旋/vg 平衡/a 处理/vn 
∥/w */n T/x 作/v 右/f 旋/vg 平衡/a 处理/vn 
算法/n 9．12/m 
  五/m 、/wn 平衡/a 树/n 查找/v 的/ude1 分析/vn 
  在/p 平衡/a 树/n 上/f 进行/vx 查找/vn 的/ude1 过程/n 和/cc 排序/vn 树/n 相同/a ，/wd 因此/c ，/wd 在/p 查找/v 过程/n 中/f 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键/n 字/n 个/q 数/n 不/d 超过/v 树/n 的/ude1 深度/n 。/wj 那末/c ，/wd 含有/v n/x 个/q 关键/n 字/n 的/ude1 平衡/a 树/n 的/ude1 最/d 大/a 深度/n 是/vshi 多少/ry 呢/y ?/ww 为/p 解答/v 这个/rz 问题/n ，/wd 我们/rr 先/d 分析/v 深度/n 为/p ^/n 的/ude1 平衡/a 树/n 所/usuo 具有/v 最/d 少/ad 结/v 点数/n 。/wj 
    假设/v 以/p N/x 。/wj 表示/v 深度/n 为/v ，/wd 2/m 的/ude1 平衡/a 树/n 中/f 含有/v 的/ude1 最/d 少/ad 结/v 点数/n 。/wj 显然/a ，/wd N0=0/x ，/wd Nl=1/x ，/wd N2：2/x ，/wd 并且/c N/x 。/wj =．N/x 卜/vg ，/wd +N/x ^/n 一：/m +l/x 。/wj 这个/rz 关系/n 和/cc 斐/b 波/n 那/rzv 契/vg 序列/n 极为/d 相似/a 。/wj 利用/v 归纳法/n 容易/ad 证明/v ：/wp 当/p ^/n ≥0/m 时/ng M=R+2/x ～/ws 1/m ，/wd 而/cc R/x 约/d 等于/v (/wkz 其中/rz 9=L/x !/wt ≯/m )/wky [/wkz ，/wd 则/d M/x 约/d 等于/v 
    。/wj 反之/c ，/wd 含有/v ”/wyy 个/q 结点/n 的/ude1 平衡/a 树/n 的/ude1 最/d 大/a 深度/n 为/v logc/x 、/wn (/wkz √5/m (/wkz n+1/x )/wky )/wky 一/m 2/m 。/wj 因此/c ，/wd 在/p 平衡/a 树/n 上/f 进行/vx 查找/vn 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz 10g/x ，/wd r/x )/wky 。/wj 
    上述/b 对/p 二/m 叉/n 排序/vn 树/n 和/cc 二/m 叉/n 平衡/a 树/n 的/ude1 查找/vn 性能/n 的/ude1 讨论/vn 都/d 是/vshi 在/v 等/udeng 概率/n 的/ude1 前提/n 下/f 进行/vx 的/ude1 ，/wd 若/c 查找/v 概率/n 不等/vi ，/wd 则/c 类似/v 于/p “/wyz 9．1．3/m 静态/n 树/n 表/n 的/ude1 查找/vn ”/wyy 中/f 的/ude1 讨论/vn 。/wj 为了/p 提高/v 查找效率/n ，/wd 需要/v 对/p 待查/v 记录/v 序列/n 先/d 进行/vx 排序/vn ，/wd 使/v 其/rz 按/p 关键字/n 递增/vi (/wkz 或/c 递减/vi )/wky 有序/a ，/wd 然后/c 再/d 按/p 算法/n 9．4/m 构造/n 一/m 棵/q 次优/n 查找/v 树/n 。/wj 显然/a ，/wd 次优/n 查找/v 树/n 也/d 是/vshi 一/m 棵/q 二/m 叉/n 排序/vn 树/n ，/wd 但/c 次优/n 查找/v 树/n 不/d 能/v 在/p 查找/v 过程/n 中/f 插入/v 结点/n 生成/v 。/wj 二/m 叉/n 排序/vn 树/n (/wkz 或/c 称/v 二/m 叉/n 查找/v 树/n )/wky 是/vshi 动态/n 树/n 表/n ，/wd 最/d 优/ag 或/c 次优/n 查找/v 树/n 是/vshi 静态/n 树/n 表/n 。/wj     9．2．2/m  B．/x 树/n 和/cc B/x ’/wyy 树/n 
    一/m 、/wn B-/x 树/n 及其/cc 查找/v 
　　B-/x 树/n 是/vshi 一/m 种/q 平衡/a 的/ude1 多/a 路/n 查找/v 树/n ，/wd 它/rr 在/p 文件/n 系统/n 中/f 很/d 有/vyou 用/v 。/wj 在/p 此/rzs 先/d 介绍/v 这/rzv 种/q 树/n 的/ude1 结构/n 及其/cc 查找算法/n 。/wj 
　　   一/m 棵/q 优/ag 阶/ng 的/ude1 B/x 树/n ，/wd 或/c 为/v 空/a 树/n ，/wd 或/c 为/p 满足/v 下列/b 特性/n 的/ude1 m/x 叉树/n ：/wp 
    (/wkz 1/m )/wky 树/n 中/f 每个/r 结点/n 至多/d 有/vyou m/x 棵子/n 树/n ；/wf 
    (/wkz 2/m )/wky 若根/nrf 结点/n 不/d 是/vshi 叶子/n 结点/n ，/wd 则/c 至少/d 有/vyou 两/m 棵子/n 1/m 对/q ；/wf 
    (/wkz 3/m )/wky 除根/vi 之外/f 的/ude1 所有/b 非/b 终端/n 结点/n 至少/d 有/vyou m／2/x ]/wky 棵子/n 树/n ；/wf 
    (/wkz 4/m )/wky 所有/b 的/ude1 非/b 终端/n 结点/n 中/f 包含/v 下列/b 信息/n 数据/n 
    (/wkz ”/wyy ，/wd A0/x ，/wd K1/x ，/wd Al/x ，/wd K/x !/wt ，/wd A2．/x …/ws ，/wd K/x 。/wj ，/wd A/x 。/wj )/wky ①/m 
    其中/rz ；/wf K/x ，/wd (/wkz 户/q l/x ，/wd …/ws ，/wd n/x )/wky 为/p 关键/n 字/n ，/wd 且/c K/x 。/wj </n K/x 。/wj +1/m (/wkz i=l/x ，/wd …/ws ，/wd "/n 1/m )/wky ；/wf Ai/x (/wkz i/x 。/wj 0/m ，/wd …/ws ，/wd n/x )/wky 为/p 指向/v 子/ng 树根/n 结点/n 的/ude1 指针/n ，/wd 且/c 指针/n Ai/x 。/wj 所/usuo 指/v 子/ng 树/v 中/b 所有/b 结点/n 的/ude1 关键/n 字/n 均/d 小于/v K：/x (/wkz i/x 。/wj l/x ，/wd …/ws ，/wd 
n/x )/wky ，/wd A/x 。/wj 所/usuo 指/v 子/ng 树/v 中/b 所有/b 结点/n 的/ude1 关键/n 字/n 均/d 大于/v K/x 。/wj ，/wd ”/wyy (/wkz )/wky 为/p 关键/n 字/n 的/ude1 个数/n (/wkz 或/c n+1/x 为/v 子/ng 树/v 个数/n )/wky 。/wj 
　　(/wkz 5/m )/wky 所有/b 的/ude1 叶子/n 结点/n 都/d 出现/v 在/p 同一/b 层次/n 上/f ，/wd 并且/c 不/d 带信息/n (/wkz 可以/v 看作/v 是/vshi 外部/f 结点/n 或/c 查找/v 失败/vi 的/ude1 结点/n ，/wd 实际上/d 这些/rz 结点/n 不/d 存在/v ，/wd 指/v 向/p 这些/rz 结点/n 的/ude1 指针/n 为/v 空/ng )/wky 。/wj 
　　    例如/v 图/n 9．14/m 所/usuo 示/vg 为/p 一/m 棵/q 4/m 阶/ng 的/ude1 B-/x 树/n ，/wd 其/rz 深度/n 为/p 4/m 。/wj 
图/n 9．14/m 一/m 棵/q 4/m 阶/ng 的/ude1 B0/x 树/n 
    由/p B．/x 树/n 的/ude1 定义/n 可知/v ，/wd 在/p B．/x 树/n 上/f 进行/vx 查找/vn 的/ude1 过程/n 和/cc 二/m 叉/n 排序/vn 树/n 的/ude1 查找/v 类似/a 。/wj 例如/v ．/w 在/p 图/n 9．14/m 的/ude1 B．/x 树上/s 查找/v 关键字/n 47/m 的/ude1 过程/n 如下/vi ：/wp 首先/d 从/p 根/n 开始/v ，/wd 根据/p 根/n 结点/n 指针/n t/x 找到/v */n a/x 结点/n ，/wd 因/p */n a/x 结点/n 中/f 只/d 有/vyou 一个/mq 关键/a 字/n ，/wd 且/c 给/p 定/v 值/v 47/m >/n 关键字/n 35/m ，/wd 则/c 若/c 存在/v 必/d 在/p 指针/n A2/x 所/usuo 指/v 的/ude1 子/ng 树/n 内/f ，/wd 顺/v 指针/n 找到/v */n c/x 结点/n ，/wd 该/rz 结点/n 有/vyou 两/m 个/q 关键/n 字/n (/wkz 43/m 和/cc 78/m )/wky ，/wd 而/cc 43/m </n 47/m </n 78/m ，/wd 则/c 若/c 存在/v 必/d 在/p 指针/n ～/ws 所/usuo 指/v 的/ude1 子树中/nr 。/wj 同样/d ，/wd 顺/v 指针/n 找到/v */n g/x 结点/n ，/wd 在/p 该/rz 结点/n 中/f 顺序/n 查找/v 找到/v 关键字/n 47/m ，/wd 由此/d ，/wd 查找/v 成功/an 。/wj 查找/v 不/d 成功/a 的/ude1 过程/n 也/d 类似/a ，/wd 例如/v 在/p 同/p 一/m 棵/q 树/n 中/f 查找/v 23/m 。/wj 从/p 根/n 开始/v ，/wd 因为/p 23/m </n 35/m ，/wd 则/c 顺/v 该/rz 结点/n 中/f 指针/n ‰/wb 找到/v */n b/x 结点/n ．/w 又/d 因为/p */n b/x 结点/n 中/f 只/d 有/vyou 一个/mq 关键/a 字/n 18/m ，/wd 且/c 23/m >/n 18/m ，/wd 所以/c 顺/v 结点/n 中/f 第二/m 个/q 指针/n A1/x 找到/v */n e/x 结点/n 。/wj 同/p 理/n 因为/p 23/m </n 27/m ，/wd 则/c 顺/v 指针/n 往/p 下/f 找/v ，/wd 此时/r 因/p 指针/n 所/usuo 指/v 为/p 叶子/n 结点/n ，/wd 说明/v 此/rzs 棵/q B．/x 树/n 中/f 不/d 存在/v 关键字/n 23/m ，/wd 查找/v 因/p 失败/vi 而/cc 告终/vi 。/wj 
    由此可见/c ，/wd 在/p B-/x 树/n 上/f 进行/vx 查找/vn 的/ude1 过程/n 是/vshi 一个/mq 顺/a 指针/n 查找/v 结点/n 和/cc 在/p 结点/n 的/ude1 关键/n 字/n 中/f 进行/vx 查找/vn 交叉/vn 进行/vx 的/ude1 过程/n 。/wj 
    由于/p B．/x 树/n 主要/d 用作/v 文件/n 的/ude1 索引/n ，/wd 因此/c 它/rr 的/ude1 查找/vn 涉及/v 外存/n 的/ude1 存取/vn ，/wd 在/p 此/rzs 略去/v 外存/n 的/ude1 读/v 写/v ，/wd 只/d 作/v 示意/v 性/ng 的/ude1 描述/vn 。/wj 假设/v 结点/n 类型/n 如下/vi 说明/v ：/wp 
#/n define/x  m/x  3/m 
tyl：ec/x [/wkz ef/x  struct/x  BTNode/x {/n 
  int/x     keynus：/x 
  ．/w truct/x  BTNode/x   。/wj parent：/x 
  Ke/x ~/n ／Pype/x     key/x [/wkz m/x 十/m l：/x ；/wf 
  8truct/x  BTNode/x     */n ptr/x 【/wkz m+l：/x ；/wf 
，/wd ／／B/x 树/n 的/ude1 阶/ng ，/wd 暂/d 设/v 为/p 3/m 
∥/w 结点/n 中/f 关键字/n 个数/n ，/wd 即/d 结点/n 的/ude1 大小/n 
∥/w 指向/v 双亲/n 结点/n 
／／/m 关键字/n 向量/n ，/wd 
指针/n 目录/n 
・/w 239・/m 
  Record/x     */n recptr/x [/wkz m+1/x ]/wky ；/wf 
IBTNode/x ，/wd */n BTree/x ；/wf 
tledef/x  struct/x {/n 
∥/w 记录/v 指针/n 向量/n ，/wd O/x 号/q 单元未/n 用/v 
∥/w B/x 树/n 结点/n 和/cc B/x 树/n 的/ude1 类型/n 
    FrNode/x */n pt/x ；/wf     ∥/w 指向/v 找到/v 的/ude1 结点/n 
    int/x     i/x ；/wf     ∥/w 1．．m/x ，/wd 在/p 结点/n 中/f 的/ude1 关键字/n 序号/n 
    ．/w int/x  tag/x ；/wf     ∥/w 1：/m 查找/v 成功/an ，/wd O：/x 查找/v 失败/vi 
    IResult/x ；/wf     ∥/w B/x 树/n 的/ude1 查找/vn 结果/n 类型/n 
则/c 算法/n 9．13/m 简要/a 地/ude2 描述/v 了/ule B/x 树/n 的/ude1 查找/vn 操作/vn 的/ude1 实现/vn 。/wj 
Result/x  searchBTree/x (/wkz BTtee/x  T/x 。/wj KeyType/x  K/x )/wky {/n 
  ∥/w 在/p m/x 阶/ng B/x 树/n T/x 上/f 查找/v 关键字/n K/x ，/wd 返回/v 结果/n (/wkz pt/x ，/wd i/x ，/wd tag/x )/wky 。/wj 若/c 查找/v 成功/an ，/wd 则/c 特征值/n ’/wyy tag=1/x ，/wd 指针/n pt/x   ∥/w 所/usuo 指/v 结点/n 中/f 第/m i/x 个/q 关键字/n 等于/v K/x ；/wf 否则/c 特征值/n tag=0/x ，/wd 等于/v K/x 的/ude1 关键/n 字/n 应/v 插入/v 在/p 指针/n pt/x 所/usuo 指/v   ∥/w 结点/n 中/f 第/m i/x 和/cc 第/m H/x  1/m 个/q 关键/n 字/n 
p：T/x ；/wf   q=NULL/x ；/wf   found=FALSE/x ；/wf   i=0/x ；/wf while/x (/wkz p/x &/n ＆/n !/wt found/x )/wky {/n 
    n=p/x >/n keynuln/x ；/wf   i=Search/x (/wkz p/x ，/wd K/x )/wky ；/wf 
∥/w 初始化/v ，/wd p/x 指向/v 待查/v 结点/n ，/wd q/x 指向/v p/x 的/ude1 双亲/n 
∥/w 在/p p/x >/n key/x [/wkz 1．．keyn/x ~/n ]/wky 中/f 查找/v ，/wd 
；/wf   ∥/w 找到/v 待查/v 关键字/n 
  else/x  return/x (/wkz q/x ，/wd i/x ，/wd 0/m )/wky ；/wf 
ff/x  SearchSTree/x 
∥/w 查找/v 成功/an 
∥/w 查找/v 不/d 成功/a ，/wd 返回/v K/x 的/ude1 插入/v 位置/n 信息/n 
算法/n 9．13/m 
  二/m 、/wn B-/x 树/n 查找/v 分析/v 
  从/p 算法/n 9．11/m 可见/c ，/wd 在/p B/x 树/n 上/f 进行/vx 查找/vn 包含/v 两/m 种/q 基本/a 操作/vn ：/wp (/wkz 1/m )/wky 在/p B．/x 树/n 中/f 找/v 结点/n ；/wf (/wkz 2/m )/wky 在/p 结点/n 中/f 找/v 关键字/n 。/wj 由于/p &/n 树/n 通常/d 存储/v 在/p 磁盘/n 上/f ，/wd 则/c 前/f 一/m 查找/v 操作/v 是/vshi 在/p 磁盘/n 上/f 进行/vx 的/ude1 (/wkz 在/p 算法/n 9．11/m 中/f 没有/d 体现/v )/wky ，/wd 而后/d 一/d 查找/v 操作/v 是/vshi 在/p 内存/n 中/f 进行/vx 的/ude1 ，/wd 即/d 在/p 磁盘/n 上/f 找到/v 指针/n p/x 所/usuo 指/v 结点/n 后/f ，/wd 先/d 将/d 结点/n 中/f 的/ude1 信息/n 读入/v 内存/n ，/wd 然后/c 再/d 利用/v 顺序/n 查找/v 或/c 折半/v 查找/v 查询/v 等于/v K/x 的/ude1 关键/n 字/n 。/wj 显然/a ，/wd 在/p 磁盘/n 上/f 进行/vx 一/m 次查找/n 比/p 在/p 内存/n 中/f 进行/vx 一/m 次查找/n 耗费时间/n 多/a 得/ude3 多/a ，/wd 因此/c ，/wd 在/p 磁盘/n 上/f 进行/vx 查找/vn 的/ude1 次数/n 、/wn 即/v 待查/v 关键字/n 所在/n 结点/n 在/p B-/x 树上/s 的/ude1 层次/n 数/n ，/wd 是/vshi 决定/v B-/x 树/n 查找效率/n 的/ude1 首要/b 因素/n 。/wj 
    现/tg 考虑/v 最/d 坏/a 的/ude1 情况/n ，/wd 即/d 待/vi 查结/v 点/qt 在/p B/x 。/wj 树上/s 的/ude1 最/d 大/a 层次/n 数/n 。/wj 也/d 就/d 是/vshi ，/wd 含/v N/x 个/q 关键/n 字/n 的/ude1 m/x 阶/ng B-/x 树/n 的/ude1 最/d 大/a 深度/n 是/vshi 多少/ry ?/ww 
    先/d 看/v 一/m 棵/q 3/m 阶/ng 的/ude1 B-/x 树/n 。/wj 按/p B．/x 树/n 的/ude1 定义/n ，/wd 3/m 阶/ng 的/ude1 B．/x 树/n 上/f 所有/b 非/b 终端/n 结点/n 至多/d 可/v 有/vyou 两/m 个/q 关键/n 字/n ，/wd 至少/d 有/vyou 一个/mq 关键/a 字/n (/wkz 即/v 子/ng 树/n 个/q 数/n 为/p 2/m 或/c 3/m ，/wd 故/c 又/d 称/v 2-3/m 树/n )/wky 。/wj 因此/c ，/wd 若/c 关键字/n 个数/n ≤2/m 时/ng ，/wd 树/v 的/ude1 深度/n 为/p 2/m (/wkz 即/v 叶子/n 结点/n 层次/n 为/p 2/m )/wky ；/wf 若/c 关键字/n 个数/n ≤6/m 时/ng ，/wd 树/v 的/ude1 深度/n 不/d 超过/v 3/m 。/wj 反之/c ，/wd 若/c B-/x 树/n 的/ude1 深度/n 为/p 4/m ，/wd 则/c 关键字/n 的/ude1 个数/n 必须/d ≥7/m (/wkz 参见图/n 9．15/m (/wkz g/x )/wky )/wky ，/wd 此时/r ，/wd 每个/r 结点/n 都/d 含有/v 可能/v 的/ude1 关键/n 字/n 的/ude1 最/d 小/a 数目/n 。/wj 
    一般/a 情况/n 的/ude1 分析/vn 可/v 类似/a 二/m 叉/n 平衡/a 树/n 进行/vx ，/wd 先/d 讨论/v 深度/n 为/v z+1/x 的/ude1 m/x 阶/ng B-/x 树/n 所/usuo 具有/v 的/ude1 最/d 少/ad 结/v 点数/n 。/wj 
    根据/p Bj．/x 的/ude1 定义/n ，/wd 第一/m 层/qv 至少/d 有/vyou 1/m 个/q 结点/n ；/wf 第二/m 层/qv 至少/d 有/vyou 2/m 个/q 结点/n ；/wf 由于/c 除根/vi 之外/f 的/ude1    图/n 9．15/m 不同/a 关键字/n 数目/n 的/ude1 B-/x 树/n 
    (/wkz a/x )/wky 空/v 树/n ；/wf (/wkz b/x )/wky N=l/x ；/wf (/wkz c/x )/wky N：2/x ；/wf (/wkz d/x )/wky N/x 一/m 3/m ；/wf (/wkz e/x )/wky N=4/x ；/wf (/wkz f/x )/wky N=5/x ；/wf (/wkz g/x )/wky N/x 。/wj 7/m 。/wj 
每个/r 非/b 终端/n 结/v ，/wd 点/qt 至少/d 有/vyou 厂/n m／2/x ]/wky 棵子/n 树/n ，/wd 则/c 第三/m 层/qv 至少/d 有/vyou 2/m (/wkz 广/b m／2/x ]/wky )/wky 个/q 结点/n ．/w ．/w ．/w …/ws ‘/wyz ；/wf 依次/d 类推/vi ，/wd 第/m z+1/x 层/n 至少/d 有/vyou 2/m (/wkz 厂/n m／2/x ]/wky )/wky 卜/vg 。/wj 个/q 结点/n 。/wj 而/cc z+1/x 层/n 的/ude1 结点/n 为/p 叶子/n 结点/n 。/wj 若/v m/x 阶/ng B-/x 树/n 中/f 具有/v N/x 个/q 关键/n 字/n ，/wd 则/c 叶子/n 结点/n 即/d 查找/v 不/d 成功/a 的/ude1 结点/n 为/v N+1/x ，/wd 由/p 此/rzs 有/vyou ：/wp 这就是说/c ，/wd 在/p 含有/v N/x 个/q 关键/n 字/n 的/ude1 B/x 树/n 上/f 进行/vx 查找/vn 时/ng ，/wd 从/p 根/n 结点/n 到/v 关键字/n 所在/n 结点/n 的/ude1 路径/n 上/f 涉及/v 的/ude1 结/v 点数/n 不/d 超过/v logr/x 。/wj 
    三/m 、/wn B．/x 树/n 的/ude1 插入/v 和/cc 删除/v 
    B-/x 树/n 的/ude1 生成/vn 也/d 是/vshi 从/p 空/a 树/n 起/vf ，/wd 逐个/d 插入/v 关键字/n 而/cc 得/v 。/wj 但/c 由于/p B/x _/n 树/n 结点/n 中/f 的/ude1 关键字/n 个数/n 必须/d ≥/m 厂/n 优/ag ／2/m ]/wky -/wp 1/m ，/wd 因此/c ，/wd 每次/r 插入/v 一个/mq 关键/a 字/n 不/d 是/vshi 在/p 树/n 中/f 添加/v 一个/mq 叶子/n 结点/n ，/wd 而是/c 首先/d 在/p 最低/a 层/qv 的/ude1 某个/rz 非/b 终端/n 结点/n 中/f 添加/v 一个/mq 关键/a 字/n ，/wd 若/c 该/rz 结点/n 的/ude1 关键/n 字/n 个/q 数/n 不/d 超过/v m-1/x ，/wd 则/c 插入/v 完成/v ，/wd 否则/c 要/v 产生/v 结点/n 的/ude1 “/wyz 分裂/vi ”/wyy ，/wd 如/v 图/n 9．16/m 所/usuo 示/vg 。/wj 
    例如/v ，/wd 图/n 9．16/m (/wkz n/x )/wky 所/usuo 示/vg 为/p 3/m 阶/ng 的/ude1 B-/x 树/n (/wkz 图/n 中/f 略去/v F/x 结点/n (/wkz 即/v 叶子/n 结点/n )/wky )/wky ，/wd 假设/v 需/v 依次/d 插入/v 关键字/n 30/m ，/wd 26/m ，/wd 85/m 和/cc 7/m 。/wj 首先/c 通过/p 查找/v 确定/v 应/v 插入/v 的/ude1 位置/n 。/wj 由/p 根/n */n a/x 起/f 进行/vx 查找/vn ，/wd 确定/v 30/m 应/v 插入/v 在/p */n d/x 结点/n 中/f ，/wd 由于/c */n d/x 中/b 关键字/n 数目/n 不/d 超过/v 2/m (/wkz 即/v m-1/x )/wky ，/wd 故/c 第一/m 个/q 关键字/n 插入/v 完成/v 。/wj 插入/v 30/m 后/f 的/ude1 B．/x 树/n 如/v 图/n 9．16/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 同样/d ，/wd 通过/p 查找/v 确定/v 关键字/n 26/m 亦/d 应/v 插入/v 在/p */n d/x 结点/n 中/f 。/wj 由于/p */n d/x 中/b 关键/n 字/n 的/ude1 数目/n 超过/v 2/m ，/wd 此时/r 需/v 将/p */n d/x 分裂/vi 成/v 两/m 个/q 结点/n ，/wd 关键/a 字/n 26/m 及其/cc 前/f 、/wn 后/f 两/m 个/q 指针/n 仍/d 保留/v 在/p */n d/x 结点/n 中/f ，/wd 而/cc 关键字/n 37/m 及其/cc 前/f 、/wn 后/f 两/m 个/q 指针/n 存储/vn 到/v 新/a 产生/v 的/ude1 结点/n */n d/x ’/wyy 中/f 。/wj 同时/c ，/wd 将/p 关键字/n 30/m 和/cc 指示/n 结点/n */n d/x ’/wyy 的/ude1 指针/n 插入/v 到/v 其/rz 双亲/n 结点/n 中/f 。/wj 由于/p */n b/x 结点/n 中/f 的/ude1 关键字/n 数目/n 没有/d 超过/v 2/m ，/wd 则/c 插入/v 完成/v 。/wj 插入/v 后/f 的/ude1 B-/x 树/n 如/v 图/n 9．16/m (/wkz d/x )/wky 所/usuo 示/vg 。/wj 类似/a 地/ude2 ，/wd 在/p */n g/x 中/f 插入/v 85/m 之后/f 需/v 分裂/vi 成/v 两/m 个/q 结点/n ，/wd 而/cc 当/v 70/m 继而/c 插入/v 到/v 双亲/n 结点/n 时/ng ，/wd 由于/c */n e/x 中/b 关键字/n 数目/n 超过/v 2/m ，/wd 则/c 再次/d 分裂/vi 为/p 结点/n */n e/x 和/cc */n e/x ’/wyy ，/wd 如/v 图/n 9．t6/x (/wkz g/x )/wky 所/usuo 示/vg 。/wj 最后/f 在/p 插入/v 关键字/n 7时/t ，/wd */n C/x 、/wn */n b/x 和/cc */n a/x 相继/d 分裂/vi ，/wd 并/cc 生成/v 一个/mq 新/a 的/ude1 根/n 结点/n */n m/x ，/wd 如/v 图/n 9．16/m (/wkz h/x )/wky 一/m (/wkz j/x )/wky 所/usuo 示/vg 。/wj 
    图/n 9．16/m 在/p B-/x 树/n 中/f 进行/vx 插入/v (/wkz 省略/v 叶子/n 结点/n )/wky 
  一般/a 情况/n 下/f ，/wd 结点/n 可/v 如下/vi 实现/v “/wyz 分裂/vi ”/wyy 。/wj 
  假设/v */n p/x 结点/n 中/f 已/d 有/vyou m-1/x 个/q 关键/n 字/n ，/wd 当/p 插入/v 一个/mq 关键/a 字/n 之后/f ，/wd 结点/n 中/f 含有/v 信息/n 为/v ：/wp 
    m/x ，/wd Ao/x ，/wd (/wkz K1/x ，/wd A1/x )/wky ，/wd …/ws ，/wd (/wkz K/x 。/wj ，/wd A/x 。/wj )/wky 
且/c 其中/rz     Ki/x </n KH/x  1/m     1≤i≤m/x 
此时/r 可/v 将/p */n p/x 结点/n 分裂/vi 为/p */n p/x 和/cc */n p/x ’/wyy 两/m 个/q 结点/n ，/wd 其中/rz */n p/x 结点/n 中/f 含有/v 信息/n 为/v 
*/n p/x ’/wyy 结点/n 中/f 含有/v 信息/n 
而/cc 关键字/n Kr/x 。/wj ／2/m ]/wky 和/cc 指针/n */n p/x ’/wyy 一/m 起/q 插入/v 到/v */n p/x 的/ude1 双亲/n 结点/n 中/f 
    在/p B-/x 树上/s 插入/v 关键字/n 的/ude1 过程/n 如/v 算法/n 9．14/m 所/usuo 示/vg ，/wd 其中/rz q/x 和/cc i/x 是/vshi 由/p 查找/v 函数/n SearchB―Tree/x 返回/v 的/ude1 信息/n 而/cc 得/v 。/wj 
Status/x 工/n nsertBTree/x (/wkz ：/wp BTree/x ＆/n T/x ，/wd KeyType/x  K/x ，/wd BTree/x  q/x ，/wd int/x  i/x )/wky {/n 
  ∥/w 在/p m/x 阶/ng B/x 树/n T/x 上/f 结点/n */n q/x 的/ude1 key/x [/wkz j1/x ]/wky 与/p key/x [/wkz i/x 十/m 1/m ]/wky 之间/f 插入/v 关键字/n K/x 。/wj 
  ∥/w 若/c 引起/v 结点/n 过/uguo 大/a ，/wd 则/c 沿/p 双亲/n 链/ng 进行/vx 必要/a 的/ude1 结点/n 分裂/vi 调整/v ，/wd 使/v T/x 仍/d 是/vshi m/x 阶/ng B/x 树/n 。/wj 
  x：K/x ；/wf   ap：NULL/x ；/wf   finished=FALSE/x ；/wf 
  ．/w hile/x (/wkz q/x &/n &/n !/wt finished/x )/wky {/n 
    Insert/x (/wkz q/x ，/wd i/x ，/wd x/x ，/wd ap/x )/wky ；/wf     ∥/w 将/d x/x 和/cc ap/x 分别/d 插入/v 到/v q/x >/n key/x [/wkz i+1/x ]/wky 和/cc q/x >/n ptr/x [/wkz i+1/x ]/wky 
    if/x (/wkz q-/x >/n keynu/x ~/n I/x </n m/x )/wky finished：TRUE/x ；/wf   ∥/w 插入/v 完成/v 
    else/x {/n     ∥/w 分裂/vi 结点/n */n q/x 
    if/x (/wkz q/x )/wky i=search/x (/wkz q/x ，/wd x/x )/wky ；/wf     ∥/w 在/p 双亲/n 结点/n */n q/x 中/f 查找/v x/x 的/ude1 插入/v 位置/n 
    }/n ∥/w else/x 
    }/n ∥/w while/x 
    if/x (/wkz !/wt finished/x )/wky     ∥/w T/x 是/vshi 空/a 树/n (/wkz 参数/n q/x 初值/n 为/v NULl/x 。/wj )/wky 或者/c 根/n 结点/n 已/d 分裂/vi 为/p 结点/n */n q/x 和/cc */n ap/x 
    NewRoot/x (/wkz T/x ，/wd q/x ，/wd x/x ，/wd ap/x )/wky ；/wf   ∥/w 生成/v 含信息/n (/wkz T/x ，/wd x/x ，/wd ap/x )/wky 的/ude1 新/a 的/ude1 根/n 结点/n */n T/x ，/wd 原/d T/x 和/cc ap/x 为/v 子/ng 树/v 指针/n 
    算法/n 9．14/m 
反之/c ，/wd 若/c 在/p B-/x 树上/s 删除/v 一个/mq 关键/a 字/n ，/wd 则/c 首先/d 应/v 找到/v 该/rz 关键字/n 所在/n 结点/n ，/wd 并/cc 从/p 中/f 删除/v 之/uzhi ，/wd 若/c 该/rz 结点/n 为/v 最/d 下层/f 的/ude1 非/b 终端/n 结点/n ，/wd 且/c 其中/rz 的/ude1 关键字/n 数目/n 不/d 少于/v rm／2/x ]/wky ，/wd 则/c 删除/v 完成/v ，/wd 否则/c 要/v 进行/vx “/wyz 合并/v ”/wyy 结点/n 的/ude1 操作/vn 。/wj 假若/c 所/usuo 删/v 关键字/n 为/p 非/b 终端/n 结点/n 中/f 的/ude1 K/x ，/wd ，/wd 则/c 可以/v 指针/n A/x 所/usuo 指/v 子树中/nr 的/ude1 最/d 小/a 关键字/n Y/x 替代/v Ki/x ，/wd 然后/c 在/p 相应/vi 的/ude1 结点/n 中/f 删/v 去/vf Y/x 。/wj 例如/v ，/wd 在/p 图/n 9．16/m (/wkz a/x )/wky 的/ude1 B．/x 树上/s 删/v 去/vf 45/m ，/wd 可以/v */n f/x 结点/n 中/f 的/ude1 50/m 替代/v 45/m ，/wd 然后/c 在/p */n f/x 结点/n 中/f 删/v 去/vf 50/m 。/wj 因此/c ，/wd 下面/f 我们/rr 可以/v 只/d 需/v 讨论/v 删除/v 最/d 下层/f 非/b 终端/n 结点/n 中/f 的/ude1 关键/n 字/n 的/ude1 情形/n 。/wj 有/vyou 下列/b 三/m 种/q 可能/n ：/wp 
    (/wkz 1/m )/wky 被/pbei 删/v 关键字/n 所在/n 结点/n 中/f 的/ude1 关键字/n 数目/n 不/d 小于/v 厂/n m／2/x ]/wky 则/d 只/d 需/v 从/p 该/rz 结点/n 中/f 删/v 去/vf 该/rz 关键字/n K/x 。/wj 和/cc 相应/vn 指针/n Aj/x ，/wd 树/v 的/ude1 其它/rz 部分/n 不/d 变/v ，/wd 例如/v ，/wd 从/p 图/n 9．16/m (/wkz a/x )/wky 所/usuo 示/vg B-/x 树/n 中/f 删去/v 关键字/n 12/m ，/wd 删除/v 后/f 的/ude1 B．/x 树/n 如/v 图/n 9．17/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 
    (/wkz 2/m )/wky 被/pbei 删/v 关键字/n 所在/n 结点/n 中/f 的/ude1 关键字/n 数目/n 等于/v 广/a "/n z／2/x ]/wky -/wp 1/m ，/wd 而/cc 与/p 该/rz 结点/n 相邻/vi 的/ude1 右/f 兄弟/n (/wkz 或/c 左/a 兄弟/n )/wky 结点/n 中/f 的/ude1 关键字/n 数目/n 大于/v 厂/n 研/v ／2/m ]/wky -/wp 1/m ，/wd 则/c 需/v 将/p 其/rz 兄弟/n 结点/n 中/f 的/ude1 最/d 小/a (/wkz 或/c 最/d 大/a )/wky 的/ude1 关键/n 字/n 上/f 移/v 至/p 双亲/n 结点/n 中/f ，/wd 而/cc 将/p 双亲/n 结点/n 中/f 小于/v (/wkz 或/c 大于/v )/wky 且/c 紧/d 靠/v 该/rz 上/f 移/v 关键字/n 的/ude1 关键字/n 下移/v 至/p 被/pbei 删/v 关键字/n 所在/n 结点/n 中/f 。/wj 例如/v ，/wd 从/p 图/n 9．17/m (/wkz a/x )/wky 中/f 删/v 去/vf 50/m ，/wd 需/v 将/p 其/rz 右/f 兄弟/n 结点/n 中/f 的/ude1 61/m 上/f 移/v 至/p */n e/x 结点/n 中/f ，/wd 而/cc 将/p */n e/x 结点/n 中/f 的/ude1 53/m 移/v 至/p */n f/x ，/wd 从而/c 使/v */n f/x 和/cc */n g/x 中/b 关键字/n 数目/n 均/d 不/d 小于/v 厂/n m／2/x ]/wky -/wp 1/m ，/wd 而/cc 双亲/n 结点/n 中/f 的/ude1 关键字/n 数目/n 不/d 变/v ，/wd 如/v 图/n 9．17/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    (/wkz 3/m )/wky 被/pbei 删/v 关键字/n 所在/n 结点/n 和/cc 其/rz 相邻/vi 的/ude1 兄弟/n 结点/n 中/f 的/ude1 关键字/n 数目/n 均/d 等于/v ／2/m ]/wky -/wp 1/m 。/wj 
假设/v 该/rz 结点/n 有/vyou 右/f 兄弟/n ，/wd 且/c 其/rz 右/f 兄弟/n 结点/n 地址/n 由/p 双亲/n 结点/n 中/f 的/ude1 指针/n A/x 所/usuo 指/v ，/wd 则/c 在/p 删去/v 关键字/n 之后/f ，/wd 它/rr 所/usuo 在/v 结点/n 中/f 剩余/v 的/ude1 关键/n 字/n 和/cc 指针/n ，/wd 加上/v 双亲/n 结点/n 中/f 的/ude1 关键/n 字/n K．/x 一起/s ，/wd 合并/v 到/v A/x 所/usuo 指/v 兄弟/n 结点/n 中/f (/wkz 若/c 没有/v 右/f 兄弟/n ，/wd 则/c 合并/v 至/p 左/a 兄弟/n 结点/n 中/f )/wky 。/wj 例如/v ，/wd 从/p 图/n 9．17/m (/wkz b/x )/wky 所/usuo 示/vg 
B-/x 树/n 中/f 删/v 去/vf 53/m ；/wf 则/c 应/v 删去/v */n f/x 结点/n ，/wd 并/cc 将/p */n f/x 中/f 的/ude1 剩余/vn 信息/n (/wkz 指针/n “/wyz 空/ng ”/wyy )/wky 和/cc 双亲/n */n e/x 结点/n 中/f 的/ude1 61/m 一起/s 合并/v 到/v 右/f 兄弟/n 结点/n */n g/x 中/f 。/wj 删除/v 后/f 的/ude1 树/n 如/v 图/n 9．17/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 如果/c 因此/c 使/v 双亲/n 结点/n 中/f 的/ude1 关键字/n 数目/n 小于/v 厂/n m／2/x ]/wky -/wp 1/m ，/wd 则/c 依次/d 类推/vi 。/wj 例如/v ，/wd 在/p 图/n 9．17/m (/wkz c/x )/wky 的/ude1 B-/x 树/n 中/f 删去/v 关键字/n 37/m 之后/f ，/wd 双亲/n b/x 结点/n 中/f 剩余/v 信息/n (/wkz “/wyz 指针/n c/x ”/wyy )/wky 应/v 和/cc 其/rz 双亲/n */n a/x 结点/n 中/f 关键字/n 45/m 一起/s 合并/v 至/p 右/f 兄弟/n 结点/n */n e/x 中/f ，/wd 删除/v 后/f 的/ude1 B-/x 树/n 如/v 图/n 9．17/m (/wkz d/x )/wky 所/usuo 示/vg 。/wj 
    在/p B-/x 树/n 中/f 删除/v 结点/n 的/ude1 算法/n 在/p 此/rzs 不再/d 详/ag 述/vg ，/wd 请/v 读者/n 参阅/v 参考书/n 目/ng [/wkz 1/m ]/wky 后/f 自己/rr 写/v 出/vf 。/wj 
    四/m 、/wn B/x ’/wyy 树/n 
    B/x ’/wyy 树/n 是/vshi 应/v 文件/n 系统/n 所/usuo 需/v 而/cc 出/vf 的/ude1 一/m 种/q B．/x 树/n 的/ude1 变型/vi 树/v ①/m 。/wj 一/m 棵/q m/x 阶/ng 的/ude1 B/x ’/wyy 树/n 和/cc m/x 阶/ng 的/ude1 B-/x 树/n 的/ude1 差异/n 在于/v ：/wp 
    (/wkz 1/m )/wky 有/vyou n/x 棵子/n 树/n 的/ude1 结点/n 中/f 含有/v n/x 个/q 关键/n 字/n ；/wf 
    (/wkz 2/m )/wky 所有/b 的/ude1 叶子/n 结点/n 中/f 包含/v 了/ule 全部/m 关键字/n 的/ude1 信息/n ，/wd 及/cc 指向/v 含/v 这些/rz 关键字记录/n 的/ude1 指针/n ，/wd 且/c 叶子/n 结点/n 本身/rz 依/v 关键字/n 的/ude1 大小/n 自/p 小/a 而/cc 大/a 顺序/n 链接/n 。/wj 
    (/wkz 3/m )/wky 所有/b 的/ude1 非/b 终端/n 结点/n 可以/v 看成/v 是/vshi 索引/n 部分/n ，/wd 结点/n 中/f 仅/d 含有/v 其/rz 子/ng 树/n (/wkz 根/n 结点/n )/wky 中/f 的/ude1 最/d 大/a (/wkz 或/c 最/d 小/a )/wky 关键字/n 。/wj 
    例如/v 图/n 9．18/m 所/usuo 示/vg 为/p 一/m 棵/q 3/m 阶/ng 的/ude1 B/x ‘/wyz 树/n ，/wd 通常/d 在/p Ⅳ/m 树/n 上/f 有/vyou 两/m 个/q 头/n 指针/n ，/wd 一个/mq 指向/v 根/n 结/v 图/n 9．18/m 挺/q 3/m 阶/ng 的/ude1 B/x ’/wyy 树/n 点/qt ，/wd 另/rz 一个/mq 指向/v 关键字/n 最/d 小/a 的/ude1 叶子/n 结点/n 。/wj 因此/c ，/wd 可以/v 对/p B/x ’/wyy 树/n 进行/vx 两/m 种/q 查找/v 运算/vn ：/wp 一/m 种/q 是/vshi 从/p 最/d 小/a 关键字/n 起/vf 顺序/n 查找/v ，/wd 另/rz 一/m 种/q 是/vshi 从/p 根/n 结点/n 开始/v ，/wd 进行/vx 随机/d 查找/v 。/wj     在/p B/x ’/wyy 树/n 上/f 进行/vx 随机/d 查找/v 、/wn 插入/v 和/cc 删除/v 的/ude1 过程/n 基本/a 上/f 与/p B．/x 树/n 类似/a 。/wj 只/d 是/vshi 在/p 查找/v 时/ng ，/wd 若非/c 终端/n 结点/n 上/f 的/ude1 关键字/n 等于/v 给/p 定/v 值/n ，/wd 并/cc 不/d 终止/v ，/wd 而是/c 继续/v 向/p 下/f 直到/v 叶子/n 结点/n 。/wj 因此/c ，/wd 在/p B/x ’/wyy 树/n ，/wd 不管/c 查找/v 成功/a 与否/u ，/wd 每次/r 查找/v 都/d 是/vshi 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 叶子/n 结点/n 的/ude1 路径/n 。/wj B/x ’/wyy 树/n 查找/v 的/ude1 分析/vn 类似/v 于/p B/x 树/n 。/wj B/x ’/wyy 树/n 的/ude1 插入/v 仅/d 在/p 叶子/n 结点/n 卜/vg 进行/vn ．/w 当/p 结点/n 中/f 的/ude1 关键字/n 个数/n 大于/v m/x 时/ng 要/v 分裂/vi 成/v 两/m 个/q 结点/n ，/wd 它们/rr 所/usuo 含/v 关键字/n 的/ude1 个数/n 分别/d 为/v L/x 竿/ng j/x 和/cc 厂/n 掣/v ]/wky 。/wj 并且/c ，/wd 它们/rr 的/ude1     </n ：/wp z：/x 
双亲/n 结点/n 中/f 应/v 同时/c 包含/v 这/rzv 两/m 个/q 结点/n 中/f 的/ude1 最/d 大/a 关键字/n 。/wj B/x ’/wyy 树/n 的/ude1 删除/v 也/d 仅/d 在/p 叶子/n 结点/n 进行/vx ，/wd 当/p 叶子/n 结点/n 中/f 的/ude1 最/d 大/a 关键字/n 被/pbei 删除/v 时/ng ，/wd 其/rz 在/p 非/b 终端/n 结点/n 中/f 的/ude1 值/n 可以/v 作为/v 一个/mq “/wyz 分界/n 关键字/n ”/wyy 存在/v 。/wj 若/c 因/p 删除/v 而/cc 使/v 结点/n 中/f 关键/n 字/n 的/ude1 个数/n 少于/v 厂/n 号/q ]/wky 时/ng ：/wp 其/rz 和/cc 兄弟/n 结点/n 的/ude1 合并/vn 过程/n 亦/d 和/cc B．/x 树/n 类似/a 。/wj 
①/m   严格/ad 说来/v ，/wd 它/rr 已/d 不/d 是/vshi 第六/m 章/q 中/b 定义/n 的/ude1 树/n 了/y 。/wj 
・/w   246・/m 
9．2．3/m 键/n 树/n 
    键/n 树/n 又/d 称/v 数字/n 查找/v 树/n (/wkz I/x )/wky igital/x  Search/x  Trees/x )/wky 。/wj 它/rr 是/vshi 一/m 棵/q 度/qv ≥2/m 的/ude1 树/n ，/wd 树/n 中/f 的/ude1 每个/r 结点/n 中/f 不/d 是/vshi 包含/v 一个/mq 或/c 几/m 个/q 关键/n 字/n ，/wd 而是/c 只/d 含有/v 组成/v 关键字/n 的/ude1 符号/n 。/wj 例如/v ，/wd 若/c 关键字/n 是/vshi 数值/n ，/wd 则/c 结点/n 中/f 只/d 包含/v 一个/mq 数/m 位/q ；/wf 若/c 关键字/n 是/vshi 单词/n ，/wd 则/c 结点/n 中/f 只/d 包含/v 一个/mq 字母/n 字符/n 。/wj 这/rzv 种/q 树/n 会/v 给/p 某/rz 种/q 类型/n 关键字/n 的/ude1 表/n 的/ude1 查找/vn 带来/v 方便/an 。/wj 
    假设/n 有/vyou 如下/vi 16/m 个/q 关键/n 字/n 的/ude1 集合/n 
    {/n CAI/x 、/wn CAO/x 、/wn LI/x 、/wn LAN/x 、/wn CHA/x 、/wn C/x }/n L/x &/n NG/x 、/wn WEN/x 、/wn CHAO/x 、/wn YUN/x 、/wn YANG/x 、/wn L/x ,/wd ONG/x 、/wn WANG/x 、/wn 
    ZHAO/x 、/wn LIU/x 、/wn wU/x 、/wn CItEN/x }/n     (/wkz 9―24/m )/wky 
可/v 对/p 此/rzs 集合/v 作/v 如下/vi 的/ude1 逐/vg 层/n 分割/vn 。/wj 
首先/c 按/p 其/rz 首/m 字符/n 不同/a 将/p 它们/rr 分成/vi 五/m 个/q 子集/n ：/wp 
    {/n CAI/x 、/wn CAO/x 、/wn CHA/x 、/wn C/x }/n tANG/x 、/wn C/x }/n tAO/x 、/wn CI-IEN/x }/n ，/wd {/n wEN/x 、/wn wANG/x 、/wn wU/x }/n ，/wd {/n ZHAO/x }/n ，/wd {/n LI/x 、/wn 
    I．AN/x 、/wn I．ONG/x 、/wn LIU/x }/n ，/wd {/n YUN/x 、/wn YANG/x }/n ，/wd 
然后/c 对/p 其中/rz 4/m 个/q 关键字/n 个数/n 大于/v 1/m 的/ude1 子集/n 再/d 按/p 其/rz 第二/m 个/q 字符/n 不同/a 进行/vx 分割/vn 。/wj 若/c 所得/n 子集/n 的/ude1 关键字/n 多于/v 1/m 个/q ，/wd 则/c 还/d 需/v 按/p 其/rz 第三/m 个/q 字符/n 不同/a 进行/vx 再/d 分割/v 。/wj 依此类推/vl ，/wd 直至/v 每个/r 小子/n 集中/v 只/d 包含/v 一个/mq 关键字/n 为止/u 。/wj 例如/v 对/p 首/m 字符/n 为/v C/x 的/ude1 集合/n 可/v 进行/vx 如下/vn 的/ude1 分割/vn ：/wp 
    {/n {/n (/wkz CAI/x )/wky 、/wn (/wkz CA0/x )/wky }/n 、/wn {/n {/n (/wkz CHA/x )/wky 、/wn (/wkz (/wkz ：/wp HANG/x )/wky 、/wn (/wkz CHAO/x )/wky }/n 、/wn (/wkz CHEN/x )/wky f/x }/n 
显然/a ，/wd 如此/rzv 集合/v 、/wn 子集/n 和/cc 元素/n 之间/f 的/ude1 层次关系/n 可以/v 用/p 一/m 棵/q 树/n 来/vf 表示/v ，/wd 这/rzv 棵/q 树/n 便/d 为/v 键/n 树/n 。/wj 例如/v ，/wd 上述/b 集合/n 及其/cc 分割/v 可用/a 图/n 9．19/m 所/usuo 示/vg 的/ude1 键/n 树/n 来/vf 表示/v 。/wj 树/n 中/b 根/n 结点/n 的/ude1 五/m 棵子/n 树/n 分别/d 表示/v H/x 】/wky     (/wkz A/x )/wky   (/wkz I/x )/wky   fO/x 】/wky fA/x )/wky (/wkz E1/x (/wkz U/x )/wky fAl/x  rUl/x  fHI/x  J/x (/wkz 0/m )/wky     (/wkz A/x )/wky     (/wkz E/x )/wky (/wkz N/x )/wky (/wkz $/n )/wky (/wkz u/x )/wky fNl/x  fN/x )/wky (/wkz N/x )/wky (/wkz $/n )/wky rNl/x  rNl/x  rA/x 
$/n )/wky (/wkz $/n )/wky (/wkz $/n )/wky (/wkz N/x )/wky (/wkz 0/m )/wky (/wkz N/x )/wky (/wkz $/n )/wky     f/x $/n )/wky fGl/x  rG/x )/wky f/x $/n 
9/m ㈣/m ㈦/m     ㈤/m Q/x 
工/n 
$/n 、/wn 
图/n 9．19/m 表示/v 式/k (/wkz 9―24/m )/wky 关键字/n 集/vg 的/ude1 一/m 棵/q 键/n 树/n 
}/n ㈣/m 置/v 
$/n )/wky     (/wkz $/n 
首/m 字符/n 为/v c/x 、/wn L/x 、/wn w/x 、/wn Y/x 和/cc z/x 的/ude1 五/m 个/q 关键字/n 子集/n 。/wj 从/p 根/n 到/v 叶子/n 结点/n 路径/n 上/f 所有/b 结点/n 的/ude1 字符/n 组成/v 的/ude1 字符串/n 表示/v 一个/mq 关键/a 字/n ，/wd 叶子/n 结点/n 中/f 的/ude1 特殊/a 符号/n $/n 表示/v 字符串/n 的/ude1 结束/vn 。/wj 在/p 叶子/n 结点/n 还/d 含有/v 指向/v 该/rz 关键字记录/n 的/ude1 指针/n 。/wj 
    为了/p 查找/v 和/cc 插入/v 方便/an ，/wd 我们/rr 约定/v 键/n 树/n 是/vshi 有序/a 树/n ，/wd 即/d 同/p 一/m 层/qv 中/b 兄弟/n 结点/n 之间/f 依/v 所/usuo 含/v 符号/n 自/p 左/f 至/p 右/f 有序/a ，/wd 并/cc 约定/vn 结束符/n $/n 小于/v 任何/rz 字符/n 。/wj 
    ・/w 247・/m 
  通常/d ，/wd 键/n 树/n 可/v 有/vyou 两/m 种/q 存储/vn 结构/n 。/wj 
  (/wkz 1/m )/wky 以/p 树/n 的/ude1 孩子/n 兄弟/n 链/ng 表/vg 来/vf 表示/v 键/n 树/n ，/wd 
则/c 每/rz 个/q 分支/n 结点/n 包括/v 三/m 个/q 域/n ：/wp symbol/x 域/n ：/wp 存储/v 关键字/n 的/ude1 一个/mq 字符/n ；/wf first/x 域/n ：/wp 存储/v 指向/v 第一/m 棵子/n 树根/n 的/ude1 指针/n ；/wf next/x 域/n ：/wp 存储/v 指向/v 右/f 兄弟/n 的/ude1 指针/n 。/wj 同时/c ，/wd 叶子/n 结点/n 的/ude1 infoptr/x 域/ng 存储/v 指向/v 该/rz 关键字记录/n 的/ude1 指针/n 。/wj 此时/r 的/ude1 键/n 树/n 又/d 称/v 双/m 链/ng 树/n 。/wj 例如/v ，/wd 图/n 9．19/m 所/usuo 示/vg 键/ng 树/n 的/ude1 双/m 链/ng 树/v 如/v 图/n 9．/m 
20/m 所/usuo 示/vg (/wkz 图/n 中/f 只/d 画/v 出/vf 第一/m 棵子/n 树/n ，/wd 其余/rz 部分/n 省/n 略/d )/wky 。/wj 
    双/m 链/ng 树/n 的/ude1 查找/vn 可/v 如/v 下/f 进行/vx ：/wp 假设/v 给定/vn 值/n 为/v K．ch/x (/wkz 0．．num-1/x )/wky ，/wd 其中/rz K．ch/x [/wkz 0/m ]/wky 至/p K．ch/x 
[/wkz num/x 一/m 2/m ]/wky 表示/v 待查/v 关键字/n 中/f num-1/x 个/q 字符/n ，/wd K．ch/x [/wkz num-1/x ]/wky 为/p 结束符/n $/n ，/wd 从/p 双/m 链/ng 树/n 的/ude1 根/n 指针/n 出发/vi ，/wd 顺/v first/x 指针/n 找到/v 第一/m 棵子/n 树/n 的/ude1 图/n 9．20/m 双/q 链/ng 树/v 示例/n  根/n 结点/n ，/wd 以/p K．oh/x [/wkz 0/m ]/wky 和/cc 此/rzs 结点/n 的/ude1 symbol/x 域/n 比较/vn ，/wd 若/c 相等/vi ，/wd 则/c 顺/v first/x 域/ng 再/d 比较/d 下/vf 一/m 字符/n ，/wd 否则/c 沿/p next/x 域/ng 顺序/n 查找/v 。/wj 若/c 直至/v “/wyz 空/ng ”/wyy 仍/d 比较/d 不等/vi ，/wd 则/c 查找/v 不/d 成功/a 。/wj 
    如果/c 对/p 双/m 链/ng 树/v 采用/v 以下/f 存储表示/n 
#/n d/x |/n Ifine/x  MAXKEYLEN/x  16/m 
tltlmch/x ~/n gtnlct/x {/n 
  char/x  ch/x [/wkz MAXKEYI／/x ~/n ]/wky ；/wf 
  iat/x  nut．/x ；/wf 
IKeysType/x ；/wf 
typ/x |/n d/x |/n f/x  enuta/x {/n LEAF/x ，/wd 咖/n l/x 
typI/x _/n d/x |/n If/x  81：alct/x  DLTNode/x {/n 
  char/x  symbol/x ；/wf 
∥/w 关键字/n 的/ude1 最/d 大/a 长度/n 
∥/w 关键字/n 
∥/w 关键字/n 长度/n 
∥/w 关键字类型/n 
l/x ~/n odeKind/x ；/wf ∥/w 结点/n 种类/n ：/wp {/n 叶子/n ，/wd 分/v 义/ng 
    stmaet/x  DLTNode/x   */n next/x ；/wf     ∥/w 指向/v 兄弟/n 结点/n 的/ude1 指针/n 
    NodeKind/x  kind/x ；/wf     ．/w 
    unlon/x {/n 
    Record/x   */n infoptr/x ；/wf     ∥/w 叶子/nr 结点/n 的/ude1 记录/n 指针/n 
    stn/x |/n ct/x  DLTNode/x   */n first/x ；/wf ∥/w 分支/n 结点/n 的/ude1 孩子/n 链/ng 指针/n 
    I/x     ’/wyy 
  }/n DLTNode/x ，/wd */n DLTree/x ；/wf     ∥/w 双/m 链/ng 树/n 的/ude1 类型/n 
则/c 在/p 双/m 链/ng 树/n 中/f 查找记录/n 的/ude1 操作/vn 由/p 算法/n 9．15/m 实现/v 。/wj 
  Record/x */n SearchDLTree/x (/wkz DLTree/x  T/x ，/wd KeysType/x  K/x )/wky {/n 
    ∥/w 在/p 非空/n 双/m 链/ng 树/n T/x 中/f 查找/v 关键字/n 等于/v K/x 的/ude1 记录/n ，/wd 若/c 存在/v ，/wd 则/c 返回/v 指向/v 该/rz 记录/n 的/ude1 指针/n ，/wd 否则/c 返回/v 空/ng 
    }/n }/n 
    P=T/x >/n first/x ；/wf   i=0/x ；/wf     ∥/w 初始化/v 
    ．/w bile/x (/wkz p/x &/n ＆/n i/x </n K．nul/x )/wky {/n 
    ．/w bile/x (/wkz P/x &/n &/n Psymbol/x !/wt =K．ch/x [/wkz i/x ]/wky )/wky P=P-/x >/n next/x ；/wf ∥/w 查找/v 关键字/n 的/ude1 第/m i/x 位/q 
    if/x (/wkz P/x ＆/n ＆/n i/x </n K．nl／m―1/x )/wky p=p/x 一/m >/n first/x ；/wf     ∥/w 准备/v 查找/v 下/vf 一/m 位/q 
    ++i：/x 
    }/n   ∥/w 查找/v 结束/v 
    算法/n 9．15/m 
    键/n 树/n 中/f 每个/r 结点/n 的/ude1 最/d 大/a 度/qv d/x 和/cc 关键/n 字/n 的/ude1 “/wyz 基/ng ”/wyy 有关/vn ，/wd 若/c 关键字/n 是/vshi 单词/n ，/wd 则/d d=27/x ，/wd 若/c 关键字/n 是/vshi 数值/n ，/wd 则/d d=11/x 。/wj 键/n 树/n 的/ude1 深度/n ^/n 则/d 取决于/v 关键字/n 中/b 字符/n 或/c 数位/n 的/ude1 个/q 数/n 。/wj 假设/v 关键字/n 为/p 随机/b 的/ude1 (/wkz 即/v 关键字/n 中/f 每/rz 一/m 位/q 取/v 基/ng 内/f 任何/rz 值/n 的/ude1 概率/n 相同/a )/wky ，/wd 则/c 在/p 双/m 链/ng 树/n 中/f 查找/v 每/rz 一/m 位/q 的/ude1 平均/ad 查找/v 长度/n 为/p ÷/m (/wkz 1+d/x )/wky 。/wj 又/d 假设/v 关键字/n 中/b 字符/n (/wkz 或/c 数位/n )/wky 的/ude1 个数/n 都/d 相等/vi ，/wd 则/c 在/p 双/m 链/ng 树/n 中/f 进行/vx 查找/vn 的/ude1 平均/ad 查找/v 长度/n 为/p 詈/n (/wkz 1+d/x )/wky 。/wj 
    在/p 双/m 链/ng 树/n 中/f 插入/v 或/c 删除/v 一个/mq 关键/a 字/n ，/wd 相当/d 于/p 在/p 树/n 中/f 某个/rz 结点/n 上/f 插入/v 或/c 删除/v 一/m 棵子/n 树/n ，/wd 在/p 此/rzs 不再/d 详/ag 述/vg 。/wj 
    (/wkz 2/m )/wky 若/c 以/p 树/n 的/ude1 多重/b 链/ng 表表示/n 键/n 树/n ，/wd 则/c 树/v 的/ude1 每个/r 结点/n 中/f 应/v 含有/v d/x 个/q 指针/n 域/ng ，/wd 此时/r 的/ude1 键/n 树/n 又/d 称/v Trie/x 树/n ①/m 。/wj 若/c 从/p 键/n 树/n 中/f 某个/rz 结点/n 到/v 叶子/n 结点/n 的/ude1 路径/n 上/f 每个/r 结点/n 都/d 只/d 有/vyou 一个/mq 孩子/n ，/wd 则/c 可/v 将/p 该/rz 路径/n 上/f 所有/b 结点/n 压缩/v 成/v 一个/mq “/wyz 叶子/n 结点/n ”/wyy ，/wd 且/c 在/p 该/rz 叶子/n 结点/n 中/f 存储/v 关键字/n 及/cc 指向/v 记录/v 的/ude1 指针/n 等/udeng 信息/n 。/wj 例如/v ，/wd 图/n 9．19/m 所/usuo 示/vg 键/ng 树/n 中/f ，/wd 从/p 结点/n Z/x 到/v 结点/n $/n 为/v 单/d 支/q 树/n ，/wd 则/c 在/p 图/n 9．21/m 
相应/vi 的/ude1 Trie/x 树/n 中/f 只/d 有/vyou 一个/mq 含有/v 关键字/n ZHAO/x 及/cc 相关/vn 信息/n 的/ude1 叶子/n 结点/n 。/wj 由此/d ，/wd 在/p Trie/x 树/n 中/f 有/vyou 两/m 种/q 结点/n ：/wp 分支/n 结点/n (/wkz 含/v 有/vyou d/x 个/q 指针/n 域/ng 和/cc 一个/mq 指示/n 该/rz 结点/n 中非/ns 空/a 指针/n 域/ng 的/ude1 个/q 数/n 的/ude1 整数/n 域/ng )/wky 和/cc 叶子/n 结点/n (/wkz 含有/v 关键字/n 域/ng 和/cc 指向/v 记录/v 的/ude1 指针/n 域/ng )/wky 。/wj 在/p 分支/n 结点/n 中/f 不/d 设/v 数据/n 域/ng ，/wd 每/rz 个/q 分支/n 结点/n 所/usuo 表示/v 的/ude1 字符/n 均/d 由/p 其/rz 双亲/n 结点/n 中/f (/wkz 指/v 向/p 该/rz 结点/n )/wky 的/ude1 指针/n 所在/n 位置/n 决定/v 。/wj 图/n 9．21/m 表示/v (/wkz 9―24/m )/wky 关键字/n 集/vg 的/ude1 Trie/x 树/n (/wkz 深度/n =5/m )/wky 
    在/p Trie/x 树/n 上/f 进行/vx 查找/vn 的/ude1 过程/n 为/v ：/wp 从/p 根/n 结点/n 出发/vi ，/wd 沿/p 和/cc 给/p 定/v 值/n 相应/vi 的/ude1 指针/n 逐/vg 层/n 向/p 下/f ，/wd 直至/v 叶子/n 结点/n ，/wd 若/c 叶子/n 结点/n 中/f 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 相等/vi ，/wd 则/c 查找/v 成功/an ，/wd 若/c 分支/n 结点/n 中和/vi 给定/v 值/n 相应/vi 的/ude1 指针/n 为/v 空/ng ，/wd 或/c 叶/ng 结点/n 中/f 的/ude1 关键/n 字/n 和/cc 给/p 定/v 值/n 不/d 相等/vi ，/wd 则/c 查找/v 不/d 成功/a 。/wj 若/c 设/v     。/wj 
①/m trie/x 这个/rz 词/n 是/vshi 从/p retrieve/x (/wkz ~/n )/wky 中/f 取/v 中间/f 四/m 个/q 字符/n 而/cc 构成/v ，/wd 读音/n 同/p (/wkz try/x )/wky 。/wj 
・/w 249・/m 
  typl6def/x  struct/x  TrieNode/x {/n 
    Node/x _/n Kind/x  kind/x ；/wf 
    union/x {/n 
    struct/x {/n Keyrype/x  K/x ；/wf   Record/x   */n infoptr/x }/n lf/x ；/wf   ∥/w 叶子/nr 结点/n 
    struct/x  lTrieNode/x ’/wyy ptr/x [/wkz 27/m ]/wky ；/wf int/x  num/x }/n   bh/x ；/wf   ∥/w 分支/n 结点/n 
    }/n ；/wf 
  }/n TrieNode/x ，/wd */n TrieTree/x ；/wf   ∥/w 键/n 树/n 类型/n 
则/c 键/n 树/n 查找/v 操作/v 可/v 如/v 算法/n 9．16/m 实现/v 之/uzhi 。/wj 
  Record/x */n SearchTrie/x (/wkz TrieTree/x  T/x ，/wd Keys/x  K/x )/wky I/x 
    ∥/w 在/p 键/n 树/n T/x 中/f 查找/v 关键字/n 等于/v K/x 的/ude1 记录/n 。/wj 
    for/x (/wkz P：T/x ，/wd i=0/x ；/wf     ∥/w 对/p K/x 的/ude1 每个/r 字符/n 逐个/d 查找/v 
    P/x &/n ＆/n P/x 一/m >/n kind==BRANCH/x ＆/n ＆/n i/x </n K．num/x ；/wf     ∥/w ”/wyy P/x 为/p 分支/n 结点/n 
    P=P/x 一/m >/n bh．ptr/x [/wkz ord/x (/wkz K．ch/x [/wkz i/x ]/wky )/wky ]/wky ，/wd ++i/x )/wky ；/wf   ∥/w ord/x ~/n )/wky 求/v 字符/n 在/p 字母表/n 中/b 序号/n 
    if/x (/wkz P/x &/n ＆/n P-/x >/n kind==LEAF/x ＆/n ＆/n p/x 一/m >/n If．K==K/x )/wky return/x  P/x 一/m >/n if．infoptr/x ；/wf   ∥/w 查找/v 成功/an 
    else/x  return/x  NULL/x ；/wf     ∥/w 查找/v 不/d 成功/a 
  l/x ∥/w SearchTrie/x     ‘/wyz 
    算法/n 9．16/m 
    从/p 上述/b 查找/vn 过程/n 可见/c ，/wd 在/p 查找/v 成功/a 时/ng 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 叶子/n 结点/n 的/ude1 路径/n 。/wj 例如/v ，/wd 在/p 图/n 9．21/m 上/f ，/wd 查找/v 关键字/n CHEN/x 的/ude1 过程/n 为/v ：/wp 从/p 根/n 结点/n a/x 出发/vi ，/wd 经/p 8/m 、/wn 7/m 结点/n ，/wd 最后/f 到达/v 叶子/n 结点/n 6/m 。/wj 而/cc 查找/v CHAI/x 的/ude1 过程/n 为/v 从/p 根/n 结点/n a/x 出发/vi ，/wd 经/p J3/x 、/wn 7/m 结点/n 后/f 到/v e/x 结点/n 。/wj 由于/p 该/rz 结点/n 中和/vi 字符/n ‘/wyz I/x ’/wyy 相应/vi 的/ude1 指针/n 为/v 空/ng ，/wd 则/c 查找/v 不/d 成功/a 。/wj 由此/d ，/wd 其/rz 查找/v 的/ude1 时间/n 依赖/v 于/p 树/n 的/ude1 深度/n 。/wj 我们/rr 可以/v 对/p 关键字/n 集/vg 选择/v 一/m 种/q 合适/a 的/ude1 分割/vn ，/wd 以/p 缩减/v Trie/x 树/n 的/ude1 深度/n 。/wj 例如/v ，/wd 根据/p (/wkz 9．24/m )/wky 中/f 关键字/n 集/vg 的/ude1 特点/n ，/wd 可/c 作/v 如下/vi 分割/v 。/wj 先/d 按/p 首/m 字符/n 不同/a 分成/vi 多/m 个/q 子集/n 之后/f ，/wd 然后/c 按/p 最后/f 一个/mq 字符/n 不同/a 分割/vn 每个/r 子集/n ，/wd 再/d 按/p 第二/m 个/q 字符/n …/ws …/ws ，/wd 前后/f 交叉/d 分割/v 。/wj 由此/d 得/ude3 到/v 如/v 图/n 9．22/m 所/usuo 示/vg 的/ude1 Trie/x 树/n ，/wd 在/p 该/rz 树上/s ，/wd 除/p 两/m 个/q 叶子/n 结点/n 在/p 第四/m 层/qv 上/f 外/f ，/wd 其余/rz 叶子/n 结点/n 均/d 在/p 第三/m 层/qv 上/vf 。/wj 还/d 可/v 限制/v Trie/x     图/n 9．22/m 对/p (/wkz 9．24/m )/wky 关键字/n 集/vg 采用/v 另/rz 一/m 种/q 分割/vn 法/n 得到/v 的/ude1 Trie/x 树/n (/wkz 深度/n =4/m )/wky 
树/n 的/ude1 深度/n ，/wd 假设/v 允许/v Trie/x 树/n 的/ude1 最/d 大/a 深度/n 为/v l/x ，/wd 则/c 所有/b 直至/v ￡-1/m 层/qv 皆/d 为/v 同义词/n 的/ude1 关键/n 字/n 都/d 进入/v 同一/b 叶子/n 结点/n 。/wj 若/c 分割/v 得/ude3 合适/a ，/wd 则/c 可/v 使/v 每个/r 叶子/n 结点/n 中/f 只/d 含有/v 少数/m 几/m 个/q 同义词/n 。/wj 当/p ①/m   假设/n ord/x 过程/n 将/d K．ch/x [/wkz i/x ]/wky 字符/n 转换/v 成/v 该/rz 字符/n 在/p 字母表/n 中/b 序号/n ，/wd 并/cc 假设/v 字符/n ’/wyy $/n ’/wyy 的/ude1 序号/n 为/p 零/m 。/wj 然/rz 也/d 可/v 增加/v 分支/n 的/ude1 个数/n 以/p 减少/v 树/n 的/ude1 深度/n 。/wj 
　　在/p Trie/x 树上/s 易于/v 进行/vx 插入/v 和/cc 删除/v ，/wd 只/d 是/vshi 需要/v 相应/vi 地/ude2 增加/v 和/cc 删除/v 一些/mq 分支/n 结点/n 。/wj 当/p 分支/n 结点/n 中/f num/x 域/n 的/ude1 值/n 减/v 为/p 1时/t ，/wd 便/d 可/v 被/pbei 删除/v 。/wj 
　　双/m 链/ng 树/n 和/cc Trie/x 树/n 是/vshi 键/n 树/n 的/ude1 两/m 种/q 不同/a 的/ude1 表示方法/n ，/wd 它们/rr 有/vyou 各自/rr 的/ude1 特点/n 。/wj 从/p 其/rz 不同/a 的/ude1 存储/vn 结构/n 特性/n 可见/c ，/wd 若键/nr 树/n 中/f 结点/n 的/ude1 度/qv 较/d 大/a ，/wd 则/c 采用/v Trie/x 树结构/n 较/d 双/m 链/ng 树/n 更为/d 合适/a 。/wj 
　　综/ng 上/f 对/p 树/n 表/n 的/ude1 讨论/vn 可见/c ，/wd 它们/rr 的/ude1 查找/vn 过程/n 都/d 是/vshi 从/p 根/n 结点/n 出发/vi ，/wd 走/v 了/ule 一/m 条/q 从/p 根/n 到/v 叶子/n (/wkz 或/c 非/b 终端/n 结点/n )/wky 的/ude1 路径/n ，/wd 其/rz 查找时间/n 依赖/v 于/p 树/n 的/ude1 深度/n 。/wj 由于/p 树/n 表/n 主要/d 用作/v 文件/n 索引/n ，/wd 因此/c 结点/n 的/ude1 存取/vn 还/d 涉及/v 外部/f 存储设备/n 的/ude1 特性/n ，/wd 故/c 在/p 此/rzs 没有/d 对/p 它们/rr 作/v 平均/ad 查找/v 长度/n 的/ude1 分析/vn 。/wj     9．3/m 哈希表/n 
9．3．1/m 什么/ry 是/vshi 哈希表/n 
    在/p 前面/f 讨论/v 的/ude1 各种/rz 结构/n (/wkz 线性/n 表/n 、/wn 树/n 等/udeng )/wky 中/f ，/wd 记录/v 在/p 结构/n 中/f 的/ude1 相对/b 位置/n 是/vshi 随机/b 的/ude1 ，/wd 和/cc 记录/n 的/ude1 关键/n 字/n 之间/f 不/d 存在/v 确定/v 的/ude1 关系/n ，/wd 因此/c ，/wd 在/p 结构/n 中/f 查找记录/n 时/ng 需/v 进行/vx 一/m 系列/q 和/cc 关键/n 字/n 的/ude1 比较/vn 。/wj 这/rzv 一/m 类/q 查找方法/n 建立/v 在/p “/wyz 比较/d ”/wyy 的/ude1 基础/n 上/f 。/wj 在/p 顺序/n 查找/v 时/ng ，/wd 比较/d 的/ude1 结果/n 为/v “/wyz =/m ”/wyy 与/p “/wyz ≠/w ”/wyy 两/m 种/q 可能/n ；/wf 在/p 折半/v 查找/v 、/wn 二/m 叉/n 排序/vn 树/n 查找/v 和/cc B-/x 树/n 查找/v 时/ng ，/wd 比较/d 的/ude1 结果/n 为/v “/wyz </n ”/wyy 、/wn “/wyz =/m ”/wyy 和/cc “/wyz >/n ”/wyy 三/m 种/q 可能/n 。/wj 查找/v 的/ude1 效率/n 依赖/v 于/p 查找/v 过程/n 中/f 所/usuo 进行/vx 的/ude1 比较/vn 次数/n 。/wj 
    理想/n 的/ude1 情况/n 是/vshi 希望/v 不/d 经过/p 任何/rz 比较/vn ，/wd 一/m 次存取/n 便/d 能/v 得到/v 所/usuo 查/v 记录/v ，/wd 那/rzv 就/d 必须/d 在/p 记录/n 的/ude1 存储位置/n 和/cc 它/rr 的/ude1 关键/n 字/n 之间/f 建立/v 一个/mq 确定/v 的/ude1 对应/vn 关系/n 厂/n ，/wd 使/v 每个/r 关键字/n 和/cc 结构/n 中/f 一个/mq 唯一/b 的/ude1 存储位置/n 相/d 对应/vi 。/wj 因而/c 在/p 查找/v 时/ng ，/wd 只/d 要/v 根据/p 这个/rz 对应/vn 关系/n 厂/n 找到/v 给/p 定/v 值/n K/x 的/ude1 像/p 厂/n (/wkz K/x )/wky 。/wj 若/c 结构/n 中/f 存在/v 关键字/n 和/cc K/x 相等/vi 的/ude1 记录/n ，/wd 则/c 必/d 定/v 在/p 厂/n (/wkz K/x )/wky 的/ude1 存储位置/n 上/f ，/wd 由此/d ，/wd 不/d 需要/v 进行/vx 比较/d 便/d 可/v 直接/ad 取得/v 所/usuo 查/v 记录/n 。/wj 在/p 此/rzs ，/wd 我们/rr 称/v 这个/rz 对应/vn 关系/n 厂/n 为/p 哈希/n (/wkz }/n lash/x )/wky 函数/n ，/wd 按/p 这个/rz 思想/n 建立/v 的/ude1 表/n 为/v 哈希表/n 。/wj 
    我们/rr 可以/v 举/v 一个/mq 哈希表/n 的/ude1 最/d 简单/a 的/ude1 例子/n 。/wj 假设/v 要/v 建立/v 一/m 张/q 全国/n 30/m 个/q 地区/n 的/ude1 各/rz 民族/n 人口/n 统计表/n ，/wd 每个/r 地区/n 为/v 一个/mq 记录/n ，/wd 记录/v 的/ude1 各/rz 数据项/n 为/v ：/wp 显然/a ，/wd 可以/v 用/p 一个/mq 一/m 维/q 数组/n c/x (/wkz 1：30/m )/wky 来/f 存放/v 这/rzv 张/q 表/n ，/wd 其中/rz C/x [/wkz i/x ]/wky 是/vshi 编号/n 为/v i/x 的/ude1 地区/n 的/ude1 人口/n 情况/n 。/wj 编号/n i/x 便/d 为/v 记录/v 的/ude1 关键/n 字/n ，/wd 由/p 它/rr 唯一/d 确定/v 记录/v 的/ude1 存储位置/n C/x [/wkz i/x ]/wky 。/wj 例如/v ：/wp 假设/v 北京市/ns 的/ude1 编号/n 为/p 1/m ，/wd 则/c 若/c 要/v 查看/v 北京市/ns 的/ude1 各/rz 民族/n 人口/n ，/wd 只要/c 取出/v c/x [/wkz 1/m ]/wky 的/ude1 记录/n 即可/v 。/wj 假如/c 把/pba 这个/rz 数组/n 看成/v 是/vshi 哈希表/n ，/wd 则/c 哈希函数/n ，/wd (/wkz key/x )/wky =key/x 。/wj 然而/c ，/wd 很多/m 情况/n 下/f 的/ude1 哈希函数/n 并/cc 不/d 如此/rzv 简单/a 。/wj 可/c 仍/d 以/p 此/rzs 为/v 例/n ，/wd 为了/p 查看/v 方便/an 应/v 以/p 地区/n 名/q 作为/v 关键字/n 。/wj 假设/v 地区/n 名/q 以/p 汉语拼音/n 的/ude1 字符/n 表示/v ，/wd 则/c 不/d 能/v 简单/a 地/ude2 取/v 哈希函数/n 厂/n (/wkz key/x )/wky =key/x ，/wd 而是/c 首先/d 要/v 将/p 它们/rr 转化/v 为/p 数字/n ，/wd 有时/d 还/d 要/v 作/v 些/q 简单/a 的/ude1 处理/vn 。/wj 例如/v 我们/rr 可以/v 有/vyou 这样/rzv 的/ude1 哈希函数/n ：/wp (/wkz 1/m )/wky 取/v 关键字/n 中/f 第一/m 个/q 字母/n 在/p 字母表/n 中/f 的/ude1 序号/n 作为/p 哈希函数/n 。/wj 例如/v ：/wp BEIJING/x 的/ude1 哈希函数/n 值/v 为/p 字母/n “/wyz B/x ”/wyy 在/p 字母表/n 中/f 的/ude1 序号/n ，/wd 等于/v 02/m ；/wf 或/c (/wkz 2/m )/wky 先/d 求/v 关键字/n 的/ude1 第一/m 个/q 和/cc 最后/f 一个/mq 字母/n 在/p 字母表/n 中/f 的/ude1 序号/n 之和/n ，/wd 然后/c 判别/v 这个/rz 和/cc 值/n ，/wd 若比/nrf 30/m (/wkz 表/n 长/ng )/wky 大/a ，/wd 则/c 减去/v 30/m  c/x ，/wd 例如/v ：/wp TIANJIN/x 的/ude1 首尾/n 两/m 个/q 字母/n “/wyz T/x ”/wyy 和/cc “/wyz N/x ”/wyy 序号/n 之和/n 为/p 34/m ，/wd 故/c 取/v 04/m 为/p 它/rr 的/ude1 哈希函数/n 值/n ；/wf 或/c (/wkz 3/m )/wky 先/d 求/v 每/rz 个/q 汉字/nz 的/ude1 第一/m 个/q 拼音/n 字母/n 的/ude1 AS/x (/wkz ：/wp II/x 码/v (/wkz 和/cc 英文/nz 字母/n 相同/a )/wky 之/uzhi 和/ng 的/ude1 八/m 进制/n 形式/n ，/wd 然后/c 将/p 这个/rz 八/m 进制数/n 看成/v 是/vshi 十进制/n 再/d 除/p 以/p 30/m 取/v 余数/n ，/wd 若/c 余数/n 为/p 零/m 则/c 加上/v 30/m 而/cc 为/p 哈希函数/n 值/n 。/wj 例如/v ：/wp HENAN/x 的/ude1 头/n 两/m 个/q 拼音/n 字母/n 为/v “/wyz H/x ”/wyy 和/cc “/wyz N/x ”/wyy ，/wd 它们/rr 的/ude1 AscII/x 码/q 之和/n ~/n 3/m (/wkz 226/m )/wky 8/m ，/wd E1/x ,/wd (/wkz 226/m )/wky Lo/x 除以/v (/wkz 30/m )/wky 10/m 得/v 余数/n 为/p 16/m ，/wd 则/c 16/m 为/v HENAN/x 的/ude1 哈希函数/n 值/n ，/wd 即/d 记录/v 在/p 数/m 组/q 中/f 的/ude1 下/vf 标值/n 。/wj 上述/b 人口/n 统计表/n 中/f 部分/m 关键字/n 在/p 进/vf 三/m 种/q 不同/a 的/ude1 哈希函数/n 情况/n 下/f 的/ude1 哈希函数/n 值/v 如/v 表/vg 9/m  l/x 所/usuo 列/v ：/wp 
表/n 9/m  l/x 简单/a 的/ude1 哈希函数/n 示例/n 
  (/wkz 1/m )/wky 哈希函数/n 是/vshi 一个/mq 映象/n ，/wd 因此/c 哈希函数/n 的/ude1 设定/vn 很/d 灵活/a ∞/m ，/wd 只要/c 使得/vi 任何/rz 关键字/n 由此/d 
所得/n 的/ude1 哈希函数/n 值/n 都/d ，/wd */n 住/vi 是/vshi 长/a 允许/v 范围/n 之内/f 即可/v ；/wf 
    (/wkz 2/m )/wky 对/p 不同/a 的/ude1 关键/n 字/n f/x 能/v 得到/v 同一/b 哈希/n 地址/n ，/wd 这种/r 现象/n 称/v 冲突/vn (/wkz coll-/x 啪/o n/x )/wky 。/wj 具有/v 相同/a 函数值/n 的/ude1 关键/n 字/n 对/p 该/rz 哈希函数/n 来说/uls 称做/v 同义词/n (/wkz 。/wj y/x …/ws ym/x )/wky 。/wj 例如/v ：/wp 关键字/n HEBEI/x 相/d HENAN/x 不等/vi ，/wd 但/c ^/n (/wkz HEBEI/x )/wky =/m ，/wd l/x (/wkz HENAN/x )/wky ，/wd 叉/v 如/v ：/wp ^/n (/wkz SHArq/x  x1/x )/wky =/m ^/n (/wkz sHANGHAI/x )/wky ；/wf ，/wd 3/m (/wkz HENAN/x )/wky =/m ^/n (/wkz sIcHuAN/x )/wky 。/wj 这种/r 现象/n 给/p 建/v 表/vg 造成/v 困难/an ，/wd 如/c 在/p 第一/m 种/q 哈希函数/n 的/ude1 情况/n 下/f ，/wd 因为/p 山西/ns 、/wn 上海/ns 、/wn 山东/ns 和/cc 四川/ns 这/rzv 四/m 个/q 记录/n 的/ude1 哈希/n 地址/n 均/d 为/v 19/m ，/wd 而/cc c/x [/wkz 19/m ]/wky 只能/v 存放/v 一个/mq 记录/n ，/wd 那末/c 其它/rz 三/m 个/q 记录/n 存放在/v 表/n 中/f 什么/ry 位置/n 呢/y ’/wyy 井/n 且/c 从/p 上/f 表/vg 三/m 个/q 不同/a 的/ude1 哈希函数/n 的/ude1 情况/n 可以/v 看出/v ，/wd 啥/ry 希/b 函数/n 选/v 得/ude3 合适/a 可以/v 减少/v 这种/r 冲突/vn 现象/n 特别/d 是/vshi 在/p 这个/rz 例子/n 中/f 。/wj 只/d 可能/v 有/vyou 30/m 个/q 记录/n ，/wd 可以/v 仔细/ad 分析/v 这/rzv 30/m 个/q 关键/n 字/n 的/ude1 特性/n l/x 选择/v 一个/mq 恰当/a 的/ude1 哈希函数/n 来/vf 避免/v 冲突/vn 的/ude1 发生/vn 。/wj 
　　然而/c ，/wd 在/p 一般/a 情况/n 下/f ，/wd 冲突/vi 只能/v 尽可能/d 地/ude2 少/v ，/wd 而/cc 不能/v 完全/ad 避免/v 。/wj 因为/c ，/wd l/x 哈希函数/n 是/vshi 从/p 键字/n 集合/v 到/v 地址/n 集合/v 的/ude1 映象/n 。/wj 通常/d ，/wd 关键字集合/n 比较/d 大/a ，/wd 它/rr 的/ude1 元素/n 包括/v 所有/b 可能/n 的/ude1 关键/n 字/n ，/wd 而/cc 地址/n 集合/v 的/ude1 元素/n 仅/d 为/v 哈希表/n 中/f 的/ude1 地址/n 值/n 。/wj 假设/n 表/vg 长/ng 为/v 玑/ng 则/c 地址/n 为/p 0/m 到/v ”/wyy -/wp 1/m 。/wj 例如/v ，/wd 在/p c/x 语言/n 的/ude1 编译程序/n 中/f 可/v 对/p 源程序/n 中/f 的/ude1 标识符/n 建立/v 一/m 张/q 哈希表/n 。/wj 在/p 设定/v 哈希函数/n 时/ng 考虑/v 的/ude1 关键字集合/n 应/v 包含/v 所/usuo 有/vyou 可能/n 产生/v 的/ude1 关键/n 字/n ；/wf 假设/v 标识符定义/n 为/p 雎/n 字母/n 为首/vi 的/ude1 8/m 位/q 字母/n 或/c 数字/n ，/wd 则/c 关键字/n (/wkz 标识符/n )/wky 的/ude1 集合/n 大小/n 为/v c/x ；/wf 2/m */n c/x 品/ng */n 7/m  1=1/m  0t9388×10/x ”/wyy ．/w 币/ng 『/wyz 在/p 源程序/n 中/f 出现/v 的/ude1 标识符/n 是/vshi 有限/a 的/ude1 ，/wd 设/v 表/vg 长/ng 为/v 1000/m 足/a 矣/y 。/wj 地址/n 集合/v 中/f 的/ude1 元素/n 为/p 0/m 到/v 999/m ~/n ,/wd 因此/c ，/wd 在/p 一般/a 情况/n 下/f ，/wd 哈希函数/n 是/vshi 一个/mq 压缩/v 映象/n ，/wd 这/rzv 就/d 不可避免/vl 产生/v 冲突/vn 。/wj 因此/c ，/wd 在/p 建造/v 哈希表/n 时/ng 不仅/c 要/v 设定/v 一个/mq “/wyz 好/a ”/wyy 的/ude1 哈希函数/n ，/wd 而且/c 要/v 没/d 定/v 一/m 种/q 处理/vn 冲突/vn 的/ude1 方法/n 。/wj  
　　 综上所述/c ．/w 可/v 如下/vi 描述/v 哈希表/n ：/wp 根据/p 设定/v 的/ude1 哈希函数/n H/x (/wkz 女/b 州/n )/wky 和/cc 处理/vn 冲突/vn 的/ude1 方法/n 将/d 一/m ①/m   Ha/x “/wyz (/wkz 哈希/n )/wky 的/ude1 原意/n 率/v 是/vshi 杂凑/v 252・/m 
组/n 关键字/n 映象/n 到/v 一个/mq 有限/a 的/ude1 连续/a 的/ude1 地址/n 集/vg (/wkz 区/n 间/f )/wky 上/f ，/wd 并/cc 以/p 关键字/n 在/p 地址/n 集中/a 的/ude1 “/wyz 象/ng ”/wyy 作为/v 记录/v 在/p 表/n 中/f 的/ude1 存储位置/n ，/wd 这种/r 表/n 便/d 称为/v 哈希表/n ，/wd 这/rzv 一/m 映象/n 过程/n 称为/v 哈希/n 造表/vi 或/c 散/v 列/v ，/wd 所得/n 存储位置/n 称/v 哈希/n 地址/n 或/c 散/v 列/v 地址/n 。/wj 
    下面/f 分别/d 就/d 哈希函数/n 和/cc 处理/vn 冲突/vn 的/ude1 方法/n 进行/vx 讨论/vn 。/wj 
    9．3．2/m 哈希函数/n 的/ude1 构造方法/n 
　　构造/n 哈希函数/n 的/ude1 方法/n 很多/m 。/wj 在/p 介绍/v 各种/rz 方法/n 之前/f ，/wd 首先/d 需要/v 明确/v 什么/ry 是/vshi “/wyz 好/a ”/wyy 的/ude1 哈希函数/n 。/wj 
　　若/c 对于/p 关键字集合/n 中/f 的/ude1 任/v 一个/mq 关键/a 字/n ，/wd 经/p 哈希函数/n 映象/n 到/v 地址/n 集合/v 中/f 任何/rz 一个/mq 地址/n 的/ude1 概率/n 是/vshi 相等/vi 的/ude1 ，/wd 则/c 称/v 此类/r 哈希函数/n 为/p 均匀/a 的/ude1 (/wkz Llniform/x )/wky 哈希函数/n 。/wj 换句话说/c ，/wd 就是/d 使/v 关键字/n 经过/p 哈希函数/n 得到/v 一个/mq “/wyz 随机/b 的/ude1 地址/n ”/wyy ，/wd 以便/d 使/v 一/m 组/q 关键字/n 的/ude1 哈希/n 地址/n 均匀分布/n 在/p 整个/b 地址/n 区间/n 中/f ，/wd 从而/c 减少/v 冲突/vn 。/wj   
    常用/a 的/ude1 构造/n 哈希函数/n 的/ude1 方法/n 有/vyou ：/wp 
    1．/m 直接/ad 定址/n 法/n 
    取/v 关键字/n 或/c 关键字/n 的/ude1 某个/rz 线性/n 函数值/n 为/p 哈希/n 地址/n 。/wj 即/v ：/wp 
    H/x (/wkz key/x )/wky =key/x 或/c H/x (/wkz key/x )/wky =a・key+b/x 
    其中/rz 和/cc 6/m 为/p 常数/n (/wkz 这种/r 哈希函数/n 叫做/v 自身/rr 函数/n )/wky o/x 
    例如/v ：/wp 有/vyou 一个/mq 从/p 1/m 岁/qt 到/v 100/m 岁/qt 的/ude1 人口/n 数字/n 统计表/n ，/wd 其中/rz ，/wd 年龄/n 作为/p 关键字/n ，/wd 哈希函数/n 取/v 关键字/n 自身/rr 。/wj 如/v 表/vg 9．2/m 所/usuo 示/vg ：/wp 
表/n 9．2/m 直接/ad 定址/n 哈希函数/n 例/n 之一/rz 
这样/rzv ，/wd 若/c 要/v 询问/v 25/m 岁/qt 的/ude1 人/n 有/vyou 多少/ry ，/wd 则/c 只/d 要/v 查/v 表/n 的/ude1 第25/m 项/q 即可/v 。/wj 
    又/d 如/v ：/wp 有/vyou 一个/mq 解放后/t 出生/vi 的/ude1 人口/n 调查表/n ，/wd 关键/a 字/n 是/vshi 年份/n ，/wd 哈希函数/n 取/v 关键字/n 加/v 一/m 常数/n ：/wp 
H/x (/wkz key/x )/wky =key+/x (/wkz -/wp 1948/m )/wky ，/wd 如/v 表/vg 9．3/m 所/usuo 示/vg 。/wj 
表/n 9．3/m 直接/ad 定址/n 哈希函数/n 例/n 之/uzhi 二/m 
这样/rzv ，/wd 若/c 要/v 查/v 1970年/t 出生/vi 的/ude1 人数/n ，/wd 则/c 只/d 要/v 查第/nrf (/wkz 1970―1948/m )/wky =22/m 项/q 即可/v 。/wj 
    由于/c 直接/ad 定址/n 所得/n 地址/n 集合/v 和/cc 关键字集合/n 的/ude1 大小/n 相同/a 。/wj 因此/c ，/wd 对于/p 不同/a 的/ude1 关键/n 字/n 不/d 会/v 发生/v 冲突/vn 。/wj 但/c 实际/n 中/f 能/v 使用/v 这种/r 哈希函数/n 的/ude1 情况/n 很/d 少/a 。/wj 
  2．/m 数字/n 分析法/n 
  假设/v 关键字/n 是/vshi 以/p r/x 为/v 基/ng 的/ude1 数/n (/wkz 如/v ：/wp 以/p 10/m 为/v 基/ng 的/ude1 十进制/n 数/n )/wky ，/wd 并且/c 哈希表/n 中/f 可能/v 出现/v 的/ude1 关键/n 字/n 都/d 是/vshi 事先/d 知道/v 的/ude1 ，/wd 则/d 可取/a 关键字/n 的/ude1 若干/m 数位/n 组成/v 哈希/n 地址/n 。/wj 
    例如/v 有/vyou 80/m 个/q 记录/n ，/wd 其/rz 关键/n 宇/ng 为/v 8/m 位/q 十进制/n 数/n 。/wj 假设/v 哈希表/n 的/ude1 表/n 长/ad 为/v 100/m 。/wj 0/m ，/wd 则/d 可取/a 两/m 位/q 十进制/n 数组/n 成/v 哈希/n 地址/n 。/wj 取/v 哪/ry 两/m 位/q ?/ww 原则/n 是/vshi 使/v 得到/v 的/ude1 哈希/n 地址/n 尽量避免/n 产生/v 冲突/vn ，/wd 则/c 需/v 从/p 分析/v 这/rzv 80/m 个/q 关键字/n 着手/v 。/wj 假设/n 这/rzv 80/m 个/q 关键字/n 中/f 的/ude1 一/m 部分/n 如下/vi 所/usuo 列/v ：/wp  
对/p 关键字/n 全体/n 的/ude1 分析/vn 中/f 我们/rr 发现/v ：/wp 第①②/m 位/q 都/d 是/vshi “/wyz 8/m  1/m ”/wyy ，/wd 第⑨/m 位/q 只/d 可能/v 取/v 1/m 、/wn 2/m 、/wn 3/m 或/c 4/m ，/wd 第⑧/m 位/q 只/d 可能/v 取/v 2/m 、/wn 5/m 或/c 7/m ，/wd 因此/c 这/rzv 四/m 位/q 都/d 不/d 可取/a 。/wj 由于/p 中间/f 的/ude1 四/m 位/q 可/v 看成/v 是/vshi 近乎/v 随机/z 的/ude1 ，/wd 因此/c 可取/v 其中/rz 任意/d 两/m 位/q ，/wd 或/c 取/v 其/rz 中/f 两/m 位/q 与/p 另外/rz 两/m 位/q 的/ude1 叠加/vn 求和/vn 后/f 舍去/v 进位/v 作为/p 哈希/n 地址/n 。/wj 
  3．/m 平方/q 取/v 中/b 法/n 
  取/v 关键字/n 平方/n 后/f 的/ude1 中间/f 几/m 位/q 为/p 哈希/n 地址/n 。/wj 这/rzv 是/vshi 一/m 种/q 较/d 常用/a 的/ude1 构造/n 哈希函数/n 的/ude1 方法/n 。/wj 
通常/d 在/p 选定/v 哈希函数/n 时/ng 不/d 一定/d 能/v 知道/v 关键字/n 的/ude1 全部/m 情况/n ，/wd 取/v 其/rz 中/f 哪/ry 几/m 位/q 也/d 不/d 一定/d 合适/a ，/wd 而/cc 一个/mq 数/m 平方/q 后/f 的/ude1 中间/f 几/m 位/q 数/n 和/cc 数/n 的/ude1 每/rz 一/m 位/q 都/d 相关/vi ，/wd 由此/d 使/v 随机/d 分布/vi 的/ude1 关键/n 字/n 得到/v 的/ude1 哈希/n 地址/n 也/d 是/vshi 随机/b 的/ude1 。/wj 取/v 的/ude1 位/q 数/n 由/p 表/n 长/a 决定/n 。/wj 
    例如/v ：/wp 为/v BASIC/x 源程序/n 中/f 的/ude1 标识符/n 建立/v 一个/mq 哈希表/n 。/wj 假设/n BASIC/x 语言/n 中/f 允许/v 的/ude1 标识符/n 为/v 一个/mq 字母/n ，/wd 或/c 一个/mq 字母/n 和/cc 一个/mq 数字/n 。/wj 在/p 计算机/n 内/f 可/v 用/p 两/m 位/q 八/m 进制数/n 表示字母/n 和/cc 数字/n ，/wd 如/v 图/n 9．23/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 取/v 标识符/n 在/p 计算机/n 中/f 的/ude1 八/m 进制数/n 为/p 它/rr 的/ude1 关键/n 字/n 。/wj 假设/n 表/vg 长/ng 为/v 512=2/m ’/wyy ，/wd 则/d 可取/a 关键字/n 平方/n 后/f 的/ude1 中间/f 9/m 位/q 二进制/n 数/n 为/p 哈希/n 地址/n 。/wj 例如/v ，/wd 图/n 9．23/m (/wkz b/x )/wky 列出/v 了/ule 一些/mq 标识符/n 及/cc 它们/rr 的/ude1 哈希/n 地址/n 。/wj 
  4．/m 折叠/v 法/n 
  将/p 关键字/n 分割/v 成/v 位/q 数/n 相同/a 的/ude1 几/m 部分/n (/wkz 最后/f 一/m 部分/n 的/ude1 位/q 数/n 可以/v 不/d 同/v )/wky ，/wd 然后/c 取/v 这/rzv 几/m 部分/n 的/ude1 叠加/vn 和/cc (/wkz 舍去/v 进位/v )/wky 作为/p 哈希/n 地址/n ，/wd 这/rzv 方法/n 称为/v 折叠/v 法/n (/wkz folding/x )/wky 。/wj 关键字/n 位数/n 很多/m ，/wd 而且/c 关键字/n 中/f 每/rz 一/m 位/q 上/f 数字/n 分布/vi 大致/d 均匀/a 时/ng ，/wd 可以/v 采用/v 折叠/v 法/n 得到/v 哈希/n 地址/n 。/wj 
┃/n     记录/v   ┃/n     关键字/n   ┃/n     (/wkz 关键字/n )/wky 。/wj   ┃/n     哈希/n 地址/n (/wkz 2/m 。/wj ’/wyy ～/ws 2/m ’/wyy )/wky   ┃/n 
    (/wkz b/x )/wky 
图/n 9．23/m   (/wkz a/x )/wky 字符/n 的/ude1 八/m 进制/n 表示/v 对照表/n   (/wkz b/x )/wky 标识符/n 及其/cc 哈希/n 地址/n 
    例如/v ：/wp 每/rz 一/m 种/q 西文/nz 图书/n 都/d 有/vyou 一个/mq 国际标准/n 图书/n 编号/n (/wkz ISBN/x )/wky ，/wd 它/rr 是/vshi 一个/mq 10/m 位/q 的/ude1 十进制/n 数字/n ，/wd 若/c 要/v 以/p 它/rr 作/v 关键字/n 建立/v 一个/mq 哈希表/n ，/wd 当/p 馆藏/vn 书/n 种类/n 不/d 到/v 10/m ，/wd 000/m 时/ng ，/wd 可/c 采用/v 折叠/v 法/b 构造/n 一个/mq 四/m 位/q 数/n 的/ude1 哈希函数/n 。/wj 在/p 折叠/v 法/b 中/b 数位/n 叠加/vi 可以/v 有/vyou 移位/vn 叠加/vn 和/cc 间/f 界/k 叠加/vi 两/m 种/q 方法/n 。/wj 移位/vi 叠加/vi 是/vshi 将/d 分割/v 后/f 的/ude1 每/rz 一/m 部分/n 的/ude1 最低/a 位/q 对/p 齐/a ，/wd 然后/c 相加/vi ；/wf 间/f 界/n 叠加/vn 是/vshi 从/p 一/m 端/q 向/p 另/rz 一/m 端/q 沿/p 分割/v 界/n 来回/vd 折/vi 迭/d ，/wd 然后/c 对齐/v 相加/vi 。/wj 如/v 国际标准/n 图书/n 编号/vi 0．442．20586．4/m 的/ude1 哈希/n 地址/n 分别/d 如/v 图/n 9．24/m (/wkz a/x )/wky 和/cc (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    1．0088/m     6092/m 
    H/x (/wkz key/x )/wky =0088/m     H/x (/wkz 电/n 缈/x )/wky =6092/m 
    (/wkz a/x )/wky     (/wkz b/x )/wky 
    图/n 9．24/m 由/p 折叠/v 法/n 求得/v 哈希/n 地址/n 
    (/wkz a/x )/wky 移位/vi 叠加/vi ；/wf   (/wkz b/x )/wky 间/f 界/k 叠加/vi 。/wj 
  5．/m 除/p 留/v 余数/n 法/n 
  取/v 关键字/n 被/pbei 某个/rz 不/d 大于/v 哈希表/n 表/vg 长/a 仇/n 的/ude1 数/n p/x 除/p 后/f 所得/n 余数/n 为/p 哈希/n 地址/n 。/wj 即/v  H/x (/wkz )/wky =key/x   MOD/x   ≤m/x 
    这/rzv 是/vshi 一/m 种/q 最/d 简单/a ，/wd 也/d 最/d 常用/a 的/ude1 构造/n 哈希函数/n 的/ude1 方法/n 。/wj 它/rr 不仅/c 可以/v 对/p 关键字/n 直接/ad 取/v 模/ng (/wkz MOD/x )/wky ，/wd 也/d 可/v 在/p 折/vi 迭/d 、/wn 平方/n 取/v 中等/b 运算/vn 之后/f 取/v 模/ng 。/wj 
    值得/v 注意/v 的/ude1 是/vshi ，/wd 在/p 使用/v 除/p 留/v 余数/n 法/n 时/ng ，/wd 对/p 户/ng 的/ude1 选择/vn 很/d 重要/a 。/wj 若/v p/x 选/v 的/ude1 不好/a ，/wd 容易/ad 产生/v 同义词/n 。/wj 请/v 看/v 下面/f 三/m 个/q 例子/n 。/wj 
　　假设/v 取/v 标识符/n 在/p 计算机/n 中/f 的/ude1 二进制/n 表示/v 为/p 它/rr 的/ude1 关键/n 字/n (/wkz 标识符/n 中/f 每个/r 字母/n 均/d 用/v 两/m 位/q 八/m 进制数/n 表示/v )/wky ，/wd 然后/c 对/p 户/ng =2/m ‘/wyz 取/v 模/ng 。/wj 这个/rz 运算/vn 在/p 计算机/n 中/f 只要/c 移位/vi 便/d 可/v 实现/v ，/wd 将/p 关键字/n 左/f 移/v 直至/v 只/d 留下/v 最低/a 的/ude1 6/m 位/q 二进制/n 数/n 。/wj 这/rzv 等于/v 将/p 关键字/n 的/ude1 所有/b 高位/n 值/n 都/d 忽略/v 不/d 计/vi 。/wj 因而/c 使得/vi 所有/b 最后/f 一个/mq 字符/n 相同/a 的/ude1 标识符/n ，/wd 如/v a1/x ，/wd i1/x ，/wd templ/x ，/wd cpl/x 等/udeng 均/d 成为/v 同义词/n 。/wj 
若/v 户/ng 含有/v 质/ng 因子/n ∥/w ，/wd 则/c 所有/b 含有/v 玎/x 因子/n 的/ude1 关键/n 字/n 的/ude1 哈希/n 地址/n 均/d 为/v Ⅳ/m 的/ude1 倍数/n 。/wj 例如/v ，/wd 当/v P：21/x (/wkz =3×7/m )/wky 时/ng ，/wd 下列/b 含/v 因子/n 7/m 的/ude1 关键/n 字/n 对/p 21/m 取/v 模/ng 的/ude1 哈希/n 地址/n 均/d 为/v 7/m 的/ude1 倍数/n 。/wj 
    关键字/n     28/m   35/m   63/m   77/m   105/m 
    哈希/n 地址/n     7/m     14/m  0/m     14/m  0/m 
    假设/n 有/vyou 两/m 个/q 标识符/n xy/x 和/cc yx/x ，/wd 其中/rz x/x 、/wn Y/x 均/d 为/v 字符/n ，/wd 又/d 假设/v 它们/rr 的/ude1 机器代码/n (/wkz 6/m 位/q 二进制/n 数/n )/wky 分别/d 为/v c/x (/wkz z/x )/wky 和/cc c/x (/wkz Y/x )/wky ，/wd 则/c 上述/b 两/m 个/q 标识符/n 的/ude1 关键/n 字/n 分别/d 为/v 
    keyl=26c/x (/wkz z/x )/wky +C/x (/wkz Y/x )/wky 和/cc key2=26c/x (/wkz y/x )/wky +c/x (/wkz z/x )/wky 
假设/v 用/v 除/p 留/v 余数/n 法/n 求/v 哈希/n 地址/n ，/wd 且/c P=tq/x ，/wd t/x 是/vshi 某个/rz 常数/n ，/wd q/x 是/vshi 某个/rz 质数/n 。/wj 则/c 当/v q=3/x 时/ng ，/wd 这/rzv 两/m 个/q 关键字/n 将/d 被/pbei 散/v 列/v 在/p 差/a 为/p 3/m 的/ude1 地址/n 上/f 。/wj 因为/p 
    [/wkz H/x (/wkz keyl/x )/wky H/x (/wkz key2/x )/wky ]/wky MOD/x  q/x 
    =/m {/n [/wkz 26c/x (/wkz z/x )/wky +f/x (/wkz Y/x )/wky ]/wky MOD/x  P/x [/wkz 26c/x (/wkz Y/x )/wky +c/x (/wkz z/x )/wky ]/wky MOD/x  P/x }/n MOD/x  q/x 
    =/m {/n 267/m (/wkz z/x )/wky MOD/x  P/x 十/m c/x (/wkz Y/x )/wky MOD/x  P26c/x (/wkz y/x )/wky MOD/x  Pf/x (/wkz z/x )/wky MOD/x  P：MOD/x  q/x 
    =/m {/n 26f/x (/wkz z/x )/wky MOD/x  q+f/x (/wkz Y/x )/wky MOD/x  q26f/x (/wkz Y/x )/wky MOD/x  q/x (/wkz z/x )/wky MOD/x  q/x }/n MOD/x  q/x 
    (/wkz 因/p 对/p 任/v z/x 有/vyou (/wkz z/x  MOD/x (/wkz t/x */n q/x )/wky )/wky MOD/x  q：/x (/wkz z/x  MOD/x  q/x )/wky MOD/x  q/x )/wky 
当/p q：3/x 时/ng ，/wd 上/f 式/k 为/v 
    =/m {/n (/wkz 2/m 。/wj MOD/x  3/m )/wky (/wkz (/wkz J・/x )/wky MOD/x  3+f/x (/wkz Y/x )/wky MOD/x  3/m 一/m (/wkz 2/m 。/wj MOD/x  3/m )/wky f/x (/wkz Y/x )/wky MOD/x  3c/x (/wkz X/x )/wky 
    M/x (/wkz )/wky D/x  3/m }/n MOD/x  3/m 
    =0/m   M/x (/wkz )/wky D/x  3/m 
    由/p 众人/n 的/ude1 经验/n 得知/v ：/wp 一般/a 情况/n 下/f ，/wd 可以/v 选/v P/x 为/p 质数/n 或/c 不/d 包含/v 小于/v 20/m 的/ude1 质/ng 因素/n 的/ude1 合数/n 。/wj 
  6．/m 随/dg 饥/ag 数/n 法/n 
  选择/v 一个/mq 随机/b 函数/n ，/wd 取/v 关键字/n 的/ude1 随机/b 函数值/n 为/p 它/rr 的/ude1 哈希/n 地址/n ，/wd 即/v H/x (/wkz key/x )/wky =random/x (/wkz key/x )/wky ，/wd 其中/rz r8/x ,/wd rldom/x 为/p 随机/b 函数/n 。/wj 通常/d ，/wd 当/p 关键字/n 长度/n 不等/vi 时/ng 采用/v 此法/r 构造/n 哈希函数/n 较/d 恰当/a 。/wj 
    实际/n 工/ag 怍/n r/x {/n j/x 需/v 似/u 不/d 问/v 的/ude1 情/n I/x 兄/ng 采用/v 不同/a 的/ude1 哈希函数/n 。/wj 通常/d ，/wd 考虑/v 的/ude1 因素/n 有/vyou ：/wp 
    (/wkz 1/m )/wky 计算/v 哈希函数/n 所/usuo 需/v 时/ng 删/v (/wkz 包括/v 硬件/n 指令/n 的/ude1 因素/n )/wky ；/wf 
    (/wkz 2/m )/wky 关键/n 字/n 的/ude1 长度/n ；/wf 
    (/wkz 3/m )/wky 哈希表/n 的/ude1 人/n 小/a ；/wf 
    (/wkz 4/m )/wky 关键/n 字/n 的/ude1 分布情况/n ；/wf 
    (/wkz 5/m )/wky 记录/v 的/ude1 查找/vn 频率/n i/x 
    9．3．3/m 处理/vn 冲突/vn 的/ude1 方法/n 
　　在/p “/wyz 9．3．1/m 什么/ry 是/vshi 哈希表/n ”/wyy 巾/ng 曾/d 提及/v 均匀/a 的/ude1 哈希函数/n 可以/v 减少/v 冲突/vn ，/wd 但/c 不/d 能/v 避免/v ，/wd 因此/c ，/wd 如何/ryv 处理/v 冲突/vn 是/vshi 哈希/n 造表/vi 不可/v 缺少/v 的/ude1 另一方面/c 。/wj 
　　假设/v 哈希表/n 的/ude1 地址/n 集/vg 为/p 0/m ～/ws (/wkz ”/wyy -/wp 1/m )/wky ，/wd 冲突/vn 是/vshi 指/v 由/p 关键字/n 得到/v 的/ude1 哈希/n 地址/n 为/v j/x (/wkz O≤J≤/x ”/wyy -/wp 1/m )/wky 的/ude1 位置/n 上/f 已/d 存/v 有/vyou 记录/n ，/wd 则/c “/wyz 处理/v 冲突/vn ”/wyy 就是/d 为/v 该/rz 关键字/n 的/ude1 记录/n 找/v 到/v 另/rz --/wp 个/q “/wyz 空/ng ”/wyy 的/ude1 哈希/n 地址/n 。/wj 在/p 处理/v 冲突/vn 的/ude1 过程/n 中/f 可能/v 得到/v 一个/mq 地址/n 序列/n H/x ，/wd   i=1/x ，/wd 2/m ，/wd …/ws ，/wd k/x ，/wd 
(/wkz Hl∈/x [/wkz 0/m ，/wd n-1/x ]/wky )/wky 。/wj 即/v 在/p 处理/v 哈希/n 地址/n 的/ude1 冲突/vn 时/ng ，/wd 若/c 得到/v 的/ude1 另/rz 一个/mq 哈希/n 地址/n H1/x 仍然/d 发生/v 冲突/vn ，/wd 则/c 再/d 求/v 下/vf 一个/mq 地址/n H2/x ，/wd 若/c 1-12/m 仍然/d 冲突/vi ，/wd 再/d 求得/v H3/x 。/wj 依次/d 类推/vi ，/wd 直至/v 巩/nr1 不/d 发生/v 冲突/vn 为止/u ，/wd 则/d Hk/x 为/p 记录/v 在/p 表/n 中/f 的/ude1 地址/n 。/wj 
    通常/d 用/v 的/ude1 处理/vn 冲突/vn 的/ude1 方法/n 有/vyou 下列/b 几/m 种/q ：/wp 
    1．/m 开放/v 定址/n 法/n 
    H=/x (/wkz H/x (/wkz key/x )/wky +di/x )/wky MOD/x  m/x   i=1/x ，/wd 2/m ，/wd …/ws ，/wd 忌/v (/wkz 愚/v ≤m-1/x )/wky     (/wkz 9-25/m )/wky 
其中/rz ：/wp H/x (/wkz 五/m 纠/vg )/wky 为/p 哈希函数/n ；/wf m/x 为/p 哈希表/n 表/vg 长/a ；/wf 以/p 为/v 增量/n 序列/n ，/wd 可/v 有/vyou 下列/b 三/m 种/q 取/v 法/n ：/wp 
(/wkz 1/m )/wky 么/nr1 =1/m ，/wd 2/m ，/wd 3/m ，/wd …/ws ，/wd m-1/x ，/wd 称/v 线性/n 探测/vn 再/d 散/v 列/v ；/wf (/wkz 2/m )/wky 么/y =l/x 。/wj ，/wd -/wp 1/m 。/wj ，/wd 22/m ，/wd 一/m 2/m 。/wj ，/wd 3/m 。/wj ，/wd …/ws ，/wd ±/w 忌/v 。/wj ，/wd (/wkz 忌/v ≤/m 研/v ／2/m )/wky 称/v 二/m 次/qv 探测/vn 再/d 散/v 列/v ；/wf (/wkz 3/m )/wky 西/f =/m 伪/ag 随机数/n 序列/n ，/wd 称/v 伪/ag 随机/d 探测/v 再/d 散/v 列/v 。/wj 
    例如/v ，/wd 在/p 长度/n 为/p 11/m 的/ude1 哈希表/n 中/f 已/d 填/v 有/vyou 关键字/n 分别/d 为/v 17/m ，/wd 60/m ，/wd 29/m 的/ude1 记录/n (/wkz 哈希函数/n H/x (/wkz key/x )/wky =key-MOD/x  11/m )/wky ，/wd 现有/v 第四/m 个/q 记录/n ，/wd 其/rz 关键字/n 为/p 38/m ，/wd 由/p 哈希函数/n 得到/v 哈希/n 地址/n 为/p 5/m ，/wd 产生/v 冲突/vn 。/wj 若/c 用/p 线性/n 探测/vn 再/d 散/v 列/v 的/ude1 方法/n 处理/v 时/ng ，/wd 得到/v 下/vf 一个/mq 地址/n 6/m ，/wd 仍/d 冲突/vi ；/wf 再/d 求/v 下/vf 一个/mq 地址/n 7/m ，/wd 仍/d 冲突/vi ；/wf 直到/v 哈希/n 地址/n 为/p 8/m 的/ude1 位置/n 为/v “/wyz 空/ng ”/wyy 时/ng 止/v ，/wd 处理/v 冲突/vn 的/ude1 过程/n 结束/v ，/wd 记录/v 填/v 入/v 哈希表/n 中/b 序号/n 为/p 8/m 的/ude1 位置/n 。/wj 若/c 用/p 二/m 次/qv 探测/vn 再/d 散/v 列/v ，/wd 则/c 应该/v 填/v 入/v 序号/n 为/p 4/m 的/ude1 位置/n 。/wj 类似/a 地/ude2 可/v 得到/v 伪/ag 随机/d 再/d 散/v 列/v 的/ude1 地址/n (/wkz 参见图/n 9．25/m )/wky 。/wj 
    图/n 9．25/m 用/p 开放/v 定址/n 处理/v 冲突/vn 时/ng ，/wd 关键/a 字/n 为/p 38/m 的/ude1 记录/n 插入/v 前后/f 的/ude1 哈希表/n 
    (/wkz a/x )/wky 插入/v 前/f ；/wf (/wkz b/x )/wky 线性/n 探测/vn 再/d 散/v 列/v ；/wf (/wkz c/x )/wky 二/m 次/qv 探测/vn 再/d 散/v 列/v ；/wf (/wkz d/x )/wky 伪/ag 随机/d 探测/v 再/d 散/v 列/v ，/wd 伪/ag 随机数/n 列/v 9/m ，/wd …/ws 
    从/p 上述/b 线性/n 探测/vn 再/d 散/v 列/v 的/ude1 过程/n 中/f 可以/v 看到/v 一个/mq 现象/n ：/wp 当/p 表/n 中/f i/x ，/wd i+l/x ，/wd i+2/x 位置/n 上/f 已/d 填/v 有/vyou 记录/n 时/ng ，/wd 下/vf 一个/mq 哈希/n 地址/n 为/v i/x 、/wn i+1/x ，/wd i+2/x 和/cc i+3/x 的/ude1 记录/n 都/d 将/d 填/v 入/v i+3/x 的/ude1 位置/n ，/wd 这种/r 在/p 处理/v 冲突/vn 过程/n 中/f 发生/v 的/ude1 两/m 个/q 第一/m 个/q 哈希/n 地址/n 不同/a 的/ude1 记录/n 争夺/v 同一个/b 后/f 继/vg 哈希/n 地址/n 的/ude1 现象/n 称作/v “/wyz 二/m 次/qv 聚集/v ”/wyy ，/wd 即/d 在/p 处理/v 同义词/n 的/ude1 冲突/vn 过程/n 中/f 又/d 添加/v 了/ule 非/b 同义词/n 的/ude1 冲突/vn ，/wd 显然/a ，/wd 这种/r 现象/n 对/p 查找/v 不利/a 。/wj 但/c 另一方面/c ，/wd 用/p 线性/n 探测/vn 再/d 散/v 列/v 处理/v 冲突/vn 可以/v 保证/v 做到/v ：/wp 只要/c 哈希表/n 未/d 填/v 满/a ，/wd 总/d 能/v 找到/v 一个/mq 不/d 发生/v 冲突/vn 的/ude1 地址/n 巩/nr1 ，/wd 而/cc 二/m 次/qv 探测/vn 再/d 散/v 列/v 只有/c 在/p 哈希表/n 长/v 优/ag 为/v 形/ng 如/v 4j+3/x (/wkz j/x 为/p 整数/n )/wky 的/ude1 素数/n 时/ng 才/d 可能/v [/wkz 川/b ，/wd 随机/d 探测/v 再/d 散/v 列/v ，/wd 则/c 取决于/v 伪/ag 随机数/n 列/v 。/wj 
    ・/w 257・/m 
  2．/m 再/d 哈希/n 法/n 
．/w RH．i/x 均/d 是/vshi 不同/a 的/ude1 哈希函数/n ，/wd 即/d 在/p 同义词/n 产生/v 地址/n 冲突/vn 时/ng 计算/v 另/rz 一个/mq 哈希函数/n 地址/n ，/wd 直到/v 冲突/vn 不再/d 发生/v 。/wj 这种/r 方法/n 不/d 易/ad 产生/v “/wyz 聚集/v ”/wyy ，/wd 但/c 增加/v 了/ule 计算/vn 的/ude1 时间/n 。/wj 
  3．/m 链/ng 地址/n 法/n 
  将/p 所有/b 关键字/n 为/p 同义词/n 的/ude1 记录/n 存储/vn 在/p 同一/b 线性/n 链/ng 表/n 中/f 。/wj 假设/v 某/rz 哈希函数/n 产生/v 的/ude1 哈希/n 地址/n 在/p 区间/n [/wkz 0/m ，/wd 优/ag -/wp 1/m ]/wky 上/f ，/wd 则/c 设立/v 一个/mq 指针/n 型/k 向量/n    Chain/x  ChainHash/x [/wkz m/x ]/wky ；/wf 
其/rz 每个/r 分量/n 的/ude1 初始状态/n 都/d 是/vshi 空/a 指针/n 。/wj 凡/d 哈希/n 地址/n 为/v i/x 的/ude1 记录/n 都/d 插入/v 到头/vi 指针/n 为/v Chain-Hash/x [/wkz i/x ]/wky 的/ude1 链/ng 表/n 中/f 。/wj 在/p 链/ng 表/n 中/f 的/ude1 插入/v 位置/n 可以/v 在/p 表头/n 或/c 表/vg 尾/ng ；/wf 也/d 可以/v 在/p 中间/f ，/wd 以/p 保持/v 同义词/n 在/p 同一/b 线性/n 链/ng 表/n 中/f 按/p 关键字/n 有序/a 。/wj 
    例/n 9．3/m   已/d 知/v 一/m 组/q 关键字/n 为/v (/wkz 19/m ，/wd 14/m ，/wd 23/m ，/wd 01/m ，/wd 68/m ，/wd 20/m ，/wd 84/m ，/wd 27/m ，/wd 55/m ，/wd 11/m ，/wd 10/m ，/wd 79/m )/wky 则/d 按/p 哈希函数/n H/x (/wkz 忌/v 掣/v )/wky =key/x  MOD/x  13/m 和/cc 链/ng 地址/n 法处理/n 冲突/vn 构造/n 所得/n 的/ude1 哈希表/n 如/v 图/n 9．26/m 所/usuo 示/vg 。/wj 
    图/n 9．26/m 链/ng 地址/n 法处理/n 冲突/vn 时/ng 的/ude1 哈希表/n 
    (/wkz 同一/b 链/ng 表/vg 中/b 关键字/n 自小/d 至/p 大/a 有/vyou 序/n )/wky 
  4．/m 建立/v 一个/mq 公共/b 溢出/v 区/n     ’/wyy 
  这/rzv 也/d 是/vshi 处理/v 冲突/vn 的/ude1 一/m 种/q 方法/n 。/wj 假设/v 哈希函数/n 的/ude1 值域/n 为/v [/wkz 0/m ，/wd m-1/x ]/wky ，/wd 则/c 设/v 向量/n }/n lashTable/x [/wkz 0．．m-1/x ]/wky 为/p 基本/a 表/n ，/wd 每个/r 分量/n 存放/v 一个/mq 记录/n ，/wd 另/d 设立/v 向量/n OverTable/x [/wkz 0．．v/x ]/wky 为/p 溢出/v 表/n 。/wj 所有/b 关键字/n 和/cc 基本/a 表/n 中/b 关键字/n 为/p 同义词/n 的/ude1 记录/n ，/wd 不管/c 它们/rr 由/p 哈希函数/n 得到/v 的/ude1 哈希/n 地址/n 是/vshi 什么/ry ，/wd 一旦/d 发生/v 冲突/vn ，/wd 都/d 填/v 入/v 溢出/v 表/n 。/wj 
  9．3．4/m 啥/ry 希/b 表/n 的/ude1 查找/vn 及其/cc 分析/vn 
在/p 哈希表/n 上/f 进行/vx 查找/vn 的/ude1 过程/n 和/cc 哈希/n 造表/vi 的/ude1 过程/n 基本一致/n 。/wj 给定/v K/x 值/n ，/wd 根据/p 造表/vi 时/ng 设定/v 的/ude1 哈希函数/n 求得/v 哈希/n 地址/n ，/wd 若/c 表/n 中/f 此位置/n 上/f 没有/d 记录/v ，/wd 则/c 查找/v 不/d 成功/a ；/wf 否则/c 比较/v 关键字/n ，/wd 若/v 和/cc 给/p 定/v 值/n 相等/vi ，/wd 则/c 查找/v 成功/an ；/wf 否则/c 根据/p 造表/vi 时/ng 设定/v 的/ude1 处理/vn 冲突/vn 的/ude1 方法/n 找/v “/wyz 下/f 一/m 地址/n ”/wyy ，/wd 直至/v 哈希表/n 中/f 某个/rz 位置/n 为/v “/wyz 空/ng ”/wyy 或者/c 表/n 中/f 所/usuo 填/v 记录/v 的/ude1 关键字/n 等于/v 给/p 定/v 值/v 时/ng 为止/u 。/wj 
    算法/n 9．17/m 为/v 以/p 开放/v 定址/n 等/udeng 方法/n (/wkz 除/p 链/ng 地址/n 法/n 外/f )/wky 处理/v 冲突/vn 的/ude1 哈希表/n 的/ude1 查找/vn 过程/n 。/wj 
∥/w …/ws 开放/v 定址/n 哈希表/n 的/ude1 存储/vn 结构/n …/ws 
int/x  hashsize/x [/wkz ]/wky =/m {/n 997/m ，/wd …/ws }/n ；/wf     ／／/m 哈希表/n 容量/n 递增/vi 表/n ，/wd 一个/mq 合适/a 的/ude1 素数/n 序列/n 
ty/x ~/n ：/wp lef/x  struct/x {/n 
  Zl/x ~/n Type/x   */n elem/x ；/wf     ∥/w 数据/n 元素/n 存储/vn 基址/n ，/wd 动态分配/n 数组/n 
  int/x     count/x ；/wf     ∥/w 当前/t 数据/n 元素/n 个数/n 
  int/x     sizeindex/x ；/wf     ∥/w hashsize/x [/wkz sizeindex/x ]/wky 为/p 当前/t 容量/n 
I/x  Has/x 抽/v 址/ng le/x ；/wf 
#/n define/x  SUCCESS/x  1/m 
#/n aeflne/x  UNSUCCESS/x  0/m 
#/n define/x  DUPLICATE―i/x 
Startle/x  SearchRash/x (/wkz HashTable/x  H/x ，/wd KeyType/x  K．ilIt/x &/n P/x ，/wd int/x ＆/n c/x )/wky {/n 
  ∥/w 在/p 开放/v 定址/n 哈希表/n H/x 中/f 查找/v 关键码/n 为/v K/x 的/ude1 元素/n ，/wd 若/c 查找/v 成功/an ，/wd 以/p P/x 指示/n 待查/v 数据/n 
  ∥/w 元素/n 在/p 表/n 中/b 位置/n ，/wd 并/cc 返回/v SUCCESS/x ；/wf 否则/c ，/wd 以/p P/x 指示/n 插入/v 位置/n ，/wd 并/cc 返/v UNSUCCESS/x ，/wd 
  ∥/w C/x 用以/d 计/vi 冲突/vn 次数/n ，/wd 其/rz 初值/n 置/v 零/m ，/wd 供/vi 建/v 表/vg 插入/v 时/ng 参考/v 
  P=Hash/x (/wkz Z/x )/wky ；/wf     ／／/m 求得/v 哈希/n 地址/n 
  ．/w bile/x (/wkz H．elem/x [/wkz p/x ]/wky ．/w key/x 『/wyz -/wp NULLKEY/x ＆/n ＆/n   ／／/m 该/rz 位置/n 中/f 填/v 有/vyou 记录/n 
    !/wt EQ/x (/wkz K/x ，/wd H．elem/x [/wkz p/x ]/wky ．/w key/x )/wky )/wky     ∥/w 并且/c 关键字/n 不/d 相/d 等/v 
    collision/x (/wkz p/x ，/wd ++c/x )/wky ；/wf     ／／/m 求得/v 下/vf 一/m 探查/v 地址/n P/x 
  if/x  EQ/x (/wkz K/x ，/wd H．elem/x [/wkz p/x ]/wky ．/w key/x )/wky 
    return/x  SUCCESS/x ；/wf     ／／/m 查找/v 成功/an ，/wd P/x 返回/v 待查/v 数据/n 元素/n 位置/n 
  elu/x  r．t/x 哪/ry UNSUCCESS/x ；/wf   ／／/m 查找/v 不/d 成功/a (/wkz H．elem/x [/wkz p/x ]/wky ．/w key==NULLKEY/x )/wky ，/wd 
    ／／P/x 返回/v 的/ude1 是/vshi 插入/v 位置/n 
}/n ∥/w SearchHash/x 
    算法/n 9．17/m 
算法/n 9．1B/x 通过/p 调用/v 查找算法/n (/wkz 算法/n 9．17/m )/wky 实现/v 了/ule 开放/v 定址/n 哈希表/n 的/ude1 插入/v 操作/vn 。/wj 
S/x ~/n tus/x  Insert/x #/n ash/x (/wkz Hagh/x 瞄/v le/x ＆/n H/x ，/wd Elemtype/x  e/x )/wky {/n 
  ∥/w 查找/v 不/d 成功/a 时/ng 插入/v 数据/n 元素/n e/x 到/v 开放/v 定址/n 哈希表/n H/x 中/f ，/wd 并/cc 返回/v OK/x ；/wf 若/c 冲突/vn 次数/n 
  ∥/w 过/d 大/a ，/wd 则/c 重建/v 哈希表/n 
  c=0/x ；/wf 
  if/x (/wkz 1Iashsearch/x (/wkz H/x ，/wd e．key/x ，/wd P/x ，/wd C/x )/wky )/wky 
    retuEn/x  DUPLICATE/x ；/wf     ／／/m 表/n 中/f 已/d 有/vyou 与/p e/x 有/vyou 相同/a 关键字/n 的/ude1 元素/n 
  else/x  if/x (/wkz C/x </n hashsize/x [/wkz H．sizeindex/x ]/wky ／2/m )/wky {/n     ∥/w 冲突/vn 次数/n c/x 未/d 达到/v 上限/n ，/wd (/wkz c/x 的/ude1 阀值/n 可/v 调/v )/wky 
    H．elem/x [/wkz p/x ]/wky =e/x ；/wf   ++H．count/x ；/wf   return/x  OK/x ；/wf   ／／/m 插入/v e/x 
    }/n 
else/x  RecreateHashTable/x (/wkz H/x )/wky ；/wf     ／／/m 重建/v 哈希表/n 
＼f/x |/n InsertHash/x 
    算法/n 9．18/m 
例/n 9-4/m   已/d 知/v 例/n 9-3/m 中/f 所/usuo 示/vg 的/ude1 一/m 组/q 关键字/n 按/p 哈希函数/n H/x (/wkz 忌/v 缈/x )/wky =key/x  MOD/x  13/m 和/cc 线性/n 探测/vn 处理/vn 冲突/vn 构造/n 所得/n 哈希表/n a．elem/x [/wkz 0．．15/m ]/wky 如/v 图/n 9．27/m 所/usuo 示/vg 。/wj 
0/m   1/m   2/m   3/m   4/m   5/m   6/m   7/m   8/m   9/m   lO/x  11/m   12/m  13/m   14/m  15/m 
  I/x  14/m  l/x  01/m  I/x  68/m  l/x  27/m  1/m  55/m  I/x  19/m  l/x  20/m  I/x  84/m  l/x  79/m  I/x  23/m  l/x  11/m  l/x  lO/x  l/x   l/x   I/x 
    图/n 9．27/m 哈希表/n a．dem/x [/wkz 0：15/m ]/wky 
    (/wkz 其/rz 哈希函数/n 为/v H/x (/wkz ￡/m 呵/y )/wky =/m ^/n 缈/x MOD/x  13/m ，/wd 处理/v 冲突/vi 为/p 线性/n 探测/vn 再/d 散/v 列/v )/wky 
　　给/p 定/v 值/n K=84/x 的/ude1 查找/vn 过程/n 为/v ：/wp 首先/d 求得/v 哈希/n 地址/n H/x (/wkz 84/m )/wky =6/m ，/wd 因/p a．elem/x [/wkz 6/m ]/wky 不/d 空/v 且/c a．elem/x [/wkz 6/m ]/wky ．/w key=／=84/x ，/wd 则/c 找/v 第一/m 次/qv 冲突/vn 处理/vn 后/f 的/ude1 地址/n H1=/x (/wkz 6+1/m )/wky MOD/x  16=7/m ，/wd 而/cc a．elem/x [/wkz 7/m ]/wky 不/d 空/v 且/c a．elem/x [/wkz 7/m ]/wky ．/w key=／=84/x ，/wd 则/c 找/v 第二/m 次/qv 冲突/vn 处理/vn 后/f 的/ude1 地址/n H2=/x (/wkz 6+2/m )/wky elem/x [/wkz 8/m ]/wky 不/d 空/v 且/c a．elem/x [/wkz 8/m ]/wky ．/w key=84/x ，/wd 则/c 查找/v 成功/an ，/wd 返回/v 记录/v 在/p 表/n 中/b 序号/n 8/m 。/wj     
　　给/p 定/v 值/n K=38/x 的/ude1 查找/vn 过程/n 为/v ：/wp 先/d 求/v 哈希/n 地址/n H/x (/wkz 38/m )/wky =12/m ，/wd a．elem/x [/wkz 12/m ]/wky 不/d 空/v 且/c a．elem/x 【/wkz 12/m ]/wky ．/w key/x ~/n 38/m ，/wd 则/c 找/v 下/vf 一/m 地址/n H1：/x (/wkz 12+1/m )/wky MOD/x  16：13/m ，/wd 由于/c a．elem/x [/wkz 13/m ]/wky 是/vshi 空/a 记录/n ，/wd 则/c 表明/v 表/n 中/f 不/d 存在/v 关键字/n 等于/v 38/m 的/ude1 记录/n 。/wj 
    从/p 哈希表/n 的/ude1 查找/vn 过程/n 可见/v ：/wp 
    1/m )/wky 虽然/c 哈希表/n 在/p 关键字/n 与/cc 记录/n 的/ude1 存储位置/n 之间/f 建立/v 了/ule 直接/a 映象/n ，/wd 但/c 由于/p “/wyz 冲突/vn ”/wyy 的/ude1 产生/vn ，/wd 使得/vi 哈希表/n 的/ude1 查找/vn 过程/n 仍然/d 是/vshi 一个/mq 给/p 定/v 值/n 和/cc 关键字/n 进行/vx 比较/vn 的/ude1 过程/n 。/wj 因此/c ，/wd 仍/d 需/v 以/p 平均/ad 查找/v 长度/n 作为/v 衡量/v 哈希表/n 的/ude1 查找效率/n 的/ude1 量度/n 。/wj 
    2/m )/wky 查找/v 过程/n 中/f 需/v 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键/n 字/n 的/ude1 个数/n 取决于/v 下列/b 三/m 个/q 因素/n ：/wp 哈希函数/n ，/wd 处理/v 冲突/vn 的/ude1 方法/n 和/cc 哈希表/n 的/ude1 装填/v 因子/n 。/wj 
    哈希函数/n 的/ude1 “/wyz 好坏/n ”/wyy 首先/d 影响/v 出现/v 冲突/vn 的/ude1 频繁/a 程度/n 。/wj 但是/c ，/wd 对于/p “/wyz 均匀/a 的/ude1 ”/wyy 哈希函数/n 可以/v 假定/n ：/wp 不同/a 的/ude1 哈希函数/n 对/p 同/p 一/m 组/q 随机/b 的/ude1 关键/n 字/n ，/wd 产生/v 冲突/vn 的/ude1 可能性/n 相同/a ，/wd 因为/c 一般/a 情况/n 下/f 设定/v 的/ude1 哈希函数/n 是/vshi 均匀/a 的/ude1 ，/wd 则/c 可/v 不/d 考虑/v 它/rr 对/p 平均/ad 查找/v 长度/n 的/ude1 影响/vn 。/wj 
　　对/p 同样/b 一/m 组/q 关键字/n ，/wd 设定/v 相同/a 的/ude1 哈希函数/n ，/wd 则/d 不同/a 的/ude1 处理/vn 冲突/vn 的/ude1 方法/n 得到/v 的/ude1 哈希表/n 不同/a ，/wd 它们/rr 的/ude1 平均/ad 查找/v 长度/n 也/d 不同/a 。/wj 如/v 例/n 9―3/m 和/cc 例/n 9．4/m 中/f 的/ude1 两/m 个/q 哈希表/n ，/wd 在/p 记录/n 的/ude1 查找/vn 概率/n 相等/vi 的/ude1 前提/n 下/f ，/wd 前者/rzv (/wkz 链/ng 地址/n 法/b )/wky 的/ude1 平均/ad 查找/v 长度/n 为/v 
　　    ASL/x ，/wd (/wkz 12/m )/wky =/m 老/a (/wkz 1・6+2・4+3+4/m )/wky =1．75/m 
后者/rzv (/wkz 线性/n 探测/vn 再/d 散/v 列/v )/wky 的/ude1 平均/ad 查找/v 长度/n 为/v 
    ASl/x ，/wd (/wkz 12/m )/wky =/m 麦/ng (/wkz 1・6+2+3・3+4+9/m )/wky =2．5/m 
    容易/ad 看出/v ，/wd 线性/n 探测/vn 再/d 散/v 列/v 在/p 处理/v 冲突/vn 的/ude1 过程/n 中/f 易/ad 产生/v 记录/v 的/ude1 二/m 次/qv 聚集/v ，/wd 如/v 即使/c 得/v 哈希/n 地址/n 不/d 相同/a 的/ude1 记录/n 又/d 产生/v 新/a 的/ude1 冲突/vn ；/wf 而/cc 链/ng 地址/n 法处理/n 冲突/vn 不/d 会/v 发生/v 类似情况/n ，/wd 因为/p 哈希/n 地址/n 不同/a 的/ude1 记录/n 在/p 不同/a 的/ude1 链/ng 表/n 中/f 。/wj 
    在/p 一般/a 情况/n 下/f ，/wd 处理/v 冲突/vn 方法/n 相同/a 的/ude1 哈希表/n ，/wd 其/rz 平均/ad 查找/v 长度/n 依赖/v 于/p 哈希表/n 的/ude1 装填/v 因子/n 。/wj 
    哈希表/n 的/ude1 装填/v 因子/n 定义/n 为/v   表/n 中/f 填/v 入/v 的/ude1 记录/n 数/m   哈希表/n 的/ude1 长度/n 
a/x 标志/n 哈希表/n 的/ude1 装满/v 程度/n 。/wj 直观/a 地/ude2 看/v ，/wd a/x 越/d 小/a ，/wd 发生/v 冲突/vn 的/ude1 可能性/n 就/d 越/d 小/a ；/wf 反之/c ，/wd a/x 越/d 大/a ，/wd 表/n 中/f 已/d 填/v 入/v 的/ude1 记录/n 越/d 多/a ，/wd 再/d 填/v 记录/v 时/ng ，/wd 发生/v 冲突/vn 的/ude1 可能性/n 就/d 越/d 大/a ，/wd 则/c 查找/v 时/ng ，/wd 给/p 定/v 值/v 需/v 与/p 之/rz 进行/vx 比较/vn 的/ude1 关键/n 字/n 的/ude1 个/q 数/n 也/d 就/d 越/d 多/a 。/wj 
    可以/v 证明/v ：/wp [/wkz ’/wyy ]/wky [/wkz 2/m ]/wky 
    线性/n 探测/vn 再/d 散/v 列/v 的/ude1 哈希表/n 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v 
    s/x 。/wj 。/wj ≈/m 丢/v (/wkz 1+/m 击/vg )/wky     (/wkz 9．27/m )/wky 
　　随机/b 探测/vn 再/d 散/v 列/v 、/wn 二/m 次/qv 探测/vn 再/d 散/v 列/v 和/cc 再/d 哈希/n 的/ude1 哈希表/n 查找/v 戊/Mg 功/n 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v 
　　    链/ng 地址/n 法处理/n 冲突/vn 的/ude1 哈希表/n 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v 
    由于/p 哈希表/n 在/p 查找/v 不/d 成功/a 时/ng 所/usuo 用/v 比较/vn 次数/n 也/d 和/cc 给/p 定/v 值/n 有关/vn ，/wd 则/c 可/v 类似/a 地/ude2 定义/v 哈希表/n 在/p 查找/v 不/d 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v ：/wp 查找/v 不/d 成功/a 时/ng 需/v 和/cc 给/p 定/v 值/n 进行/vx 比较/vn 的/ude1 关键字/n 个数/n 的/ude1 期望值/n 。/wj 同样/d 可/v 证明/v ，/wd 不同/a 的/ude1 处理/vn 冲突/vn 方法/n 构成/v 的/ude1 哈希表/n 查找/v 不/d 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 分别/d 为/v   线性/n 探测/vn 再/d 散/v 列/v ,/wd   伪/ag 随机/d 探测/v 再/d 散/v 列/v 等/udeng  链/ng 地址/n 
    下面/f 仅/d 以/p 随机/b 探测/vn 的/ude1 一/m 组/q 公式/n 为/p 例/n 进行/vx 分析/vn 推导/vn 。/wj 
    先/d 分析/v 长度/n 为/v m/x 的/ude1 哈希表/n 中/f 装填/v 有/vyou n/x 个/q 记录/n 时/ng 查找/v 不/d 成功/a 的/ude1 平均/ad 查找/v 长度/n 。/wj 这个/rz 问题/n 相当/d 于/p 要求/n 在/p 这/rzv 张/q 表/n 中/f 填/v 入/v 第九+1/m 个/q 记录/n 时/ng 所/usuo 需/v 作/v 的/ude1 比较/vn 次数/n 的/ude1 期望值/n 。/wj 
　　假定/n ：/wp (/wkz 1/m )/wky 哈希函数/n 是/vshi 均匀/a 的/ude1 。/wj 即/d 产生/v 表/n 中/f 各个/rz 地址/n 的/ude1 概率/n 相等/vi ；/wf (/wkz 2/m )/wky 处理/v 冲突/vn 后/f 产生/v 的/ude1 地址/n 也/d 是/vshi 随机/b 的/ude1 。/wj 
若/c 设/v A/x 表示/v 前/f i/x 个/q 哈希/n 地址/n 均/d 发生/v 冲突/vn 的/ude1 概率/n ；/wf qi/x 表示/v 需/v 进行/vx i/x 次比较/n 才/d 找到/v 一个/mq “/wyz 空位/n ”/wyy 的/ude1 哈希/n 地址/n (/wkz 即/v 前/f i-1/x 次/qv 发生/v 冲突/vn ，/wd 第/m i/x 次/qv 不/d 冲突/vi )/wky 的/ude1 概率/n 。/wj 则/c 有/vyou ：/wp  
可见/c ，/wd 在/p 户/q i/x 和/cc q/x ；/wf 之间/f ，/wd 存在/v 关系式/n 
由此/d ，/wd 当/p 长度/n 为/v 优/ag 的/ude1 哈希表/n 中/f 已/d 填/v 有/vyou 扎/v 个/q 记录/n 时/ng ，/wd 查找/v 不/d 成功/a 的/ude1 平均/ad 查找/v 长度/n 为/v 
　　由于/p 哈希表/n 中/f 扎/v 个/q 记录/n 是/vshi 先后/d 填/v 入/v 的/ude1 ，/wd 查找/v 每/rz 一个/mq 记录所需/n 比较/vn 次数/n 的/ude1 期望值/n ，/wd 恰/d 为/v 填/v 入/v 此记录/n 时/ng 找/v 到/v 此/rzs 哈希/n 地址/n 时/ng 所/usuo 进行/vx 的/ude1 比较/vn 次数/n 的/ude1 期望值/n 。/wj 因此/c ，/wd 对/p 表/n 长/ad 为/v m/x 、/wn 记录/v 数/n 为/v ，/wd z/x 的/ude1 哈希表/n ，/wd 查找/v 成功/a 时/ng 的/ude1 平均/ad 查找/v 长度/n 为/v 
　　    s/x 。/wj =∑PiCi=∑PiU/x ；/wf 
设/v 对/p 挖/v 个/q 记录/n 的/ude1 查找/vn 概率/n 相等/vi 。/wj 即/v 户/q ；/wf =÷/m 则/q 
    从/p 以上/f 分析/v 可见/c ，/wd 哈希表/n 的/ude1 平均/ad 查找/v 长度/n 是/vshi a/x 的/ude1 函数/n ，/wd 而/cc 不/d 是/vshi ，/wd z/x 的/ude1 函数/n 。/wj 由此/d ，/wd 不管/c n/x 多/m 大/a ，/wd 我们/rr 总/d 可以/v 选择/v 一个/mq 合适/a 的/ude1 装填/v 因子/n 以便/d 将/d 平均/ad 查找/v 长度/n 限定/v 在/p 一个/mq 范围/n 内/f 。/wj 
    值得/v 提醒/v 的/ude1 是/vshi ，/wd 若/c 要/v 在/p 非/b 链/ng 地址/n 处理/vn 冲突/vn 的/ude1 哈希表/n 中/f 删除/v 一个/mq 记录/n ，/wd 则/c 需/v 在/p 该/rz 记录/n 的/ude1 位置/n 上/f 填/v 入/v 一个/mq 特殊/a 的/ude1 符号/n ，/wd 以免/c 找/v 不到/v 在/p 它/rr 之后/f 填/v 入/v 的/ude1 “/wyz 同义词/n ”/wyy 的/ude1 记录/n 。/wj 
    最后/f 要/v 说明/v 的/ude1 是/vshi ，/wd 对于/p 预先/d 知道/v 且/c 规模/n 不/d 大/a 的/ude1 关键字/n 集/vg ，/wd 有时/d 也/d 可以/v 找到/v 不/d 发生/v 冲突/vn 的/ude1 哈希函数/n ，/wd 因此/c ，/wd 对/p 频繁/ad 进行/vx 查找/vn 的/ude1 关键字/n 集/vg ，/wd 还是/c 应/v 尽力/d 设计/v 一个/mq 完美/a 的/ude1 (/wkz perfect/x )/wky 的/ude1 哈希函数/n 。/wj 例如/v ，/wd 对/p PASCAI/x 。/wj 语言/n 中/f 的/ude1 26/m 个/q 保留字/n 可/v 设定/v 下/f 述/vg 无/v 冲突/vn 的/ude1 哈希函数/n 
    H/x (/wkz key/x )/wky =L+g/x (/wkz key/x [/wkz 1/m ]/wky )/wky +g/x (/wkz key/x [/wkz L/x ]/wky )/wky     (/wkz 9．34/m )/wky 
其中/rz L/x 为/p 保留字/n 长度/n ，/wd key/x [/wkz 1/m ]/wky 为/p 第一/m 个/q 字符/n ，/wd key/x [/wkz L/x ]/wky 为/p 最后/f 一个/mq 字符/n ，/wd g/x (/wkz x/x )/wky 为/v 从/p 字符/n 到/v 数字/n 的/ude1 转换/vn 函数/n ，/wd 例如/v g/x [/wkz F/x ]/wky =15/m ，/wd g/x (/wkz N/x )/wky =13/m ，/wd H/x (/wkz F15NCTION/x )/wky ：/wp 8+15+13=36/m ~/n 所得/n 哈希表/n 长度/n 为/p 37/m (/wkz 请/v 参见/v 参考书/n 目/ng [/wkz 14/m ]/wky p．327/x 一/m p．328/x )/wky 。/wj 

第10/m 章/q 内部/f 排序/vi 
  10．1/m 概/ng   述/vg 
    排序/vi (/wkz Sorting/x )/wky 是/vshi 计算机程序/n 设计/vn 中/f 的/ude1 一/m 种/q 重要/a 操作/vn ，/wd 它/rr 的/ude1 功能/n 是/vshi 将/p 一个/mq 数据/n 元素/n (/wkz 或/c 记录/v )/wky 的/ude1 任意/b 序列/n ，/wd 重新/d 排列/v 成/v 一个/mq 按/p 关键字/n 有序/a 的/ude1 序列/n 。/wj 
    从/p 第9/m 章/q 的/ude1 讨论/vn 中/f 容易/ad 看出/v ，/wd 为了/p 查找方便/n ，/wd 通常/d 希望/v 计算机/n 中/f 的/ude1 表/n 是/vshi 按/p 关键字/n 有序/a 的/ude1 。/wj 因为/p 有序/a 的/ude1 顺序/n 表/vg 可以/v 采用/v 查找效率/n 较/d 高/a 的/ude1 折半/v 查找/v 法/n ，/wd 其/rz 平均/ad 查找/v 长度/n 为/v log2/x (/wkz ，/wd z+1/x )/wky -/wp 1/m ，/wd 而/cc 无序/b 的/ude1 顺序/n 表/n 只/d 能/v 进行/vx 顺序/n 查找/v ，/wd 其/rz 平均/ad 查找/v 长度/n 为/v (/wkz n+1/x )/wky ／2/m 。/wj 又/d 如/v 建造/v 树/n 
表/n (/wkz 无论是/c 二/m 叉/n 排序/vn 树/n 或/c B．/x 树/n )/wky 的/ude1 过程/n 本身/rz 就是/v 一个/mq 排序/vi 的/ude1 过程/n 。/wj 因此/c ，/wd 学习/v 和/cc 研究/v 各种/rz 排序/vn 方法/n 是/vshi 计算机/n 工作者/n 的/ude1 重要/a 课题/n 之一/rz 。/wj 
    为了/p 便于/v 讨论/vn ，/wd 在/p 此/rzs 首先/d 要/v 对/p 排序/vi 下/f 一个/mq 确切/a 的/ude1 定义/n ：/wp 
    假设/v 含/v n/x 个/q 记录/n 的/ude1 序列/n 为/v 
    {/n R1/x ，/wd R2/x ，/wd …/ws ，/wd R/x 。/wj }/n     (/wkz 101/m )/wky 
其/rz 相应/vi 的/ude1 关键字/n 序列/n 为/v 
    {/n K1/x ，/wd K2/x ，/wd …/ws ，/wd K/x 。/wj }/n 
需/v 确定/v 1/m ，/wd 2/m ，/wd …/ws ，/wd n/x 的/ude1 一/m 种/q 排列/v p1/x ，/wd p2/x ，/wd …/ws ，/wd 户/q 。/wj ，/wd 使/v 其/rz 相应/vi 的/ude1 关键字/n 满足/v 如下/vi 的/ude1 非/b 递减/vn (/wkz 或/c 非/b 递增/vi ①/m )/wky 关系/n 
    Kp/x ，/wd ≤Kp/x ，/wd ≤/m …/ws ≤Kp/x     (/wkz 102/m )/wky 
即使/c 式/ng (/wkz 10．1/m )/wky 的/ude1 序列/n 成为/v 一个/mq 按/p 关键字/n 有序/a 的/ude1 序列/n 
    {/n Rp．/x ，/wd Rp/x ，/wd ，/wd …/ws ，/wd Rp/x }/n     (/wkz 10-3/m )/wky 
这样/rzv 一/m 种/q 操作/v 称为/v 排序/vi 。/wj 
　　上述/b 排序/vn 定义/n 中/f 的/ude1 关键/n 字/n Ki/x 可以/v 是/vshi 记录/v Ri/x (/wkz 净/a 1/m ，/wd 2/m ，/wd …/ws ，/wd n/x )/wky 的/ude1 主/ag 关键字/n ，/wd 也/d 可以/v 是/vshi 记录/v R/x ；/wf 的/ude1 次关键字/n ，/wd 甚至/d 是/vshi 若干/m 数据项/n 的/ude1 组合/vn 。/wj 若/v Ki/x 是/vshi 主/b 关键字/n ，/wd 则/c 任何/rz 一个/mq 记录/n 的/ude1 无序/b 序列/n 经/p 排序/vi 后/f 得到/v 的/ude1 结果/n 是/vshi 唯一/b 的/ude1 ；/wf 若/v Ki/x 是/vshi 次关键字/n ，/wd 则/d 排序/vi 的/ude1 结果/n 不/d 唯一/b ，/wd 因为/c 待/vi 排序/vi 的/ude1 记录/n 序列/n 中/f 可能/v 存在/v 两/m 个/q 或/c 两/m 个/q 以上/f 关键字/n 相等/vi 的/ude1 记录/n 。/wj 假设/n Ki=Ki/x (/wkz 1≤i≤/x ”/wyy ，/wd 1≤n≤n/x ，/wd i≠j/x )/wky ，/wd 且/c 在/p 排序/vi 前/f 的/ude1 序列/n 中/f Ri/x 领先/vi 于/p Ri/x (/wkz 即/v i/x </n n/x )/wky 。/wj 若/c 在/p 排序/vi 后/f 的/ude1 序列/n 中/f Ri/x 仍/d 领先/vi 于/p R/x ，/wd ，/wd 则/c 称/v 所/usuo 用/v 的/ude1 排序/vn 方法/n 是/vshi 稳定/a 的/ude1 ；/wf 反之/c ，/wd 若/c 可能/v 使/v 排序/vi 后/f 的/ude1 序列/n 中/f 尺/q i/x 领先/vi 于/p Ri/x ，/wd 则/c 称/v 所/usuo 用/v 的/ude1 排序/vn 方法/n 是/vshi 不/d 稳定/a 的/ude1 。/wj ②/m 
　　由于/c 待/vi 排序/vi 的/ude1 记录/n 数量/n 不同/a ，/wd 使得/vi 排序/vi 过程/n 中/f 涉及/v 的/ude1 存储器/n 不同/a ，/wd 可/c 将/d 排序/vi 方法/n 分为/v 两/m 大/a 类/n ：/wp 一/m 类/q 是/vshi 内部/f 排序/vi ，/wd 指/v 的/ude1 是/vshi 待/vi 排序/vi 记录/v 存放/v 在/p 计算机随机/n 存储器中进行/n 的/ude1 排序/vn 过程/n ①/m   若/c 将/d 式/k (/wkz 10-2/m )/wky 中/f 的/ude1 “/wyz ≤/m ”/wyy 号/n 改/vd 为/v “/wyz ≥/m ”/wyy 号/n 。/wj 则/c 满足/v 非/b 递增/vi 关系/n 。/wj 
②/m   对/p 不/d 稳定/a 的/ude1 排序/vn 方法/n ，/wd 只要/c 举出/v 一/m 组/q 关键字/n 的/ude1 实例/n 说明/v 它/rr 的/ude1 不/d 稳定性/n 即可/v 。/wj 
；/wf 另/rz 一/m 类/q 是/vshi 外部/f 排序/vi 。/wj 指/v 的/ude1 是/vshi 待/vi 排序/vi 记录/v 的/ude1 数量/n 很/d 大/a ，/wd 以致/c 内存/n 一/m 次/qv 不/d 能/v 容纳/v 全部/m 记录/n ，/wd 在/p 排序/vn 过程/n 中/f 尚/d 需/v 对外/vd 存/v 进行/vx 访问/vn 的/ude1 排序/vn 过程/n 。/wj 本章/nr2 先/d 集中/ad 讨论/v 内部/f 排序/vi ，/wd 将/d 在/p 下/f 一/m 章/q 中/f 讨论/v 外部/f 排序/vi 。/wj 
    内部/f 排序/vi 的/ude1 方法/n 很多/m ，/wd 但/c 就/d 其/rz 全面/a 性能/n 而言/uls ，/wd 很/d 难/ad 提出/v 一/m 种/q 被/pbei 认为/v 是/vshi 最/d 好/a 的/ude1 方法/n ，/wd 每/rz 一/m 种/q 方法/n 都/d 有/vyou 各自/rr 的/ude1 优缺点/n ，/wd 适合/v 在/p 不同/a 的/ude1 环境/n (/wkz 如/v 记录/v 的/ude1 初始/vn 排列/v 状态/n 等/udeng )/wky 下/f 使用/v 。/wj 如果/c 按/p 排序/vn 过程/n 中/b 依据/n 的/ude1 不同/a 原则/n 对/p 内部/f 排序/vi 方法/n 进行/vx 分类/vn ，/wd 则/c 大致/d 可/v 分为/v 插入/v 排序/vi 、/wn 交换/v 排序/vi 、/wn 选择/v 排序/vi 、/wn 归并/vi 排序/vi 和/cc 计数/vi 排序/vi 等/udeng 五/m 类/q ；/wf 如果/c 按/p 内部/f 排序/vi 过程/n 中/f 所/usuo 需/v 的/ude1 工作量/n 来/vf 区分/v ，/wd 则/c 可/v 分为/v 三/m 类/q ：/wp (/wkz 1/m )/wky 简单/a 的/ude1 排序/vn 方法/n ，/wd 其/rz 时间/n 复杂度/n 为/v O/x (/wkz 恕/vg 0/m )/wky ；/wf (/wkz 2/m )/wky 先进/a 的/ude1 排序/vn 方法/n ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz nlogn/x )/wky ；/wf (/wkz 3/m )/wky 基数/n 排序/vi ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz 矗/n ・/w n/x )/wky 。/wj 本章/nr2 仅/d 就/d 每/rz 一/m 类/q 介绍/v 一两/m 个/q 典型/n 算法/n ，/wd 有/vyou 兴趣/n 了解/v 更/d 多/a 算法/n 的/ude1 读者/n 可/v 阅读/v D．E．/x 克努特/nrf 著/v (/wkz 计算机程序/n 设计/vn 技巧/n >/n L2/x ]/wky (/wkz 第三/m 卷/q ，/wd 排序/vi 和/cc 查找/v )/wky 。/wj 读者/n 在/p 学习/v 本/rz 章/q 内容/n 时/ng 应/v 注意/v ，/wd 除了/p 掌握/v 算法/n 本身/rz 以外/f ，/wd 更/d 重要/a 的/ude1 是/vshi 了解/v 该/rz 算法/n 在/p 进行/vx 排序/vn 时/ng 所/usuo 依据/v 的/ude1 原则/n ，/wd 以/p 利于/v 学习/v 和/cc 创造/v 更加/d 新/a 的/ude1 算法/n 。/wj 
    通常/d ，/wd 在/p 排序/vi 的/ude1 过程/n 中/f 需/v 进行/vx 下列/b 两/m 种/q 基本/a 操作/vn ：/wp (/wkz 1/m )/wky 比较/d 两/m 个/q 关键/n 字/n 的/ude1 大小/n ；/wf (/wkz 2/m )/wky 将/d 记录/v 从/p 一个/mq 位置/n 移动/vn 至/p 另/rz 一个/mq 位置/n 。/wj 前/f 一个/mq 操作/v 对/p 大多数/m 排序/vn 方法/n 来说/uls 都/d 是/vshi 必要/a 的/ude1 ，/wd 而后/d 一个/mq 操作/v 可以/v 通过/p 改变记录/n 的/ude1 存储方式/n 来/f 予以/vx 避免/v 。/wj 待/vi 排序/vi 的/ude1 记录/n 序列/n 可/v 有/vyou 下列/b 三/m 种/q 存储方式/n ：/wp (/wkz 1/m )/wky 待/vi 排序/vi 的/ude1 一/m 组/q 记录/n 存放在/v 地址/n 连续/a 的/ude1 一/m 组/q 存储单元/n 上/f 。/wj 它/rr 类似/v 于/p 线性/n 表/n 的/ude1 顺序/n 存储/vn 结构/n ，/wd 在/p 序列/n 中/f 相邻/vi 的/ude1 两/m 个/q 记录/n Ri/x 和/cc R/x ；/wf +/m ，/wd (/wkz j=1/x ，/wd 2/m ，/wd …/ws ，/wd n-1/x )/wky ，/wd 它们/rr 的/ude1 存储位置/n 也/d 相邻/vi 。/wj 在/p 这种/r 存储方式/n 中/f ，/wd 记录/v 之间/f 的/ude1 次序/n 关系/n 由/p 其/rz 存储位置/n 决定/v ，/wd 则/c 实现/v 排序/vi 必须/d 借助移动/n 记录/n ；/wf (/wkz 2/m )/wky 一/m 组/q 待/vi 排序/vi 记录/v 存放在/v 静态/n 链/ng 表/vg ①/m 中/f ，/wd 记录/v 之间/f 的/ude1 次序/n 关系/n 由/p 指针/n 指示/n ，/wd 则/c 实现/v 排序/vi 不/d 需要/v 移动/vn 记录/n ，/wd 仅/d 需/v 修改/v 指针/n 即可/v ；/wf (/wkz 3/m )/wky 待/vi 排序/vi 记录/v 本身/rz 存储/vn 在/p 一/m 组/q 地址/n 连续/a 的/ude1 存储单元/n 内/f ，/wd 同时/c 另/d 设/v 一个/mq 指示/n 各个/rz 记录/n 存储位置/n 的/ude1 地址/n 向量/n ，/wd 在/p 排序/vn 过程/n 中/f 不/d 移动/v 记录/v 本身/rz ，/wd 而/cc 移动/vn 地址/n 向量/n 中/f 这些/rz 记录/n 的/ude1 “/wyz 地址/n ”/wyy ，/wd 在/p 排序/vi 结束/v 之后/f 再/d 按照/p 地址/n 向量/n 中/f 的/ude1 值/n 调整记录/n 的/ude1 存储位置/n 。/wj 在/p 第二/m 种/q 存储方式/n 下/f 实现/v 的/ude1 排序/vn 又/d 称/v (/wkz 链/ng )/wky 表排序/n ，/wd 在/p 第三/m 种/q 存储方式/n 下/f 实现/v 的/ude1 排序/vn 又/d 称/v 地址/n 排序/vi 。/wj 在/p 本/rz 章/n 的/ude1 讨论/vn 中/f ，/wd 设/v 待/vi 排序/vi 的/ude1 一/m 组/q 记录/n 以/p 上述/b 第一/m 种/q 方式/n 存储/vn ，/wd 且/c 为/v 了/ule 讨论/v 方便/v 起见/u ，/wd 设/v 记录/v 的/ude1 关键/n 字/n 均/d 为/v 整数/n 。/wj 即/v 在/p 以后/f 讨论/v 的/ude1 大部分/m 算法/n 中/f ，/wd 待/vi 排/v 记录/v 的/ude1 数据/n 类型/n 设/v 为/v ：/wp 
#/n defin・/x   MAXSIZE/x   20/m 
type4ef/x  int/x  KeyType/x ；/wf 
t/x ~/n mN／ef/x  struct/x {/n 
  KefOype/x  key/x ；/wf 
  InfoType/x  otherinfo/x ；/wf 
}/n R/x ~/n mme/x ；/wf 
∥/w 一个/mq 用作/v 示例/n 的/ude1 小/a 顺序/n 表/n 的/ude1 最/d 大/a 长度/n 
∥/w 定义/n 关键字类型/n 为/p 整数/n 类型/n 
∥/w 关键字项/n 
∥/w 其它/rz 数据项/n 
∥/w 记录/v 类型/n 
typedef/x  struc％/x {/n 
  RedType/x  r/x [/wkz MAXsIZE+1/x ]/wky ；/wf   ∥/w r/x [/wkz 0/m ]/wky 闲置/vi 或/c 用作/v 哨兵/n 单元/n 
  int/x  length/x ；/wf     ∥/w 顺序/n 表/vg 长度/n 
}/n SqList/x ；/wf     ∥/w 顺序/n 表/vg 类型/n 
    ①/m   因为/c 在/p 排序/vn 过程/n 中/f ，/wd 只/d 是/vshi 改变记录/n 之间/f 的/ude1 次序/n 关系/n 。/wj 而/cc 不/d 进行/vx 插入/v 、/wn 删除/v 操作/vn ，/wd 且/c 在/p 排序/vi 结束/v 时/ng 尚/d 需/v 调整记录/n ，/wd 故/c 采用/v 静态/n 链/ng 表/n 。/wj 
10．2/m 插入/v 排序/vi 
  lO．2．1/x 直接/ad 插/v 人/n 排序/vi 
  直接/ad 插/v 人/n 排序/vi (/wkz Straight/x  Insertion/x  Sort/x )/wky 是/vshi 一/m 种/q 最/d 简单/a 的/ude1 排序/vn 方法/n ，/wd 它/rr 的/ude1 基本/a 操作/vn 是/vshi 将/p 一个/mq 记录/n 插入/v 到/v 已/d 排/v 好/a 序/n 的/ude1 有序/a 表/n 中/f ，/wd 从而/c 得到/v 一个/mq 新/a 的/ude1 、/wn 记录/v 数/n 增/v 1/m 的/ude1 有序/a 表/n 。/wj 
    例如/v ，/wd 已/d 知/v 待/vi 排序/vi 的/ude1 一/m 组/q 记录/n 的/ude1 初始/vn 排列/v 如下/vi 所/usuo 示/vg ：/wp ①/m 
    R/x (/wkz 49/m )/wky ，/wd R/x (/wkz 38/m )/wky ，/wd R/x (/wkz 65/m )/wky ，/wd R/x (/wkz 97/m )/wky ，/wd R/x (/wkz 76/m )/wky ，/wd R/x (/wkz 13/m )/wky ，/wd R/x (/wkz 27/m )/wky ，/wd R/x (/wkz 49/m )/wky ，/wd …/ws     (/wkz 10―4/m )/wky 
假设/v 在/p 排序/vn 过程/n 中/f ，/wd 前/f 4/m 个/q 记录/n 已/d 按/p 关键字/n 递增/vi 的/ude1 次序/n 重新/d 排列/v ，/wd 构成/v 一个/mq 含/v 4/m 个/q 记录/n 的/ude1 有序/a 序列/n 
    {/n R/x (/wkz 38/m )/wky ，/wd R/x (/wkz 49/m )/wky ，/wd R/x (/wkz 65/m )/wky ，/wd R/x (/wkz 97/m )/wky I/x     (/wkz 10-5/m )/wky 
现/tg 要/v 将/d 式/k (/wkz 10．4/m )/wky 中/f 第5/m 个/q (/wkz 即/v 关键字/n 为/p 76/m 的/ude1 )/wky 记录/v 插入/v 上述/b 序列/n ，/wd 以/p 得到/v 一个/mq 新/a 的/ude1 含/v 5/m 个/q 记录/n 的/ude1 有序/a 序列/n ，/wd 则/c 首先/d 要/v 在/p 式/k (/wkz 10．5/m )/wky 的/ude1 序列/n 中/f 进行/vx 查找/vn 以/p 确定/v R/x (/wkz 76/m )/wky 所/usuo 应/v 插入/v 的/ude1 位置/n ，/wd 然后/c 进行/vx 插入/v 。/wj 假设/v 从/p R/x (/wkz 97/m )/wky 起/f 向/p 左/f 进行/vx 顺序/n 查找/v ，/wd 由于/c 65/m </n 76/m </n 97/m ，/wd 则/d R/x (/wkz 76/m )/wky 应/v 插入/v 在/p R/x (/wkz 65/m )/wky 和/cc R/x (/wkz 97/m )/wky 之间/f ，/wd 从而/c 得到/v 下列/b 新/a 的/ude1 有序/a 序列/n 
    {/n R/x (/wkz 38/m )/wky ，/wd R/x (/wkz 49/m )/wky ，/wd R/x (/wkz 65/m )/wky ，/wd R/x (/wkz 76/m )/wky ，/wd R/x (/wkz 97/m )/wky }/n     (/wkz 106/m )/wky 
称/v 从/p 式/k (/wkz 10．5/m )/wky 到/v 式/k (/wkz 10/m ，/wd 6/m )/wky 的/ude1 过程/n 为/p 一/m 趟/qv 直接/ad 插入/v 排序/vi 。/wj 一般/a 情况/n 下/f ，/wd 第/m i/x 趟/qv 直接/ad 插入/v 排序/vi 的/ude1 操作/vn 为/v ：/wp 在/p 含有/v i-1/x 个/q 记录/n 的/ude1 有序/a 子/ng 序列/n r/x [/wkz 1．．/m 卜/vg 1/m ]/wky ⑦/m 中/f 插入/v 一个/mq 记录/n r/x [/wkz i/x ]/wky 后/f ，/wd 变成/v 含有/v i/x 个/q 记录/n 的/ude1 有序/a 子/ng 序列/n r/x [/wkz 1．．i/x ]/wky ；/wf 并且/c ，/wd 和/cc 顺序/n 查找/v 类似/a ，/wd 为了/p 在/p 查找/v 插入/v 位置/n 的/ude1 过程/n 中/f 避免/v 数组/n 下标/n 出界/vi ，/wd 在/p r/x [/wkz O/x ]/wky 处/n 设置/vn 监视哨/n 。/wj 在/p 自/p i-1/x 起/f 往/p 前/f 搜索/v 的/ude1 过程/n 中/f ，/wd 可以/v 同时/n 后移/vn 记录/n 。/wj 整个/b 排序/vn 过程/n 为/v 进行/vx 孢/n -/wp 1/m 趟/qv 插入/v ，/wd 即/v ：/wp 先/d 将/p 序列/n 中/f 的/ude1 第1/m 个/q 记录/n 看成/v 是/vshi 一个/mq 有序/a 的/ude1 子/ng 序列/n ，/wd 然后/c 从/p 第2/m 个/q 记录/n 起/vf 逐个/d 进行/vx 插入/v ，/wd 直至/v 整个/b 序列/n 变成/v 按/p 关键字/n 非/b 递减/vi 有序/a 序列/n 为止/u 。/wj 其/rz 算法/n 如/v 算法/n 10．1/m 所/usuo 示/vg ：/wp 
    void/x  InsertSort/x (/wkz &/n 扣/v ist/x ＆/n L/x )/wky {/n 
    ∥/w 对/p 顺序/n 表/n L/x 作/v 直接/ad 插入/v 排序/vi 。/wj 
    for/x (/wkz i=2/x ；/wf i/x </n =L．1engeh/x ；/wf ++i/x )/wky 
    if/x  LT/x (/wkz L．r/x [/wkz i/x ]/wky ．/w key/x 。/wj L．r/x [/wkz i-1/x ]/wky ．/w key/x )/wky i/x     ∥/w “/wyz </n ”/wyy ，/wd 需/v 将/d L．r/x 【/wkz i/x ]/wky 插入/v 有序/a 子/ng 表/n 
    L．r/x [/wkz 0/m ]/wky =L．r/x [/wkz i/x ]/wky ；/wf     ∥/w 复制/v 为/p 哨兵/n 
    for/x (/wkz j=il/x ；/wf LT/x (/wkz r．．r/x [/wkz 0/m ]/wky ．/w key/x ，/wd L．r/x [/wkz j/x ]/wky ．/w key/x )/wky ；/wf   j/x )/wky 
    L．rfj+1/x ]/wky =L．r/x [/wkz j/x ]/wky ；/wf     ∥/w 记录/v 后移/vn 
    L．r/x [/wkz j+1/x ]/wky =L．r/x [/wkz 0/m ]/wky ；/wf     ∥/w 插入/v 到/v 正确/a 位置/n 
    I/x 
    }/n ∥/w InsettSort/x 
    算法/n 10．1/m 
    以/p 式/k (/wkz 10―4/m )/wky 中/f 关键字/n 为/p 例/n ，/wd 按照/p 算法/n 10．1/m 进行/vx 直接/ad 插入/v 排序/vi 的/ude1 过程/n 如/v 图/n 10．1/m 
所/usuo 示/vg 。/wj ④/m 
①/m   R/x (/wkz x/x )/wky 表示/v 关键字/n 为/v x/x 的/ude1 记录/n ，/wd 以下/f 同/v 。/wj 
⑦/m r/x [/wkz 1．．I/x _/n 1/m ]/wky 表示/v 参与/v 排序/vi 的/ude1 顺序/n 表/vg 中/b 下标/n 从/p l/x 到/v i―l/x 的/ude1 记录/n 序列/n ，/wd 以后/f 同/v 。/wj 
③/m   为/p 简便/a 起见/u ，/wd 图/n 中/f 省略/v 记录/v R/x 的/ude1 符号/n ，/wd 而/cc 只/d 列/v 其/rz 关键/n 宇/ng 。/wj 
・/w 265・/m 
[/wkz 初始/b 关键字/n ]/wky ：/wp (/wkz 49/m )/wky 38/m   65/m   97/m   76/m   13/m   27/m   49/m 
    t/x 监视哨/n L．r/x [/wkz O/x ]/wky 
    图/n 10．1/m 直接/ad 插入/v 排序/vn 示例/n 
　　从/p 上面/f 的/ude1 叙述/vn 可见/c ，/wd 直接/ad 插入/v 排序/vi 的/ude1 算法/n 简洁/a ，/wd 容易/ad 实现/v ，/wd 那么/c 它/rr 的/ude1 效率/n 如何/ryv 呢/y ?/ww 
　　从/p 空间/n 来看/u ，/wd 它/rr 只/d 需要/v 一个/mq 记录/n 的/ude1 辅助/vn 空间/n ，/wd 从/p 时间/n 来/vf 看/v ，/wd 排序/vi 的/ude1 基本/ad 操作/v 为/v ：/wp 比较/v 两/m 个/q 关键/n 字/n 的/ude1 大小/n 和/cc 移动/vn 记录/n 。/wj 先/d 分析/v 一/m 趟/qv 插入/v 排序/vi 的/ude1 情况/n 。/wj 算法/n 10．1/m 中/f 里/f 层/qv 的/ude1 for/x 循环/vn 的/ude1 次数/n 取决于/v 待/vi 插/v 记录/v 的/ude1 关键/n 字/n 与/p 前/f i-1/x 个/q 记录/n 的/ude1 关键/n 字/n 之间/f 的/ude1 关系/n 。/wj 若/v L．r/x [/wkz i/x ]/wky ．/w key/x >/n L．r/x [/wkz i-1/x ]/wky ．/w key/x ，/wd 则/c 内/f 循环/vn 只/d 进行/vx 一/m 次关键字/n 间/f 的/ude1 比较/vn ，/wd 而/cc 不/d 移动/v 记录/v ；/wf 若/v L．r/x [/wkz ikey/x </n L．r/x [/wkz 1/m ]/wky ．/w key/x ，/wd 则/c 内/f 循环/vn 中/f ，/wd 待/vi 插/v 记录/v 的/ude1 关键字/n 需/v 与/p 有序/a 子/ng 序列/n L．r/x [/wkz 1．．i-1/x ]/wky 中/f i-1/x 个/q 记录/n 的/ude1 关键/n 字/n 和/cc 监视哨/n 中/f 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 并/cc 将/d L．r/x [/wkz 1．．i-1/x ]/wky 中/f i-1/x 个/q 记录/n 后移/vn 。/wj 则/c 在/p 整个/b 排序/vn 过程/n (/wkz 进行/vn ，/wd z―l/x 趟/qv 插入/v 排序/vi )/wky 中/f ，/wd 当/p 待/vi 排/v 序列/n 中/f 记录/v 按/p 关键字/n 非/b 递减/vn 有序/ad 排列/v (/wkz 以下/f 称之为/v “/wyz 正/b 序/n ”/wyy )/wky 时/ng ，/wd 所/usuo 需/v 进行/vx 关键字/n 间/f 比较/v 的/ude1 次数/n 达/v 最/d 小/a 值/n 竹/ng -/wp 1/m (/wkz 即/v ∑1/m )/wky ，/wd 记录/v 不/d 需/v 移动/vn ；/wf 反之/c ，/wd 当/p 待/vi 排/v 序列/n 中/f 记录/v 按/p 关键字/n 非/b 递增/vi 有序/ad 排列/v (/wkz 以下/f 称之为/v “/wyz 逆/vg 序/n ”/wyy )/wky 时/ng ，/wd 总/b 的/ude1 比较/vn 次数/n 达/v 最/d 大值/n (/wkz 扎/v +2/m )/wky (/wkz n-1/x )/wky ／2/m (/wkz 即/v ∑i/x )/wky ，/wd 记录移动/n 的/ude1 次数/n 也/d 达/v 最/d 大值/n (/wkz n+4/x )/wky -/wp 1/m )/wky ／2/m (/wkz 即/v ∑/m (/wkz f+1/x )/wky )/wky 。/wj 若/c 待/vi 排序/vi 记录/v 是/vshi 随机/b 的/ude1 ，/wd 即/d 待/vi 排/v 序列/n 中/f 的/ude1 记录/n 可能/v 出现/v 的/ude1 各种/rz 排列/v 的/ude1 概率/n 相同/a ，/wd 则/c 我们/rr 可取/v 上述/b 最/d 小/a 值/n 和/cc 最/d 大值/n 的/ude1 平均值/n ，/wd 作为/v 直接/ad 插入/v 排序/vi 时/ng 所/usuo 需/v 进行/vx 关键字/n 间/f 的/ude1 比较/vn 次数/n 和/cc 移动/vn 记录/n 的/ude1 次数/n ，/wd 约/d 为/v 扎/v 。/wj ／4/m 。/wj 由此/d ，/wd 直接/ad 插入/v 排序/vi 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz 凡/d 0/m )/wky 。/wj 
10．2．2/m 其它/rz 插/v 人/n 排序/vi 
    从/p 上/f 一/m 节/q 的/ude1 讨论/vn 中/f 可见/v ，/wd 直接/ad 插入/v 排序/vn 算法/n 简便/a ，/wd 且/c 容易/ad 实现/v 。/wj 当/p 待/vi 排序/vi 记录/v 的/ude1 数量/n n/x 很/d 小时/n ，/wd 这/rzv 是/vshi 一/m 种/q 很/d 好/a 的/ude1 排序/vn 方法/n 。/wj 但是/c ，/wd 通常/d 待/vi 排序/vi 序列/n 中/f 的/ude1 记录/n 数量/n n/x 很/d 大/a ，/wd 则/c 不宜/v 采用/v 直接/ad 插入/v 排序/vi 。/wj 由此/d 需要/v 讨论/v 改进/v 的/ude1 办法/n 。/wj 在/p 直接/ad 插入/v 排序/vi 的/ude1 基础/n 上/f ，/wd 从/p 减少/v “/wyz 比较/d ”/wyy 和/cc “/wyz 移动/vn ”/wyy 这/rzv 两/m 种/q 操作/vn 的/ude1 次数/n 着眼/vi ，/wd 可/v 得/ude3 下列/b 各种/rz 插入/v 排序/vi 的/ude1 方法/n 。/wj 
  一/m 、/wn 折半/v 插入/v 排序/vi 
  由于/c 插入/v 排序/vi 的/ude1 基本/a 操作/vn 是/vshi 在/p 一个/mq 有序/a 表/n 中/f 进行/vx 查找/vn 和/cc 插入/v ，/wd 则/c 从/p 9．1/m 节/q 的/ude1 讨论/vn 中/f 可知/v ，/wd 这个/rz “/wyz 查找/v ”/wyy 操作/v 可/v 利用/v “/wyz 折半/v 查找/v ”/wyy 来/f 实现/v ，/wd 由/p 此/rzs 进行/vx 的/ude1 插入/v 排序/vi 称之为/v 折半/v 插入/v 排序/vi (/wkz Binary/x  Insertion/x  Sort/x )/wky ，/wd 其/rz 算法/n 如/v 算法/n 10．2/m 所/usuo 示/vg 。/wj 
void/x  BInsertSort/x (/wkz SqList/x &/n L/x )/wky {/n 
  ∥/w 对/p 顺序/n 表/n L/x 作/v 折半/v 插入/v 排序/vi 。/wj 
  for/x (/wkz i=2/x ；/wf i/x </n =L．1ength/x ；/wf ++i/x )/wky {/n     ‘/wyz 
    L．r/x [/wkz 0/m ]/wky =L．r/x [/wkz i/x ]/wky ；/wf     ∥/w 将/d L．r/x [/wkz i/x ]/wky 暂/d 存/v 到/v L．r/x [/wkz 0/m ]/wky 
    low=1：high=i-1/x ；/wf 
    ．/w h1．1・/x (/wkz 10w/x </n =high/x )/wky {/n     ∥/w 在/p r/x [/wkz 10w．．high/x ]/wky 中/f 折半/v 查找/v 有序/ad 插入/v 的/ude1 位置/n 
    m=/x (/wkz 10w+high/x )/wky ／2/m ；/wf     ∥/w 折半/v 
    if/x  Lr/x (/wkz L．r/x [/wkz 0/m ]/wky ．/w key/x ，/wd L．r/x [/wkz m/x ]/wky ．/w key/x )/wky high=m-1/x ；/wf     ∥/w 插入/v 点/qt 在/p 低/a 半/m 区/n 
    else/x  low=m+1：/x     ∥/w 插入/v 点/qt 在/p 高/a 半/m 区/n 
    }/n ∥/w while/x 
    ~/n or/x (/wkz j=i-1/x ；/wf j/x >/n =high+1/x ；/wf  j/x )/wky L．dj+1/x ]/wky =L．r/x [/wkz j/x ]/wky ；/wf     ∥/w 记录/v 后移/vn 
    L．r/x [/wkz high+1/x ]/wky =L．r/x [/wkz 0/m ]/wky ；/wf     ∥/w 插入/v 
  I/x ∥/w for・/x 
}/n ∥/w BIrmertSozlt/x 
    算法/n lO．2/x 
    从/p 算法/n 10．2/m 容易/ad 看出/v ，/wd 折半/v 插入/v 排序/vi 所/usuo 需/v 附加/vn 存储空间/n 和/cc 直接/ad 插入/v 排序/vi 相同/a ，/wd 从/p 时间/n 上/f 比较/d ，/wd 折半/v 插入/v 排序/vi 仅/d 减少/v 了/ule 关键字/n 间/f 的/ude1 比较/vn 次数/n ，/wd 而/cc 记录/n 的/ude1 移动/vn 次数/n 不/d 变/v 。/wj 因此/c ，/wd 折半/v 插入/v 排序/vi 的/ude1 时间/n 复杂度/n 仍/d 为/v O/x (/wkz ，/wd z/x 。/wj )/wky 。/wj 
  二/m 、/wn 2．/m 路/qv 插入/v 排序/vi 
  2．/m 路/qv 插/v 人/n 排序/vn 是/vshi 在/p 折半/v 插入/v 排序/vi 的/ude1 基础/n 上/f 再/d 改进/v 之/uzhi ，/wd 其/rz 目的/n 是/vshi 减少/v 排序/vn 过程/n 中/b 移动/vn 记录/n 的/ude1 次数/n ，/wd 但/c 为/p 此/rzs 需要/v ”/wyy 个/q 记录/n 的/ude1 辅助/vn 空间/n 。/wj 具体/a 做法/n 是/vshi ：/wp 另/d 设/v 一个/mq 和/cc L．r/x 同/p 类型/n 的/ude1 数组/n d/x ，/wd 首先/c 将/d L．r/x [/wkz 1/m ]/wky 赋值/v 给/v d/x [/wkz 1/m ]/wky ，/wd 并/cc 将/d d/x [/wkz 1/m ]/wky 看成/v 是/vshi 在/p 排/v 好/a 序/n 的/ude1 序列/n 中/f 处于/v 中间/f 位置/n 的/ude1 记录/n ，/wd 然后/c 从/p L．r/x 中/f 第2/m 个/q 记录/n 起/vf 依次/d 插入/v 到/v d/x [/wkz 1/m ]/wky 之前/f 或/c 之后/f 的/ude1 有序/a 序列/n 中/f 。/wj 先/d 将/d 待/vi 插/v 记录/v 的/ude1 关键/n 字/n 和/cc d/x [/wkz 1/m ]/wky 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 若/c L．r/x [/wkz i/x ]/wky ．/w key/x </n d/x [/wkz 1/m ]/wky ．/w key/x ，/wd 则/c 将/d L．r/x [/wkz i/x ]/wky 插入/v 到/v d/x 【/wkz 1/m ]/wky 之前/f 的/ude1 有序/a 表/n 中/f 。/wj 反之/c ，/wd 则/c 将/d L/x _/n r/x [/wkz i/x ]/wky 插入/v 到/v d/x [/wkz 1/m ]/wky 之后/f 的/ude1 有序/a 表/n 中/f 。/wj 在/p 实现/v 算法/n 时/ng ，/wd 可/c 将/d d/x 看成/v 是/vshi 一个/mq 循环/vn 向量/n ，/wd 并/cc 设/v 两/m 个/q 指针/n first/x 和/cc final/x 分别/d 指示/v 排序/vn 过程/n 中/f 得到/v 的/ude1 有序/a 序列/n 中/f 的/ude1 第一/m 个/q 记录/n 和/cc 最后/f 一个/mq 记录/n 在/p d/x 中/f 的/ude1 位置/n 。/wj 具体/a 算法/n 留作/n 习题/n 由/p 读者/n 自己/rr 写/v 出/vf 。/wj 
   仍/d 以/p 式/k (/wkz 10．4/m )/wky 中/f 的/ude1 关键/n 字/n 为/p 例/n ，/wd 进行/vx 2．/m 路/qv 插入/v 排序/vi 的/ude1 过程/n 如/v 图/n 10．2/m 所/usuo 示/vg 。/wj 
    [/wkz 初始/b 关键字/n ]/wky ：/wp   49/m   38/m   65/m   97/m   76/m   13/m   27/m 药/n 
    排序/vn 过程/n 中/f d/x 的/ude1 状态/n 如下/vi ：/wp 
i=1：/x     (/wkz 49/m )/wky 
    first/x 十十/m final/x 
i=2：/x 
i：3：/x 
i：4：/x 
(/wkz 49/m )/wky 
+final/x 
(/wkz 49/m  65/m )/wky 
    +final/x 
(/wkz 49/m  65/m  97/m )/wky 
    ^/n final/x 
(/wkz 38/m )/wky 
▲/w first/x 
(/wkz 38/m )/wky 
十/m first/x 
(/wkz 38/m )/wky 
+first/x 
    ・/w 267・/m 
i=5/x 
i=6/x 
i=7/x 
(/wkz 49/m  65/m  76/m  97/m )/wky 
    ^/n final/x 
(/wkz 49/m  65/m  76/m  97/m )/wky 
    +final/x 
(/wkz 49/m  65/m  76/m  97/m )/wky 
    ▲/w final/x 
    (/wkz 38/m )/wky 
    ▲/w first/x 
(/wkz 13/m  38/m )/wky 
+first/x 
(/wkz 13/m  27/m  38/m )/wky 
+first/x 
    i=8：/x (/wkz 49/m  49/m  65/m  76/m  97/m   13/m   27/m   38/m )/wky 
    +final+first/x 
    图/n 10．2/m  2/m 一路/mq 插入/v 排序/vn 示例/n 
    在/p 2．/m 路/qv 插入/v 排序/vi 中/f ，/wd 移动/vn 记录/n 的/ude1 次数/n 约/d 为/v n/x 。/wj ／8/m 。/wj 因此/c ，/wd 2．/m 路/qv 插入/v 排序/vi 只/d 能/v 减少移动/n 
记录/v 的/ude1 次数/n ，/wd 而/cc 不/d 能/v 绝对/d 避免/v 移动/vn 记录/n 。/wj 并且/c ，/wd 当/v L．r/x [/wkz 1/m ]/wky 是/vshi 待/vi 排序/vi 记录/v 中/b 关键字/n 最/d 小/a 或/c 最/d 大/a 的/ude1 记录/n 时/ng ，/wd 2．/m 路/qv 插入/v 排序/vi 就/d 完全/ad 失去/v 它/rr 的/ude1 优越性/n 。/wj 因此/c ，/wd 若/c 希望/v 在/p 排序/vn 过程/n 中/f 不/d 移动/v 记录/v ，/wd 只有/c 改变存储/n 结构/n ，/wd 进行/vx 表/n 插入/v 排序/vi 。/wj 
  三/m 、/wn 表/n 插入/v 排序/vi 
#/n d．/x |/n fin・SIZE/x  100/m 
t/x '/n rP：n/x |/n ct/x  I/x 
  RcdI/x ，/wd pe/x   re/x ；/wf 
  ilIt/x     next：/x 
}/n s/x 【/wkz Node/x ；/wf 
td．z1Ict/x {/n 
  S/x ~/n ode/x  r/x [/wkz SIZ/x ~/n ]/wky ；/wf 
  inth/x ；/wf 
lSL/x ~/n istType/x ；/wf 
∥/w 静态/n 链/ng 表/vg 容量/n 
∥/w 记录项/n 
}/n }/n ∥/w 表/n 结点/n 类型/n 
∥/w 0/m 号/q 单元/n 为/p 表头/n 结点/n 
∥/w 链/ng 表/n 当前/t 长度/n 
∥/w 静态/n 链/ng 表/vg 类型/n 
    假设/v 以/p 上述/b 说明/vn 的/ude1 静态/n 链/ng 表/vg 类型/n 作为/v 待/vi 排/v 记录/v 序列/n 的/ude1 存储/vn 结构/n ，/wd 并且/c ，/wd 为了/p 插入/v 方便/v 起见/u ，/wd 设/v 数组/n 中下/f 标/v 为/v “/wyz 0/m ”/wyy 的/ude1 分量/n 为/p 表头/n 结点/n ，/wd 并/cc 令/v 表头/n 结点/n 记录/v 的/ude1 关键字/n 取/v 最/d 大/a 整数/n MAXINT/x 。/wj 则/c 表/n 插入/v 排序/vi 的/ude1 过程/n 描述/v 如下/vi ：/wp 首先/d 将/p 静态/n 链/ng 表/vg 中/b 数组/n 下标/n 为/v “/wyz 1/m ”/wyy 的/ude1 分量/n (/wkz 结点/n )/wky 和/cc 表头/n 结点/n 构成/v 一个/mq 循环/vn 链/ng 表/n ，/wd 然后/c 依次/d 将/p 下标/n 为/v “/wyz 2/m ”/wyy 至/p “/wyz n/x ”/wyy 的/ude1 分量/n (/wkz 结点/n )/wky 按/p 记录/v 关键字/n 非/b 递减/vn 有序/ad 插入/v 到/v 循环/vn 链/ng 表/n 中/f 。/wj 仍/d 以/p 式/k (/wkz 10―4/m )/wky 中/f 的/ude1 关键/n 字/n 为/p 例/n ，/wd 表/vg 插入/v 排序/vi 的/ude1 过程/n 如/v 图/n 10．3/m 所/usuo 示/vg (/wkz 图/n 中/f 省略/v 记录/v 的/ude1 其它/rz 数据项/n )/wky 。/wj 
i=2/x 
key/x 域/n 
next/x 域/n 
i=8/x 
MAXINT/x  l/x  49/m  I/x  38/m  I/x  65/m  I/x  97/m  I/x  76/m  1/m  13/m  I/x  27/m 
    图/n 10．3/m 表/n 插入/v 排序/vn 示例/n 
    从/p 表/n 插入/v 排序/vi 的/ude1 过程/n 可见/c ，/wd 表/vg 插入/v 排序/vi 的/ude1 基本/a 操作/vn 仍/d 是/vshi 将/p 一个/mq 记录/n 插入/v 到/v 已/d 排/v 好/a 序/n 的/ude1 有序/a 表/n 中/f 。/wj 和/cc 直接/ad 插入/v 排序/vi 相比/vi ，/wd 不同/a 之/uzhi 处/n 仅/d 是/vshi 以/p 修改/v 2/m ，/wd z/x 次/qv 指针/n 值/v 代替/v 移动/vn 记录/n ，/wd 排序/vn 过程/n 中/f 所/usuo 需/v 进行/vx 的/ude1 关键/n 字/n 间/f 的/ude1 比较/vn 次数/n 相同/a 。/wj 因此/c ，/wd 表/vg 插入/v 排序/vi 的/ude1 时间/n 复杂度/n 仍/d 是/vshi 0/m (/wkz n/x 。/wj )/wky 。/wj 
    另一方面/c ，/wd 表/vg 插入/v 排序/vi 的/ude1 结果/n 只/d 是/vshi 求得/v 一个/mq 有序/a 链/ng 表/n ，/wd 则/c 只/d 能/v 对/p 它/rr 进行/vx 顺序/n 查找/v ，/wd 不/d 能/v 进行/vx 随机/d 查找/v ，/wd 为了/p 能/v 实现/v 有序/a 表/n 的/ude1 折半/v 查找/v ，/wd 尚/d 需/v 对/p 记录/n 进行/vx 重新/d 排列/v 。/wj 
    重排/v 记录/v 的/ude1 做法/n 是/vshi ：/wp 顺序/n 扫描/v 有序/a 链/ng 表/n ，/wd 将/d 链/ng 表/n 中/f 第/m i/x 个/q 结点/n 移动/v 至/p 数组/n 的/ude1 第/m i/x 个/q 分量/n 中/f 。/wj 例如/v ，/wd 图/n 10．4/m (/wkz a/x )/wky 是/vshi 经/p 表/n 插入/v 排序/vi 后/f 得到/v 的/ude1 有序/a 链/ng 表/n SL/x 。/wj 根据/p 头/n 结点/n 中/f 指针/n 域/ng 的/ude1 指示/n ，/wd 链/ng 表/n 的/ude1 第一/m 个/q 结点/n ，/wd 即/v 关键字/n 最/d 小/a 的/ude1 结点/n 是/vshi 数组/n 中下/f 标/v 为/p 6/m 的/ude1 分量/n ，/wd 其中/rz 记录/n 应/v 移/v 至/p 数组/n 的/ude1 第一/m 个/q 分量/n 中/f ，/wd 则/c 将/d SL．r/x [/wkz 1/m ]/wky 和/cc SL．r/x [/wkz 6/m ]/wky 互换/v ，/wd 并且/c 为了/p 不/d 中断/v 静态/n 链/ng 表/n 中/f 的/ude1 “/wyz 链/ng ”/wyy ，/wd 即/d 在/p 继续/v 顺/v 链/ng 扫描/v 时/ng 仍/d 能/v 找到/v 互换/v 之前/f 在/p SL/x _/n r/x [/wkz 1/m ]/wky 中/f 的/ude1 结点/n ，/wd 令/v 互换/v 之后/f 的/ude1 SL．r/x [/wkz 1/m ]/wky 中/f 指针/n 域/ng 的/ude1 值/n 改/vd 为/v “/wyz 6/m ”/wyy (/wkz 见/v 图/n 10．4/m (/wkz b/x )/wky )/wky 。/wj 推广/v 至/p 一般/a 情况/n ，/wd 若第/nrf i/x 个/q 最/d 小/a 关键字/n 的/ude1 结点/n 是/vshi 数组/n 中下/f 标/v 为/v 户/ng 且/c 户/q >/n i/x 的/ude1 分量/n ，/wd 则/c 互换/v SL．r/x [/wkz i/x ]/wky 和/cc SL．r/x [/wkz p/x ]/wky ，/wd 且/c 令/v sL．r/x [/wkz i/x ]/wky 中/f 指针/n 域/ng 的/ude1 值/n 改/vd 为/v 户/q ；/wf 由于/p 此时/r 数组/n 中/b 所有/b 小于/v i/x 的/ude1 分量/n 中/f 已/d 是/vshi “/wyz 到位/vi ”/wyy 的/ude1 记录/n ，/wd 则/c 当/v p/x </n i/x 时/ng ，/wd 应/v 顺/v 链/ng 继续/v 查找/v 直到/v p≥i/x 为止/u 。/wj 图/n 10．4/m 所/usuo 示/vg 为/p 重排/v 记录/v 的/ude1 全部/m 过程/n 。/wj 
初始状态/n 
   耍/v iG/x ，/wd ．/w 重/v 妻/ng ；/wf 静/a 悉/vg 链/ng 表/vg 数组/n 中/f 记录/v 的/ude1 过程/n 
    算法/n 10．3/m 描述/v 了/ule 二/m 还/d 重排/v 记录/v 的/ude1 过程/n 。/wj 容易/ad 看出/v ，/wd 在/p 重排/v 记录/v 的/ude1 过程/n 中/f ，/wd 最/d 坏/a 情况/n 是/vshi 每个/r 记录/v 到/v 位/q 都/d 必须/d 进行/vx 一/m 次/qv 记录/n 的/ude1 交换/vn ，/wd 即/v 3/m 次/qv 移动/vn 记录/n ，/wd 所以/c 重排/v 记录/v 至多/d 需/v 进行/vx 3/m (/wkz ，/wd z―t-/x )/wky 次/qv 记录/n 的/ude1 移动/vn ，/wd 它/rr 并/d 不/d 增加/v 表/vg 插入/v 排序/vi 的/ude1 时间/n 复杂度/n ：/wp 
void/x  Arrange/x (/wkz SLi/x ~/n kList/x ?/ww ype/x &/n SL/x )/wky {/n 
  ∥/w 根据/p 静态/n 链/ng 表/n SL/x 中/f 备/v 结点/n 的/ude1 指针/n 值/v 调整记录/n 位置/n ．/w 浇/v 得/v sL/x 中/f 记录/v 按/p 关键字/n 
  ∥/w 减/v 有序/a 顺序/n 排列/v 
  p=SL．rio/x ]/wky ．/w next/x ；/wf     ∥/w p/x 指示/n 第一/m 个/q 记录/n 的/ude1 当前/t 位置/n 
  ~/n or/x (/wkz i=/x 】/wky ；/wf i/x </n sL．ien/x ~/n th/x ；/wf 十/m +i/x )/wky ：/wp     ∥/w SL．r：i．．i―l/x !/wt 中/b 记录/n 已/d 按/p 关键字/n 
    ’/wyy 乡/n 笼/ng -/wp 令/v 记录/v 在/p sL/x 中/f 的/ude1 当前/t 位置/n 应/v 不/d 小于/v i/x 
    while/x (/wkz p/x </n i/x )/wky   p/x ，/wd 三二/m J．r：≥j．next/x 
    q=sL．rip/x ]/wky ．/w next/x ；/wf 
・/w 270・/m 
l/x ∥/w Arrange/x 
∥/w 交换/v 记录/v ，/wd 使/v 第/m i/x 个/q 记录/n 到位/vi 
∥/w 指向/v 被/pbei 移/v 走/v 的/ude1 记录/n ，/wd 使得/vi 以后/f 可/v 由/p while/x 循环/vn 找回/v 
∥/w p/x 指示/n 尚未/d 调整/v 的/ude1 表/n 尾/ng ，/wd 为/p 找/v 第/m i+1/x 个/q 记录/n 作/v 准备/v 
算法/n   10．3/m 
    10．2．3/m 希尔/nrf 排序/vi 
    希尔/nrf 排序/vi (/wkz Shell/x ’/wyy s/x  Sort/x )/wky 又/d 称/v “/wyz 缩小/v 增量/n 排序/vi ”/wyy (/wkz I/x )/wky iminishing/x  Increment/x  Sort/x )/wky ，/wd 它/rr 也/d 是/vshi 一/m 种/q 属/v 插入/v 排序/vn 类/n 的/ude1 方法/n ，/wd 但/c 在/p 时间/n 效率/n 上/f 较/d 前述/v 几/m 种/q 排序/vn 方法/n 有/vyou 较/d 大/a 的/ude1 改进/vn 。/wj 
    从/p 对/p 直接/ad 插入/v 排序/vi 的/ude1 分析/vn 得知/v ，/wd 其/rz 算法/n 时间/n 复杂度/n 为/v 0/m (/wkz ”/wyy 。/wj )/wky ，/wd 但是/c ，/wd 若/c 待/vi 排/v 记录/v 序列/n 为/v “/wyz 正/b 序/n ”/wyy 时/ng ，/wd 其/rz 时间/n 复杂度/n 可/v 提高/v 至/p 0/m (/wkz ”/wyy )/wky 。/wj 由此/d 可/v 设想/vn ，/wd 若/c 待/vi 排/v 记录/v 序列/n 按/p 关键字/n “/wyz 基本/a 有序/a ”/wyy ，/wd 即/v 序列/n 中/f 具有/v 下列/b 特性/n     I．．rf/x _/n i/x ]/wky ．/w ke/x >/n r/x </n Maxi/x  I．．r/x [/wkz j/x ]/wky ．/w ke/x 。/wj y/x ’/wyy ：/wp     ，/wd 11/m )/wky 一/m 7/m )/wky 
    l≤/x 】/wky </n I/x 
的/ude1 记录/n 较/d 少/a 时/ng ，/wd 直接/ad 插入/v 排序/vi 的/ude1 效率/n 就/d 可/v 大大提高/n ，/wd 叭/o 另/d 一/m 方/q 而/cc 来/vf 看/v ，/wd 由于/c 直接/ad 插入/v 排序/vn 算法/n 简单/a ，/wd 则/c 在/p ，/wd ，/wd 值/v 很/d 小时/n 效率/n 也/d 比较/d 高/a 。/wj 希尔/nrf 排序/vi 正是/v 从/p 这/rzv 两点/m 分析/v 出发/vi 对/p 直接/ad 插入/v 排序/vi 进行/vx 改进/vn 得到/v 的/ude1 一/m 种/q 插入/v 排序/vn 方法/n 。/wj 
　　它/rr 的/ude1 基本思想/n 是/vshi ：/wp 先/d 将/p 整个/b 待/vi 排/v 记录/v 序列/n 分割/v 成为/v 若干/m 子/q 序列/n 分别/d 进行/vx 直接/ad 插入/v 排序/vi ，/wd 待/p 整个/b 序列/n 中/f 的/ude1 记录/n “/wyz 基本/a 有序/a ”/wyy 时/ng ，/wd 再/d 对/p 全体/n 记录/v 进行/vx 一/m 次/qv 直接/ad 插入/v 排字/vn j/x 
　　仍/d 以/p 式/k (/wkz 10―4/m )/wky 中/f 的/ude1 关键/n 字/n 为/p 例/n ，/wd 先/d 看/v 一下/mq 希尔/nrf 排序/vi 的/ude1 过程/n 、/wn 初始/b 关键字/n 序列/n 如/v 图/n 10．5/m 的/ude1 第1/m 行/q 所/usuo 示/vg 。/wj 首先/c 将/p 该/rz 序列/n 分成/vi 五/m 个子/n 序列/n {/n Ri/x ，/wd R6/x ；/wf ，/wd ：/wp R/x  2．R/x  7/m ∥/w 一/m ，/wd ；/wf R/x ，/wd ，/wd R/x 】/wky 0：/m ，/wd 如/v 图/n 10．5/m 的/ude1 第2/m 行/q 至/p 第6/m 行/q 所/usuo 示/vg ，/wd 分别/d 对/p 每个/r 子/ng 序列/n 进行/vx 直接/ad 插入/v 排序/vi ，/wd 排序/vn 结果/n 如/v 图/n 10．5/m 的/ude1 第7/m 行/q 所/usuo 示/vg ，/wd 从/p 第1/m 行/q 的/ude1 初始序列/n 得到/v 第7/m 行/q 的/ude1 序列/n 的/ude1 过程/n 称为/v 一/m 趟/qv 希尔/nrf 排序/vi 。/wj 然后/c 进行/vx 第二/m 趟/qv 希尔/nrf 排序/vi ，/wd 即/d 分别/d 对/p 下列/b 三/m 个子/n 序列/n ：/wp {/n R/x 】/wky ，/wd R/x 。/wj ，/wd R/x ，/wd ，/wd R10：/x ，/wd ：/wp R/x  2/m ，/wd R/x ；/wf ，/wd R8/x }/n 和/cc !/wt R3/x ，/wd R/x 。/wj ，/wd ．/w R/x ，/wd }/n 进行/vx 直接/ad 插入/v 排序/vi 。/wj 其/rz 结果/n 如/v 图/n 10．5/m 的/ude1 第/m 1l/x 行/n 所/usuo 示/vg ，/wd 最后/f 对/p 整个/b 序列/n 进行/vx 一/m 趟/qv 直接/ad 插入/v 排序/vi 。/wj 至此/d ，/wd 希尔/nrf 排序/vi 结束/v ，/wd 整个/b 序列/n 的/ude1 记录/n 已/d 按/p 关键字/n 非/b 递减/vn 有序/ad 排列/v 。/wj 
　　从/p 上述/b 排序/vn 过程/n 可见/c ，/wd 希尔/nrf 排序/vi 的/ude1 一个/mq 特点/n 是/vshi ：/wp 子/ng 序列/n 的/ude1 构成/n 不/d 是/vshi 简单/a 地/ude2 “/wyz 逐/vg 段/ng 分割/v ”/wyy ，/wd 而是/c 将/d 相隔/v 某个/rz “/wyz 增量/n ”/wyy 的/ude1 记录/n 组成/v 一个/mq 子/ng 序列/n 。/wj 如上/b 例/n 中/f ，/wd 第一/m 趟/qv 排序/vi 时/ng 的/ude1 增量/n 为/p 5/m ，/wd 第=/m 趟/qv 排序/vi 时/ng 的/ude1 增量/n 为/p 3/m ，/wd 由于/c 在/p 前/f 两/m 趟/qv 的/ude1 插入/v 排序/vi 中/f 记录/v 的/ude1 关键/n 字/n 是/vshi 和/cc 同/p 一/m 子/q 序列/n 中/f 的/ude1 前/f 一个/mq 记录/n 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 因此/c 关键字/n 较/d 小/a 的/ude1 记录/n 就/d 不/d 是/vshi 一/m 步/qv 一/m 步/qv 地/ude2 往/p 前/f 挪动/v ，/wd 而是/c 跳跃式/b 地/ude2 往/p 前/f 移/v ，/wd 从而/c 使得/vi 在/p 进行/vx 最后/f 一/m 趟/qv 增量/n 为/p 1/m 的/ude1 插入/v 排序/vi 时/ng ．/w 序列/n 已/d 基本/a 有序/a ，/wd 只要/c 作/v 记录/v 的/ude1 少量/m 比较/vn 和/cc 移动/vn 即/d 可/v 完成/v 乔/ag ，/wd 享/vg ，/wd 西/f 此/rzs 綦/nr1 尔/Rg 排序/vi 的/ude1 时间/n 复杂度较/n 直接/ad 插入/v 排序/vi 低/a 。/wj 下面/f 用/p 算法/n 语言/n 描述/v 上述/b 希尔/nrf 排序/vi 的/ude1 过程/n ．/w 为此/d 先/d 将/p 算法/n 10．：/m 改写/v 成/v 如/v 算法/n 10．4/m 所/usuo 示/vg 的/ude1 一般/a 形式/n 。/wj 希尔/nrf 排序/vi 算法/n 如/v 算法/n lO．5/x 所/n 示/vg 。/wj 
void/x  ShellInsez/x ‘/wyz t/x (/wkz SqList/x &/n L/x ，/wd int/x  dk/x )/wky l/x 
  ∥/w 对/p 顺序/n 表/n L/x 作/v 一/m 趟/qv 希尔/nrf 插入/v 排序/vi 。/wj 本/rz 算法/n 是/vshi ：/wp 
∥/w     I/x 前后/f 记录位置/n 的/ude1 增/v 越是/d 出/vf ，/wd 而/cc 不/d 是/vshi l/x ；/wf 
∥/w     2/m  r/x [/wkz 0/m ]/wky 只是/d 暂/d 存单元/n ，/wd 不/d 是/vshi 哨兵/n 。/wj 当/v ]/wky </n =0/m 时/ng ，/wd 插入/v 位置/n 已/d 找到/v 。/wj 
算法/n 】/wky 0/m  4/m 
vold/x  ShellSort/x (/wkz SqList/x ＆/n L/x ，/wd int/x  dlta/x [/wkz ]/wky ．/w i/x 北/f t/x )/wky I/x 
  ∥/w 按/p 增/v 世/ng 序/n l/x 列/n dita/x [/wkz O/x  t/x ～/ws l/x 】/wky 对/p 顺序/n 表/n L/x 作/v 希尔/nrf 排序/vi 。/wj 
    Shelllns/x ~/n t/x (/wkz L．dlta/x [/wkz k/x 】/wky )/wky ；/wf     ∥/w 一/m 趟/qv 增/v m/x }/n 为/p ~/n ta/x [/wkz k/x ]/wky 的/ude1 插/v 人/n 排序/vi 
l／／ShellSort/x 
    算法/n lO/x  5/m 
(/wkz 关键字/n ]/wky t/x   {/n 9/m  38/m  65/m  97/m ，/wd 6/m  l/x  3/m 卵石/n 55/m  04/m 
一/m 趟/qv 排序/vi 结/v */n ：/wp   13/m 
排序/vn 结果/n z/x   13/m  04/m 石/ng 拍/v 一/m 27/m  49/m  55/m  65/m  97/m  76/m 
结果/n ・/w 04/m  13/m  27/m  38/m  49/m  49/m  55/m  65/m  76/m  97/m 
    希尔/nrf 排序/vi 的/ude1 分析/vn 是/vshi 一个/mq 复杂/a 的/ude1 问题/n ．/w 因为/c 它/rr 的/ude1 时间/n 是/vshi 所/usuo 取/v “/wyz 增量/n ”/wyy 序列/n 的/ude1 函数/n ，/wd 这/rzv 涉及/v 一些/mq 数学/n 上/f 尚未/d 解决/v 的/ude1 难题/n 。/wj l/x 烈/a 此/rzs ，/wd 到/p 目前/t 为止/u 尚未/d 有/vyou 八/m 求得/v 一/m 种/q 最/d 好/a 的/ude1 ，/wd 希尔/nrf 排序/vi 所/usuo 需/v 的/ude1 比较/vn 和/cc 移动/vn 次数/n 约/d 为/v n1．．．/x ，/wd 当/v 恕/vg +oo/x 时/ng ，/wd 可/c 减少/v 到/v n/x (/wkz 】/wky tog2/x 以/b )/wky 。/wj 旺/a ’/wyy 。/wj 增量/n 序列/n 可以/v 有/vyou 各种/rz 取/v 法/b ①/m ，/wd 但/c 需/v 注意/v 应/v 使/v 增量/n 序列/n 中/f 的/ude1 值/n 没有/d 除/p 1/m 之外/f 的/ude1 公/b 因子/n ，/wd 并且/c 最后/f 一个/mq 增量/n 值/n 必须/d 等于/v 1/m 。/wj 
10．3/m 快速/d 排序/vi 
    这/rzv 一/m 节/q 讨论/v 一/m 类/q 藉助/n “/wyz 交换/v ”/wyy 进行/vx 排序/vn 的/ude1 方法/n ，/wd 其中/rz 最/d 简单/a 的/ude1 一/m 种/q 就是/v 人们/n 所/usuo 熟知/v 的/ude1 起泡/vi 排序/vi (/wkz Bubble/x  Sort/x )/wky o/x 
    起泡/vi 排序/vi 的/ude1 过程/n 很/d 简单/a 。/wj 首先/c 将/p 第一/m 个/q 记录/n 的/ude1 关键/n 字/n 和/cc 第二/m 个/q 记录/n 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 若/c 为/v 逆/vg 序/n (/wkz 即/v L．r/x [/wkz 1/m ]/wky ．/w key/x >/n L．r/x [/wkz 2/m ]/wky ．/w key/x )/wky ，/wd 则/c 将/p 两/m 个/q 记录/n 交换/v 之/uzhi ，/wd 然后/c 比较/d 第二/m 个/q 记录/n 和/cc 第三/m 个/q 记录/n 的/ude1 关键/n 字/n 。/wj 依次/d 类推/vi ，/wd 直至/v 第/m n-1/x 个/q 记录/n 和/cc 第/m n/x 个/q 记录/n 的/ude1 关键/n 字/n 进行/vx 过/uguo 比较/d 为止/u 。/wj 上述/b 过程/n 称作/v 第一/m 趟/qv 起泡/vi 排序/vi ，/wd 其/rz 结果/n 使得/vi 关键字/n 最/d 大/a 的/ude1 记录/n 被/pbei 安置/v 到/v 最后/f 一个/mq 记录/n 的/ude1 位置/n 上/f 。/wj 然后/c 进行/vx 第二/m 趟/qv 起泡/vi 排序/vi ，/wd 对/p 前/f ，/wd l-1/x 个/q 记录/n 进行/vx 同样/b 操作/vn ，/wd 其/rz 结果/n 是/vshi 使/v 关键字/n 次/qv 大/a 的/ude1 记录/n 被/pbei 安置/v 到/v 第旭/nr2 -/wp 1/m 个/q 记录/n 的/ude1 位置/n 上/f 。/wj 一般/a 地/ude2 ，/wd 第/m i/x 趟/qv 起泡/vi 排序/vi 是/vshi 从/p L．f/x [/wkz 1/m ]/wky 到/v L．r/x [/wkz n―j+1/x ]/wky 依次/d 比较/d 相邻/vi 两/m 个/q 记录/n 的/ude1 关键/n 字/n ，/wd 并/cc 在/p “/wyz 逆/vg 序/n ”/wyy 时/ng 交换/v 相邻/vd 记录/v ，/wd 其/rz 结果/n 是/vshi 这/rzv n―i+1/x 个/q 记录/n 中/b 关键字/n 最/d 大/a 的/ude1 记录/n 被/pbei 交换/v 到/v 第/m ，/wd z―i+1/x 的/ude1 位置/n 上/f 。/wj 整个/b 排序/vn 过程/n 需/v 进行/vx 忌/vn (/wkz 1≤/m 愚/a </n n/x )/wky 趟/v 起泡/vi 排序/vi ，/wd 显然/a ，/wd 判别/v 起泡/vi 排序/vi 结束/v 的/ude1 条件/n 应该/v 是/vshi “/wyz 在/p 一/m 趟/qv 排序/vn 过程/n 中/f 没有/v 进行/vx 过/uguo 交换/v 记录/v 的/ude1 操作/vn ”/wyy 。/wj 图/n 10．6/m 展示/v 了/ule 起泡/vi 排序/vi 的/ude1 一个/mq 实例/n 。/wj 从/p 图/n 中/f 可见/v ，/wd 在/p 起泡/vi 排序/vi 的/ude1 过程/n 中/f ，/wd 关键字/n 较/d 小/a 的/ude1 记录/n 好比/v 水中/s 气泡/n 逐/vg 趟/v 向上/vi 飘浮/v ，/wd 而/cc 关键字/n 较/d 大/a 的/ude1 记录/n 好比/v 石块/n 往/p 下/f 沉/v ，/wd 每/rz 一/m 趟/qv 有/vyou 一/m 块/q “/wyz 最/d 大/a ”/wyy 的/ude1 石头/n 沉/v 到/v 水底/s (/wkz 请/v 参见/v “/wyz 1．43/m 算法/n 效率/n 的/ude1 度量/n ”/wyy 中/f 起泡/vi 排序/vi 的/ude1 算法/n )/wky 。/wj 
    图/n 10．6/m 起泡/vi 排序/vi 示例/n 
分析/v 起泡/vi 排序/vi 的/ude1 效率/n ，/wd 容易/ad 看出/v ，/wd 若/c 初始序列/n 为/v “/wyz 正/b 序/n ”/wyy 序列/n ，/wd 则/c 只/d 需/v 进行/vx 一/m 趟/qv 排序/vi ，/wd 在/p 
①/m 其它/rz 增量/n 序列/n 如/v ：/wp 
"/n 第一/m 趟/qv 排序/vi 后/f 
排序/vn 过程/n 中/f 进行/vx n―1/x 次关键字/n 间/f 的/ude1 比较/vn ，/wd 且/c 不/d 移动/v 记录/v ；/wf 反之/c ，/wd 若/c 初始序列/n 为/v “/wyz 逆/vg 序/n ”/wyy 序列/n ，/wd 则/c 需/v 进行/vx 礼/n -/wp 1/m 趟/qv 排序/vi ，/wd 需/v 进行/vx 乏/a ：/wp (/wkz i-1/x )/wky ：/wp n/x (/wkz n-1/x )/wky ／2/m 次比较/n ，/wd 并/cc 作/v 等/udeng 数量级/n 的/ude1 记录/n 
移动/vn 。/wj 因此/c ，/wd 总/b 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz n2/x )/wky 。/wj 
    快速/d 排序/vi (/wkz Quiek/x  Sort/x )/wky 是/vshi 对/p 起泡/vi 排序/vi 的/ude1 一/m 种/q 改进/vn 。/wj 它/rr 的/ude1 基本思想/n 是/vshi ，/wd 通过/p 一/m 趟/qv 排序/vi 将/d 待/vi 排/v 记录/v 分割/v 成/v 独立/a 的/ude1 两/m 部分/n ，/wd 其中/rz 一部分/m 记录/n 的/ude1 关键/n 字/n 均/d 比/p 另/rz 一/m 部分/m 记录/n 的/ude1 关键/n 字/n 小/a ，/wd 则/c 可/v 分别/d 对/p 这/rzv 两/m 部分/m 记录/n 继续/v 进行/vx 排序/vn ，/wd 以/p 达到/v 整个/b 序列/n 有序/a 。/wj 
　　假设/n 待/vi 排序/vi 的/ude1 序列/n 为/p {/n L/x _/n r/x [/wkz s/x ]/wky ，/wd L/x _/n r/x [/wkz s+1/x ]/wky ，/wd …/ws ，/wd L．r/x [/wkz t/x ]/wky }/n ，/wd 首先/c 任意/d 选取/v 一个/mq 记录/n (/wkz 通常/d 可/v 选/v 第一/m 个/q 记录/n L．r/x [/wkz s/x ]/wky )/wky 作为/p 枢轴/n (/wkz 或/c 支点/n )/wky (/wkz pivot/x )/wky ，/wd 然后/c 按/p 下/f 述/vg 原则/n 重新/d 排列/v 其余/rz 记录/n ：/wp 将/p 所有/b 关键字/n 较/d 它/rr 小/a 的/ude1 记录/n 都/d 安置/v 在/p 它/rr 的/ude1 位置/n 之前/f ，/wd 将/p 所有/b 关键字/n 较/d 它/rr 大/a 的/ude1 记录/n 都/d 安置/v 在/p 它/rr 的/ude1 位置/n 之后/f 。/wj 由此/d 可以/v 该/rz “/wyz 枢轴/n ”/wyy 记录/n 最后/f 所/usuo 落/v 的/ude1 位置/n i/x 作/v 分界线/n ，/wd 将/p 序列/n {/n L．r/x [/wkz s/x ]/wky ，/wd …/ws ，/wd L．r/x [/wkz t/x ]/wky }/n 分割/v 成/v 两/m 个子/n 序列/n {/n L．r/x [/wkz s/x ]/wky ，/wd L．r/x [/wkz s+1/x ]/wky ，/wd …/ws ，/wd L．r/x [/wkz i-1/x ]/wky }/n 和/cc {/n L．r/x [/wkz i+1/x ]/wky ，/wd L．r/x [/wkz i+2/x ]/wky ，/wd …/ws ，/wd L．r/x 【/wkz t/x ]/wky }/n 。/wj 这个/rz 过程/n 称作/v 一/m 趟/qv 快速/d 排序/vi (/wkz 或/c 一/m 次/qv 划分/v )/wky 。/wj 
　　一/m 趟/qv 快速/d 排序/vi 的/ude1 具体/a 做法/n 是/vshi ：/wp 附设/v 两/m 个/q 指针/n low/x 和/cc high/x ，/wd 它们/rr 的/ude1 初值/n 分别/d 为/v lOW/x 和/cc high/x ，/wd 设/v 枢轴/n 记录/v 的/ude1 关键/n 字/n 为/v pivotkey/x ，/wd 则/c 首先/d 从/p high/x 所/usuo 指/v 位置/n 起/vf 向前/vi 搜索/v 找到/v 第一/m 个/q 关键字/n 小于/v pivotkey/x 的/ude1 记录/n 和/cc 枢轴/n 记录/v 互相交换/n ，/wd 然后/c 从/p low/x 所/usuo 指/v 位置/n 起/vf 向/p 后/f 搜索/v ，/wd 找到/v 第一/m 个/q 关键字/n 大于/v pivotkey/x 的/ude1 记录/n 和/cc 枢轴/n 记录/v 互相交换/n ，/wd 重复/v 这/rzv 两/m 步/qv 直至/v low=high/x 为止/u 。/wj 其/rz 算法/n 如/v 算法/n 10．6/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 
int/x  Partitlon/x (/wkz SqUist/x ＆/n L/x ，/wd int/x  low/x ，/wd int/x  high/x )/wky {/n 
  ∥/w 交换/v 顺序/n 表/n L/x 中子/n 表/n L．r/x [/wkz 1Dw．．high/x ]/wky 的/ude1 记录/n ，/wd 使/v 枢轴/n 记录/v 到位/vi ，/wd 并/cc 返回/v 其/rz 所在/n 位置/n ，/wd 此时/r 
  ∥/w 在/p 它/rr 之前/f (/wkz 后/f )/wky 的/ude1 记录/n 均/d 不/d 大/a (/wkz 小/a )/wky 于/p 它/rr 。/wj 
  plvotkey=L．r/x 【/wkz ．/w 10w/x ]/wky ．/w key/x ；/wf     ∥/w 用/v 子/ng 表/n 的/ude1 第一/m 个/q 记录/n 作/v 枢轴/n 记录/v 
  while/x (/wkz 10w/x </n high/x )/wky {/n     ∥/w 从/p 表/n 的/ude1 两端/n 交替/d 地/ude2 向/p 中间/f 扫描/v 
    L．r/x [/wkz 10w/x ]/wky --/wp L．r/x [/wkz high/x ]/wky ；/wf     ∥/w 将/d 比/p 枢轴/n 记录/v 小/a 的/ude1 记录/n 交换/v 到/v 低端/n 
    whi．1e/x (/wkz 10w/x </n high/x ＆/n &/n L．r/x [/wkz 10W/x ]/wky ．/w key/x </n =pivotkey/x )/wky   十/m +low/x ；/wf 
    L．r/x 【/wkz 10w/x 卜/vg --/wp L．r/x [/wkz high/x ]/wky ；/wf     ∥/w 将/d 比/p 枢轴/n 记录/v 大/a 的/ude1 记录/n 交换/v 到/v 高端/n 
  I/x 
  retchl/x  10w/x ；/wf     ∥/w 返回/v 枢轴/n 所在/n 位置/n 
I/x ∥/w Partition/x 
    算法/n 10．6/m 【/wkz a/x )/wky 
    具体实现/n 上述/b 算法/n 时/ng ，/wd 每/rz 交换/v 一/m 对/q 记录/n 需/v 进行/vx 三/m 次/qv 记录移动/n (/wkz 赋值/v )/wky 的/ude1 操作/vn 。/wj 而/cc 实际上/d ，/wd 在/p 排序/vn 过程/n 中/f 对/p 枢轴/n 记录/v 的/ude1 赋值/v 是/vshi 多余/a 的/ude1 ，/wd 因为/c 只有/c 在/p 一/m 趟/qv 排序/vi 结束/v 时/ng ，/wd 即/v lOW：laigh/x 的/ude1 位置/n 才/d 是/vshi 枢轴/n 记录/v 的/ude1 最后/f 位置/n 。/wj 由此/d 可/v 改写/v 上述/b 算法/n ，/wd 先/d 将/p 枢轴/n 记录/v 暂/d 存在/v r/x [/wkz 0/m ]/wky 的/ude1 位置/n 上/f ，/wd 排序/vn 过程/n 中/f 只/d 作/v r/x [/wkz 10w/x ]/wky 或/c r/x [/wkz high/x ]/wky 的/ude1 单向/b 移动/vn ，/wd 直至/v 一/m 趟/qv 排序/vi 结束/v 后/f 再/d 将/p 枢轴/n 记录/v 移/v 至/p 正确/a 位置/n 上/f 。/wj 如/v 算法/n 10．6/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
int/x  Partition/x (/wkz SqList/x ＆/n L/x ，/wd int/x  low/x ，/wd int/x  high/x )/wky {/n 
  ∥/w 交换/v 顺序/n 表/n L/x 中子/n 表/n r/x [/wkz 10w．．high/x ]/wky 的/ude1 记录/n ，/wd 枢轴/n 记录/v 到位/vi ，/wd 并/cc 返回/v 其/rz 所在/n 位置/n ，/wd 此时/r 
  ∥/w 在/p 它/rr 之前/f (/wkz 后/f )/wky 的/ude1 记录/n 均/d 不/d 大/a (/wkz 小/a )/wky 于/p 它/rr 。/wj 
  L/x ，/wd r/x [/wkz 0/m ]/wky =L．r/x [/wkz 10w/x ]/wky ；/wf 
・/w 274・/m 
∥/w 用/v 子/ng 表/n 的/ude1 第一/m 个/q 记录/n 作/v 枢轴/n 记录/v 
  plvotkey=L．r/x [/wkz 10w/x ]/wky ．/w key/x ；/wf     ∥/w 枢轴/n 记录/v 关键字/n 
  while/x (/wkz 10w/x </n high/x )/wky l/x     ∥/w 从/p 表/n 的/ude1 两端/n 交替/d 地/ude2 向/p 中间/f 扫描/v 
    while/x (/wkz 10w/x </n high/x ＆/n &/n L．r/x [/wkz high/x ]/wky ．/w key/x >/n =pivotkey/x )/wky --/wp high/x ；/wf 
    L．r/x [/wkz 10w/x ]/wky =L．r/x [/wkz high/x ]/wky ；/wf     ∥/w 将/d 比/p 枢轴/n 记录/v 小/a 的/ude1 记录/n 移/v 到/v 低端/n 
    while/x (/wkz 10w/x </n high/x ＆/n ＆/n L．r/x 【/wkz low/x ]/wky ．/w key/x </n =pivotkey/x )/wky ++low/x ；/wf 
    L．r/x [/wkz high/x ]/wky =L．r/x 【/wkz low/x ]/wky ；/wf     ∥/w 将/d 比/p 枢轴/n 记录/v 大/a 的/ude1 记录/n 移/v 到/v 高端/n 
  }/n 
  L．r/x [/wkz 10w/x ]/wky =L．r/x [/wkz 0/m ]/wky ；/wf     ∥/w 枢轴/n 记录/v 到位/vi 
  return/x  low/x ；/wf     ∥/w 返回/v 枢轴/n 位置/n 
t/x ?/ww ?/ww Partition/x 
    算法/n 10．6/m (/wkz b/x )/wky 
    以/p 式/k (/wkz 10．4/m )/wky 中/f 的/ude1 关键/n 字/n 为/p 例/n ，/wd 一/m 趟/qv 快/d 排/v 的/ude1 过程/n 如/v 图/n 10．7/m (/wkz a/x )/wky 所/usuo 示/vg 。/wj 整个/b 快速/b 排序/vn 的/ude1 过程/n 可/v 递归/n 进行/vx 。/wj 若/c 待/vi 排/v 序列/n 中/f 只/d 有/vyou 一个/mq 记录/n ，/wd 显然/ad 已/d 有序/a ，/wd 否则/c 进行/vx 一/m 趟/qv 快速/d 排序/vi 后/f 再/d 分别/d 对/p 分割/v 所得/n 的/ude1 两/m 个子/n 序列/n 进行/vx 快速/d 排序/vi ，/wd 如/v 图/n 10．7/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 
    pivotkey/x 
初始/b 关键字/n 
进行/vx 2/m 次/qv 交换/v 之后/f   27/m   38/m 
进行/vx 3/m 次/qv 交换/v 之后/f   27/m   38/m 
进行/vx 4/m 次/qv 交换/v 之后/f   27/m   38/m   13/m     76/m   97/m   65/m   ―/wp 49/m 
完成/v 一/m 趟/qv 排序/vi     27/m   38/m   13/m  49/m   76/m   97/m   65/m   ―/wp 49/m 
    (/wkz a/x )/wky 
    初始状态/n     }/n 49/m   38/m   65/m   97/m   76/m   13/m 
    一/m 次/qv 划分/vn 之后/f     }/n 27/m   38/m   13/m }/n   49/m   {/n 76/m   97/m 
    分别/d 进行/vx 快速/d 排序/vi   {/n 13/m }/n   27/m   {/n 38/m }/n 
    有序/a 序列/n     {/n 13/m   27/m   38/m  49/m   ―/wp 49/m   65/m 
    (/wkz b/x )/wky 
    图/n 10．7/m 快速/b 排序/vn 示例/n 
    (/wkz a/x )/wky 一/m 趟/qv 快/d 排/v 过程/n ；/wf (/wkz b/x )/wky 排序/vi 的/ude1 全/a 过程/n 。/wj 
递归/n 形式/n 的/ude1 快速/b 排序/vn 算法/n 如/v 算法/n 10．7/m 和/cc 算法/n 10．8/m 所/usuo 示/vg 。/wj 
void/x  QSort/x (/wkz SqLi8t/x ＆/n L/x 。/wj int/x  10w/x 。/wj int/x  high/x )/wky {/n 
  ∥/w 对/p 顺序/n 表/n L/x 中/f 的/ude1 子/ng 序列/n L．r/x [/wkz 10w．．high/x ]/wky 作/v 快速/d 排序/vi 
  if/x (/wkz 10w/x </n high/x )/wky I/x     ∥/w 长度/n 大于/v 1/m 
    pivot/x ]/wky ．/w oc=Partition/x (/wkz L/x ，/wd 10w/x ，/wd high/x )/wky ；/wf     ∥/w 将/d L．r/x [/wkz 10w．．high/x ]/wky 一分/t 为/p 二/m 
    QSort/x (/wkz L/x ，/wd 10w/x ，/wd pi・votloc―1/x )/wky ；/wf     ∥/w 对/p 低/a 子/ng 表/n 递归/n 排序/vi ，/wd pivotloc/x 是/vshi 枢轴/n 位置/n 
    QSort/x (/wkz n/x ，/wd pivotloc+l/x ，/wd high/x )/wky ；/wf     ∥/w 对/p 高子表/nr 递归/n 排序/vi 
  I/x 
}/n ∥/w QSort/x 
    算法/n 10．7/m 
void/x  QuickSort/x (/wkz SqList/x  an/x )/wky {/n 
  ∥/w 对/p 顺序/n 表/n L/x 作/v 快速/d 排序/vi 。/wj 
  QSort/x (/wkz L/x ，/wd l/x 。/wj L．1ength/x )/wky ；/wf 
}/n ∥/w QuickSort/x 
算法/n lO．8/x 
    快速/d 排序/vi 的/ude1 平均/a 时间/n 为/v L/x 馏/v (/wkz 竹/ng )/wky =/m 足以/d Inn/x ，/wd 其中/rz n/x 为/v 待/vi 排序/vi 序列/n 中/f 记录/v 的/ude1 个/q 数/n ，/wd 是/vshi 为/p 某个/rz 常数/n ，/wd 经验/n 证明/v ，/wd 在/p 所有/b 同/p 数量级/n 的/ude1 此类/r (/wkz 先进/a 的/ude1 )/wky 排序/vn 方法/n 中/f ，/wd 快速/d 排序/vi 的/ude1 常数/n 因子/n 最/d 小/a 。/wj 因此/c ，/wd 就/d 平均/a 时间/n 而言/uls ，/wd 快速/d 排序/vi 是/vshi 目前/t 被/pbei 认为/v 是/vshi 最/d 好/a 的/ude1 一/m 种/q 内部/f 排序/vi 方法/n 。/wj 
    下面/f 我们/rr 来/vf 分析/v 快速/d 排序/vi 的/ude1 平均/a 时间/n 性能/n 。/wj 
    假设/n T/x (/wkz ”/wyy )/wky 为/v 对/p n/x 个/q 记录/n L．r/x [/wkz 1．．n/x ]/wky 进行/vx 快速/b 排序/vn 所/usuo 需/v 时间/n ，/wd 则/c 由/p 算法/n QuickSon/x 可见/v ，/wd 其中/rz 丁加/nrf 。/wj (/wkz n/x )/wky 为/v 对/p n/x 个/q 记录/n 进行/vx 一/m 趟/qv 快速/b 排序/vn Partition/x (/wkz L/x ，/wd 1/m ，/wd n/x )/wky 所/usuo 需/v 时间/n ，/wd 从/p 算法/n 10．7/m 可见/c ，/wd 它/rr 和/cc 记录/v 数/n 扎/v 成/v 正比/n ，/wd 可以/v cn/x 表示/v 之/rz (/wkz c/x 为/p 某个/rz 常数/n )/wky ；/wf T/x (/wkz 忌/v -/wp 1/m )/wky 和/cc T/x (/wkz 扎/v 一/m 愚/an )/wky 分别/d 为/v 对/p L．r/x [/wkz 1．．k-1/x ]/wky 和/cc L．r/x [/wkz k+1．．n/x ]/wky 中/f 记录/v 进行/vx 快速/b 排序/vn QSort/x (/wkz L/x ，/wd 1/m ，/wd k-1/x )/wky 和/cc Q/x !/wt Sort/x (/wkz L/x ，/wd k+1/x ，/wd n/x )/wky 所/usuo 需/v 时间/n 。/wj 假设/n 待/vi 排/v 序列/n 中/f 的/ude1 记录/n 是/vshi 随机/d 排列/v 的/ude1 ，/wd 则/c 在/p 一/m 趟/qv 排序/vi 之后/f ，/wd 足/d 取/v 1/m 至/p n/x 之间/f 任何/rz 一/m 值/n 的/ude1 概率/n 相同/a ，/wd 快速/d 排序/vi 所/usuo 需/v 时间/n 的/ude1 平均值/n 则/d 为/v 
    通常/d ，/wd 快速/d 排序/vi 被/pbei 认为/v 是/vshi ，/wd 在/p 所有/b 同/p 数量级/n (/wkz 0/m (/wkz 10g/x 恕/vg )/wky )/wky 的/ude1 排序/vn 方法/n 中/f ，/wd 其/rz 平均/a 性能/n 最/d 好/a 。/wj 但是/c ，/wd 若/c 初始/b 记录/n 序列/n 按/p 关键字/n 有序/a 或/c 基本/a 有序/a 时/ng ，/wd 快速/d 排序/vi 将/d 蜕化/vi 为/v 起泡/vi 排序/vi ，/wd 其/rz 时间/n 复杂度/n 为/v 0/m (/wkz n/x 。/wj )/wky 。/wj 为/p 改进/v 之/uzhi ，/wd 通常/d 依/v “/wyz 三/m 者/k 取/v 中/f ”/wyy 的/ude1 法则/n 来/vf 选取/v 枢轴/n 记录/v ，/wd 即/d 比较/d L．r/x [/wkz s/x ]/wky ．/w key/x 、/wn LI/x  r/x [/wkz t/x ]/wky ．/w key/x 和/cc L．rl/x  I/x 半/m l/x  I．key/x ，/wd 取/v 三/m 者/k 中/f 其/rz 关键字/n 取/v 中/f 值/v 的/ude1 记录/n 为/p 枢轴/n ，/wd 只要/c 将/p 该/rz 记录/n 和/cc L．r/x [/wkz s/x ]/wky 互换/v ，/wd 算法/n 10．6/m (/wkz b/x )/wky 。/wj 不/d 变/v 。/wj 经验/n 证明/v ，/wd 采用/v 三/m 者/k 取/v 中/f 的/ude1 规则/n 可/c 大大改善/n 快速/d 排序/vi 在/p 最/d 坏/a 情况/n 下/f 的/ude1 性能/n 。/wj 然而/c ，/wd 即使如此/dl ，/wd 也/d 不/d 能/v 使/v 快速/d 排序/vi 在/p 待/vi 排/v 记录/v 序列/n 已/d 按/p 关键字/n 有序/a 的/ude1 情况/n 下/f 达到/v 0/m (/wkz n/x )/wky 的/ude1 时间/n 复杂度/n 。/wj 为此/bl ，/wd 可/v 如下/vi 所/usuo 述/vg 修改/v “/wyz 一/m 次/qv 划分/v ”/wyy 算法/n ：/wp 在/p 指针/n high/x 减/v l/x 和/cc low/x 增/v 1/m 的/ude1 同时/n 进行/vx “/wyz 起泡/vi ”/wyy 操作/vn ，/wd 即/d 在/p 相邻/vi 两/m 个/q 记录/n 处于/v “/wyz 逆/vg 序/n ”/wyy 时/ng 进行/vx 互换/vn ，/wd 同时/c 在/p 算法/n 中/f 附设/v 两/m 个/q 布尔/n 型/k 变量/n 分别/d 指示/v 指针/n low/x 和/cc high/x 在/p 从/p 两端/n 向/p 中间/f 的/ude1 移动/vn 过程/n 中/f 是否/v 进行/vx 过/uguo 交换/v 记录/v 的/ude1 操作/vn ，/wd 若/c 指针/n ．/w 10w/x 在/p 从/p 低端/n 向/p 中间/f 的/ude1 移动/vn 过程/n 中/f 没有/v 进行/vx 交换/vn 记录/n 的/ude1 操作/vn ，/wd 则/c 不/d 再/d 需要/v 对/p 低/a 端子/n 表/n 进行/vx 排序/vn ；/wf 类似/a 地/ude2 ，/wd 若/c 指针/n high/x 在/p 从/p 高端/n 向/p 中间/f 的/ude1 移动/vn 过程/n 中/f 没有/v 进行/vx 交换/vn 记录/n 的/ude1 操作/vn ，/wd 则/c 不/d 再/d 需要/v 对/p 高/a 端子/n 表/n 进行/vx 排序/vn 。/wj 显然/a 。/wj 如此/rzv “/wyz 划分/v ”/wyy 将/d 进一步/d 改善/v 快速/d 排序/vi 的/ude1 平均/a 性能/n 。/wj 
　　由/p 以上/f 讨论/v 可知/v ，/wd 从/p 时间/n 上/f 看/v ，/wd 快速/d 排序/vi 的/ude1 平均/a 性能/n 优于/v 前面/f 讨论/v 过/uguo 的/ude1 各种/rz 排序/vn 方法/n ，/wd 从/p 空间/n 上/f 看/v ，/wd 前面/f 讨论/v 的/ude1 各种/rz 方法/n ，/wd 除/p 2．/m 路/qv 插入/v 排序/vi 之外/f ，/wd 都/d 只/d 需要/v 一个/mq 记录/n 的/ude1 附加/vn 空间/n 即可/v ，/wd 但/c 快速/d 排序/vi 需/v 一个/mq 栈/ng 空间/n 来/vf 实现/v 递归/n 。/wj 若/c 每/rz 一/m 趟/qv 排序/vi 都/d 将/d 记录/v 序列/n 均匀/a 地/ude2 分割/v 成/v 长度/n 相/d 接近/v 的/ude1 两/m 个子/n 序列/n ，/wd 则/d 栈/ng 的/ude1 最/d 大/a 深度/n 为/v L/x  logzn/x  j+1/x (/wkz 包括/v 最/d 外层/n 参量/n 进/vf 栈/ng )/wky ，/wd 但是/c ，/wd 若/c 每/rz 趟/qv 排序/vi 之后/f ，/wd 枢轴/n 位置/n 均/d 偏向/v 子/ng 序列/n 的/ude1 一/m 端/q ，/wd 则/c 为/v 最/d 坏/a 情况/n ，/wd 栈/ng 的/ude1 最/d 大/a 深度/n 为/v n/x 。/wj 如果/c 改写/v 算法/n 10．7/m ，/wd 在/p 一/m 趟/qv 排序/vi 之后/f 比较/d 分割/v 所/usuo 得/v 两/m 部分/n 的/ude1 长度/n ，/wd 且/c 先/d 对/p 长度短/n 的/ude1 子/ng 序列/n 中/f 的/ude1 记录/n 进行/vx 快速/d 排序/vi ，/wd 则/d 栈/ng 的/ude1 最/d 大/a 深度/n 可/v 降/v 为/v O/x (/wkz 10g/x )/wky 。/wj 
10．4/m 选择/v 排序/vi 
    选择/v 排序/vi (/wkz Selection/x  Sot/x ’/wyy t/x )/wky 的/ude1 基本思想/n 是/vshi ：/wp 每/rz 一/m 趟/qv 在/p n―i+1/x (/wkz i=1/x ，/wd 2/m ，/wd …/ws ，/wd 恕/vg -/wp 1/m )/wky 个/q 记录/n 中/f 选取/v 关键字/n 最/d 小/a 的/ude1 记录/n 作为/v 有序/a 序列/n 中/f 第/m i/x 个/q 记录/n 。/wj 其中/rz 最/d 简单/a 、/wn 且/c 为/p 读者/n 最/d 熟悉/v 的/ude1 是/vshi 简单/a 选择/vn 排序/vn 。/wj (/wkz simple/x  Selection/x  Sort/x )/wky 。/wj 
  10．4．1/m 简单/ad 选择/v 排序/vi 
  一/m 趟/qv 简单/ad 选择/v 排序/vi 的/ude1 操作/vn 为/v ：/wp 通过/v n―z/x 次关键字/n 间/f 的/ude1 比较/vn ，/wd 从/p n/x 一/m i+1/x 个/q 记录/n 中/f 选出/v 关键字/n 最/d 小/a 的/ude1 记录/n ，/wd 并/cc 和/cc 第/m i/x (/wkz 1≤/m {/n ≤n/x )/wky 个/q 记录/n 交换/v 之/uzhi 。/wj 
    显然/a ，/wd 对/p L．r/x [/wkz 1．．n/x ]/wky 中/f 记录/v 进行/vx 简单/a 选择/vn 排序/vn 的/ude1 算法/n 为/v ：/wp 令/v i/x 从/p 1/m 至/p 凡/d -/wp 1/m ，/wd 进行/vx n/x 一/m 1/m 趟/qv 选择/vn 操作/vn ，/wd 如/v 算法/n 10．9/m 所/usuo 示/vg 。/wj 容易/ad 看出/v ，/wd 简单/ad 选择/v 排序/vn 过程/n 中/f ，/wd 所/usuo 需/v 进行/vx 记录移动/n 的/ude1 操作次数/n 较/d 少/a ，/wd 其/rz 最/d 小/a 值/n 为/v “/wyz 0/m ”/wyy ，/wd 最/d 大值/n 为/p 3/m (/wkz n-1/x )/wky 。/wj 然而/c ，/wd 无论/c 记录/v 的/ude1 初始/vn 排列/v 如何/ryv ，/wd 所/usuo 需/v 进行/vx 的/ude1 关键/n 字/n 间/f 的/ude1 比较/vn 次数/n 相同/a ，/wd 均/d 为/v n/x (/wkz n-1/x )/wky ／2/m 。/wj 因此/c ，/wd 总/b 的/ude1 时间/n 复杂度/n 也/d 是/vshi 0/m (/wkz n0/x )/wky 。/wj 
’/wyy '/n oid/x  SelectSort/x (/wkz SqList/x ＆/n L/x )/wky l/x 
∥/w 对/p 顺序/n 表/n L/x 作/v 简单/ad 选择/v 排序/vi 。/wj 
for/x (/wkz i≈1/x ；/wf i/x </n L．1ength/x ；/wf ++i/x )/wky l/x 
  j=SelectMinKey/x (/wkz L/x ，/wd i/x )/wky ；/wf 
∥/w 选择/v 第/m i/x 小/a 的/ude1 记录/n ，/wd 并/cc 交换/v 到位/vi 
∥/w 在/p L．r/x [/wkz i．．L．1en/x ~/n h/x ]/wky 中/f 选择/v key/x 最/d 小/a 的/ude1 记录/n 
・/w 277・/m 
    if/x (/wkz i/x !/wt ：/wp j/x )/wky L．r/x [/wkz 1/m 卜/vg --/wp L．r/x 【/wkz jj/x ；/wf     ∥/w 与/p 第/m i/x 个/q 记录/n 交换/v 
}/n 
∥/w SelectSort/x 
    算法/n 10．9/m 
    那末/c ，/wd 能否/v 加以/vx 改进/vn 呢/y ?/ww 
    从/p 上述/b 可见/c ，/wd 选择/v 排序/vi 的/ude1 主要/b 操作/vn 是/vshi 进行/vx 关键字/n 间/f 的/ude1 比较/vn ，/wd 因此/c 改进/v 简单/ad 选择/v 排序/vi 应/v 从/p 如何/ryv 减少/v “/wyz 比较/d ”/wyy 出发/vi 考虑/v 。/wj 显然/a ，/wd 在/p n/x 个/q 关键字/n 中/f 选/v 出/vf 最/d 小/a 值/n ，/wd 至少/d 进行/vx ，/wd z-1/x 次比较/n ，/wd 然而/c ，/wd 继续/v 在/p 剩余/vn 的/ude1 ，/wd z―1/x 个/q 关键字/n 中/f 选择/v 次/qv 小/a 值/n 就/d 并非/v 一定/d 要/v 进行/vx ”/wyy 一/m 2/m 次比较/n ，/wd 若/c 能/v 利用前/n ”/wyy -/wp 1/m 次比较/n 所得/n 信息/n ，/wd 则/c 可/v 减少/v 以后/f 各/rz 趟/qv 选择/v 排序/vi 中/f 所/usuo 用/v 的/ude1 比较/vn 次数/n 。/wj 实际上/d ，/wd 体育/n 比赛/vn 中/f 的/ude1 锦标赛/n 便是/v 一/m 种/q 选择/vn 排序/vn 。/wj 例如/v ，/wd 在/p 八/m 个/q 运动员/n 中/f 决/vg 出/vf 前/f 三/m 名/q 至/p 多/ad 需要/v 11/m 场/qv 比赛/vn ，/wd 而/cc 不/d 是/vshi 7+6十5=18/m 场/qv 比赛/vn (/wkz 它/rr 的/ude1 前提/n 是/vshi ，/wd 若/v 乙/Mg 胜/v 丙/Mg ，/wd 甲胜乙/nr ，/wd 则/c 认为/v 甲必能/nr 胜丙/nr )/wky 。/wj 例如/v ，/wd 图/n 10．8/m (/wkz a/x )/wky 中/f 最低/a 层/qv 的/ude1 叶子/n 结点/n 中/f 8/m 个/q 选手/n 之间/f 经过/p 第一/m 轮/qv 的/ude1 四/m 场/qv 比赛/vn 之后/f 选拔/v 出/vf 四/m 个/q 优胜者/n “/wyz cH/x 久/ng ’/wyy 、/wn “/wyz BA/x (/wkz )/wky ”/wyy 、/wn “/wyz DIAO/x ”/wyy 和/cc “/wyz wANG/x ”/wyy ，/wd 然后/c 经过/p 两/m 场/qv 半决赛/n 和/cc 一/m 场/qv 决赛/vn 之后/f ，/wd 选拔/v 出/vf 冠军/n “/wyz ．/w BA/x (/wkz )/wky ”/wyy 。/wj 显然/a ，/wd 按照/p 锦标赛/n 的/ude1 传递/vn 关系/n ，/wd 亚军/n 只/d 能/v 产生/v 于/p 分别/d 在/p 决赛/vn ，/wd 半决赛/n 和/cc 第一/m 轮/qv 比赛/vn 中/f 输/v 给/p 冠军/n 的/ude1 选手/n 中/f 。/wj 由此/d ，/wd 在/p 经过/p “/wyz CHA/x ”/wyy 和/cc “/wyz LIU/x ”/wyy 、/wn “/wyz CHA/x ”/wyy 和/cc “/wyz DIA/x (/wkz )/wky ”/wyy 的/ude1 两/m 场/qv 比赛/vn 之后/f ，/wd 选拔/v 出/vf 亚军/n “/wyz CHA/x ”/wyy ，/wd 同/p 理/n ，/wd 选拔/v 殿军/n 的/ude1 比赛/vn 只要/c 在/p “/wyz ZHAO/x '/n ’/wyy 、/wn “/wyz LIu/x ”/wyy 和/cc “/wyz DIAO/x ”/wyy 三/m 个/q 选手/n 之间/f 进行/vx 即可/vn 。/wj 按照/p 这种/r 锦标赛/n 的/ude1 思想/n 可/v 导出/v 树形/n 选择/v 排序/vi 。/wj 
10．4．2/m 树形/n 选择/v 排序/vi 
    树形/n 选择/vn 排序/vn (/wkz 1/m 】/wky ?/ww ree/x  Selection/x  Sort/x )/wky ，/wd 又/d 称/v 锦标赛/n 排序/vi (/wkz 170urnament/x  Sort/x )/wky ，/wd 是/vshi 一/m 种/q 按照/p 锦标赛/n 的/ude1 思想/n 进行/vx 选择/vn 排/v 亭/ng 的/ude1 方法/n 。/wj 首先/c 对/p 竹/ng 个/q 记录/n 的/ude1 关键/n 字/n 进行/vx 两两/m 比较/vn ，/wd 然后/c 在/p 其中/rz 厂/n 詈/n ]/wky 个/q 较/d 小/a 者/k 之间/f 再/d 进行/vx 两两/m 比较/vn ，/wd 如此/rzv 重复/v ，/wd 直至/v 选/v 出/vf 最/d 小/a 关键字/n 的/ude1 记录/n 为止/u 。/wj 这个/rz 过程/n 可/v 用/p 一/m 棵/q 有/vyou ”/wyy 个/q 叶子/n 结点/n 的/ude1 完全/a 二/m 叉树/n 表示/v 。/wj 一/m 例如/v ，/wd 图/n 10．9/m (/wkz a/x )/wky 中/f 的/ude1 二/m 叉树/n 表示/v 从/p 8/m 个/q 关键字/n 中/f 选/v 出/vf 最/d 小/a 关键字/n 的/ude1 过程/n 。/wj 8/m 个/q 叶子/n 结点/n 中/f 依次/d 存放/v 排序/vi 之前/f 的/ude1 8/m 个/q 关键/n 字/n ，/wd 每个/r 非/b 终端/n 结点/n 中/f 的/ude1 关键字/n 均等/vi 于/p 其/rz 左/a 、/wn 右/f 孩子/n 结点/n 中/f 较/d 小/a 的/ude1 关键/n 字/n ，/wd 则/c 根/n 结点/n 中/f 的/ude1 关键/n 字/n 即/d 为/v 叶子/n 结点/n 中/f 的/ude1 最/d 小/a 关键字/n 。/wj 在/p 输出/v 最/d 小/a 关键字/n 之后/f ，/wd 根据/p 关系/n 的/ude1 可/c 传递/v 性/ng ，/wd 欲/d 选出/v 次/qv 小/a 关键字/n ，/wd 仅/d 需/v 将/p 叶子/n 结点/n 中/f 的/ude1 最/d 小/a 关键字/n (/wkz 13/m )/wky 改/v 为/v “/wyz 最/d 大值/n ”/wyy ，/wd 然后/c 从/p 该/rz 叶子/n 结点/n 开始/v ，/wd 和/cc 其/rz 左/a (/wkz 或/c 右/f )/wky 兄弟/n 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 修改/v 从/p 叶子/n 结点/n 到/v 根/n 的/ude1 路径/n 上/f 各/rz 结点/n 的/ude1 关键/n 字/n ，/wd 则/c 根/n 结点/n 的/ude1 关键/n 字/n 即/d 为/v 次/qv 小/a 关键字/n 。/wj 同/p 理/n ，/wd 可/c 依次/d 选出/v 从/p 小/a 到/v 大/a 的/ude1 所有/b 关键字/n (/wkz 参见图/n 10．9/m (/wkz b/x )/wky 和/cc (/wkz c/x )/wky )/wky 。/wj 由于/c 含有/v ，/wd z/x 个/q 叶子/n 结点/n 的/ude1 完全/a 二/m 叉树/n 的/ude1 深度/n 为/p 厂/n log：/x ”/wyy ]/wky +1/m ，/wd 则/c 在/p 树形/n 选择/v 排序/vi 中/f ，/wd 除了/p 最/d 小/a 关键字/n 之外/f ，/wd 每/rz 选择/v 一个/mq 次/qv 小/a 关键字/n 仅/d 需/v 进行/vx 厂/n bg2n/x ]/wky 次比较/n ，/wd 因此/c ，/wd 它/rr 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz ，/wd zlog2n/x )/wky 。/wj 但是/c ，/wd 这种/r 排序/vn 方法/n 尚/d 有/vyou 辅助存储/n 空间较/n 多/a 、/wn 和/cc “/wyz 最/d 大值/n ”/wyy 进行/vx 多余/a 的/ude1 比较/vn 等/udeng 缺点/n 。/wj 为了/p 弥补/v ，/wd 威洛姆斯/nrf (/wkz J．willioms/x )/wky 在/p 1964年/t 提出/v 了/ule 另/rz 一/m 种/q 形式/n 的/ude1 选择/vn 排序/vn ――/wp 堆/v 排序/vi 。/wj 
10．4．3/m 堆/q 排序/vi 
堆/v 排序/vi (/wkz Ileap/x  Sort/x )/wky 只/d 需要/v 一个/mq 记录/n 大小/n 的/ude1 辅助/vn 空间/n ，/wd 每个/r 待/vi 排序/vi 的/ude1 记录/n 仅/d 占/v 有/vyou 一个/mq ・/w 278・/m 
    (/wkz a/x )/wky 选拔/v 冠军/n 的/ude1 比赛/vn 程序/n ；/wf (/wkz b/x )/wky 选拔/v 亚军/n 的/ude1 两/m 场/qv 比赛/vn ；/wf (/wkz c/x )/wky 选拔/v 殿军/n 的/ude1 两/m 场/qv 比赛/vn 。/wj 
存储空间/n 。/wj 
    堆/v 的/ude1 定义/n 如下/vi ：/wp ”/wyy 个/q 元素/n 的/ude1 序列/n m/x 。/wj ，/wd 五/m 2/m ，/wd …/ws ，/wd 忌/v 。/wj }/n 当/v 且/c 仅/d 当/v 满足/v 下/vf 关系/n 时/ng ，/wd 称之为/v 堆/q 。/wj 
    若/c 将/d 和/p 此/rzs 序列/n 对应/vi 的/ude1 一/m 维/q 数组/n (/wkz 即/v 以/p 一/m 维/q 数组/n 作/v 此/rzs 序列/n 的/ude1 存储/vn 结构/n )/wky 看成/v 是/vshi 一个/mq 完全/a 二/m 叉树/n ，/wd 则/c 堆/v 的/ude1 含义/n 表明/v ，/wd 完全/ad 二/m 叉树/n 中/b 所有/b 非/b 终端/n 结点/n 的/ude1 值/n 均/d 不/d 大于/v (/wkz 或/c 不/d 小于/v )/wky 其/rz 左/a 、/wn 右/f 孩子/n 结点/n 的/ude1 值/n 。/wj 由此/d ，/wd 若/c 序列/n }/n 七/m l/x ，/wd 是/vshi 2/m ，/wd …/ws ，/wd 尼/b 。/wj }/n 是/vshi 堆/q ，/wd 则/c 堆/v 顶/v 元素/n (/wkz 或/c 完全/a 二/m 叉树/n 的/ude1 根/n )/wky 必/d 为/v 序列/n 中/f 扎/v 个/q 元素/n 的/ude1 最/d 小/a 值/n (/wkz 或/c 最/d 大值/n )/wky 。/wj 例如/v ，/wd 下列/b 两/m 个/q 序列/n 为/v 堆/q ，/wd 对应/vi 的/ude1 完全/a 二/m 叉树/n 如/v 图/n 10．10/m 所/usuo 示/vg 。/wj 
    图/n 10．9/m 树形/n 选择/vn 排序/vn 示例/n 
(/wkz a/x )/wky ~/n _/n ／ilt/x 小/a 关键字/n 为/p 13/m ；/wf (/wkz b/x )/wky 选出/v 次/qv 小/a 关键字/n 为/p 27/m ；/wf (/wkz c/x )/wky 选出/v 居/v 第三/m 的/ude1 关键/n 字/n 为/p 38/m 。/wj 
    图/n 10．10/m 堆/q 的/ude1 示例/n 
    (/wkz a/x )/wky 堆/v 顶/v 元素/n 取/v 最/d 大值/n ；/wf (/wkz b/x )/wky 堆/v 顶/v 元素/n 取/v 最/d 小/a 值/n 。/wj 
　　若/c 在/p 输出/v 堆/k 顶/v 的/ude1 最/d 小/a 值/n 之后/f ，/wd 使得/vi 剩余/v n-1/x 个/q 元素/n 的/ude1 序列/n 重/d 又/d 建成/v 一个/mq 堆/v ，/wd 则/c 得到/v ”/wyy 个/q 元素/n 中/f 的/ude1 次/qv 小/a 值/n 。/wj 如此/rzv 反复执行/n ，/wd 便/d 能/v 得到/v 一个/mq 有序/a 序列/n ，/wd 这个/rz 过程/n 称之为/v 堆/k 排序/vi 。/wj 
　　由此/d ，/wd 实现/v 堆/k 排序/vi 需要/v 解决/v 两/m 个/q 问题/n ：/wp (/wkz 1/m )/wky 如何/ryv 由/p 一个/mq 无序/b 序列/n 建成/v 一个/mq 堆/v ?/ww (/wkz 2/m )/wky 如何/ryv 在/p 输出/v 堆/k 顶/v 元素/n 之后/f ，/wd 调整/v 剩余/vn 元素/n 成为/v 一个/mq 新/a 的/ude1 堆/n ?/ww 
　　下面/f 先/d 讨论/v 第二/m 个/q 问题/n 。/wj 例如/v ，/wd 图/n 10．11/m (/wkz a/x )/wky 是/vshi 个/q 堆/n ，/wd 假设/v 输出/v 堆/k 顶/v 元素/n 之后/f ，/wd 以/p 堆/v 中/f 最后/f 一个/mq 元素/n 替代/v 之/uzhi ，/wd 如/v 图/n 10．11/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 此时/r 根/n 结点/n 的/ude1 左/a 、/wn 右/f 子/ng 树/n 均/d 为/v 堆/q ，/wd 则/c 仅/d 需/v 自/p 上/f 至/p 下/f 进行/vx 调整/vn 即可/v 。/wj 首先/c 以/p 堆/v 顶/v 元素/n 和/cc 其/rz 左/a 、/wn 右/f 子/ng 树根/n 结点/n 的/ude1 值/n 比较/d 之/uzhi ，/wd 由于/p 右/f 子/ng 树根/n 结点/n 的/ude1 值/n 小于/v 左/f 子树根/nr 结点/n 的/ude1 值/n 且/c 小于/v 根/n 结点/n 的/ude1 值/n ，/wd 则/c 将/p 27/m 和/cc 97/m 交换/v 之/rz ；/wf 由于/p 97/m 替代/v 了/ule 27/m 之后/f 破坏/v 了/ule 右/f 子/ng 树/n 的/ude1 “/wyz 堆/v ”/wyy ，/wd 则/c 需/v 进行/vx 和/cc 上述/b 相同/a 的/ude1 调整/vn ，/wd 直至/v 叶子/n 结点/n ，/wd 调整/v 后/f 的/ude1 状态/n 如/v 图/n 10．11/m (/wkz c/x )/wky 所/usuo 示/vg ，/wd 此时/r 堆/v 顶/ng 为/v n-1/x 个/q 元素/n 中/f 的/ude1 最/d 小/a 值/n 。/wj 重复/v 上述/b 过程/n ，/wd 将/d 堆/v 顶/v 元素/n 27/m 和/cc 堆/v 中/f 最后/f 一个/mq 元素/n 97/m 交换/v 且/c 调整/v ，/wd 得到/v 如/v 图/n 10．11/m (/wkz d/x )/wky 所/usuo 示/vg 新/a 的/ude1 堆/n 。/wj 
    图/n 10．11/m 输出/v 堆/k 顶/v 元素/n 并/cc 调整/v 建/v 新/a 堆/k 的/ude1 过程/n 
(/wkz a/x )/wky  堆/v ；/wf (/wkz b/x )/wky 13/m ~/n 97/m 交换/v 后/f 的/ude1 情形/n ；/wf (/wkz c/x )/wky 调整/v 后/f 的/ude1 新/a 推/v ；/wf (/wkz d/x )/wky 27/m 和/cc 97/m 交换/v 后/f 再/d 进行/vx 调整/vn 建成/v 的/ude1 新/a 堆/q 。/wj 
(/wkz b/x )/wky      我们/rr 称/v 这个/rz 自/p 堆/v 顶/v 至/p 叶子/n 的/ude1 调整/vn 过程/n 为/v “/wyz 筛选/v ”/wyy 。/wj 
    从/p 一个/mq 无序/b 序列/n 建/v 堆/k 的/ude1 过程/n 就/d 是/vshi 一个/mq 反复/d “/wyz 筛选/v ”/wyy 的/ude1 过程/n 。/wj 若/c 将/p 此/rzs 序列/n 看成/v 是/vshi 一个/mq 完全/a 二/m 叉树/n ，/wd 则/c 最后/f 一个/mq 非/b 终端/n 结点/n 是/vshi 第/m L/x 恕/vg ／2/m  J/x 个/q 元素/n ，/wd 由此/d “/wyz 筛选/v ”/wyy 只/d 需/v 从/p 第/m L/x 个/q 元素/n 开始/v 。/wj 例如/v ，/wd 图/n 10．12/m (/wkz a/x )/wky 中/f 的/ude1 二/m 叉树/n 表示/v 一个/mq 有/vyou 8/m 个/q 元素/n 的/ude1 无序/b 序列/n     {/n 49/m ，/wd 38/m ，/wd 65/m ，/wd 97/m ，/wd 76/m ，/wd 13/m ，/wd 27/m ，/wd 丽/ag }/n 则/d 筛选/v 从/p 第4/m 个/q 元素/n 开始/v ，/wd 由于/c 97/m >/n 丽/ag ，/wd 则/c 交换/v 之/uzhi ，/wd 交换/v 后/f 的/ude1 序列/n 如/v 图/n 10．12/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 同/p 理/n ，/wd 在/p 第3/m 个/q 元素/n 65/m 被/pbei 筛选/v 之后/f 序列/n 的/ude1 状态/n 如/v 图/n 10．12/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 由于/p 第2/m 个/q 元素/n 38/m 不/d 大/a 于/p 其/rz 左/a 、/wn 右/f 子/ng 树根/n 的/ude1 值/n ，/wd 则/c 筛选/v 后/f 的/ude1 序列/n 不/d 变/v 。/wj 图/n 10．12/m (/wkz e/x )/wky 所/usuo 示/vg 为/p 筛选/v 根/q 元素/n 49/m 之后/f 建成/v 的/ude1 堆/n 。/wj     
    堆/v 排序/vi 的/ude1 算法/n 如/v 算法/n 10．11/m 所/usuo 示/vg ，/wd 其中/rz 筛选/v 的/ude1 算法/n 如/v 算法/n 10．10/m 所/usuo 示/vg 。/wj 为/p 使/v 排序/vn 结果/n 和/cc 10．1/m 节/q 中/f 的/ude1 定义/n 一致/an ，/wd 即/v ：/wp 使/v 记录/v 序列/n 按/p 关键字/n 非/b 递减/vn 有序/ad 排列/v ，/wd 则/c 在/p 堆/v 排序/vi 的/ude1 算法/n 中/f 先/d 建/v 一个/mq “/wyz 大/a 顶/ng 堆/v ”/wyy ，/wd 即/d 先/d 选/v 得/ude3 一个/mq 关键/a 字/n 为/v 最/d 大/a 的/ude1 记录/n 并/cc 与/p 序列/n 中/f 最后/f 一个/mq 记录/n 交换/v ，/wd 然后/c 对/p 序列/n 中/f 前/f 他/rr -/wp 1/m 记录/n 进行/vx 筛选/vn ，/wd 重新/d 将/p 它/rr 调整/v 为/v 一个/mq “/wyz 大/a 顶/ng 堆/v ”/wyy ，/wd 如此/rzv 反复/d 直至/v 排序/vi 结束/v 。/wj 由此/d ，/wd “/wyz 筛选/v ”/wyy 应/v 沿/p 关键字/n 较/d 大/a 的/ude1 孩子/n 结点/n 向/p 下/f 进行/vx 。/wj 
typ．def/x  sqList/x  HeapType/x ；/wf     ∥/w 堆/v 采用/v 顺序/n 表存储/n 表示/v 
void/x  HeapAdjust/x (/wkz HeapType/x &/n H/x ’/wyy int/x  s/x ，/wd int/x  m/x )/wky {/n 
  ∥/w 已/d 知/v H．r/x [/wkz s．．m/x ]/wky 中/f 记录/v 的/ude1 关键字/n 除/p H．r/x [/wkz 8/m ]/wky ．/w key/x 之/uzhi 外/f 均满足/n 堆/k 的/ude1 定义/n ，/wd 本/rz 函数/n 调整/v H．r/x [/wkz s/x ]/wky   ∥/w 的/ude1 关键/n 字/n ，/wd 使/v H．r/x [/wkz s．．m/x ]/wky 成为/v 一个/mq 大/a 顶/ng 堆/v (/wkz 对/p 其中/rz 记录/n 的/ude1 关键字/n 而言/uls )/wky 
∥/w 将/d 堆/v 顶/ng 记录/v 和/cc 当前/t 未经/d 排序/vi 于/p 序列/n Mr/x 【/wkz 1/m  1/m 】/wky 中/f 
∥/w 最后/f 一个/mq 记录/n 相互/d 交换/v 
∥/w 将/d H/x  r/x [/wkz 1--1/m ]/wky 重新/d 调整/v 为/p 大/a 顶/ng 堆/v 
算法/n 10/m  11/m 
    堆/v 排序/vn 方法/n 对/p 记录/v 数/n 较/d 少/a 的/ude1 文件/n 并/cc 不/d 值得/v 提倡/v ，/wd 但/c 对/p ”/wyy 较/d 大/a 的/ude1 文件/n 还是/c 很/d 有效/a 的/ude1 。/wj 因为/p 其/rz 运行/vn 时间/n 主要/d 耗费/v 在建/v 初始/b 堆/n 和/cc 调整/v 建/v 新/a 堆/n 时/ng 进行/vx 的/ude1 反复/d “/wyz 筛选/v ’/wyy ’/wyy 上/f 。/wj 对/p 深度/n 为/v n/x 的/ude1 堆/n ，/wd 筛选/v 算法/n 中/f 进行/vx 的/ude1 关键/n 字/n 比较/vn 次数/n 至多/d 为/v 2/m (/wkz 忌/v -/wp 1/m )/wky 次/qv ，/wd 则/c 在/p 建/v 含/v n/x 个/q 元素/n 、/wn 深度/n 为/p ^/n 的/ude1 堆/n 时/ng ，/wd 总共/d 进行/vx 的/ude1 关键/n 字/n 比较/vn 次数/n 不/d 超过/v 4n/x 。/wj ①/m 又/c ，/wd 以/p 个/q 结点/n 的/ude1 完全/a 二/m 叉树/n 的/ude1 深度/n 为/v L/x  log2/x ，/wd 2/m  J+1/x ，/wd 则/c 调整/v 建/v 新/a 堆/n 时/ng 调用/v }/n teapAdjust/x 过程/n n-1/x 次/qv ，/wd 总共/d 进行/vx 的/ude1 比较/vn 次数/n 不/d 超过/v 下/vf 式/ng 之/uzhi 值/ng ，/wd 由此/d ，/wd 堆/v 排序/vi 在/p 最/d 坏/a 的/ude1 情况/n 下/f ，/wd 其/rz 时间/n 复杂度/n 也/d 为/v 0/m (/wkz nlog/x ”/wyy )/wky 。/wj 相对/d 于/p 快速/b 排序/vn 来说/uls ，/wd 这/rzv 是/vshi 堆/v 排序/vi 的/ude1 最/d 大/a 优点/n 。/wj 此外/c ，/wd 堆/v 排序/vi 仅/d 需/v 一个/mq 记录/n 大小/n 供/vi 交换/v 用/v 的/ude1 辅助存储/n 空间/n 。/wj 
10．5/m   归并/vi 排序/vi 
    归并/vi 排序/vi (/wkz Merging/x  Sort/x )/wky 是/vshi 又/d 一/m 类/q 不同/a 的/ude1 排序/vn 方法/n 。/wj “/wyz 归并/vi ”/wyy 的/ude1 含义/n 是/vshi 将/p 两/m 个/q 或/c 两/m 个/q 以上/f 的/ude1 有序/a 表/n 组合/vd 成/v 一个/mq 新/a 的/ude1 有序/a 表/n 。/wj 它/rr 的/ude1 实现/vn 方法/n 早已/d 为/v 读者/n 所/usuo 熟悉/v ，/wd 无论是/c 顺序/n 存储/vn 结构/n 还/d 是/vshi 链/ng 表存储/n 结构/n ，/wd 都/d 可/v 在/p 0/m (/wkz 优/ag +/m 竹/ng )/wky ②/m 的/ude1 时间/n 量级/n 上/f 实现/v 。/wj 利用/v 归并/vi 的/ude1 思想/n 容易/ad 实现/v 排序/vi 。/wj 假设/v 初始序列/n 含有/v 礼/n 个/q 记录/n ，/wd 则/c 可/v 看成/v 是/vshi 竹/n 个/q 有序/a 的/ude1 子/ng 序列/n ，/wd 每/rz 个子/n 序列/n 的/ude1 长度/n 为/p 1/m ，/wd 然后/c 两两/m 归并/vi ，/wd 得到/v r/x 等/udeng ]/wky 个/q 长度/n 为/p 2/m 或/c 1/m 的/ude1 有序/a 子/ng 序列/n ；/wf 再/d 两两/m 归并/vi ，/wd …/ws …/ws ，/wd 如此/rzv 重复/v ，/wd 直至/v 得到/v 一个/mq 长度/n 为/v n/x 的/ude1 有序/a 序列/n 为止/u ，/wd 这种/r 排序/vn 方法/n 称为/v 2．/m 路/qv 归并/vi 排序/vi 。/wj 例如/v 图/n 10．13/m 为/p 2．/m 路/qv 归并/vi 排序/vi 的/ude1 一个/mq 例子/n 。/wj 
初始/b 关键字/n 
一/m 趟/qv 归并/vi 之后/f 
二/m 趟/qv 归并/vi 之后/f 
    图/n 1Q/x  13/m 争/v 路/n 归并/vi 排序/vi 示例/n 
    2/m 一路/mq 归并/vi 排序/vi 中/f 的/ude1 核心/n 操作/vn 是/vshi 将/p 一/m 维/q 数组/n 中/f 前后/f 相邻/vi 的/ude1 两/m 个/q 有序/a 序列/n 归并/vi 为/v 一个/mq 有序/a 序列/n ，/wd 其/rz 算法/n (/wkz 类似/v 于/p 算法/n 2．7/m )/wky 如/v 算法/n 10．12/m 所/usuo 示/vg 。/wj 
vold/x  Merge/x (/wkz RcdType/x  sa/x [/wkz ]/wky ，/wd aed/x ~/n hrpe/x ＆/n TR/x [/wkz ]/wky ，/wd int/x  i/x ，/wd 城/n m/x ，/wd int/x  n/x )/wky {/n 
  ∥/w 将/d 有序/a 的/ude1 sa/x [/wkz i．．m/x ]/wky 和/cc sa/x [/wkz m+1．．n/x ]/wky 归并/vi 为/p 有序/a 的/ude1 Ta/x [/wkz i．．n/x ]/wky 
  for/x (/wkz j=m+1/x ，/wd k=i/x ；/wf i/x </n =m/x ＆/n &/n j/x </n =n/x ；/wf 十/m +k/x )/wky l/x     ∥/w 将/d sR/x 中/f 记录/v 由小到大/vl 地/ude2 并入/v TR/x 
  ①/m 由于/p 第/m i/x 层/n 上/f 的/ude1 结/v 点数/n 至多/d 为/v 2i-1/x ，/wd 以/p 它们/rr 为/p 根/n 的/ude1 二/m 叉树/n 的/ude1 深度/n 为/p ^/n 一/m i+1/x 。/wj 则/c 调用/v l/x 号/n J/x 次/qv HeapAdjust/x 
过程/n 时/ng 总/d 共/d 进行/vx 的/ude1 关键/n 字/n 比较/vn 次数/n 不/d 超过/v 下/vf 式/ng 之/uzhi 值/n ：/wp 
    算法/n 10．12/m 
    一/m 趟/qv 归并/vi 排序/vi 的/ude1 操作/vn 是/vshi ，/wd 调用/v n/x 次/qv 算法/n merge/x 将/d SR/x [/wkz 1．．n/x ]/wky 中/f 前后/f 相邻/vi 且/c 长度/n 
为/p ^/n 的/ude1 有序/a 段/q 进行/vx 两两/m 归并/vi ，/wd 得到/v 前后/f 相邻/vi 、/wn 长度/n 为/p 2/m 矗/n 的/ude1 有序/a 段/q ，/wd 并/cc 存放/v 在/p TR/x [/wkz 1．．n/x ]/wky 中/f ，/wd 整个/b 归并/vi 排序/vi 需/v 进行/vx [/wkz 10g2/x ，/wd z/x ]/wky 趟/v 。/wj 可见/c ，/wd 实现/v 归并/vi 排序/vi 需/v 和/cc 待/vi 排/v 记录/v 等/udeng 数量/n 的/ude1 辅助/vn 空间/n ，/wd 其/rz 时间/n 复杂度/n 为/v o/x (/wkz nlog2n/x )/wky 。/wj 
    递归/n 形式/n 的/ude1 2．/m 路/qv 归并/vi 排序/vi 的/ude1 算法/n 如/v 算法/n 10．13/m 和/cc 算法/n 10．14/m 所/usuo 示/vg 。/wj 值得/v 提醒/v 的/ude1 是/vshi ，/wd 递归/n 形式/n 的/ude1 算法/n 在/p 形式/n 上/f 较/d 简洁/a ，/wd 但/c 实用/a 性/ng 很/d 差/a 。/wj 其非/nr2 递归/n 形式/n 的/ude1 算法/n 可/v 查阅/v 参考/vn 书目/n [/wkz 1/m ]/wky 。/wj 
    与/p 快速/b 排序/vn 和/cc 堆/v 排序/vi 相比/vi ，/wd 归并/vi 排序/vi 的/ude1 最/d 大/a 特点/n 是/vshi ，/wd 它/rr 是/vshi 一/m 种/q 稳定/a 的/ude1 排序/vn 方法/n 。/wj 但/c 在/p 一般/a 情况/n 下/f ，/wd 很/d 少/ad 利用/v 2/m 一路/mq 归并/vi 排序/vi 法/n 进行/vx 内部/f 排序/vi ，/wd 其它/rz 形式/n 的/ude1 归并/vi 排序/vi 如/v 本书/r 习题集/n 中/b 习题/n 10．17/m 所/usuo 述/vg 。/wj 
  ∥/w 将/d sR/x [/wkz s．．t/x ]/wky 归并/vi 排序/vi 为/v TRI/x [/wkz s．．t/x ]/wky 。/wj 
  if/x (/wkz s==t/x )/wky TRI/x [/wkz s/x ]/wky =sR/x [/wkz s/x ]/wky ；/wf 
  e18・l/x 
    m=/x (/wkz s+t/x )/wky ／2/m ；/wf     ∥/w 将/d sR/x [/wkz s．．t/x ]/wky 平分/v 为/v sR/x [/wkz s．．m/x ]/wky 和/cc sR/x [/wkz e+1．．t/x ]/wky 
    MSort/x (/wkz sR/x ，/wd 啦/y ，/wd s/x ，/wd m/x )/wky ；/wf     ∥/w 递归/n 地/ude2 将/p SR/x [/wkz s．．m/x ]/wky 归并/vi 为/p 有序/a 的/ude1 TR2/x 【/wkz s．．m/x ]/wky 
    MSort/x (/wkz ss/x ，/wd TR2/x ，/wd m+l/x ，/wd t/x )/wky ；/wf   ∥/w 递归/n 地/ude2 将/p sR/x [/wkz m+1．．t/x ]/wky 归并/vi 为/p 有序/a 的/ude1 TR2/x [/wkz m+1．．t/x ]/wky 
    Merge/x (/wkz 啦/y ，/wd TRl/x ，/wd s/x ，/wd m/x ，/wd t/x )/wky ；/wf ∥/w 将/d TR2/x [/wkz s．．m/x ]/wky 和/cc TR2/x [/wkz m+1．．t/x ]/wky 归并/vi 到/v TRI/x [/wkz s．．t/x ]/wky 
  }/n 
}/n ∥/w MSort/x 
    算法/n 10．13/m 
woi4/x  MergeSort/x (/wkz SqList/x  aL/x )/wky l/x 
  ∥/w 对/p 顺序/n 表/n L/x 作/v 归并/vi 排序/vi 。/wj 
  MSorlt/x (/wkz L．r/x ，/wd L/x 。/wj r/x ，/wd l/x ，/wd L．1ength/x )/wky ；/wf "/n 
I/x ∥/w MezgeSort/x 
算法/n lO．14/x 
10．6/m 基数/n 排序/vi 
    基数/n 排序/vi (/wkz Radix/x  Sorting/x )/wky 是/vshi 和/p 前面/f 所/usuo 述/vg 各类/r 排序/vn 方法/n 完全/ad 不/d 相同/a 的/ude1 一/m 种/q 排序/vn 方法/n 。/wj 从/p 前/f 几/m 节/q 的/ude1 讨论/vn 可见/c ，/wd 实现/v 排序/vi 主要/d 是/vshi 通过/p 关键字/n 间/f 的/ude1 比较/vn 和/cc 移动/vn 记录/n 这/rzv 两/m 种/q 操作/vn ，/wd 而/cc 实现/v 基数/n 排序/vi 不/d 需要/v 进行/vx 记录/vn 关键字/n 间/f 的/ude1 比较/vn 。/wj 基数/n 排序/vn 是/vshi 一/m 种/q 借助/v 多/a 关键字/n 排序/vi 的/ude1 思想/n 对/p 单/b 逻辑/n 关键字/n 进行/vx 排序/vn 的/ude1 方法/n 。/wj 
  10．6．1/m 多/m 关键字/n 的/ude1 排序/vn 
  什么/ry 是/vshi 多/a 关键字/n 排序/vn 问题/n ?/ww 先/d 看/v 一个/mq 具体/a 例子/n 。/wj 
  已/d 知/v 扑克牌/n 中/f 52/m 张/q 牌/n 面的/n 次序/n 关系/n 为/v ：/wp 
    ●/w 2/m </n ．/w ．/w 13/m </n …/ws </n ．/w ．/w ．/w A/x </n ◆/n 2/m </n ◆/n 3/m </n …/ws </n ◆/n A/x 
    </n ◆/n 2/m </n 1-13/m </n …/ws </n ◆/n A/x </n ．/w ．/w -/wp 2/m </n ●/w 3/m </n …/ws </n ●/w A/x 
每/rz 一/m 张/q 牌/n 有/vyou 两/m 个/q “/wyz 关键/n 字/n ”/wyy ：/wp 花色/n (/wkz ．/w ．/w ．/w </n ◆/n </n ◆/n </n ．/w ．/w I/x )/wky 和/cc 面值/n (/wkz 2/m </n 3/m </n …/ws </n A/x )/wky ，/wd 且/c “/wyz 花色/n ”/wyy 的/ude1 地位/n 高于/v “/wyz 面值/n ”/wyy ，/wd 在/p 比较/d 任意/d 两/m 张/q 牌/n 面/n 的/ude1 大小/n 时/ng ，/wd 必须/d 先/d 比较/d “/wyz 花色/n ”/wyy ，/wd 若/c “/wyz 花色/n ”/wyy 相同/a ，/wd 则/c 再/d 比较/v 面值/n 。/wj 由此/d ，/wd 将/p 扑克牌/n 整理/v 成/v 如上所述/c 次序/n 关系/n 时/ng ，/wd 通常/d 采用/v 的/ude1 办法/n 是/vshi ：/wp 先/d 按/p 不同/a “/wyz 花色/n ”/wyy 分成/vi 有/vyou 次序/n 的/ude1 四/m 堆/q ，/wd 每/rz 一/m 堆/q 的/ude1 牌/n 均/d 具有/v 相同/a 的/ude1 “/wyz 花色/n ”/wyy ，/wd 然后/c 分别/d 对/p 每/rz 一/m 堆/q 按/p “/wyz 面值/n ”/wyy 大/d 小/a 整理/v 有序/a 。/wj 
    也/d 可/v 采用/v 另/rz 一/m 种/q 办法/n ：/wp 先/d 按/p 不同/a “/wyz 面值/n ”/wyy 分成/vi 13/m 堆/q ，/wd 然后/c 将/p 这/rzv 13/m 堆/q 牌/n 自/p 小/a 至/p 大/a 叠/v 在/p 一起/s (/wkz “/wyz 3/m ”/wyy 在/p “/wyz 2/m ”/wyy 之上/f ，/wd “/wyz 4/m ”/wyy 在/p “/wyz 3/m ”/wyy 之上/f ，/wd …/ws …/ws ，/wd 最/d 上面/f 的/ude1 是/vshi 4/m 张/q “/wyz A/x ”/wyy )/wky ，/wd 然后/c 将/p 这/rzv 付/v 牌/n 整个/b 颠倒/v 过来/vf 再/d 重新/d 按/p 不同/a “/wyz 花色/n ”/wyy 分成/vi 4/m 堆/q ，/wd 最后/f 将/d 这/rzv 4/m 堆/q 牌/n 按/p 自/rr 小/a 至/p 大/a 的/ude1 次序/n 合/v 在/p 一起/s (/wkz ●/w 在/p 最/d 下面/f ，/wd ．/w ．/w I/x 在/p 最/d 上面/f )/wky ，/wd 此时/r 同样/d 得到/v 一/m 付/v 满足/v 如上/b 次序/n 关系/n 的/ude1 牌/n 。/wj 这/rzv 两/m 种/q 整理/vn 扑克牌/n 的/ude1 方法/n 便/d 是/vshi 两/m 种/q 多/a 关键字/n 的/ude1 排序/vn 方法/n 。/wj 
    一般/a 情况/n 下/f ，/wd 假设/v 有/vyou n/x 个/q 记录/n 的/ude1 序列/n 
    {/n R1/x ，/wd R2/x ，/wd …/ws R/x 。/wj }/n     (/wkz 10―10/m )/wky 
且/c 每/rz 个/q 记录/n Ri/x 中/f 含有/v d/x 个/q 关键/n 字/n (/wkz K/x ?/ww ，/wd K：/x ，/wd …/ws ，/wd 础/ng -/wp 1/m )/wky ，/wd 则/c 称/v 序列/n (/wkz 10-10/m )/wky 对/p 关键/n 字/n (/wkz K/x 。/wj ，/wd K/x 。/wj ，/wd …/ws ，/wd K/x 扣/v ’/wyy )/wky 有序/ad 是/vshi 指/v ：/wp 对于/p 序列/n 中/f 任意/d 两/m 个/q 记录/n Ri/x 和/cc Rj/x (/wkz 1≤i/x </n ．/w j≤n/x )/wky 都/d 满足/v 下列/b 有序/a 关系/n ①/m ：/wp 
    (/wkz K/x ?/ww ，/wd Kj/x ，/wd …/ws ，/wd K：-1/x )/wky </n (/wkz K/x ?/ww ，/wd Kj/x ，/wd …/ws ，/wd Kj/x 。/wj )/wky 
其中/rz K/x 。/wj 称为/v 最/d 主/ag 位/ng 关键字/n ，/wd Kd/x 。/wj 称为/v 最/d 次位/n 关键字/n 。/wj 为/p 实现/v 多/a 关键字/n 排序/vi ，/wd 通常/d 有/vyou 两/m 种/q 方法/n ：/wp 第一/m 种/q 方法/n 是/vshi ：/wp 先/d 对/p 最/d 主/ag 位/ng 关键字/n K0/x 进行/vx 排序/vn ，/wd 将/p 序列/n 分成若干/n 子/q 序列/n ，/wd 每/rz 个子/n 序列/n 中/f 的/ude1 记录/n 都/d 具有/v 相同/a 的/ude1 K/x 。/wj 值/n ，/wd 然后/c 分别/d 就/d 每/rz 个子/n 序列/n 对/p 关键字/n K/x ’/wyy 进行/vx 排序/vn ，/wd 按/p K/x 。/wj 值/n 不/d 同/p 再/d 分成若干/n 更/d 小/a 的/ude1 子/ng 序列/n ，/wd 依次/d 重复/v ，/wd 直至/v 对/p ．/w Kaq/x 进行/vx 排序/vn 之后/f 得到/v 的/ude1 每/rz 一/m 子/q 序列/n 中/f 的/ude1 记录/n 都/d 具有/v 相同/a 的/ude1 关键/n 字/n (/wkz Ko/x ，/wd K/x ‘/wyz ，/wd …/ws ，/wd K/x 扩/vg 。/wj )/wky ，/wd 而后/d 分别/d 每/rz 个子/n 序列/n 对/p K/x 。/wj 进行/vx 排序/vn ，/wd 最后/f 将/d 所有/vi 子/ng 序列/n 依次/d 联接/v 在/p 一起/s 成为/v 一个/mq 有序/a 序列/n ，/wd 这种/r 方法/n 称之为/v 最高/a 位/q 优先/v (/wkz Most/x  Significant/x  Digit．first/x )/wky 法/n ，/wd 简称/v MSD/x 法/n ；/wf 第二/m 种/q 方法/n 是/vshi 从/p 最/d 次位/n 关键字/n Kd/x  11/m 起/q 进行/vx 排序/vn 。/wj 然后/c 再/d 对/p 高/a 一/m 位/q 的/ude1 关键/n 字/n Kd/x  1/m 进行/vx 排序/vn ，/wd 依次/d 重复/v ，/wd 直至/v 对/p Ko/x 进行/vx 排序/vn 后/f 便/d 成为/v 一个/mq 有序/a 序列/n 。/wj 这种/r 方法/n 称之为/v 最低/a 位/q 优先/v (/wkz I/x ~/n east/x  Significant/x  Digit/x  first/x )/wky 法/n ，/wd 简称/v LSD/x 法/n 。/wj 
    MSD/x 和/cc L/x ,/wd SD/x 只/d 约定/v 按/p 什么样/ryv 的/ude1 “/wyz 关键字/n 次序/n ”/wyy 来/f 进行/vx 排序/vn ，/wd 而/cc 未/d 规定/v 对/p 每个/r 关键字/n 进行/vx 排序/vn 时/ng 所/usuo 用/v 的/ude1 方法/n 。/wj 但/c 从/p 上面/f 所/usuo 述/vg 可以/v 看出/v 这/rzv 两/m 种/q 排序/vn 方法/n 的/ude1 不同/a 特点/n ：/wp 若/c 按/p ①/m   (/wkz “/wyz 。/wj ，/wd Ⅱ/m 。/wj ，/wd …/ws ，/wd 口/q 。/wj 一/m 。/wj )/wky </n (/wkz 6/m 。/wj ，/wd 6/m ’/wyy ，/wd …/ws ，/wd ∥/w 一/m ’/wyy )/wky 是/vshi 指/v 必定/d 存在/v z/x ，/wd 使得/vi }/n 当/p 5=0/m ，/wd …/ws ，/wd z―l/x 时/ng ，/wd akbe/x 。/wj 而/cc a/x ‘/wyz </n b/x ‘/wyz 。/wj 
．/w MS/x [/wkz )/wky 进行/vx 排序/vn ，/wd 必须/d 将/p 序列/n 逐/vg 层/n 分割成若干/n 子/q 序列/n ，/wd 然后/c 对/p 各/rz 子/ng 序列/n 分别/d 进行/vx 排序/vn ；/wf 而/cc 按/p LsD/x 进行/vx 排序/vn 时/ng ，/wd 不必/d 分成/vi 子/ng 序列/n ，/wd 对/p 每个/r 关键字/n 都/d 是/vshi 整个/b 序列/n 参加/v 排序/vi ，/wd 但/c 对/p K/x ’/wyy (/wkz 0≤i≤d/x 一/m 2/m )/wky 进行/vx 排序/vn 时/ng ，/wd 只能/v 用/p 稳定/a 的/ude1 排序/vn 方法/n 。/wj 另一方面/c ，/wd 按/p LSD/x 进行/vx 排序/vn 时/ng ，/wd 在/p 一定/b 的/ude1 条件/n 下/f (/wkz 即/v 对/p 前/f 一个/mq 关键/a 字/n Ki/x (/wkz 0≤i≤d/x 一/m 2/m )/wky 的/ude1 不同/a 值/n ，/wd 后/f 一个/mq 关键/a 字/n KH/x ‘/wyz 均/d 取/v 相同/a 值/n )/wky ，/wd 也/d 可以/v 不/d 利用前/n 几/m 节/q 所/usuo 述/vg 各种/rz 通过/p 关键字/n 间/f 的/ude1 比较/d 来/vf 实现/v 排序/vi 的/ude1 方法/n ，/wd 而是/c 通过/p 若干/m 次/qv “/wyz 分配/v ”/wyy 和/cc “/wyz 收集/v ”/wyy 来/f 实现/v 排序/vi ，/wd 如/v 上述/b 第二/m 种/q 整理/vn 扑克牌/n 的/ude1 方法/n 那样/rzv 。/wj 
  10．6．2/m 链式/n 基数/n 排序/vi 
  基数/n 排序/vn 是/vshi 借助/v “/wyz 分配/v ”/wyy 和/cc “/wyz 收集/v ”/wyy 两/m 种/q 操作/v 对/p 单/b 逻辑/n 关键字/n 进行/vx 排序/vn 的/ude1 一/m 种/q 内部/f 排序/vi 方法/n 。/wj 
  有/vyou 的/ude1 逻辑/n 关键字/n 可以/v 看成/v 由/p 若干/m 个/q 关键字/n 复合/vn 而/cc 成/v 的/ude1 。/wj 例如/v ，/wd 若/c 关键字/n 是/vshi 数值/n ，/wd 且/c 其/rz 值/n 都/d 在/p 0≤K≤999/x 范围/n 内/f ，/wd 则/c 可/v 把/pba 每/rz 一个/mq 十/m 进数字/n 看成/v 一个/mq 关键/a 字/n ，/wd 即/d 可/v 认为/v K/x 由/p 三/m 个/q 关键/n 字/n (/wkz K/x 。/wj ，/wd K/x ‘/wyz ，/wd K/x 。/wj )/wky 组成/v ，/wd 其中/rz Ko/x 是/vshi 百/m 位/q 数/n ，/wd K/x ‘/wyz 是/vshi 十/m 位/q 数/n ，/wd K/x 。/wj 是/vshi 个/q 位/q 数/n ；/wf 又/d 若/v 关键字/n K/x 是/vshi 由/p 五/m 个/q 字母/n 组成/v 的/ude1 单词/n ，/wd 则/c 可/v 看成/v 是/vshi 由/p 五/m 个/q 关键/n 字/n (/wkz K0/x ，/wd K/x ’/wyy ，/wd K/x 。/wj ，/wd K0/x ，/wd K/x 。/wj )/wky 组成/v ，/wd 其中/rz 11/m 是/vshi (/wkz 自/p 左/f 至/p 右/f 的/ude1 )/wky 第/m J+1/x 个/q 字母/n 。/wj 由于/p 如此/rzv 分解/v 而/cc 得/v 的/ude1 每个/r 关键字/n 印/b 都/d 在/p 相同/a 的/ude1 范围/n 内/f (/wkz 对/p 数字/n ，/wd 0≤Kj≤9/x ，/wd 对/p 字母/n ’/wyy A/x ’/wyy ≤Kj≤/x ’/wyy Z/x ’/wyy )/wky ，/wd 则/c 按/p LSD/x 进行/vx 排序/vn 更/d 为/v 方便/an ，/wd 只要/c 从/p 最低/a 数位/n 关键字/n 起/vf ，/wd 按/p 关键字/n 的/ude1 不同/a 值/n 将/p 序列/n 中/f 记录/v “/wyz 分配/v ”/wyy 到/v RADIX/x 个/q 队列/n 中/f 后/f 再/d “/wyz 收集/v ”/wyy 之/uzhi ，/wd 如此/rzv 重复/v d/x 次/qv 。/wj 按/p 这种/r 方法/n 实现/v 排序/vi 称之为/v 基数/n 排序/vi ，/wd 其中/rz “/wyz 基/ng ”/wyy 指/v 的/ude1 是/vshi RADIX/x 的/ude1 取值/v 范围/n ，/wd 在/p 上述/b 两/m 种/q 关键字/n 的/ude1 情况/n 下/f ，/wd 它们/rr 分别/d 为/v “/wyz 10/m ”/wyy 和/cc “/wyz 26/m ”/wyy 。/wj 
　　实际上/d ，/wd 早/ad 在/p 计算机/n 出现/v 之前/f ，/wd 利用/v 卡片/n 分类/vn 机/ng 对/p 穿孔/v 卡/n 上/f 的/ude1 记录/n 进行/vx 排序/vn 就是/d 用/v 的/ude1 这种/r 方法/n 。/wj 然而/c ，/wd 在/p 计算机/n 出现/v 之后/f 却/d 长期/d 得/ude3 不/d 到/v 应用/vn ，/wd 原因/n 是/vshi 所/usuo 需/v 的/ude1 辅助/vn 存储量/n (/wkz RADIX×N/x 个/q 记录空间/n )/wky 太/d 大/a 。/wj 直到/v 1954年/t 有人/r 提出/v 用/p “/wyz 计数/vi ”/wyy 代替/v “/wyz 分配/v ”/wyy 才/d 使/v 基数/n 排序/vi 得以/v 在/p 计算机/n 上/f 实现/v ，/wd 但/c 此时/r 仍/d 需要/v 犯/v 个/q 记录/n 和/cc 2×RADIX/x 个/q 计数单元/n 的/ude1 辅助/vn 空间/n 。/wj 
　　此后/t ，/wd 有人/r 提出/v 用/v 链/ng 表/n 作/v 存储/vn 结构/n ，/wd 则/c 又/d 省去/v 了/y ”/wyy 个/q 记录/n 的/ude1 辅助/vn 空间/n 。/wj 下面/f 我们/rr 就/d 来/vf 介绍/v 这种/r “/wyz 链式/n 基数/n 排序/vi ”/wyy 的/ude1 方法/n 。/wj 
    先/d 看/v 一个/mq 具体/a 例子/n 。/wj 首先/c 以/p 静态/n 链/ng 表存储/n n/x 个/q 待/vi 排/v 记录/v ，/wd 并/cc 令/v 表头/n 指针/n 指向/v 第一/m 个/q 记录/n ，/wd 如/v 图/n 10．14/m (/wkz a/x )/wky 所/usuo 示/vg ；/wf 第一/m 趟/qv 分配/v 对/p 最低/a 数位/n 关键字/n (/wkz 个/q 位/q 数/n )/wky 进行/vx ，/wd 改变记录/n 的/ude1 指针/n 值/n 将/d 链/ng 表/n 中/f 的/ude1 记录/n 分配/v 至/p 10/m 个/q 链/ng 队列/n 中/f 去/vf ，/wd 每个/r 队列/n 中/f 的/ude1 记录/n 关键字/n 的/ude1 个/q 位数/n 相等/vi ，/wd 如/v 图/n 10．14/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 其中/rz f/x [/wkz i/x ]/wky 和/cc e/x [/wkz i/x ]/wky 分别/d 为/v 第/m i/x 个/q 队/n 列/v 的/ude1 头/n 指针/n 和/cc 尾/ng 指针/n ；/wf 第一/m 趟/qv 收集/v 是/vshi 改变/v 所有/b 非空/n 队列/n 的/ude1 队尾/n 记录/v 的/ude1 指针/n 域/ng ，/wd 令/v 其/rz 指向/v 下/vf 一个/mq 非空/n 队列/n 的/ude1 队头/n 记录/n ，/wd 重新/d 将/p 10/m 个/q 队列/n 中/f 的/ude1 记录/n 链/ng 成/v 一个/mq 链/ng 表/n ，/wd 如/v 图/n 10．14/m (/wkz c/x )/wky 所/usuo 示/vg ；/wf 第二/m 趟/qv 分配/vn ，/wd 第二/m 趟/qv 收集/v 及/cc 第三/m 趟/qv 分配/vn 和/cc 第三/m 趟/qv 收集/v 分别/d 是/vshi 对/p 十/m 位/q 数/n 和/cc 百/m 位/q 数/n 进行/vx 的/ude1 ，/wd 其/rz 过程/n 和/cc 个/q 位/q 数/n 相同/a ，/wd 如/v 图/n 10．14/m (/wkz d/x )/wky ～/ws (/wkz g/x )/wky 所/usuo 示/vg 。/wj 至此/d 排序/vi 完毕/vi 。/wj 
    在/p 描述/v 算法/n 之前/f ，/wd 尚/d 需/v 定义新/n 的/ude1 数据/n 类型/n 
#/n define/x  MAX―NUll/x 一/m 0F―KEY/x  8/m 
#/n deflne/x  RADIX/x     10/m 
#/n define/x  MAX―SPACE/x   10000/m 
。/wj t／Imdef/x  struct/x {/n 
・/w 286・/m 
∥/w 关键字/n 项数/n 的/ude1 最/d 大值/n 
∥/w 关键字/n 基数/n ，/wd 此时/r 是/vshi 十进制/n 整数/n 的/ude1 基数/n 
(/wkz g/x )/wky 
    图/n 10．14/m 链式/n 基数/n 排序/vn 示例/n 
(/wkz a/x )/wky 初始状态/n ；/wf (/wkz b/x )/wky 第一/m 趟/qv 分配/vn 之后/f ；/wf (/wkz c/x )/wky 第一/m 趟/qv 收集/v 之后/f ；/wf (/wkz d/x )/wky 第二/m 趟/qv 分配/vn 之后/f 
  (/wkz e/x )/wky 第二/m 趟/qv 收集/v 之后/f ；/wf (/wkz f/x )/wky 第三/m 趟/qv 分配/vn 之后/f ；/wf (/wkz g/x )/wky 第三/m 趟/qv 收集/v 之后/f 的/ude1 有序/a 文件/n 
  KeysType/x  keys/x [/wkz MAX―NUM―OF/x 
  InfoType/x  otheritems/x ；/wf 
  int/x  next/x ；/wf 
}/n SLCell/x ；/wf 
typedef/x  struct/x {/n 
KEY/x ]/wky ；/wf   ∥/w 关键字/n 
    ∥/w 其它/rz 数据项/n 
∥/w 静态/n 链/ng 表/n 的/ude1 结点/n 类型/n 
・/w 287・/m 
  SLCell/x  r/x [/wkz MAX―SPACE/x ]/wky ；/wf 
  int/x     keynum/x ；/wf 
  int/x     recnum：/x 
}/n SLList/x ；/wf 
typedef/x  int/x  ArrType/x [/wkz RADIX/x ]/wky ；/wf 
∥/w 静态/n 链/ng 表/n 的/ude1 可/c 利用/v 空间/n ，/wd r/x [/wkz O/x ]/wky 为/p 头/n 结点/n 
∥/w 记录/v 的/ude1 当前/t 关键字/n 个数/n 
∥/w 静态/n 链/ng 表/n 的/ude1 当前/t 长度/n 
∥/w 静态/n 链/ng 表/vg 类型/n 
∥/w 指针/n 数组/n 类型/n 
    算法/n 10．15/m 为/v 链式/n 基数/n 排序/vi 中/f 一/m 趟/qv 分配/vn 的/ude1 算法/n ，/wd 算法/n 10．16/m 为/p 一/m 趟/qv 收集/v 的/ude1 算法/n ，/wd 算法/n 10．17/m 为/v 链式/n 基数/n 排序/vi 的/ude1 算法/n 。/wj 从/p 算法/n 中/f 容易/ad 看出/v ，/wd 对于/p ”/wyy 个/q 记录/n (/wkz 假设/n 每个/r 记录/v 含/v d/x 个/q 关键/n 宇/ng ，/wd 每个/r 关键字/n 的/ude1 取值/v 范围/n 为/v 以/p 个/q 值/n )/wky 进行/vx 链式/n 基数/n 排序/vi 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz d/x (/wkz n+rd/x )/wky )/wky ，/wd 其中/rz 每/rz 一/m 趟/qv 分配/vn 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz n/x )/wky ，/wd 每/rz 一/m 趟/qv 收集/v 的/ude1 时间/n 复杂度/n 为/v O/x (/wkz )/wky ，/wd 
整个/b 排序/vn 需/v 进行/vx d/x 趟/qv 分配/vn 和/cc 收集/v 。/wj 所/usuo 需/v 辅助/vn 空间/n 为/v 2rd/x 个/q 队列/n 指针/n 。/wj 当然/d ，/wd 由于/c 需/v 用/v 链/ng 表/n 作/v 存储/vn 结构/n ，/wd 则/c 相对/d 于/p 其/rz 它/rr 以/p 顺序/n 结构/n 存储记录/n 的/ude1 排序/vn 方法/n 而言/uls ，/wd 还/d 增加/v 了/y ”/wyy 个/q 指针/n 域/ng 的/ude1 空间/n 。/wj 
void/x  Distribute/x (/wkz SLCell/x &/n r/x ，/wd int/x  i/x ，/wd ArrTyPe/x &/n f/x ，/wd ArrType/x ＆/n e/x )/wky {/n 
  ∥/w 静态/n 链/ng 表/n L/x 的/ude1 r/x 域/n 中/f 记录/v 已/d 按/p (/wkz keys/x [/wkz 0/m ]/wky ，/wd …/ws ，/wd keys/x [/wkz i-1/x ]/wky )/wky 有序/a 。/wj 
  ∥/w 本/rz 算法/n 按/p 第/m i/x 个/q 关键字/n keys/x [/wkz i/x ]/wky 建立/v RADIX/x 个子/n 表/n ，/wd 使/v 同/p 一/m 子/q 表中记录/n 的/ude1 keys/x [/wkz i/x ]/wky 相同/a   ∥/w f/x [/wkz o．．RADIX-1/x ]/wky 和/cc e10．．RADIX-1/x ]/wky 分别/d 指向/v 各/rz 子/ng 表/n 中/f 第一/m 个/q 和/cc 最后/f 一个/mq 记录/n 。/wj 
  for/x (/wkz J=0/x ；/wf J/x </n Radix/x ；/wf ++j/x )/wky f/x [/wkz J/x ]/wky =0/m ；/wf     ∥/w 各/rz 子/ng 表/n 初始化/v 为/p 空/a 表/n 
  for/x (/wkz P=rio/x ]/wky ．/w next/x ；/wf p/x ；/wf P=rip/x ]/wky ．/w next/x )/wky {/n 
    J：ord/x (/wkz r/x [/wkz p/x ]/wky ．/w keys/x [/wkz i/x ]/wky )/wky ；/wf     ∥/w 
    if/x (/wkz !/wt f/x [/wkz j/x ]/wky )/wky f/x [/wkz j/x ]/wky =p/x ；/wf 
    else/x  r/x [/wkz e/x [/wkz j/x ]/wky ]/wky ．/w next：p/x ；/wf 
    e/x [/wkz j/x ]/wky =p/x ；/wf 
  }/n 
I/x  ff/x  Distribute/x 
ord/x 将/d 记录/v 中/f 第/m i/x 个/q 关键字/n 映射/vi 到/v [/wkz 0．．RADIX―i/x ]/wky ，/wd 
∥/w 将/d P/x 所/usuo 指/v 的/ude1 结点/n 插入/v 第/m j/x 个子/n 表/n 中/f 
算法/n 10．15/m 
void/x  Collect/x (/wkz SLCell/x ＆/n r/x ，/wd int/x  i/x ，/wd ArrType/x  f/x ，/wd ArrType/x  e/x )/wky {/n 
  ∥/w 本/rz 算法/n 按/p keys/x [/wkz i/x ]/wky 自/p 小/a 至/p 大/a 地/ude2 将/p f/x [/wkz 0．．RADIX-1/x ]/wky 所/usuo 指/v 备/v 子/ng 表/n 依次/d 链接/n 成/v 一个/mq 链/ng 表/n ，/wd 
  ∥/w e10．．RADIX-1/x ]/wky 为/p 各/rz 子/ng 表/n 的/ude1 尾/q 指针/n 。/wj 
  ~/n or/x (/wkz J/x 。/wj 0/m ；/wf !/wt f/x [/wkz J/x ]/wky ；/wf J：SUCC/x (/wkz J/x )/wky )/wky ；/wf ∥/w 找/v 第一/m 个/q 非/b 空子/n 表/n ，/wd SUCC/x 为/p 求/v 后/f 继/vg 函数/n 
  r/x [/wkz 0/m  J．next=f/x [/wkz J/x ]/wky ；/wf t=e/x [/wkz J/x ]/wky ；/wf     ∥/w r/x [/wkz 0/m ]/wky ．/w next/x 指向/v 第一/m 个/q 非/b 空子/n 表/n 中/f 第一/m 个/q 结点/n 
  while/x (/wkz J/x </n RADIX/x )/wky {/n 
    for/x (/wkz J/x 。/wj SUCC/x (/wkz j/x )/wky ；/wf   J/x </n RADIX―i/x ＆/n ＆/n !/wt f/x [/wkz J/x ]/wky ；/wf   j：SUCC/x (/wkz J/x )/wky )/wky ；/wf     ∥/w 找/v 下/vf 一个/mq 非/b 空子/n 表/n 
    if/x (/wkz f/x [/wkz j/x ]/wky )/wky {/n r/x [/wkz t/x ]/wky ．/w next=f/x [/wkz J/x ]/wky ；/wf t=e/x [/wkz ]/wky ]/wky ；/wf I/x     ∥/w 链接/n 两/m 个/q 非/b 空子/n 表/n 
  }/n 
  r/x [/wkz t/x ]/wky ．/w next：0/x ；/wf 
＼/m ?/ww f/x  Collect/x 
∥/w t/x 指向/v 最后/f 一个/mq 非/b 空子/n 表/n 中/f 的/ude1 最后/f 一个/mq 结点/n 
算法/n 10．16/m 
 void/x  RadixSort/x (/wkz SLList/x &/n L/x )/wky {/n 
    ∥/w L/x 是/vshi 采用/v 静态/n 链/ng 表表示/n 的/ude1 顺序/n 表/n 。/wj 
    ∥/w 对/p L/x 作/v 基数/n 排序/vi ，/wd 使得/vi L/x 成为/v 按/p 关键字/n 自小/d 到/v 大/a 的/ude1 有序/a 静态/n 链/ng 表/n 。/wj L．r/x [/wkz 0/m ]/wky 为/p 头/n 结点/n 。/wj 
    for/x (/wkz i=0/x ；/wf i/x </n L．recnum/x ；/wf ++i/x )/wky   L．r/x [/wkz i/x ]/wky ．/w next=i+1：/x 
・/w 288・/m 
  L．r/x [/wkz L．recn/x 衄/n ]/wky ．/w ne/x )/wky 【/wkz t：0/x ；/wf     ∥/w 将/d L/x 改造/v 为/p 静态/n 链/ng 表/n 
  for/x (/wkz i=O/x ；/wf i/x </n L．keyn/x 唧/v ；/wf ++i/x )/wky {/n ∥/w 按/p 最低/a 位/q 优先/vd 依次/d 对/p 各/rz 关键字/n 进行/vx 分配/vn 和/cc 收集/v 
    Distri/x ~/n te/x (/wkz L．r/x ，/wd 1/m ，/wd f/x ，/wd e/x )/wky ；/wf     ∥/w 第/m i/x 趟/qv 分配/vn 
    Co/x ]/wky lect/x (/wkz I．．r/x ，/wd i/x ，/wd f/x ，/wd e/x )/wky ；/wf     ∥/w 第/m i/x 趟/qv 收集/v 
  }/n 
}/n ∥/w Radixsort/x 
    算法/n 10．17/m 
10．7/m 各种/rz 内部/f 排序/vi 方法/n 的/ude1 比较/d 讨论/v 
综合/vd 比较/v 本/rz 章/n 内/f 讨论/v 的/ude1 各种/rz 内部/f 排序/vi 方法/n ，/wd 大致/d 有/vyou 如下/vn 结果/n ：/wp 
┏/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┳/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┳/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┳/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┓/n 
┃/n     排序/vn 方法/n   ┃/n     平均/a 时间/n     ┃/n     最/d 坏/a 情况/n     ┃/n     辅助存储/n   ┃/n 
┣/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ╋/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┫/n 
┃/n     简单/ad 排序/vi   ┃/n     O/x (/wkz n/x 。/wj )/wky       ┃/n     o/x (/wkz ”/wyy 。/wj )/wky      ┃/n     0/m (/wkz 1/m )/wky       ┃/n 
┃/n     快速/d 排序/vi   ┃/n     o/x (/wkz nlogn/x )/wky     ┃/n     o/x (/wkz 月/n 。/wj )/wky      ┃/n     O/x (/wkz 1/m 。/wj g/x ”/wyy )/wky  ┃/n 
┃/n     堆/v 排序/vi     ┃/n     0/m (/wkz 月/n l/x 。/wj g/x ”/wyy )/wky  ┃/n     O/x (/wkz ”/wyy log≈/x )/wky   ┃/n     O/x (/wkz 1/m )/wky       ┃/n 
┃/n     归并/vi 排序/vi   ┃/n     o/x (/wkz "/n logn/x )/wky     ┃/n     O/x (/wkz nbgn/x )/wky      ┃/n     O/x (/wkz 规/ng )/wky      ┃/n 
┃/n     基数/n 排序/vi   ┃/n     o/x (/wkz d/x (/wkz ”/wyy +/m 刑/n )/wky )/wky  ┃/n     O/x (/wkz d/x (/wkz n+/x 以/b )/wky )/wky   ┃/n     0/m (/wkz 一/m )/wky      ┃/n 
┗/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┻/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┻/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┻/n ━/n ━/n ━/n ━/n ━/n ━/n ━/n ┛/n 
    从/p 上/f 表/vg 司/ng 以/p 得/v 出/vf 如/v F/x 几/m 个/q 结论/n ：/wp 
    (/wkz 1/m )/wky 从/p 平均/a 时间/n 性能/n 而言/uls ，/wd 快速/d 排序/vi 最佳/z ，/wd 其/rz 所/usuo 需/v 时间/n 最/d 省/v ，/wd 但/c 快速/d 排序/vi 在/p 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 性能/n 不/d 如/v 堆/k 排序/vi 和/cc 归并/vi 排序/vi 。/wj 而后/d 两者/rzv 相/d 比较/v 的/ude1 结果/n 是/vshi ，/wd 在/p 佗/ng 较/d 大/a 时/ng ，/wd 归并/vi 排序/vi 所/usuo 需/v 时间/n 较/d 堆/v 排序/vn 省/n ，/wd 但/c 它/rr 所/usuo 需/v 的/ude1 辅助/vn 存储量/n 最/d 多/a 。/wj 
    (/wkz 2/m )/wky 上/f 表/n 中/f 的/ude1 “/wyz 简单/a 排序/vn ”/wyy 包括/v 除/p 希尔/nrf 排序/vi 之外/f 的/ude1 所有/b 插入/v 排序/vi ，/wd 起泡/vi 排序/vi 和/cc 简单/ad 选择/v 排序/vi ，/wd 其中/rz 以/p 直接/ad 插入/v 排序/vi 为/v 最/d 简单/a ，/wd 当/p 序列/n 中/f 的/ude1 记录/n “/wyz 基本/a 有序/a ”/wyy 或/c n/x 值/n 较/d 小时/n ，/wd 它/rr 是/vshi 最佳/z 的/ude1 排序/vn 方法/n ，/wd 因此/c 常/d 将/p 它/rr 和/cc 其它/rz 的/ude1 排序/vn 方法/n ，/wd 诸如/v 快速/d 排序/vi 、/wn 归并/vi 排序/vi 等/udeng 结合/v 在/p 一起/s 使用/v 。/wj 
    (/wkz 3/m )/wky 基数/n 排序/vi 的/ude1 时间/n 复杂度/n 也/d 可/v 写/v 成/v 0/m (/wkz d・/x ”/wyy )/wky 。/wj 因此/c ，/wd 它/rr 最/d 适用/vi 于/p n/x 值/n 很/d 大/a 而/cc 关键字/n 较/d 小/a 的/ude1 序列/n 。/wj 若/c 关键字/n 也/d 很/d 大/a ，/wd 而/cc 序列/n 中/f 大多数/m 记录/n 的/ude1 “/wyz 最/d 高位/b 关键字/n ”/wyy 均不同/n ，/wd 则/c 亦/d 可/v 先/d 按/p “/wyz 最/d 高位/b 关键字/n ”/wyy 不同/a 将/p 序列/n 分成若干/n “/wyz 小/a ”/wyy 的/ude1 子/ng 序列/n ，/wd 而后/d 进行/vx 直接/ad 插入/v 排序/vi 。/wj 
    (/wkz 4/m )/wky 从/p 方法/n 的/ude1 稳定性/n 来/vf 比较/v ，/wd 基数/n 排序/vn 是/vshi 稳定/a 的/ude1 内/f 排/v 方法/n ，/wd 所有/b 时间/n 复杂度/n 为/v 0/m (/wkz n/x 。/wj )/wky 的/ude1 简单/a 排序/vn 法/n 也/d 是/vshi 稳定/a 的/ude1 ，/wd 然而/c ，/wd 快速/d 排序/vi 、/wn 堆/v 排序/vn 和/cc 希尔/nrf 排序/vi 等/udeng 时间/n 性能/n 较/d 好/a 的/ude1 排序/vn 方法/n 都/d 是/vshi 不/d 稳定/a 的/ude1 。/wj 一般来说/vl ，/wd 排序/vn 过程/n 中/f 的/ude1 “/wyz 比较/d ”/wyy 是/vshi 在/p “/wyz 相邻/vi 的/ude1 两/m 个/q 记录/n 关键字/n ”/wyy 间/f 进行/vx 的/ude1 排序/vn 方法/n 是/vshi 稳定/a 的/ude1 。/wj 值得/v 提出/v 的/ude1 是/vshi ，/wd 稳定性/n 是/vshi 由/p 方法/n 本身/rz 决定/n 的/ude1 ，/wd 对/p 不/d 稳定/a 的/ude1 排序/vn 方法/n 而言/uls ，/wd 不管/c 其/rz 描述/vn 形式/n 如何/ryv ，/wd 总/d 能/v 举出/v 一个/mq 说明/v 不/d 稳定/a 的/ude1 实例/n 来/vf 。/wj 反之/c ，/wd 对/p 稳定/a 的/ude1 排序/vn 方法/n ，/wd 总/d 能/v 找到/v 一/m 种/q 不/d 引起/v 不/d 稳定/a 的/ude1 描述/vn 形式/n 。/wj 由于/p 大多数/m 情况/n 下/f 排序/vi 是/vshi 按/p 记录/n 的/ude1 主/ag 关键字/n 进行/vx 的/ude1 ，/wd 则/d 所/usuo 用/v 的/ude1 排序/vn 方法/n 是否/v 稳定/an 无关紧要/vl 。/wj 若/c 排序/vi 按/p 记录/n 的/ude1 次关键字/n 进行/vx ，/wd 则/c 应/v 根据/p 问题/n 所/usuo 需/v 慎重/ad 选择/v 排序/vn 方法/n 及/cc 其/rz 描述/vn 算法/n 。/wj 
    综上所述/c ，/wd 在/p 本/rz 章/n 讨论/vn 的/ude1 所有/b 排序/vn 方法/n 中/f ，/wd 没有/v 哪/ry 一/m 种/q 是/vshi 绝对/d 最/d 优/ag 的/ude1 。/wj 有的/rz 适用/vi 于/p n/x 较/d 大/a 的/ude1 情况/n ，/wd 有的/rz 适用/vi 于/p ”/wyy 较/d 小/a 的/ude1 情况/n ，/wd 有的/rz …/ws …/ws 等等/udeng 。/wj 因此/c ，/wd 在/p 实用/a 时/ng 需/v 根据/p 不同/a 情况/n 适当/ad 选用/v ，/wd 甚至/d 可/v 将/p 多种/m 方法/n 结合/v 起来/vf 使用/v 。/wj 
    本章/nr2 讨论/v 的/ude1 多数/m 排序/vn 算法/n 是/vshi 在/p 顺序/n 存储/vn 结构/n 上/f 实现/v 的/ude1 ，/wd 因此/c 在/p 排序/vn 过程/n 中/f 需/v 进行/vx 大量/m 记录/n 的/ude1 移动/vn 。/wj 当/p 记录/n 很/d 大/a (/wkz 即/v 每个/r 记录/n 所/usuo 占/v 空间较/n 多/a )/wky 时/ng ，/wd 时间/n 耗费/v 很/d 大/a ，/wd 此时/r 可/v 采用/v 静态/n 链/ng 表/n 作/v 存储/vn 结构/n 。/wj 如/v 表/vg 插入/v 排序/vi 、/wn 链式/n 基数/n 排序/vi ，/wd 以/p 修改/v 指针/n 代替/v 移动/vn 记录/n 。/wj 但是/c ，/wd 有的/rz 排序/vn 方法/n ，/wd 如/c 快速/d 排序/vi 和/cc 堆/v 排序/vi ，/wd 无法/v 实现/v 表排序/n 。/wj 在/p 这种/r 情况/n 下/f 可以/v 进行/vx “/wyz 地址/n 排序/vi ”/wyy ，/wd 即/d 另/d 设/v 一个/mq 地址/n 向量/n 指示/n 相应/vd 记录/v ；/wf 同时/c 在/p 排序/vn 过程/n 中/f 不/d 移动/v 记录/n 而/cc 移动/vn 地址/n 向量/n 中/f 相应/vi 分量/n 的/ude1 内容/n 。/wj 例如/v 对/p 图/n 10．15/m (/wkz a/x )/wky 所/usuo 示/vg 记录/v 序列/n 进行/vx 地址/n 排序/vi 时/ng ，/wd 可/c 附设/v 向量/n adr/x (/wkz 1：8/m )/wky 。/wj 在/p 开始/v 排序/vi 之前/f 令/v adr÷/x [/wkz i/x ]/wky ：/wp =i/x ，/wd 凡/d 在/p 排序/vn 过程/n 中/f 需/v 进行/vx r/x [/wkz i/x ]/wky ：：/wp r/x [/wkz j/x ]/wky 的/ude1 操作/vn 时/ng ，/wd 均/d 以/p adr・/x [/wkz i/x ]/wky ：：/wp adr/x [/wkz j/x ]/wky 代替/v ，/wd 则/c 在/p 排序/vi 结束/v 之后/f ，/wd 地址/n 向量/n 中/f 的/ude1 值/n 指示/n 排序/vi 后/f 的/ude1 记录/n 的/ude1 次序/n ，/wd r/x [/wkz adr/x [/wkz 1/m ]/wky ]/wky 为/p 关键字/n 最/d 小/a 的/ude1 记录/n ，/wd r/x [/wkz adr/x [/wkz 8/m ]/wky ]/wky 为/p 关键字/n 最/d 大/a 的/ude1 记录/n ，/wd 如/v 图/n 10．15/m (/wkz b/x )/wky 所/usuo 示/vg 。/wj 最后/f 在/p 需要/v 时/ng 可/v 根据/p adr/x 的/ude1 值/n 重排/v 记录/v 的/ude1 物理/n 位置/n 。/wj 重排/v 算法/n 如下/vi ：/wp 
r/x (/wkz 1：8/m )/wky 
adr/x (/wkz 1：81/m 
 r/x (/wkz 1：8/m )/wky 
    图/n 10．15/m 地址/n 排序/vn 示例/n ．/w 
　　(/wkz a/x )/wky 待/vi 排/v 记录/n 和/cc 地址/n 向量/n 的/ude1 初始状态/n ；/wf (/wkz b/x )/wky 排序/vi 结束/v 后/f 的/ude1 地址/n 向量/n ；/wf (/wkz c/x )/wky 重排/v 记录/v 过程/n 中/f 的/ude1 状态/n 从/p 卢/b 1/m 起/q 依次/d 检查/v 每个/r 分量/n 位置/n 上/f 的/ude1 记录/n 是否/v 正确/ad 到位/vi 。/wj 若/v adr/x [/wkz i/x ]/wky =i/x ，/wd 则/d r/x [/wkz i/x ]/wky 中/f 恰/d 为/v 第/m i/x 个/q 最/d 小/a 关键字/n 的/ude1 记录/n ，/wd 该/rz 位置/n 上/f 的/ude1 记录/n 不/d 需要/v 调整/v ；/wf 若/v adr/x [/wkz i/x ]/wky =k≠i/x ，/wd 则/c 说明/v r/x [/wkz k/x ]/wky 中/f 记录/v 是/vshi 第/m i/x 个/q 最/d 小/a 关键字/n 的/ude1 记录/n ，/wd 应/v 在/p 暂/d 存/v 记录/v r/x [/wkz i/x ]/wky 之后/f 将/d r/x [/wkz k/x ]/wky 中/f 记录/v 移/v 至/p r/x [/wkz i/x ]/wky 的/ude1 位置/n ①/m 上/f 。/wj 类似/a 地/ude2 ，/wd 若/c adz/x _/n [/wkz k/x ]/wky ≠k/x ，/wd 则/c 应/v 将/d r/x [/wkz adr/x [/wkz k/x ]/wky ]/wky 中/f 记录/v 移/v 至/p r/x [/wkz k/x ]/wky 的/ude1 位置/n 上/f 。/wj 依次/d 类推/vi ，/wd 直至/v 找/v 到/v 某个/rz 值/n j=adr/x [/wkz adr/x [/wkz ．/w ．/w ・/w adr/x [/wkz k/x ]/wky ．/w ．/w ・/w ]/wky ]/wky ，/wd 等式/n adr・/x Ⅲ/m =i/x 成立/vi 时/ng ，/wd 将/d 暂/d 存/v 记录/v 移/v 至/p r/x Ⅲ/m 的/ude1 位置/n 上/f 。/wj 至此/d 完成/v 一个/mq 调整记录/n 位置/n 的/ude1 小/a 循环/vn 。/wj 例如/v 图/n 10．15/m 的/ude1 例子/n ，/wd 由于/c 图/n 10．15/m (/wkz b/x )/wky 中/f adr/x 。/wj [/wkz 1/m ]/wky ：/wp 6/m ，/wd 则/c 在/p 暂/d 存/v R/x (/wkz 49/m )/wky 以后/f ，/wd 需/v 将/d R/x (/wkz 13/m )/wky 从/p r/x [/wkz 6/m ]/wky 的/ude1 位置/n 移/v 至/p r/x [/wkz 1/m ]/wky 的/ude1 位置/n 。/wj 又/c ，/wd 因为/p adr/x [/wkz 6/m ]/wky ：/wp 2/m ，/wd 则/c 应/v 将/d R/x (/wkz 65/m )/wky 从/p r/x [/wkz 2/m ]/wky 的/ude1 位置/n 移/v 至/p r/x [/wkz 6/m ]/wky 的/ude1 位置/n 。/wj 同/p 理/n ，/wd 将/d R/x (/wkz 27/m )/wky 移/v 至/p r/x [/wkz 2/m ]/wky 的/ude1 位置/n ，/wd 此时/r ，/wd 因/p adr/x [/wkz 4/m ]/wky =1/m ，/wd 则/d R/x (/wkz 49/m )/wky 应/v 置/v 入/v r/x [/wkz 4/m ]/wky 的/ude1 位置/n 上/f 。/wj 完成/v 上述/b 调整/vn 后/f 的/ude1 记录/n 及/cc 地址/n 向量/n 的/ude1 状态/n 如/v 图/n 10．15/m (/wkz c/x )/wky 所/usuo 示/vg 。/wj 算法/n 10．18/m 即/v 为/p 上述/b 重排/v 记录/v 的/ude1 算法/n 。/wj 
　　①/m r/x [/wkz i/x ]/wky 的/ude1 位置/n 指/v 的/ude1 是/vshi r/x 数组/n 中/f 第/m i/x 个/q 分量/n ，/wd 下同/vi 。/wj 
void/x  Rear．range/x (/wkz SqList/x &/n L/x ，/wd int/x  adz．/x [/wkz ]/wky )/wky I/x 
  ∥/w adz・/x 给/v 出/vf 顺序/n 表/n L/x 的/ude1 有序/a 次序/n ，/wd 即/v L．r/x [/wkz adr/x [/wkz i/x ]/wky ]/wky 是/vshi 第/m i/x 小/a 的/ude1 记录/n 。/wj 
  ∥/w 本/rz 算法/n 按/p adr/x 重排/v L．r/x ，/wd 使/v 其/rz 有序/a 。/wj 
  for/x (/wkz i=1/x ；/wf i/x </n L．1ength/x ；/wf ++i/x )/wky 
    if/x (/wkz adr/x [/wkz i/x ]/wky !/wt =i/x )/wky j/x 
    j=i/x ；/wf   L．r/x [/wkz O/x ]/wky =L．r/x [/wkz i/x ]/wky ；/wf     ∥/w 暂/d 存/v 记录/v L．r/x [/wkz i/x ]/wky 
    while/x (/wkz adr/x [/wkz j/x ]/wky I/x _/n i/x )/wky {/n     ∥/w 调整/v L．r/x [/wkz adr/x [/wkz j/x ]/wky ]/wky 的/ude1 记录/n 到/v 位/q 直到/v adr/x [/wkz j/x ]/wky =i/x 为止/u 
    k=adr/x [/wkz j/x ]/wky ；/wf L．r/x [/wkz j/x ]/wky =L．r/x [/wkz k/x ]/wky ；/wf 
    adr/x 【/wkz j/x  J=j/x ；/wf   j=k/x ；/wf 
    }/n 
    adr/x [/wkz j/x ]/wky ：/wp L．r/x [/wkz O/x ]/wky ；/wf adr/x [/wkz j/x ]/wky =j/x ；/wf   ∥/w 记录/v 按/p 序/n 到位/vi 
    I/x 
}/n ∥/w Rearrange/x 
    算法/n 10．18/m 
    从/p 上述/b 算法/n 容易/ad 看出/v ，/wd 除了/p 在/p 每个/r 小循环/n 中/f 要/v 暂/d 存/v 一/m 次/qv 记录/n 外/f ，/wd 所有/b 记录/n 均/d 一/m 次/qv 移动/vn 到位/vi 。/wj 而/cc 每个/r 小循环/n 至少/d 移动/v 两/m 个/q 记录/n ，/wd 则/c 这样/rzv 的/ude1 小循环/n 至多/d 有/vyou L/x  n／2/x  j/x 个/q ，/wd 所以/c 重排/v 记录/v 的/ude1 算法/n 中/f 至多/d 移动/v 记录/v L/x  3/m ，/wd z／2/x  j/x 次/qv 。/wj 
    本/rz 节/n 最后/f 要/v 讨论/v 的/ude1 一个/mq 问题/n 是/vshi ，/wd “/wyz 内部/f 排序/vi 可能/v 达到/v 的/ude1 最/d 快/a 速度/n 是/vshi 什么/ry ”/wyy 。/wj 我们/rr 已经/d 看到/v ，/wd 本/rz 章/n 讨论/vn 的/ude1 各种/rz 排序/vn 方法/n ，/wd 其/rz 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂度/n 或/c 为/p 0/m (/wkz ”/wyy 。/wj )/wky ，/wd 或/c 为/p 0/m (/wkz nlogn/x )/wky ，/wd 其中/rz 0/m (/wkz n0/x )/wky 是/vshi 它/rr 的/ude1 上/f 界/n ，/wd 那末/c O/x (/wkz 扎/v logn/x )/wky 是否/v 是/vshi 它/rr 的/ude1 下/vf 界/n ，/wd 也就是说/vl ，/wd 能否/v 找到/v 一/m 种/q 排序/vn 方法/n ，/wd 它/rr 在/p 最/d 坏/a 情况/n 下/f 的/ude1 时间/n 复杂/a 度/qv 低于/v O/x (/wkz nlogn/x )/wky 呢/y ?/ww 
    由于/p 本/rz 章/n 讨论/vn 的/ude1 各种/rz 排序/vn 方法/n ，/wd 除/p 基数/n 排序/vi 之外/f ，/wd 都/d 是/vshi 基于/p “/wyz 关键字/n 间/f 的/ude1 比较/vn ”/wyy 这个/rz 操作/v 进行/vx 的/ude1 ，/wd 则/c 均/d 可/v 用/p 一/m 棵/q 类似/a 于/p 图/n 10．16/m 所/usuo 示/vg 的/ude1 判定/vn 树/n 来/vf 描述/v 这/rzv 类/q 排序/vn 方法/n 的/ude1 过程/n 。/wj 
⑥/m     ⑤/m 
    图/n 10．16/m 
    ⑧/m     ②/m 
描述/v 排序/vn 过程/n 的/ude1 判定/vn 树/n 
    图/n 10．16/m 的/ude1 判定/vn 树/n 表示/v 三/m 个/q 关键字/n 分别/d 为/v Kl/x 、/wn K2/x 和/cc K/x 。/wj 的/ude1 记录/n 进行/vx 直接/ad 插入/v 排序/vi 的/ude1 过程/n ，/wd 树/n 中/f 每个/r 非/b 终端/n 结点/n 表示/v 两/m 个/q 关键字/n 间/f 的/ude1 一/m 次比较/n ，/wd 其/rz 左/a 、/wn 右/f 子/ng 树/n 分别/d 表示/v 这/rzv 次比较/n 所得/n 的/ude1 两/m 种/q 结果/n 。/wj 假设/n K1≠K2≠K3≠K1/x ，/wd 则/d 排序/vi 之前/f 依次/d 排列/v 的/ude1 这/rzv 三/m 个/q 记录/n {/n R1/x ，/wd R2/x ，/wd R/x  3/m }/n 之间/f 只/d 可能/v 有/vyou 下列/b 六/m 种/q 关系/n ：/wp (/wkz 1/m )/wky Kl/x </n K2/x </n K3/x ；/wf (/wkz 2/m )/wky Kl/x </n K3/x </n K2/x ；/wf (/wkz 3/m )/wky K3/x 
</n K1/x </n K2/x ；/wf (/wkz 4/m )/wky K2/x </n K1/x </n K3/x ；/wf (/wkz 5/m )/wky K2/x </n K3/x </n K1/x ；/wf (/wkz 6/m )/wky K3/x </n K2/x </n K1/x ，/wd 换句话说/c ，/wd 这/rzv 三/m 个/q 记录/n 经过/p 排序/vi 只/d 可能/v 得到/v 下列/b 六/m 种/q 结果/n ：/wp (/wkz 1/m )/wky {/n R1/x ，/wd R2/x ，/wd R3/x  l/x ；/wf (/wkz 2/m )/wky {/n Rl/x ，/wd R3/x ，/wd R2/x }/n ；/wf (/wkz 3/m )/wky {/n R3/x ，/wd R1/x ’/wyy _/n R2/x }/n ；/wf (/wkz 4/m )/wky {/n R2/x ，/wd R1/x ，/wd R3/x }/n ；/wf (/wkz 5/m )/wky {/n R2/x ，/wd R3/x ，/wd R1/x }/n ；/wf (/wkz 6/m )/wky {/n R/x  3/m ，/wd R2/x ，/wd R1/x }/n ，/wd 而/cc 图/n 10．16/m 中/f 的/ude1 判定/vn 树/n 
    ・/w   291/m   ・/w 
上/f 六/m 个/q 终端/n 结点/n 恰好/d 表示/v 这/rzv 六/m 种/q 排序/vn 结果/n 。/wj 判定/v 树/n 上/f 进行/vx 的/ude1 每/rz 一/m 次比较/n 都/d 是/vshi 必要/a 的/ude1 ，/wd 因此/c ，/wd 这个/rz 判定/v 树/n 足以/d 描述/v 通过/p “/wyz 比较/d ”/wyy 进行/vx 的/ude1 排序/vn 过程/n 。/wj 并且/c ，/wd 对/p 每/rz 一个/mq 初始序列/n 经/p 排序/vi 达到/v 有序/a 所/usuo 需/v 进行/vx 的/ude1 “/wyz 比较/d ”/wyy 次数/n ，/wd 恰/d 为/v 从/p 树根/n 到/v 和/cc 该/rz 序列/n 相应/vi 的/ude1 叶子/n 结点/n 的/ude1 路径长度/n 。/wj 由于/p 图/n 10．16/m 的/ude1 判定/vn 树/n 的/ude1 深度/n 为/p 4/m ，/wd 则/c 对/p 3/m 个/q 记录/n 进行/vx 排序/vn 至少/d 要/v 进行/vx 3/m 次比较/n 。/wj --/wp 
    推广/v 至/p 一般/a 情况/n ，/wd 对/v 。/wj 个/q 记录/n 进行/vx 排序/vn 至少/d 需/v 进行/vx 多少/ry 次关键字/n 间/f 的/ude1 比较/vn ，/wd 这个/rz 问题/n 等价/vn 于/p ，/wd 给定/v 竹/ng 个/q 不同/a 的/ude1 砝码/n 和/cc 一/m 台/q 天平/n ，/wd 按/p 重量/n 的/ude1 大小/n 顺序/n 排列/v 这些/rz 砝码/n 所/usuo 需要/v 的/ude1 最/d 少/ad 称/v 重量/n 次数/n 问题/n 。/wj 由于/c 含/v n/x 个/q 记录/n 的/ude1 序列/n 可能/v 出现/v 的/ude1 初始状态/n 有/vyou n/x !/wt 个/q ，/wd 则/c 描述/v n/x 个/q 记录/n 排序/vn 过程/n 的/ude1 判定/vn 树/n 必须/d 有/vyou n/x !/wt 个/q 叶子/n 结点/n 。/wj 因为/c ，/wd 若/c 少/v 一个/mq 叶子/n ，/wd 则/c 说明/v 尚/d 有/vyou 两/m 种/q 状态/n 没有/d 分辨/v 出/vf 来/vf 。/wj 我们/rr 已经/d 知道/v ，/wd 若/c y．/x 树/n 的/ude1 高度/d 为/v h/x ，/wd 则/c 叶子/n 结点/n 的/ude1 个/q 数/n 不/d 超过/v 2/m ；/wf 反之/c ，/wd 若/c 有/vyou n/x 个/q 叶子/n 结点/n ，/wd 则/c 二/m 叉树/n 的/ude1 高度/n 至少/d 为/v 厂/n log2/x “/wyz ]/wky 十/m 1/m 。/wj 这就是说/c ，/wd 描述/v 。/wj 个/q 记录/n 排序/vi 的/ude1 判定/vn 树上/s 必定/d 存在/v 一/m 条/q 长度/n 为/p 广/a log2/x (/wkz n/x !/wt )/wky ]/wky 的/ude1 路径/n 。/wj 由此/d 得/ude3 到/v 下/f 述/vg 结论/n ：/wp 任何/rz 一个/mq 借助/v “/wyz 比较/d ”/wyy 进行/vx 排序/vn 的/ude1 算法/n ，/wd 在/p 最/d 坏/a 情况/n 下/f 所/usuo 需/v 进行/vx 的/ude1 比较/vn 次数/n 至少/d 为/v 。/wj 然而/c ，/wd 这/rzv 只/d 是/vshi 一个/mq 理论/n 上/f 的/ude1 下/vf 界/n ，/wd 一般/a 的/ude1 排序/vn 算法/n 在/p n/x >/n 4时/t 所/usuo 需/v 进行/vx 的/ude1 比较/vn 次数/n 均/d 大/a 于/p 此值/n ，/wd 直到/v 1956年/t ，/wd H．B．Demuth/x 首先/d 找到/v 了/ule 对/p 五/m 个/q 数/n 进行/vx 排序/vn 只/d 需要/v 七/m 次比较/n 的/ude1 方法/n ‘/wyz 。/wj ’/wyy 之后/f ，/wd Lester/x  Ford/x 和/cc Selmer/x  Johnson/x 将/p 其/rz 推广/vn ，/wd 提出/v 了/ule 归并/vi 插入/v ①/m (/wkz Merge/x  Insertion/x )/wky 排序/vi ，/wd 在/p 竹/ng </n 11时/t 所/usuo 用/v 的/ude1 比较/vn 次数/n 和/cc 厂/n log2/x (/wkz 竹/ng !/wt )/wky ]/wky 相同/a 。/wj ②/m 。/wj 根据/p 斯特林/nrf 公式/n ，/wd 有/vyou 厂/n log2/x (/wkz ，/wd z/x !/wt )/wky ]/wky =O/x (/wkz nlogn/x )/wky ，/wd 上述/b 结论/n 从/p 数量级/n 上/f 告诉/v 我们/rr ，/wd 借助于/v “/wyz 比较/d ”/wyy 进行/vx 排序/vn 的/ude1 算法/n 在/p 最/d 坏/a 情况/n 下/f 能/v 达到/v 的/ude1 最/d 好/a 的/ude1 时间/n 复杂度/n 为/v 0/m (/wkz nlogn/x )/wky 。/wj ①/m   归并/vi 插入/v 排序/vi 的/ude1 过程/n 请/v 参见/v (/wkz 题/n 集/vg )/wky 第10/m 章/q 中/b 最后/f 一/m 题/n 。/wj 
②/m 下/vf 表/n 中/f B/x (/wkz n/x )/wky 、/wn M/x (/wkz n/x )/wky 和/cc F/x (/wkz ”/wyy )/wky 分别/d 表示/v 对/p n/x 个数/n 进行/vx 折半/v 插入/v 排序/vi 、/wn 归并/vi 排序/vi 和/cc 归并/vi 插入/v 排序/vi 时/ng 在/p 最/d 坏/a 情况/n 下/f 所/usuo 需/v 进行/vx 的/ude1 比较/vn 次数/n ‘/wyz 。/wj ’/wyy 

第11/m 章/q 外部/f 排序/vi 
    上/f 一/m 章/q 中/f 已/d 提到/v ，/wd 外部/f 排序/vi 指/v 的/ude1 是/vshi 大文件/n 的/ude1 排序/vn ，/wd 即/d 待/vi 排序/vi 的/ude1 记录/n 存储/vn 在/p 外/f 存储器/n 上/f ，/wd 在/p 排序/vn 过程/n 中/f 需/v 进行/vx 多次/mq 的/ude1 内/f 、/wn 外存/n 之间/f 的/ude1 交换/vn 。/wj 因此/c ，/wd 在/p 本/rz 章/n 讨论/vn 外部/f 排序/vi 之前/f ，/wd 首先/d 需要/v 了解/v 对外/vd 存信息/n 进行/vx 存取/vn 的/ude1 特点/n 。/wj 
11．1/m 外存/n 信息/n 的/ude1 存取/vn 
    计算机/n 一般/ad 有/vyou 两/m 种/q 存储器/n ：/wp 内存储器/n (/wkz 主存/n )/wky 和/cc 外/f 存储器/n (/wkz 辅存/nr2 )/wky 。/wj 内存/n 的/ude1 信息/n 可/v 随机/b 存取/vn ，/wd 且/c 存取速度/n 快/a ，/wd 但/c 价格/n 贵/a 、/wn 容量/n 小/a 。/wj 外/f 存储器包括/n 磁带/n 和/cc 磁盘/n (/wkz 或/c 磁鼓/n )/wky ，/wd 前者/rzv 为/p 顺序/n 存取/vn 的/ude1 设备/n ，/wd 后者/rzv 为/p 随机/b 存取/vn 的/ude1 设备/n 。/wj 
    一/m 、/wn 磁带/n 信息/n 的/ude1 存取/vn     接收盘/n     源/ng 盘/ng 
    磁带/n 是/vshi 薄/a 薄/a 涂/v 上/vf 一/m 层磁性/n 材料/n 的/ude1 一/m 条/q 窄/a 带/v 。/wj 现在/t 使用/v 的/ude1 磁带/n 大多数/m 有/vyou 寺/ng 英寸/q 宽/a ，/wd 最/d 长/a 可/c 达/v 3600/m 英尺/q ，/wd 绕/v 在/p 一个/mq 卷盘/n 上/vf 。/wj 使用/v 时/ng ，/wd 将/p 磁带/n 盘/qv 放在/v 磁带机/n 上/f ，/wd 驱动器/n 控制/vn 磁带/n 盘/qv 转动/v ，/wd 带动/v 磁带/n 向前/vi 移动/vn 。/wj 通过/p 读/v ／/w 写/v 头/n 就/d 可以/v 读出/v 磁带/n 上/f 的/ude1 信息/n 或者/c 把/pba 信息/n 写入/v 磁带/n 中/f (/wkz 图/n 11．1/m )/wky 。/wj 
图/n 11．1/m 磁带/n 运动/vn 示意图/n 
    在/p ÷/m 英寸/q 宽/a 的/ude1 带/v 面/n 上/f 可以/v 记录/v 9/m 位/q 或/c 7/m 位/q 二进制/n 信息/n (/wkz 通常/d 称为/v 9/m 道/qv 带/v 或/c 7/m 道/qv 带/v )/wky 。/wj 以/p 9/m 道/qv 带/v 为/p 例/n ，/wd 每/rz 一/m 横排/n 就/d 可/v 表示/v 一个/mq 字符/n (/wkz 8/m 位/q 表示/v 一个/mq 字符/n ，/wd 另/rz 一/m 位/q 作/v 奇/ag 偶/d 校验/v 位/q )/wky 。/wj 因此/c ，/wd 磁带/n 上/f 可/v 记/v 下/vf 各种/rz 文字/n 信息/n 或/c 二进制/n 信息/n 。/wj 在/p 磁带/n 上/f 信息/n 按/p 字符/n 组/n ①/m 存放/v ，/wd 而/cc 不/d 是/vshi 按/p 字符/n 存放/v 。/wj 
    磁带/n 上/f 信息/n 的/ude1 密度/n 通常/d 为/v 每/rz 英寸/q 800/m 位/q 或/c 1600/m 位/q 或/c 6250/m 位/q (/wkz 即/v 每/rz 英寸/q 的/ude1 二进制/n 字符/n 数/n )/wky ，/wd 移动/vn 速度/n 是/vshi 每/rz 秒/qt 200/m 英寸/q 。/wj 
    磁带/n 不/d 是/vshi 连续运转/n 的/ude1 设备/n ，/wd 而是/c 一/m 种/q 启/v 停/vi 设备/n ，/wd (/wkz 启/v 停/vi 时间/n 约/d 为/v 5/m 毫秒/q )/wky ，/wd 它/rr 可以/v 根据/p 读/v ／/w 写/v 的/ude1 需要/n 随时/d 启动/v 和/cc 停止/v 。/wj 由于/c 读/v ／/w 写/v 信息/n 应/v 在/p 旋转/vi 稳定/v 时/ng 进行/vx ，/wd 而/cc 磁带/n 从/p 静止状态/n 启动/v 后/f ，/wd 要/v 经过/p 一个/mq 加速/vi 的/ude1 过程/n 才/d 能/v 达到稳定/n 状态/n ；/wf 反之/c ，/wd 在/p 读/v ／/w 写/v 结束/v 后/f ，/wd 从/p 运动/vn 状态/n 到/v 完全/ad 停止/v ，/wd 要/v 经过/p 一个/mq 减速/vi 的/ude1 过程/n 。/wj 因此/c ，/wd 在/p 磁带/n 上/f 相邻/vi 两/m 组/q 字符/n 组/n (/wkz 记录/n )/wky 之间/f 要/v 留/v 一/m 空白区/n ，/wd 叫做/v 间隙/n IRG/x (/wkz Inter/x  Record/x  Gap/x )/wky 。/wj 根据/p 启/v 停/vi 时间/n 的/ude1 需要/n ，/wd 这个/rz 间隙/n 通常/d 为/v 1／4/m ～/ws 3／4/m 英寸/q 。/wj 如果/c 每个/r 字符/n 组/n 的/ude1 长度/n 是/vshi 80/m 个/q 字符/n ，/wd IRG/x 为/p 3／4/m 英寸/q ，/wd 则/c 对/p 密度/n 为/p 每/rz 英寸/q 1600/m 个/q 字符/n 的/ude1 磁带/n ，/wd 其/rz 利用率/n 仅/d 为/v 1／16/m ，/wd 有/vyou 15／16/m 的/ude1 带/v 用于/v IRG/x (/wkz 参见图/n 11．2/m (/wkz a/x )/wky )/wky 。/wj 
    为了/p 有效/a 地/ude2 利用/v 磁带/n ，/wd 常常/d 用/v 组成/v 块/q 的/ude1 办法/n 来/vf 减少/v IRG/x 的/ude1 个/q 数/n 。/wj 在/p 每/rz 次写/n 信息/n 时/ng ，/wd ①/m   字符/n 组/n 在/p 操作/vn 系统/n 的/ude1 一些/mq 描述/vn 中/f 称为/v “/wyz 记录/n ”/wyy 。/wj 注意/v ：/wp 操作系统/nl 中/f 的/ude1 “/wyz 记录/n ”/wyy 不同/a 于/p 本/rz 书/n 前面/f 定义/v 的/ude1 记录/n 。/wj 
20/m 个/q 记录/n Iil/x 乏/v 翻/v 20/m 个/q 记录/n }/n 20/m 个/q 记录/n 
    图/n 11．2/m 磁带/n 上/f 信息/n 存放/v 示意图/n 
    (/wkz a/x )/wky 字符/n 组长/n 80/m 字符/n 的/ude1 磁带/n ；/wf   (/wkz b/x )/wky 成/v 块/q 存放/v 的/ude1 磁带/n 。/wj 
不/d 是/vshi 按/p 用户/n 给/v 出/vf 的/ude1 字符/n 组/n 记/ng 入/v 磁带/n ，/wd 而是/c 将/p 若干/m 个/q 字符/n 组/n 合并/v 成/v 一/m 块/q 后/f 一/m 次/qv 写入/v 磁带/n 。/wj 于是/cc ，/wd 每个/r 字符/n 组/n 间/f 就/d 没有/v IRG/x ，/wd 而/cc 变成/v 块间/n 的/ude1 间隙/n IBG/x (/wkz Inter/x  Block/x  Gap/x )/wky 。/wj 图/n 11．2/m (/wkz b/x )/wky 表示/v 将/p 20/m 个/q 长度/n 为/p 80/m 字符/n 的/ude1 字符/n 组/n 存放在/v 磁带/n 上/f 的/ude1 一个/mq 物理/n 块/q 中/f 的/ude1 情况/n 。/wj 
    成/v 块/q 的/ude1 办法/n 可以/v 减少/v I．RG/x 的/ude1 数目/n ，/wd 从而/c 可以/v 提高/v 磁带/n 的/ude1 利用率/n ，/wd 块/q 的/ude1 长度/n 大于/v IBG/x 的/ude1 长度/n 。/wj 
    成/v 块/q 还/d 可/v 减少/v I／O/x 操作/vn 。/wj 因为/p 一/m 次/qv I／O/x 操作/v 可/v 把/pba 整个/b 物理/n 块/q 都/d 读/v 到/v 内存/n 缓冲区/n 中/f ，/wd 然后/c 再/d 从/p 缓冲区/n 中/f 取出/v 所/usuo 需要/v 的/ude1 信息/n (/wkz 一个/mq 字符/n 组/vg )/wky 。/wj 每当/p 要/v 读/v 一个/mq 字符/n 组/n 时/ng ，/wd 首先/d 要/v 查/v 缓冲区/n 中/f 是否/v 已/d 有/vyou ，/wd 若/c 有/vyou ，/wd 则/c 不必/d 执行/v I／O/x 操作/vn ，/wd 直接/ad 从/p 缓冲区读取/n 即可/v 。/wj 
    软件/n 要/v 有/vyou 处理/v 成/v 块/q 、/wn 解/v 块/q 和/cc 保存/v 字符/n 组/n 的/ude1 功能/n 。/wj 在/p 使用者/n 看来/v ，/wd 每/rz 次/qv 读/v ／/w 写/v 的/ude1 却/d 只/d 是/vshi 一个/mq 字符/n 组/n [/wkz 。/wj 
    是否/v 物理/n 块/q 越/d 大/a ，/wd 数据/n 越/d 紧凑/a ，/wd 效率/n 就/d 越/d 高/a 呢/y ?/ww 实际上/d 不/d 是/vshi 这样/rzv 的/ude1 。/wj 物理/n 块/q 不能/v 太/d 大/a ，/wd 通常/d 只/d 有/vyou lK/x ～/ws 8K/x 字节/n 。/wj 这/rzv 是/vshi 因为/p 如果/c 一/m 次/qv 读/v 写/v 太/d 长/a ，/wd 则/d 出错/vi 的/ude1 概率/n 就/d 增大/v ，/wd 可靠性/n 就/d 降低/v ；/wf 此外/c ，/wd 若/c 块/q 太/d 大/a ，/wd 则/c 在/p 内存/n 开辟/v 的/ude1 缓冲区/n 就/d 大/a ，/wd 从而/c 耗费/v 内存/n 空间/n 也/d 多/a 。/wj 
    在/p 磁带/n 上/f 读/v 写/v 一/m 块信息/n 所/usuo 需/v 的/ude1 时间/n 由/p 两/m 部分/n 组成/v ：/wp 
其中/rz ：/wp ￡/m 。/wj 为/p 延迟/v 时间/n ，/wd 读/v ／/w 写/v 头/n 到达/v 传输信息/n 所/usuo 在/v 物理/n 块/q 起始/vn 位置/n 所/usuo 需/v 时间/n ；/wf ￡/m 。/wj 为/p 传输/v b/x 个/q 字符/n 的/ude1 时间/n 。/wj 
    显然/a ，/wd 延迟/v 时间/n 和/cc 信息/n 在/p 磁带/n 上/f 的/ude1 位置/n 、/wn 当前/t 读/v ／/w 写/v 头/q 所在/n 位置/n 有关/vn 。/wj 例如/v ，/wd 若/c 读/v ／/w 写/v 头/n 在/p 第/m i/x 和/cc 第/m i+1/x 个/q 物理/n 块/q 之间/f 的/ude1 间隙/n 上/f ，/wd 则/c 读/v 第/m i+1/x 个/q 物理/n 块/q 上/f 的/ude1 信息/n 仅/d 需/v 几/m 毫秒/q ；/wf 
若/c 读/v ／/w 写/v 头/n 位于/v 磁带/n 的/ude1 始/vg 端/ng ，/wd 而/cc 要/v 读/v 的/ude1 信息/n 在/p 磁带/n 的/ude1 尾/ng 端/v ，/wd 则/c 必须/d 使/v 磁带/n 向前/vi 运动/vn ，/wd 跳/vi 过/uguo 中间/f 的/ude1 许多/m 块/q ，/wd 直到/v 所/usuo 需/v 信息/n 通过/p 读/v ／/w 写/v 头/n 时/ng 才/d 能/v 得到/v ，/wd 这/rzv 可能/v 需要/v 几/m 分钟/qt 的/ude1 时间/n 。/wj 因此/c ，/wd 由于/c 磁带/n 是/vshi 顺序/n 存取/vn 的/ude1 设备/n ，/wd 则/c 读/v ／/w 写/v 信息/n 之前/f 先/d 要/v 进行/vx 顺序/n 查找/v ，/wd 并且/c 当/p 读/v ／/w 写/v 头/n 位于/v 磁带/n 尾/ng 端/v ，/wd 而/cc 要/v 读/v 的/ude1 信息/n 在/p 磁带/n 始/vg 端/v 时/ng ，/wd 尚/d 需/v 使/v 磁带/n 倒转/vi 运动/vn 。/wj 这/rzv 是/vshi 顺序/n 存取设备/n 的/ude1 主要/b 缺点/n ，/wd 它/rr 使/v 检索/vn 和/cc 修改/vn 信息/n 很/d 不/d 方便/a 。/wj 因此/c ，/wd 顺序/n 存取设备/n 主要/d 用于/v 处理/v 变化/vn 少/a 、/wn 只/d 进行/vx 顺序/n 存取/vn 的/ude1 大量/m 数据/n 。/wj 
    二/m 、/wn 磁盘信息/n 的/ude1 存取/vn 
    磁盘/n 是/vshi 一/m 种/q 直接/ad 存取/v 的/ude1 存储设备/n (/wkz I/x )/wky ASI/x )/wky )/wky 。/wj 它/rr 是/vshi 以/p 存取时间/n 变化/vn 不/d 大/a 为/p 特征/n 的/ude1 。/wj 它/rr 不/d 像/v 磁带/n 那样/rzv 只/d 能/v 进行/vx 顺序/n 存取/vn ，/wd 而/cc 可以/v 直接/ad 存取任何/n 字符/n 组/n 。/wj 它/rr 的/ude1 容量/n 大/a 、/wn 速度/n 快/a ，/wd 存取速度/n 比/p 磁带/n 快/a 得/ude3 多/a 。/wj 磁盘/n 是/vshi 一个/mq 扁平/b 的/ude1 圆盘/n (/wkz 与/p 电唱机/n 的/ude1 唱片/n 类似/v )/wky ，/wd 盘面/n 上/f 有/vyou 许多/m 称为/v 磁道/n 的/ude1 圆圈/n ，/wd 信息/n 就/d 记载/v 在/p 磁道/n 上/f 。/wj 由于/p 磁道/n 的/ude1 圆圈/n 为/p 许多/m 同心圆/n ，/wd 所以/c 可以/v 直接/ad 存取/v 。/wj 磁盘/n 可以/v 是/vshi 单/d 片/q 的/ude1 ，/wd 也/d 可以/v 由/p 若干/m 盘/qv 片/ng 组成/v 盘/qv 组/n 。/wj 每/rz 一/m 片/q 上/f 有/vyou 两/m 个/q 面/n 。/wj 以/p 6/m 片/q 盘/qv 组/n 为/p 例/n ，/wd 由于/c 最/d 顶/v 上/f 和/cc 最低/a 下/f 盘/v 片/q 的/ude1 外/f 侧面/f 不/d 存信息/n ，/wd 所以/c 总共/d 只/d 有/vyou 10/m 个/q 面/n 可/v 用/v 来/vf 保存信息/n ，/wd 如/v 图/n 11．3/m 所/usuo 示/vg 。/wj 
    磁盘驱动器/n 执行/v 读/v ／/w 写/v 信息/n 的/ude1 功能/n 。/wj 盘/ng 片/ng 装/v 在/p 一个/mq 主轴/n 上/f ，/wd 并/cc 绕/v 主轴/n 高速旋转/n ，/wd 当/p 磁道/n 在读/vn ／/w 写/v 头/n 下/f 通过/v 时/ng ，/wd 便/d 可以/v 进行/vx 信息/n 的/ude1 读/v ／/w 写/v 。/wj 
    可以/v 把/pba 磁盘/n 分为固定/n 头/n 盘/qv 和/cc 活动/vn 头/n 盘/qv 。/wj 固定头/n 盘/qv 的/ude1 每/rz 一/m 道/qv 上/f 都/d 有/vyou 独立/a 的/ude1 磁头/n ，/wd 它/rr 是/vshi 固定不动/n 的/ude1 ，/wd 专/d 负责/v 读/v ／/w 写/v 某/rz 一/m 道/qv 上/f 的/ude1 信息/n 。/wj 
    活动/vn 头/n 盘/qv 的/ude1 磁头/n 是/vshi 可/v 移动/vn 的/ude1 。/wj 盘/v 组/n 也/d 是/vshi 可/v 变/v 的/ude1 。/wj 一个/mq 面/n 上/f 只/d 有/vyou 一个/mq 磁头/n ，/wd 它/rr 可以/v 从/p 该/rz 面上/s 的/ude1 一/m 道/qv 移动/vn 到/v 另/rz 一/m 道/qv 。/wj 
磁头/n 装/v 在/p 一个/mq 动臂/n 上/f ，/wd 不同/a 面上/s 的/ude1 磁头/n 是/vshi 同时/n 移动/vn 的/ude1 ，/wd 并/cc 处于/v 同一/b 圆柱/n 面上/s 。/wj 各个/rz 面上/s 半径/n 相同/a 的/ude1 磁道/n 组成/v 一个/mq 圆柱/n 面/q ，/wd 圆柱/n 面的/n 个数/n 就/d 是/vshi 盘/qv 片面/a 上/f 的/ude1 磁道/n 数/n 。/wj 通常/d ，/wd 每个/r 面/n 上/f 有/vyou 200/m ～/ws 400/m 道/qv 。/wj 在/p 磁盘/n 上/f 标明/v 一个/mq 具体/a 信息/n 必须/d 用/v 一个/mq 三维/mq 地址/n ：/wp 柱/n 面/q 号/n 、/wn 盘面/n 号/q 、/wn 块号/n 。/wj 
    其中/rz ，/wd 柱/ng 面/n 号确定/n 读/v ／/w 写/v 头/n 的/ude1 径向/n 运动/vn ，/wd 而/cc 块号/n 确定/v 信息/n 
在/p 盘/qv 片/q 圆圈/n 上/f 的/ude1 位置/n 。/wj 
盘/v 片/q  柱/ng 面/n  磁道/n 
图/n 11．3/m 活动/vn 头/n 盘/qv 示意图/n 
　　为了/p 访问/v 一/m 块信息/n ，/wd 首先/c 必须/d 找/v 柱/ng 面/n ，/wd 移动/v 臂/ng 使/v 磁头移动/n 到/v 所/usuo 需/v 柱/ng 面上/s (/wkz 称为/v 定位/n 或/c 寻/v 查/v )/wky ；/wf 然后/c 等待/v 要/v 访问/v 的/ude1 信息/n 转/vd 到/v 磁头/n 之下/f ；/wf 最后/f ，/wd 读/v ／/w 写/v 所/usuo 需/v 信息/n 。/wj 
　　所以/c ，/wd 在/p 磁盘/n 上/f 读/v 写/v 一/m 块信息/n 所/usuo 需/v 的/ude1 时间/n 由/p 三/m 部分/n 组成/v ：/wp 
    其中/rz ：/wp ￡/m 。/wj ^/n 为/p 寻/v 查/v 时间/n (/wkz seek/x  time/x )/wky ，/wd 即/d 读/v ／/w 写/v 头/n 定位/vi 的/ude1 时间/n ；/wf 
    ￡/m 如/v 为/p 等待/v 时间/n (/wkz 1atency/x  time/x )/wky ，/wd 即/d 等待/v 信息/n 块/q 的/ude1 初始位置/n 旋转/vi 到/v 读写头/n 下/f 的/ude1 时间/n ；/wf 
    ￡/m 一/m 为/v 传输时间/n (/wkz transmission/x  time/x )/wky 。/wj 
由于/p 磁盘/n 的/ude1 旋转/vn 速度/n 很快/d ，/wd 约/d 2/m  400/m ～/ws 3/m  600/m 转/v ／/w 分/v ，/wd 则/c 等待/v 时间/n 最/d 长/a 不/d 超过/v 25/m 毫秒/q (/wkz 旋转/vi 一/m 圈/qv 的/ude1 时间/n )/wky ，/wd 磁盘/n 的/ude1 传输速率/n 一般/uyy 在/p 10/m ’/wyy 字符/n ／/w 秒/qt 和/cc 5×100/m 字符/n ／/w 秒/qt 之间/f ，/wd 则/c 在/p 磁盘/n 上/f 读/v ／/w 写/v 信息/n 的/ude1 时间/n 主要/b 花/n 在/p 寻/v 查/v 时间/n 上/f (/wkz 其/rz 最/d 大/a 寻/v 查/v 时间/n 约/d 为/v 0．1/m 秒/qt )/wky 。/wj 因此/c ，/wd 在/p 磁盘/n 上/f 存放/v 信息/n 时/ng 应/v 将/d 相关/vi 的/ude1 信息/n 放/v 在/p 同一/b 柱/ng 面/n 或/c 邻近/v 柱/ng 面上/s ，/wd 以/p 求/v 在/p 读/v ／/w 写/v 信息/n 时/ng 尽量减少/n 磁头/n 来回/vd 移动/v 的/ude1 次数/n ，/wd 以/p 避免/v 不必要/a 的/ude1 寻/v 查/v 时间/n 。/wj 11．2/m 外部/f 排序/vi 的/ude1 方法/n 
    外部/f 排序/vi 基本/a 上/f 由/p 两/m 个/q 相对/d 独立/a 的/ude1 阶段/n 组成/v 。/wj 首先/c ，/wd 按/p 可用/a 内存/n 大小/n ，/wd 将/p 外存/n 上/f 含/v n/x 个/q 记录/n 的/ude1 文件/n 分成若干/n 长度/n 为/v z/x 的/ude1 子/ng 文件/n 或/c 段/q (/wkz segment/x )/wky ，/wd 依次/d 读入/v 内存/n 并/cc 利用/v 有效/a 的/ude1 内部/f 排序/vi 方法/n 对/p 它们/rr 进行/vx 排序/vn ，/wd 并/cc 将/d 排序/vi 后/f 得到/v 的/ude1 有序/a 子/ng 文件/n 重新/d 写入/v 外存/n ，/wd 通常/d 称/v 这些/rz 有序/a 子/ng 文件/n 为/v 归并/vi 段/ng 或/c 顺/v 串/v (/wkz run/x )/wky ；/wf 然后/c ，/wd 对/p 这些/rz 归并/vi 段/ng 进行/vx 逐/v 趟/qv 归并/vi ，/wd 使/v 归并/vi 段/ng (/wkz 有序/a 的/ude1 子/ng 文件/n )/wky 逐渐/d 由/p 小/a 至/p 大/a ，/wd 直至/v 得/ude3 到/v 整个/b 有序/a 文件/n 为止/u 。/wj 显然/a ，/wd 第一/m 阶段/n 的/ude1 工作/vn 是/vshi 上/f 一/m 章/q 已经/d 讨论/v 过/uguo 的/ude1 内容/n 。/wj 本/rz 章/n 主要/d 讨论/v 第二/m 阶段/n 即/d 归并/vi 的/ude1 过程/n 。/wj 先/d 从/p 一个/mq 具体/a 例子/n 来/vf 看/v 外/f 排/v 中/f 的/ude1 归并/vi 是/vshi 如何/ryv 进行/vx 的/ude1 ?/ww 
    ・/w 295・/m 
    假/ad 设有/v 一个/mq 含/v 10/m  000/m 个/q 记录/n 的/ude1 文件/n ，/wd 首先/c 通过/p 10/m 次/qv 内部/f 排序/vi 得到/v 10/m 个/q 初始/b 归并/vi 段/q R1/x ～/ws R10/x ，/wd 其中/rz 每/rz 一/m 段/q 都/d 含/v 1000/m 个/q 记录/n 。/wj 然后/c 对/p 它们/rr 作/v 如下/vn 图/n 所/usuo 示/vg 的/ude1 两两/m 归并/vi ，/wd 直至/v 得到/v 一个/mq 有序/a 文件/n 为止/u 。/wj     R1/x     R2/x     R3/x     R4/x     R5/x     R6/x     R7/x     R8/x     R9/x     R10/x 
　　从/p 上/f 图/n 可见/c ，/wd 由/p 10/m 个/q 初始/b 归并/vi 段/ng 到/v 一个/mq 有序/a 文件/n ，/wd 共/d 进行/vx 了/ule 四/m 趟/qv 归并/vi ，/wd 每/rz 一/m 趟/qv 从/p m/x 个/q 归并/vi 段/ng 得/ude3 到/v 厂/n m／2/x ]/wky 个/q 归并/vi 段/ng 。/wj 这种/r 归并/vi 方法/n 称为/v 2/m 一路/mq 平衡/a 归并/vi 。/wj 
　　    将/p 两/m 个/q 有序/a 段/q 归并/vi 成/v 一个/mq 有序/a 段/q 的/ude1 过程/n ，/wd 若/c 在/p 内存/n 进行/vx ，/wd 则/c 很/d 简单/a ，/wd 上/f 一/m 章/q 中/f 的/ude1 merge/x 过程/n 便/d 可/v 实现/v 此/rzs 归并/vi 。/wj 但是/c ，/wd 在/p 外部/f 排序/vi 中/f 实现/v 两两/m 归并/vi 时/ng ，/wd 不仅/c 要/v 调用/v merge/x 过程/n ，/wd 而且/c 要/v 进行/vx 外存/n 的/ude1 读/v ／/w 写/v ，/wd 这/rzv 是/vshi 由于/p 我们/rr 不/d 可能/v 将/p 两/m 个/q 有序/a 段/q 及/cc 归并/vi 结果/n 段/q 同时/n 存放在/v 内存/n 中/f 的/ude1 缘故/n 。/wj 在/p 11．1/m 节/q 中/f 已经/d 提到/v ，/wd 对外/vd 存/v 上/vf 信息/n 的/ude1 读/v ／/w 写/v 是/vshi 以/p “/wyz 物理/n 块/ng ”/wyy 为/p 单位/n 的/ude1 。/wj 假设/v 在/p 上/f 例/n 中/f 每个/r 物理/n 块/q 可以/v 容纳/v 200/m 个/q 记录/n ，/wd 则/c 每/rz 一/m 趟/qv 归并/vi 需/v 进行/vx 50/m 次/qv “/wyz 读/v ”/wyy 和/cc 50/m 次/qv “/wyz 写/v ”/wyy ，/wd 四/m 趟/qv 归并/vi 加上/v 内部/f 排序/vi 时/ng 所/usuo 需/v 进行/vx 的/ude1 读/v ／/w 写/v 使得/vi 在/p 外/f 排/v 中/f 总/d 共/d 需/v 进行/vx 500/m 次/qv 的/ude1 读/v ／/w 写/v 。/wj     ・/w 
    一般/a 情况/n 下/f ，/wd 外部/f 排序/vi 所/usuo 需/v 总/b 的/ude1 时间/n =/m     内部/f 排序/vi (/wkz 产生/v 初始/t 归并/vi 段/ng )/wky 所/usuo 需/v 的/ude1 时间/n   m/x */n tIs/x     +/m 外存/n 信息/n 读/v 写/v 的/ude1 时间/n     d/x */n t10/x     (/wkz 11．1/m )/wky     +/m 内部/f 归并/vi 所/usuo 需/v 的/ude1 时间/n     其中/rz ：/wp ￡/m ，/wd s/x 是/vshi 为/p 得到/v 一个/mq 初始/b 归并/vi 段/ng 进行/vx 内部/f 排序/vi 所/usuo 需/v 时间/n 的/ude1 均值/n ；/wf ￡/m 尬/x 是/vshi 进行/vx 一/m 次/qv 外存/n 读/v ／/w 写/v 时间/n 的/ude1 均值/n ；/wf Utm/x 。/wj 是/vshi 对/p “/wyz 个/q 记录/n 进行/vx 内部/f 归并/vi 所/usuo 需/v 时间/n ；/wf m/x 为/v 经过/p 内部/f 排序/vi 之后/f 得到/v 的/ude1 初始/b 归并/vi 段/ng 的/ude1 个/q 数/n ；/wf s/x 为/v 归并/vi 的/ude1 趟/qv 数/n ；/wf d/x 为/p 总/b 的/ude1 读/v ／/w 写/v 次数/n 。/wj 由此/d ，/wd 上/vf 例/n 10/m  000/m 个/q 记录/n 利用/v 2．/m 路/qv 归并/vi 进行/vx 外/f 排/v 所/usuo 需/v 总/b 的/ude1 时间/n 为/v ：/wp 
    10/m */n tIs+500/x */n tIo+4/x */n 10/m  000tmg/x 
其中/rz ￡/m ，/wd 0/m 取决于/v 所/usuo 用/v 的/ude1 外存/n 设备/n ，/wd 显然/a ，/wd tlo/x 较/d ￡/m 。/wj 。/wj 要/v 大/a 得/ude3 多/a 。/wj 因此/c ，/wd 提高/v 外/f 排/v 的/ude1 效率/n 应/v 主要/d 着眼/vi 于/p 减少/v 外存/n 信息/n 读/v 写/v 的/ude1 次数/n d/x 。/wj 
    下面/f 来/vf 分析/v d/x 和/cc “/wyz 归并/vi 过程/n ”/wyy 的/ude1 关系/n 。/wj 若/c 对/p 上/f 例/n 中/f 所/usuo 得/v 的/ude1 10/m 个/q 初始/b 归并/vi 段/ng 进行/vx 5．/m 路/n 平衡/an 归并/vi (/wkz 即/v 每/rz 一/m 趟/qv 将/p 5/m 个/q 或/c 5/m 个/q 以下/f 的/ude1 有序/a 子/ng 文件/n 归并/vi 成/v 一个/mq 有序/a 子/ng 文件/n )/wky ，/wd 则/c 从/p 下/f 图/n 可见/c ，/wd 仅/d 需/v 进行/vx 二/m 趟/qv 归并/vi ，/wd 外/f 排/v 时/ng 总/b 的/ude1 读/v ／/w 写/v 次数/n 便/d 减/v 至/p 2×100+100=300/m ，/wd 比/p 2．/m 路/qv 归并/vi 减少/v 了/ule 200/m 次/qv 的/ude1 读/v ／/w 写/v 。/wj 
    有序/a 文件/n 
    可见/c ，/wd 对/p 同一/b 文件/n 而言/uls ，/wd 进行/vx 外/f 排/v 时/ng 所/usuo 需/v 读/v ／/w 写/v 外存/n 的/ude1 次数/n 和/cc 归并/vi 的/ude1 趟/qv 数/n s/x 成/v 正比/n 。/wj 而/cc 在/p 一般/a 情况/n 下/f ，/wd 对/p m/x 个/q 初始/b 归并/vi 段/ng 进行/vx k/x 一路/d 平衡/a 归并/vi 时/ng ，/wd 归并/vi 的/ude1 趟/qv 数/n ，/wd 若/c 增加/v b/x 或/c 减少/v s/x 便/d 能/v 减少/v s/x 。/wj 下面/f 分别/d 就/d 这/rzv 两/m 个/q 方面/n 讨论/v 之/uzhi 。/wj 
11．3/m 多/m 路/n 平衡/an 归并/vi 的/ude1 实现/vn 
    从/p 式/k (/wkz 11―2/m )/wky 得知/v ，/wd 增加/v 走/v 可以/v 减少/v s/x ，/wd 从而/c 减少/v 外存/n 读/v ／/w 写/v 的/ude1 次数/n 。/wj 但是/c ，/wd 从/p 下面/f 的/ude1 讨论/vn 中/f 又/d 可/v 发现/v ，/wd 单纯/ad 增加/v 是/vshi 将/d 导致/v 增加/v 内部/f 归并/vi 的/ude1 时间/n “/wyz ￡/m 。/wj 。/wj 。/wj 那末/c ，/wd 如何/ryv 解决/v 这个/rz 矛盾/an 呢/y ?/ww 
    先/d 看/v 2/m 一路/mq 归并/vi 。/wj 令/v “/wyz 个/q 记录/n 分布/vi 在/p 两/m 个/q 归并/vi 段/ng 上/f ，/wd 按/p merge/x 过程/n 进行/vx 归并/vi 。/wj 每/rz 得到/v 归并/vi 后/f 的/ude1 一个/mq 记录/n ，/wd 仅/d 需/v 一/m 次比较/n 即可/v ，/wd 则/c 得到/v 含/v “/wyz 个/q 记录/n 的/ude1 归并/vi 段/ng 需/v 进行/vx “/wyz -/wp 1/m 次比较/n 。/wj 
    再/d 看/v 志/n 一路/mq 归并/vi 。/wj 令/v “/wyz 个/q 记录/n 分布/vi 在/p 是/vshi 个/q 归并/vi 段/ng 上/f ，/wd 显然/a ，/wd 归并/vi 后/f 的/ude1 第一/m 个/q 记录/n 应/v 是/vshi 走/v 个/q 归并/vi 段/ng 中/f 关键字/n 最/d 小/a 的/ude1 记录/n ，/wd 即/d 应/v 从/p 每个/r 归并/vi 段/ng 的/ude1 第一/m 个/q 记录/n 的/ude1 相互/b 比较/vn 中/f 选/v 出/vf 最/d 小/a 者/k ，/wd 这/rzv 需要/v 进行/vx 忌/vn -/wp 1/m 次比较/n 。/wj 同/p 理/n ，/wd 每/rz 得到/v 归并/vi 后/f 的/ude1 有序/a 段/q 中/f 的/ude1 一个/mq 记录/n ，/wd 都/d 要/v 进行/vx 1/m 次比较/n 。/wj 显然/a ，/wd 为/p 得到/v 含/v “/wyz 个/q 记录/n 的/ude1 归并/vi 段/ng 需/v 进行/vx (/wkz 甜/a -/wp 1/m )/wky (/wkz 七-/m 1/m )/wky 次比较/n 。/wj 由此/d ，/wd 对/p n/x 个/q 记录/n 的/ude1 文件/n 进行/vx 外/f 排/v 时/ng ，/wd 在/p 内部/f 归并/vi 过程/n 中/f 进行/vx 的/ude1 总/b 的/ude1 比较/vn 次数/n 为/v s/x (/wkz 1/m )/wky 。/wj 假设/v 所得/n 初始/t 归并/vi 段/ng 为/v m/x 个/q ，/wd 则/c 由/p 式/k (/wkz 11．2/m )/wky 可/v 得/ude3 内部/f 归并/vi 过程/n 中/f 进行/vx 比较/vn 的/ude1 总/b 的/ude1 次数/n 为/v 
由于/c 等/v 专/d 随/v v/x 的/ude1 增长/vn 而/cc 增长/vn ，/wd 则/c 内部/f 归并/vi 时间/n 亦/d 的/ude1 增长/vn 而/cc 增长/vn 。/wj 这/rzv 将/d 抵消/v 由于/c 增大/v  g/x 而/cc 减少/v 外存/n 信息/n 读写时间/n 所得/n 效益/n ，/wd 这/rzv 是/vshi 我们/rr 所/usuo 不/d 希望/v 的/ude1 。/wj 然而/c ，/wd 若/c 在/p 进行/vx 走/v 一路/mq 归并/vi 时/ng 利用/v “/wyz 败者/n 树/n ”/wyy (/wkz Tree/x  of/x  Loser/x )/wky ，/wd 则/c 可/v 使/v 在/p 忌/v 个/q 记录/n 中/f 选出/v 关键字/n 最/d 小/a 的/ude1 记录/n 时/ng 仅/d 需/v 进行/vx glog2/x 是/vshi ]/wky 次比较/n ，/wd 从而/c 使/v 总/b 的/ude1 归并/vi 时间/n 由/p 式/k (/wkz 11―3/m )/wky 变为/v 厂/n log2/x 仇/n ]/wky (/wkz 他/rr -/wp 1/m )/wky f/x 。/wj 。/wj ，/wd 显然/a ，/wd 这个/rz 式子/n 和/cc f/x 无关/v ，/wd 它/rr 不再/d 随/v f/x 的/ude1 增长/vn 而/cc 增长/vn 。/wj 
    图/n 11．4/m 实现/v 5/m 一路/mq 归并/vi 的/ude1 败者/n 树/n 
    那末/c ，/wd 什么/ry 是/vshi “/wyz 败者/n 树/n ”/wyy ?/ww 它/rr 是/vshi 树形/n 选择/v 排序/vi 的/ude1 一/m 种/q 变型/vi 。/wj 相对/b 地/n ，/wd 我们/rr 可/v 称/v 图/n 10．8/m 和/cc 图/n 10．9/m 中/f 的/ude1 二/m 叉树/n 为/v “/wyz 胜/v 者/k 树/v ”/wyy ，/wd 因为/c 每个/r 非/b 终端/n 结点/n 均/d 表示/v 其/rz 左/a 、/wn 右/f 孩子/n 结点/n 中/f 的/ude1 “/wyz 胜/v 者/k ”/wyy 。/wj 反之/c ，/wd 若/c 在/p 双亲/n 结点/n 中/f 记/v 下/f 刚/d 进行/vx 完/vi 的/ude1 这/rzv 场/qv 比赛/vn 中/f 的/ude1 败者/n ，/wd 而/cc 让/v 胜/v 者/k 去/vf 参加/v 更/d 高/a 一/m 层/qv 的/ude1 比赛/vn ，/wd 便/d 可/v 得到/v 一/m 棵/q “/wyz 败者/n 树/n ”/wyy 。/wj 例如/v ，/wd 图/n 11．4/m (/wkz a/x )/wky 所/usuo 示/vg 为/p 一/m 棵/q 实现/v 5/m 一路/mq 归并/vi 的/ude1 败者/n 树/n ls/x [/wkz 0．．4/m ]/wky ，/wd 图/n 中/b 方形/n 结点/n 表示/v 叶子/n 结点/n (/wkz 也/d 可/v 看成/v 是/vshi 外/f 结点/n )/wky ，/wd 分别/d 为/v 5/m 个/q 归并/vi 段/ng 中/f 当前/t 参加/v 归并/vi 选择/v 的/ude1 记录/n 的/ude1 关键/n 字/n ；/wf 败者/n 树/n 中/b 根/n 结点/n ls/x [/wkz 1/m ]/wky 的/ude1 双亲/n 结点/n ls/x [/wkz 0/m ]/wky 为/p “/wyz 冠军/n ”/wyy ，/wd 在/p 此/rzs 指示/n 各/rz 归并/vi 段/ng 中/f 的/ude1 最/d 小/a 关键字记录/n 为/p 第三/m 段/q 中/f 的/ude1 当前/t 记录/v ；/wf 结点/n ls/x [/wkz 3/m ]/wky 指示/n b1/x 和/cc b2/x 两/m 个/q 叶子/n 结点/n 中/f 的/ude1 败者/n 即/v b2/x ，/wd 而/cc 胜/v 者/k b1/x 和/cc b3/x (/wkz b3/x 是/vshi 叶子/n 结点/n b3/x 、/wn b4/x 和/cc b0/x 经过/p 两/m 场/qv 比赛/vn 后/f 选出/v 的/ude1 获胜/vi 者/k )/wky 进行/vx 比较/vn ，/wd 结点/n ls/x [/wkz 1/m ]/wky 则/d 指示/v 它们/rr 中/f 的/ude1 败者/n 为/v b1/x 。/wj 在/p 选/v 得/ude3 最/d 小/a 关键字/n 的/ude1 记录/n 之后/f ，/wd 只要/c 修改/v 叶子/n 结点/n b3/x 中/f 的/ude1 值/n ，/wd 使/v 其/rz 为/p 同一/b 归并/vi 段/ng 中/f 的/ude1 下/vf 一个/mq 记录/n 的/ude1 关键/n 字/n ，/wd 然后/c 从/p 该/rz 结点/n 向上/vi 和/cc 双亲/n 结点/n 所/usuo 指/v 的/ude1 关键/n 字/n 进行/vx 比较/vn ，/wd 败者/n 留/v 在/p 该/rz 双亲/n 结点/n ，/wd 胜/v 者/k 继续/v 向/p 上/f 直至/v 树根/n 的/ude1 双亲/n 。/wj 如/v 图/n 11．4/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 当/p 第3/m 个/q 归并/vi 段/ng 中/f 第2/m 个/q 记录/n 参加/v 归并/vi 时/ng ，/wd 选/v 得/v 的/ude1 最/d 小/a 关键字记录/n 为/p 第一/m 个/q 归并/vi 段/ng 中/f 的/ude1 记录/n 。/wj 为了/p 防止/v 在/p 归并/vi 过程/n 中/f 某个/rz 归并/vi 段/ng 变空/n ，/wd 可以/v 在/p 每个/r 归并/vi 段/ng 中/f 附加/v 一个/mq 关键/a 字/n 为/v 最/d 大值/n 的/ude1 记录/n 。/wj 当/p 选出/v 的/ude1 “/wyz 冠军/n ”/wyy 记录/v 的/ude1 关键/n 字/n 为/v 最/d 大值/n 时/ng ，/wd 表明/v 此次/rz 归并/vi 已/d 完成/v 。/wj 由于/c 实现/v k．/x 路/n 归并/vi 的/ude1 败者/n 树/n 的/ude1 深度/n 为/v log2/x 五/m ]/wky +1/m ，/wd 则/c 在/p d/x 个/q 记录/n 中/f 选择/v 最/d 小/a 关键字/n 仅/d 需/v 进行/vx log2/x 愚/v ]/wky 次比较/n 。/wj 败者/n 树/n 的/ude1 初始化/v 也/d 容易/ad 实现/v ，/wd 只要/c 先令/n 所有/b 的/ude1 非/b 终端/n 结点/n 指向/v 一个/mq 含/v 最/d 小/a 关键字/n 的/ude1 叶子/n 结点/n ，/wd 然后/c 从/p 各个/rz 叶子/n 结点/n 出发/vi 调整/v 非/b 终端/n 结点/n 为/v 新/a 的/ude1 败者/n 即可/v 。/wj 
    下面/f 的/ude1 算法/n 11．1/m 简单/ad 描述/v 利用/v 败者/n 树/n 进行/vx k/x 一路/d 归并/vi 的/ude1 过程/n 。/wj 为了/p 突出/v 如何/ryv 利用/v 败者/n 树/n 进行/vx 归并/vi ，/wd 在/p 算法/n 中/f 避开/v 了/ule 外存/n 信息/n 存取/vn 的/ude1 细节/n ，/wd 可以/v 认为/v 归并/vi 段/ng 已/d 在/p 内存/n 。/wj 算法/n 11．2/m 描述/v 在/p 从/p 败者/n 树/n 选/v 得/ude3 最/d 小/a 关键字/n 的/ude1 记录/n 之后/f ，/wd 如何/ryv 从/p 叶/ng 到/v 根/n 调整/vn 败者/n 树/n 选/v 得/ude3 下/vf 一个/mq 最/d 小/a 关键字/n 。/wj 算法/n 11．3/m 为/v 初/f 建/v 败者/n 树/n 的/ude1 过程/n 的/ude1 算法/n 描述/vn 。/wj 
typedef/x  int/x  LoserTree/x [/wkz k/x ]/wky ；/wf     ∥/w 败者/n 树/n 是/vshi 完全/a 二/m 叉树/n 且/c 不/d 含/v 叶子/n ，/wd 可/c 采用/v 顺序/n 存储/vn 结构/n 
t/x ’/wyy 瞳/n edef/x  struct/x {/n 
  Ke/x ~/n "/n ype/x  key/x ；/wf 
}/n ExNode/x ，/wd Externa/x ]/wky [/wkz k/x ]/wky ；/wf     ∥/w 外/f 结点/n ，/wd 只/d 存放/v 待/vi 归并/vi 记录/v 的/ude1 关键/n 字/n 
void/x  K―Merge/x (/wkz LoserTree/x ＆/n ls/x ，/wd External/x ＆/n b/x )/wky {/n 
    ∥/w 利用/v 败者/n 树/n ls/x 将/d 编号/vi 从/p 0/m 到/v k-1/x 的/ude1 k/x 个/q 输入/v 归并/vi 段/ng 中/f 的/ude1 记录/n 归并/vi 到/v 输出/v 归并/vi 段/ng 。/wj 
    ∥/w b/x [/wkz 0/m ]/wky 至/p b/x [/wkz k-1/x ]/wky 为/p 败者/n 树上/s 的/ude1 k/x 个/q 叶子/n 结点/n ，/wd 分别/d 存放/v k/x 个/q 输入/v 归并/vi 段/ng 中/f 当前/t 记录/v 的/ude1 关键/n 字/n 。/wj 
    for/x (/wkz i=0/x ；/wf i/x </n k/x ；/wf ++i/x )/wky input/x (/wkz b/x [/wkz i/x ]/wky ．/w key/x )/wky ；/wf     ∥/w 分别/d 从/p k/x 个/q 输入/v 归并/vi 段/ng 读入/v 该段/r 当前/t 
    ∥/w 第一/m 个/q 记录/n 的/ude1 关键/n 字/n 到/v 外/f 结点/n 
  CreateLoserTree/x (/wkz 1s/x )/wky ；/wf     ∥/w 建/v 败者/n 树/n ls/x ，/wd 选/v 得/ude3 最/d 小/a 关键字/n 为/v b/x [/wkz 1s/x [/wkz 0/m ]/wky ]/wky ．/w key/x 
  曲/n ile/x (/wkz b/x [/wkz 1s/x [/wkz 0/m ]/wky ]/wky ．/w key/x  I/x _/n MAXKEY/x )/wky {/n 
    q=ls/x [/wkz O/x ]/wky ；/wf     ∥/w q/x 指示/n 当前/t 最/d 小/a 关键字/n 所在/n 归并/vi 段/ng 
    output/x (/wkz q/x )/wky ；/wf     ∥/w 将/p 编号/n 为/v q/x 的/ude1 归并/vi 段/ng 中/f 当前/t (/wkz 关键字/n 为/v b/x [/wkz q/x ]/wky ．/w key/x )/wky 的/ude1 记录/n 
    ∥/w 写/v 至/p 输出/v 归并/vi 段/ng 
    input/x (/wkz b/x [/wkz q/x ]/wky ．/w key/x )/wky ；/wf     ∥/w 从/p 编号/n 为/v q/x 的/ude1 输入/vn 归并/vi 段/ng 中/f 读入/v 下/vf 一个/mq 记录/n 的/ude1 关键/n 字/n 
    Adjust/x (/wkz 1s/x ，/wd q/x )/wky ；/wf     ∥/w 调整/v 败者/n 树/n ，/wd 选择/v 新/a 的/ude1 最/d 小/a 关键字/n 
  }/n ∥/w while/x 
・/w 298・/m 
  output/x (/wkz 1s/x [/wkz 0/m ]/wky )/wky ；/wf     ∥/w 将/d 含/v 最/d 大/a 关键字/n MAXKEY/x 的/ude1 记录写/n 至/p 输出/v 归并/vi 段/ng 
}/n ∥/w K―Merge/x 
    算法/n 11．1/m 
void．Adjust/x (/wkz LoserTree/x ＆/n ls/x ，/wd int/x  s/x )/wky {/n 
  ∥/w 沿/p 从/p 叶子/n 结点/n b/x [/wkz s/x ]/wky 到/v 根/n 结点/n ls/x [/wkz 0/m ]/wky 的/ude1 路径/n 调整/vn 败者/n 树/n 
  t=/x (/wkz s+k/x )/wky ／2/m ；/wf     ∥/w ls/x [/wkz t/x ]/wky 是/vshi b/x [/wkz s/x ]/wky 的/ude1 双亲/n 结点/n 
  ．/w hile/x (/wkz t/x >/n 0/m )/wky {/n 
    if/x (/wkz b/x [/wkz s/x ]/wky ．/w key/x >/n b/x [/wkz 1s/x [/wkz t/x ]/wky ]/wky ．/w key/x )/wky s--ls/x [/wkz t/x ]/wky ；/wf     ∥/w s/x 指示/n 新/a 的/ude1 胜/v 者/k 
    t=/x ‘/wyz t／2：/x 
  }/n 
  ls/x [/wkz 0/m ]/wky =s/x ；/wf 
、/wn }/n {/n Adjust/x 
    算法/n   11．2/m 
void/x  CreateLoserTree/x (/wkz LoserTree/x ＆/n ls/x )/wky l/x 
  ∥/w 已/d 知/v b/x [/wkz O/x ]/wky 到/v b/x [/wkz k-1/x ]/wky 为/p 完全/a 二/m 叉树/n ls/x 的/ude1 叶子/n 结点/n 存/v 有/vyou k/x 个/q 关键/n 字/n ，/wd 沿/p 从/p 叶子/n 
  ∥/w 到/v 根/n 的/ude1 k/x 条/q 路径/n 将/d ls/x 调整/v 成为/v 败者/n 树/n 。/wj 
  b/x [/wkz k/x ]/wky ．/w key=MINKEY/x ；/wf     ∥/w 设/v MINKEY/x 为/p 关键字/n 可能/v 的/ude1 最/d 小/a 值/n 
  for/x (/wkz i=0/x ；/wf i/x </n k/x ；/wf ++i/x )/wky ls/x [/wkz i/x ]/wky =k/x ；/wf     ∥/w 设置/v ls/x 中/f “/wyz 败者/n ”/wyy 的/ude1 初值/n 
  {/n i/x  CreateLoserTree/x 
    算法/n   11．3/m 
    最后/f 要/v 提及/v 一点/mq ，/wd 愚/an 值/n 的/ude1 选择/vn 并非/v 越/d 大/a 越/d 好/a ，/wd 如何/ryv 选择/v 合适/a 的/ude1 曼/ag 是/vshi 一个/mq 需要/n 综合/vd 考虑/v 的/ude1 问题/n 。/wj 
11．4/m 置换/v 一/m 选择/v 排序/vi 
    由/p 11．2/m 式/k 得知/v ，/wd 归并/vi 的/ude1 趟/qv 数/n 不仅/c 和/cc 悬/v 成/v 反比/n ，/wd 也/d 和/cc m/x 成/v 正比/n ，/wd 因此/c ，/wd 减少/v 优/ag 是/vshi 减少/v s/x 的/ude1 另/rz 一/m 条/q 途径/n 。/wj 然而/c ，/wd 我们/rr 从/p 11．2/m 节/q 的/ude1 讨论/vn 中/f 也/d 得知/v ，/wd m/x 是/vshi 外部/f 文件/n 经过/p 内部/f 排序/vi 之后/f 得到/v 的/ude1 初始/b 归并/vi 段/ng 的/ude1 个/q 数/n ，/wd 显然/a ，/wd 优/ag =/m 厂/n 扎/v ／f/x ]/wky ，/wd 其中/rz 挖/v 为/v 外部/f 文件/n 中/f 的/ude1 记录/n 数/n ，/wd f/x 为/p 初始/t 归并/vi 段/ng 中/f 的/ude1 记录/n 数/n 。/wj 回顾/v 上/vf 一/m 章/q 讨论/vn 的/ude1 各种/rz 内/f 排/v 方法/n ，/wd 在/p 内/f 排/v 过程/n 中/b 移动/vn 记录/n 和/cc 对/p 关键字/n 进行/vx 比较/d 都/d 是/vshi 在/p 内存/n 中/f 进行/vx 的/ude1 。/wj 因此/c ，/wd 用/p 这些/rz 方法/n 进行/vx 内部/f 排序/vi 得到/v 的/ude1 各个/rz 初始/b 归并/vi 段/ng 的/ude1 长度/n z/x (/wkz 除/p 最后/f 一/m 段/q 外/f )/wky 都/d 相同/a ，/wd 且/c 完全/ad 依赖/v 于/p 进行/vx 内部/f 排序/vi 时/ng 可/v 用/p 内存/n 工作区/n 的/ude1 大小/n ，/wd 则/d m/x 也/d 随/v 其/rz 而/cc 限定/vn 。/wj 由此/d ，/wd 若/c 要/v 减少/v m/x ，/wd 即/d 增加/v z/x ，/wd 就/d 必须/d 探索/v 新/a 的/ude1 排序/vn 方法/n 。/wj 
    置换/v ．/w 选择/v 排序/vi (/wkz Replacement-Selection/x  Sorting/x )/wky 是/vshi 在/p 树形/n 选择/v 排序/vi 的/ude1 基础/n 上/f 得/ude3 来/vf 的/ude1 ，/wd 它/rr 的/ude1 特点/n 是/vshi ：/wp 在/p 整个/b 排序/vn (/wkz 得到/v 所有/b 初始/b 归并/vi 段/ng )/wky 的/ude1 过程/n 中/f ，/wd 选择/v 最/d 小/a (/wkz 或/c 最/d 大/a )/wky 关键字/n 和/cc 输入/vn 、/wn 输出/vn 交叉/vn 或/c 平行/vd 进行/vx 。/wj 
    先/d 从/p 具体/a 例子/n 谈/v 起/vf 。/wj 已/d 知/v 初始文件/n 含有/v 24/m 个/q 记录/n ，/wd 它们/rr 的/ude1 关键/n 字/n 分别/d 为/v 51/m ，/wd 49/m ，/wd 39/m ，/wd 46/m 。/wj 38/m ，/wd 29/m ，/wd 14/m ，/wd 61/m ，/wd 15/m ，/wd 30/m ，/wd 1/m ，/wd 48/m ，/wd 52/m ，/wd 3/m ，/wd 63/m ，/wd 27/m ，/wd 4/m ，/wd 13/m ，/wd 89/m ，/wd 24/m ，/wd 46/m ，/wd 58/m ，/wd 33/m ，/wd 。/wj 760/m 假设/n 内存/n 工作区/n 可/v 容纳/v 6/m 个/q 记录/n ，/wd 则/c 按/p 上/f 章/n 讨论/vn 的/ude1 选择/vn 排序/vn 可/v 求得/v 如下/vi 4/m 个/q 初始/b 归并/vi 段/ng ：/wp     RUNl：29/x ，/wd 38/m ，/wd 39/m ，/wd 46/m ，/wd 49/m ，/wd 51/m 
    l/x ~/n rJN2：/x   I/x ，/wd 14/m ，/wd 15/m ，/wd 30/m ，/wd 48/m ，/wd 61/m 
    RU-N3：3/x ，/wd 4/m ，/wd 13/m ，/wd 27/m ，/wd 52/m ，/wd 63/m 
    1：Ib/x '/n N4：24/x ，/wd 33/m ，/wd 46/m ，/wd 58/m ，/wd 76/m ，/wd 89/m 
若/c 按/p 置换/v 一/m 选择/v 进行/vx 排序/vn ，/wd 则/c 可/v 求得/v 如下/vi 3/m 个/q 初始/b 归并/vi 段/ng ：/wp 
    RUNl：29/x ，/wd 38/m ，/wd 39/m ，/wd 46/m ，/wd 49/m ，/wd 51/m ，/wd 61/m     ’/wyy 
    RUN2：1/x ，/wd 3/m ，/wd 14/m ，/wd 15/m ，/wd 27/m ，/wd 30/m ，/wd 48/m ，/wd 52/m ，/wd 63/m ，/wd 89/m 
    RUN3：4/x ，/wd 13/m ，/wd 24/m ，/wd 33/m ，/wd 46/m ，/wd 58/m ，/wd 76/m 
    假设/n 初始/t 待/vi 排/v 文件/n 为/p 输入/v 文件/n FI/x ，/wd 初始/t 归并/vi 段文件/n 为/p 输出/vn 文件/n FO/x ，/wd 内存/n 工作区/n 为/v WA/x ，/wd FO/x 和/cc WA/x 的/ude1 初始状态/n 为/v 空/ng ，/wd 并/cc 设/v 内存/n 工作/vn wA/x 区/n 的/ude1 容量/n 可/v 容纳/v 叫/vi 个/q 记录/n ，/wd 则/c 置换/v -/wp 选择/v 排序/vi 的/ude1 操作过程/n 为/v ：/wp 
    (/wkz 1/m )/wky 从/p FI/x 输入/v w/x 个/q 记录/n 到/v 工作区/n WA/x 。/wj 
    (/wkz 2/m )/wky 从/p wA/x 中/f 选/v 出/vf 其中/rz 关键字/n 取/v 最/d 小/a 值/n 的/ude1 记录/n ，/wd 记/v 为/v MINIMAX/x 记录/n 。/wj 
    (/wkz 3/m )/wky 将/d MINIMAX/x 记录/n 输出/v 到/v FO/x 中/f 去/vf 。/wj 
    (/wkz 4/m )/wky 若/v FI/x 不/d 空/a ，/wd 则/c 从/p FI/x 输入/v 下/vf 一个/mq 记录/n 到/v WA/x 中/f 。/wj 
    (/wkz 5/m )/wky 从/p wA/x 中/b 所有/b 关键字/n 比/p MINIMAX/x 记录/n 的/ude1 关键/n 字/n 大/a 的/ude1 记录/n 中/f 选/v 出/vf 最/d 小/a 关键字记录/n ，/wd 作为/v 新/a 的/ude1 MINIMAX/x 记录/n 。/wj 
    (/wkz 6/m )/wky 重复/v (/wkz 3/m )/wky ～/ws (/wkz 5/m )/wky ，/wd 直至/v 在/p WA/x 中/f 选/v 不/d 出/vf 新/a 的/ude1 MINIMAX/x 记录/n 为止/u ，/wd 由此/d 得/ude3 到/v 一个/mq 初始/b 归并/vi 段/ng ，/wd 输出/v 一个/mq 归并/vi 段/ng 的/ude1 结束/vn 标志/n 到/v FO/x 中/f 去/vf 。/wj 
    (/wkz 7/m )/wky 重复/v (/wkz 2/m )/wky ～/ws (/wkz 6/m )/wky ，/wd 直至/v WA/x 为/v 空/ng 。/wj 由此/d 得/ude3 到/v 全部/m 初始/t 归并/vi 段/ng 。/wj 
例如/v ，/wd 以上/f 所/usuo 举/v 之/uzhi 例/n 的/ude1 置换/vn ．/w 选择/v 过程/n 如/v 图/n 11．5/m 所/usuo 示/vg 。/wj 
图/n 11．5/m 置换/v ．/w 选择/v 排序/vn 过程/n 示例/n 
    在/p WA/x 中/f 选择/v MINIMAX/x 记录/n 的/ude1 过程/n 需/v 利用/v “/wyz 败者/n 树/n ”/wyy 来/f 实现/v 。/wj 关于/p “/wyz 败者/n 树/n ”/wyy 本身/rz ，/wd 上/vf 节/n 已/d 有/vyou 详细/a 讨论/vn ，/wd 在/p 此/rzs 仅/d 就/d 置换/v ．/w 选择/v 排序/vi 中/f 的/ude1 实现/vn 细节/n 加以/vx 说明/vn 。/wj (/wkz 1/m )/wky 内存/n 工作区/n 中/f 的/ude1 记录/n 作为/p 败者/n 树/n 的/ude1 外部/f 结点/n ，/wd 而/cc 败者/n 树/n 中/b 根/n 结点/n 的/ude1 双亲/n 结点/n 指示/n 工作区/n 中/b 关键字/n 最/d 小/a 的/ude1 记录/n ；/wf (/wkz 2/m )/wky 为了/p 便于/v 选/v 出/vf MINIMAX/x 记录/n ，/wd 为/p 每个/r 记录/v 附设/v 一个/mq 所在/n 归并/vi 段/ng 的/ude1 序号/n ，/wd 在/p 进行/vx 关键字/n 的/ude1 比较/vn 时/ng ，/wd 先/d 比较/d 段号/n ，/wd 段号/n 小/a 的/ude1 为/p 胜/v 者/k ；/wf 段号/n 相同/a 的/ude1 则/c 关键字/n 小/a 的/ude1 为/p 胜/v 者/k ；/wf (/wkz 3/m )/wky 败者/n 树/n 的/ude1 建立/v 可/v 从/p 设/v 工作区/n 中/f 所/usuo 有/vyou 记录/n 的/ude1 段号/n 均/d 为/v “/wyz 零/m ”/wyy 开始/v ，/wd 然后/c 从/p FI/x 逐个/d 输入/v "/n 个/q 记录/n 到/v 工作区/n 时/ng ，/wd 自下而上/al 调整/v 败者/n 树/n ，/wd 由于/c 这些/rz 记录/n 的/ude1 段号/n 为/v …/ws 1/m ’/wyy ，/wd 则/c 它们/rr 对于/p “/wyz 零/m ”/wyy 段/ng 的/ude1 记录/n 而言/uls 均/d 为/v 败者/n ，/wd 从而/c 逐个/d 填充/v 到/v 败者/n 树/n 的/ude1 各/rz 结点/n 中/f 去/vf 。/wj 算法/n 11．4/m 是/vshi 置换/v 一/m 选择/v 排序/vi 的/ude1 简单/a 描述/vn ，/wd 其中/rz ，/wd 求得/v 一个/mq 初始/b 归并/vi 段/ng 的/ude1 过程/n 如/v 算法/n 11．5/m 所/usuo 述/vg 。/wj 算法/n 11．6/m 和/cc 算法/n 1i．7/x 分别/d 描述/v 了/ule 置换/vn 一/d 选择/v 排序/vi 中/f 的/ude1 败者/n 树/n 的/ude1 调整/vn 和/cc 初/f 建/v 的/ude1 过程/n 。/wj 
  Rcffrype/x  rec/x ；/wf     ∥/w 记录/v 
  KeyType/x  key/x ；/wf     ∥/w 从/p 记录/n 中/f 抽取/v 的/ude1 关键/n 字/n 
  i．t/x     rnum/x ；/wf     ∥/w 所属/n 归并/vi 段/ng 的/ude1 段号/n 
}/n RcdNode/x ，/wd WorkArea/x [/wkz w/x ]/wky ；/wf     ∥/w 内存/n 工作区/n ，/wd 容量/n 为/v W/x 
void/x  Replace―Selection/x (/wkz LoserTree/x ＆/n is/x ，/wd WorkArea/x ＆/n wa/x ，/wd FILE/x */n fi/x ，/wd FILE/x */n fo/x )/wky {/n 
  ∥/w 在/p 败者/n 树/n is/x 和/cc 内存/n 工作区/n wa/x 上/f 用/v 置换/v 一/m 选择/v 排序/vi 求/v 初始/t 归并/vi 段/ng ，/wd fi/x 为/p 输入/v 文件/n 
  ∥/w (/wkz 只/d 读文件/n )/wky 指针/n ，/wd fo/x 为/p 输出/vn 文件/n (/wkz 只/d 写/v 文件/n )/wky 指针/n ，/wd 两/m 个/q 文件/n 均/d 已/d 打开/v 
  Construct―Loser/x (/wkz is/x ，/wd wa/x )/wky ；/wf     ∥/w 初/f 建/v 败者/n 树/n 
  rc/x 。/wj rmax=I/x ；/wf     ∥/w rc/x 指示/n 当前/t 生成/v 的/ude1 初始/b 归并/vi 段/ng 的/ude1 段号/n ，/wd 
    ∥/w rmax/x 指示/n wa/x 中/b 关键字/n 所属/n 初始/t 归并/vi 段/ng 的/ude1 最/d 大/a 段号/n 
  while/x (/wkz rc/x </n 。/wj rma/x 】/wky 【/wkz )/wky {/n     ∥/w ”/wyy rc：rmax+1/x ”/wyy 标志/n 输入/vn 文件/n 的/ude1 置换/vn 一/d 选择/v 排序/vi 已/d 完成/v 
    get―zlln/x (/wkz is/x ，/wd wa/x )/wky ；/wf     ∥/w 求得/v 一个/mq 初始/b 归并/vi 段/ng 
    fwrlte/x (/wkz RUNEND―SYMBOL/x ，/wd sizeof/x (/wkz str．et/x  RcdType/x )/wky ，/wd 1/m ，/wd fo/x )/wky ；/wf   ∥/w 将/p 段/ng 结束/v 标志/n 写入/v 输出/vn 文件/n 
    rc=wa/x [/wkz is/x [/wkz 0/m ]/wky ]/wky ．/w rnum/x ；/wf     ∥/w 设置/v 下/vf 一/m 段/q 的/ude1 段号/n 
  I/x     ’/wyy 
、/wn }/n }/n Replace―Selection/x 
    算法/n II．4/x 
void/x  get―run/x (/wkz LoserTree/x &/n is/x ，/wd WorkArea/x &/n wa/x )/wky {/n 
  ∥/w 求得/v 一个/mq 初始/b 归并/vi 段/ng ，/wd fi/x 为/p 输入/v 文件/n 指针/n ，/wd f0/x 为/p 输出/vn 文件/n 指针/n 
  while/x (/wkz wa/x [/wkz is/x [/wkz 0/m ]/wky ]/wky ．/w mum==rc/x )/wky {/n     ∥/w 选/v 得/v 的/ude1 MINIMAX/x 记录/n 属/v 当前/t 段/ng 时/ng 
    q/x 。/wj 18/m [/wkz O/x ]/wky ；/wf     ∥/w q/x 指示/n MINIMAX/x 记录/n 在/p wa/x 中/f 的/ude1 位置/n 
    ・/w 301・/m 
  minimax/x 。/wj wa/x [/wkz g/x ]/wky ．/w key/x ；/wf 
  fwrite/x (/wkz ~/n wa/x [/wkz q/x ]/wky ．/w rec/x ，/wd slzeof/x (/wkz struct/x  EcdType/x )/wky ，/wd 1/m ，/wd fo/x )/wky ；/wf 
    ∥/w 将/d 刚/d 选/v 得/v 的/ude1 MINIMAX/x 记录/n 写入/v 输出/vn 文件/n 
  if/x (/wkz feof/x (/wkz f1/x )/wky )/wky {/n wa/x [/wkz q/x ]/wky ．/w rnt/x ~/n m=rmax+1/x ；/wf wa/x [/wkz q/x ]/wky ．/w key=MAXKEY/x }/n 
    ∥/w 输入/v 文件/n 结束/v ，/wd 虚设/v 记录/v (/wkz 属/v ”/wyy rm/x ~/n ux+1/x ”/wyy 段/ng )/wky 
  else/x {/n     ∥/w 输入/v 文件/n 非空/n 时/ng 
    fread/x (/wkz ~/n wa/x [/wkz q/x ]/wky ．/w rec/x ，/wd sizeof/x (/wkz struct/x  RcdType/x )/wky ，/wd 1/m ，/wd fi/x )/wky ；/wf   ∥/w 从/p 输入/v 文件/n 读入/v 下/vf 一/m 记录/n 
    wa/x [/wkz q/x ]/wky ．/w key=wa/x [/wkz q/x ]/wky ．/w rec．key/x     ∥/w 提取/v 关键字/n 
    if/x (/wkz wa/x [/wkz q/x ]/wky ．/w key/x </n minimax/x )/wky {/n     ∥/w 新/d 读入/v 的/ude1 记录/n 属下/n 一/m 段/q 
    rmax：rc+1/x ；/wf   wa/x [/wkz q/x ]/wky ．/w rnum=rmax/x ；/wf 
    }/n 
    else/x  wa/x [/wkz q/x ]/wky ．/w rnum=rc/x ；/wf     ∥/w 新/d 读入/v 的/ude1 记录/n 属/v 当前/t 段/ng 
    }/n 
    Select―MiniMax/x (/wkz is/x ，/wd wa/x ，/wd q/x )/wky ；/wf     ∥/w 选择/v 新/a 的/ude1 MINIMAX/x 记录/n 
＼ff/x  while/x 
、/wn ，/wd |/n get．run/x 
    算法/n 11．5/m 
void/x  Select―MiniMax/x (/wkz LoserTree/x ＆/n is/x ，/wd WorkArea/x  Wa/x ，/wd int/x  q/x )/wky {/n 
  ∥/w 从/p wa/x [/wkz q/x ]/wky 起到/v 败者/n 树/n 的/ude1 根/n 比较/d 选择/v MINIMAX/x 记录/n ，/wd 并/cc 由/p q/x 指示/n 它/rr 所/usuo 在/v 的/ude1 归并/vi 段/ng 
  for/x (/wkz t=/x (/wkz w/x ’/wyy q/x )/wky ／2/m ，/wd P=ls/x 【/wkz t/x ]/wky ；/wf t/x >/n O/x ；/wf t=t／2/x ，/wd P=ls/x 【/wkz t/x ]/wky ；/wf )/wky 
    if/x (/wkz wa/x [/wkz p/x ]/wky ．/w mum/x </n wa/x [/wkz q/x ]/wky ．/w rnum/x  ll/x  wa/x [/wkz p/x ]/wky ．/w mum==wa/x [/wkz q/x ]/wky ．/w mum/x &/n &/n wa/x [/wkz P/x ]/wky ．/w key/x </n wa/x [/wkz q/x ]/wky ．/w key/x )/wky 
    q/x 一-/m 1s/x [/wkz t/x ]/wky ；/wf     ∥/w q/x 指示/n 新/a 的/ude1 胜利者/n 
  is/x [/wkz O/x ]/wky =q/x ；/wf 
I/x ∥/w Select―MiniMax/x 
    算法/n 11．6/m 
void/x  Construct―Loser/x (/wkz LoserTree/x ＆/n is/x ，/wd WorkArea/x ＆/n wa/x )/wky {/n 
  ∥/w 输入/v W/x 个/q 记录/n 到/v 内存/n 工作区/n Wa/x ，/wd 建/v 得/ude3 败者/n 树/n ls/x ，/wd 选出/v 关键字/n 最/d 小/a 的/ude1 记录/n 并/cc 由/p S/x 指示/n 
  ∥/w 其/rz 在/p wa/x 中/f 的/ude1 位置/n 
  for/x (/wkz i=0/x ；/wf i/x </n W/x ；/wf ++i/x )/wky 
    wa/x [/wkz i/x ]/wky ．/w rnum=wa/x [/wkz i/x ]/wky ．/w key=is/x [/wkz i/x ]/wky =O/x ；/wf     ∥/w 工作区/n 初始化/v 
    fread/x (/wkz &/n wa/x 【/wkz i/x ]/wky ．/w rec/x ，/wd sizeof/x (/wkz struct/x  RcdType/x )/wky ，/wd 1/m ，/wd fi/x )/wky ；/wf     ∥/w 输入/v 一个/mq 记录/n 
    wa/x [/wkz i/x ]/wky ．/w key=wa/x [/wkz i/x ]/wky ．/w rec．key/x ；/wf     ∥/w 提取/v 关键字/n 
    we/x [/wkz i/x ]/wky ．/w rnuI/x Ⅱ/m =1/m ；/wf     ∥/w 其/rz 段号/n 为/v ”/wyy 1/m ”/wyy 
}/n ∥/w Construct―Loser/x 
    算法/n 11．7/m 
    利用/v 败者/n 树/n 对/p 前面/f 例子/n 进行/vx 置换/vn ．/w 选择/v 排序/vi 时/ng 的/ude1 局部/n 状况/n 如/v 图/n 11．6/m 所/usuo 示/vg ，/wd 其中/rz 图/n 11．6/m (/wkz a/x )/wky ～/ws (/wkz g/x )/wky 显示/v 了/ule 败者/n 树/n 建立/v 过程/n 中/f 的/ude1 状态/n 变化/vn 状况/n 。/wj 最后/f 得到/v 最/d 小/a 关键字/n 的/ude1 记录/n 为/v wa/x [/wkz O/x ]/wky ，/wd 之后/f ，/wd 输出/v wa/x [/wkz O/x ]/wky ．/w rec/x ，/wd 并/cc 从/p FI/x 中/f 输入/v 下/vf 一个/mq 记录/n 至/p wa/x [/wkz O/x ]/wky ，/wd 由于/c 它/rr 的/ude1 关键字/n 小于/v 刚刚/d 输出/v 的/ude1 记录/n 的/ude1 关键/n 字/n ，/wd 则/c 设/v 此/rzs 新/d 输入/v 的/ude1 记录/n 的/ude1 段号/n 为/p 2/m (/wkz 如/v 图/n 11．6/m (/wkz h/x )/wky 所/usuo 示/vg )/wky ，/wd 而/cc 由于/c 在/p 输出/v wa/x [/wkz 1/m ]/wky 之后/f 新/d 输入/v 的/ude1 关键/n 字/n 较/d wa/x [/wkz 1/m ]/wky ．/w key/x 大/a ，/wd 则/c 该/rz 新/a 输入/vn 的/ude1 记录/n 的/ude1 段号/n 仍/d 为/v 1/m (/wkz 如/v 图/n 11．6/m (/wkz i/x )/wky 所/usuo 示/vg )/wky 。/wj 图/n 11．6/m (/wkz j/x )/wky 所/usuo 示/vg 为/v 在/p 输出/v 6/m 个/q 记录/n 之后/f 选/v 得/v 的/ude1 MINIMAX/x 记录/n 为/v     图/n 11．6/m 置换/v ～/ws 选择/v 过程/n 中/f 的/ude1 败者/n 树/n 
(/wkz a/x )/wky ～/ws (/wkz g/x )/wky 建立/v 败者/n 树/n ，/wd 选/v 出/vf 最/d 小/a 关键字记录/n wa/x [/wkz 0/m ]/wky ；/wf   (/wkz h/x )/wky ～/ws (/wkz I/x )/wky 选/v 得/ude3 新/a 的/ude1 MINIMAX/x 记录/n 。/wj 。/wj wa/x [/wkz 1/m ]/wky 时/ng 的/ude1 败者/n 树/n 。/wj 图/n 11．6/m (/wkz k/x )/wky 表明/v 在/p 输出/v 该/rz 记录/n wa/x [/wkz 1/m ]/wky 之后/f ，/wd 由于/c 输入/v 的/ude1 下/vf 一个/mq 记录/n 的/ude1 关键/n 字/n 较/d 小/a ，/wd 其/rz 段号/n 亦/d 为/v 2/m ，/wd 致使/v 工作区/n 中/f 所/usuo 有/vyou 记录/n 的/ude1 段号/n 均/d 为/v 2/m 。/wj 由此/d 败者/n 树/n 选出/v 的/ude1 新/a 的/ude1 MINIMAX/x 记录/n 的/ude1 段号/n 大于/v 当前/t 生成/v 的/ude1 归并/vi 段/ng 的/ude1 序号/n ，/wd 这/rzv 说明/v 该段/r 已/d 结束/v 。/wj 而/cc 此/rzs 新/a 的/ude1 MINIMAX/x 记录/n 应/v 是/vshi 下/vf 一/m 归并/vi 段/ng 中/f 的/ude1 第一/m 个/q 记录/n 。/wj 
    从/p 上述/b 可见/c ，/wd 由/p 置换/v ．/w 选择/v 排序/vn 所得/n 初始/t 归并/vi 段/ng 的/ude1 长度/n 不等/vi 。/wj 且/c 可/v 证明/v ，/wd 当/p 输入/v 文件/n 中/f 记录/v 的/ude1 关键/n 字/n 为/p 随机数/n 时/ng ，/wd 所得/n 初始/t 归并/vi 段/ng 的/ude1 平均/a 长度/n 为/p 内存/n 工作区/n 大小/n 硼/n 的/ude1 两/m 倍/q 。/wj 这个/rz 证明/v 是/vshi E．F．Moore/x 在/p 1961年/t 从/p 置换/v ．/w 选择/v 排序/vn 和/cc 扫雪/v 机/ng 的/ude1 类比/vi 中/f 得出/v 的/ude1 。/wj 
    假设/v 一/m 台/q 扫雪/v 机/ng 在/p 环形/n 路上/s 等速/vi 行进/vi 扫雪/v ，/wd 又/d 下雪/vi 的/ude1 速度/n 也/d 是/vshi 均匀/a 的/ude1 (/wkz 即/v 每/rz 小时/n 落/v 到/v 地面/n 上/f 的/ude1 雪/n 量/n 相等/vi )/wky ，/wd 雪/n 均匀/a 地/ude2 落/v 在/p 扫雪/v 机/ng 的/ude1 前/f 、/wn 后/f 路面/n 上/f ，/wd 边/d 下雪/vi 边/d 扫雪/v 。/wj 显然/a ，/wd 在/p 某个/rz 时刻/n 之后/f ，/wd 整个/b 系统/n 达到/v 平衡/a 状态/n ，/wd 路面/n 上/f 的/ude1 积雪/n 总量/n 不/d 变/v 。/wj 且/c 在/p 任何/rz 时刻/n ，/wd 整个/b 路面/n 上/f 的/ude1 积雪/n 都/d 形成/v 一个/mq 均匀/a 的/ude1 斜面/n ，/wd 紧/d 靠/v 扫雪/v 机/ng 前端/f 的/ude1 积雪/n 最/d 厚/a ，/wd 其/rz 深度/n 为/p ^/n ，/wd 而/cc 在/p 扫雪/v 机/ng 刚/d 扫/v 过/uguo 的/ude1 路面/n 上/f 的/ude1 积雪/n 深度/n 为/p 零/m 。/wj 若/c 将/p 环形/n 路/n 伸展/v 开来/v ，/wd 路面/n 积雪/n 状态/n 如/v 图/n 11．7/m 所/usuo 示/vg 。/wj 假设/n 此刻/r 路面/n 积雪/n 的/ude1 总体/n 积/v 为/p 砌/v ，/wd 环形/n 路/n 一/m 圈/qv 的/ude1 长度/n 为/v z/x ，/wd 由于/c 扫雪/v 机/ng 在/p 任何/rz 时刻/n 扫/v 走/v 的/ude1 雪/n 的/ude1 深度/n 均/d 为/v ^/n ，/wd 则/c 扫雪/v 机/ng 在/p 环形/n 路上/s 走/v 一/m 圈/qv 扫/v 掉/v 的/ude1 积雪/n 体积/n 为/v 。/wj 
    将/d 置换/v ．/w 选择/v 排序/vi 与/p 此/rzs 类/q 比/v ，/wd 工作区/n 中/f 的/ude1 记录/n 好比/v 路面/n 的/ude1 积雪/n ，/wd 输出/v 的/ude1 MINIMAX/x 记录/n 好比/v 扫/v 走/v 的/ude1 雪/n ，/wd 新/d 输入/v 的/ude1 记录/n 好比/v 新/a 下/f 的/ude1 雪/n ，/wd 当/p 关键字/n 为/p 随机数/n 时/ng ，/wd 新/a 记录/n 的/ude1 关键/n 字/n 比/p MINIMAX/x 大/a 或/c 小/a 的/ude1 概率/n 相等/vi 。/wj 若/c 大/a ，/wd 则/c 属/v 当前/t 的/ude1 归并/vi 段/ng (/wkz 好比/v 落/v 在/p 扫雪/v 机/ng 前面/f 的/ude1 积雪/n ，/wd 在/p 这/rzv 一/m 圈/qv 中/f 将/d 被/pbei 扫/v 走/v )/wky ；/wf 若/c 小/a ，/wd 则/c 属/v 下/vf 一/m 归并/vi 段/ng (/wkz 好比/v 落/v 在/p 扫雪/v 机/ng 后面/f 的/ude1 积雪/n ，/wd 在/p 下/f 一/m 圈/qv 中/f 才/d 能/v 扫/v 走/v )/wky 。/wj 由此/d ，/wd 得到/v 一个/mq 初始/b 归并/vi 段/ng 好比/v 扫雪/v 机/ng 走/v 一/m 圈/qv 。/wj 假设/n 工作区/n 的/ude1 容量/n 为/v 叫/vi ，/wd 则/c 置换/v ．/w 选择/v 所得/n 初始/t 归并/vi 段长度/n 的/ude1 期望值/n 便/d 为/v 2/m 训/v 。/wj 
    容易/ad 看出/v ，/wd 若/c 不/d 计/vi 输入/v 、/wn 输出/v 的/ude1 时间/n ，/wd 则/c 对/p 一个/mq 记录/n 的/ude1 文件/n 而言/uls ，/wd 生成/v 所有/b 初始/b 归并/vi 段/ng 所/usuo 需/v 时间/n 为/p 0/m (/wkz logme/x ，/wd )/wky 。/wj 
图/n 11．7/m 环形/n 路上/s 扫雪/v 机系统/n 平衡/a 时/ng 的/ude1 状态/n 
11．5/m 最佳/z 归并/vi 树/n 
    这/rzv 一/m 节/q 要/v 讨论/v 的/ude1 问题/n 是/vshi ，/wd 由/p 置换/v 一/m 选择/vn 生成/vn 所得/n 的/ude1 初始/b 归并/vi 段/ng ，/wd 其/rz 各/rz 段长度/n 不/d 等/v 对/p 平衡/a 归并/vi 有/vyou 何/ry 影响/v ?/ww 
    假设/v 由/p 置换/v 一/m 选择/v 得到/v 9/m 个/q 初始/b 归并/vi 段/ng ，/wd 其/rz 长度/n (/wkz 即/v 记录/v 数/m )/wky 依次/d 为/v ：/wp 9/m ，/wd 30/m ，/wd 12/m ，/wd 18/m ，/wd 3/m ，/wd 17/m ，/wd 2/m ，/wd 6/m ，/wd 24/m 。/wj 现/tg 作/v 3/m 一路/mq 平衡/a 归并/vi ，/wd 其/rz 归并/vi 树/n (/wkz 表示/v 归并/vi 过程/n 的/ude1 图/n )/wky 如/v 图/n 11．8/m 所/usuo 示/vg ，/wd 图/n 中/f 每个/r 圆圈/n 表示/v 一个/mq 初始/b 归并/vi 段/ng ，/wd 圆圈/n 中/b 数字/n 表示/v 归并/vi 段/ng 的/ude1 长度/n 。/wj 假设/n 每个/r 记录/v 占/v 一个/mq 物理/n 块/q ，/wd 则/c 两/m 趟/qv 归并/vi 所/usuo 需/v 对外/vd 存/v 进行/vx 的/ude1 读/v ／/w 写/v 次数/n 为/v     (/wkz 9+30+12+18+3+17+2+6+24/m )/wky ×2×2=484/m 
  ・/w 304・/m 
    图/n 11．8/m  3/m 一路/mq 平衡/a 归并/vi 的/ude1 归并/vi 树/n 
若/c 将/p 初始/t 归并/vi 段/ng 的/ude1 长度/n 看成/v 是/vshi 归并/vi 树/v 中/b 叶子/n 结点/n 的/ude1 权/n ，/wd 则/c 此/rzs 三叉/b 树/n 的/ude1 带权/n 路径长度/n 的/ude1 两/m 倍/q 恰/d 为/v 484/m 。/wj 显然/a ，/wd 归并/vi 方案/n 不同/a ，/wd 所得/n 归并/vi 树/n 亦/d 不/d 同/v ，/wd 树/v 的/ude1 带权/n 路径长度/n (/wkz 或/c 外存/n 读/v ／/w 写/v 次数/n )/wky 亦/d 不同/a 。/wj 回顾/v 在/p 第6/m 章/q 中/f 曾/d 讨论/v 了/ule 有/vyou 礼/n 个/q 叶子/n 结点/n 的/ude1 带权/n 路径长度/n 最/d 短/a 的/ude1 二/m 叉树/n 称/v 赫夫曼/nrf 树/n ，/wd 同/p 理/n ，/wd 存在/v 有/vyou n/x 个/q 叶子/n 结点/n 的/ude1 带权/n 路径长度/n 最/d 短/a 的/ude1 三叉/b 、/wn 四/m 叉/n 、/wn …/ws 、/wn n/x 叉树/n 亦/d 称/v 为/p 赫夫曼/nrf 树/n 。/wj 因此/c ，/wd 若/c 对/p 长度/n 不等/vi 的/ude1 m/x 个/q 初始/b 归并/vi 段/ng ，/wd 构造/v 一/m 棵/q 赫/q 夫曼/n 树/n 作为/v 归并/vi 树/n ，/wd 便/d 可/v 使/v 在/p 进行/vx 外部/f 归并/vi 时/ng 所/usuo 需/v 对外/vd 存/v 进行/vx 的/ude1 读/v ／/w 写/v 次数/n 达/v 最/d 少/a 。/wj 例如/v ，/wd 对/p 上述/b 9/m 个/q 初始/b 归并/vi 段/ng 可/v 构造/n 一/m 棵/q 如/v 图/n 11．9/m 所/usuo 示/vg 的/ude1 归并/vi 树/n ，/wd 按/p 此/rzs 树/n 进行/vx 归并/vi ，/wd 仅/d 需/v 对外/vd 存/v 进行/vx 446/m 次/qv 读/v ／/w 写/v ，/wd 这/rzv 棵/q 归并/vi 树/n 便/d 称作/v 最佳/z 归并/vi 树/n 。/wj 
    图/n 11．9/m   3/m 一路/mq 平衡/a 归并/vi 的/ude1 最佳/z 归并/vi 树/n     图/n 11．10/m  8/m 个/q 归并/vi 段/ng 的/ude1 最佳/z 归并/vi 树/n     图/n 11．9/m 的/ude1 赫夫曼/nrf 树/n 是/vshi 一/m 棵/q 真正/b 的/ude1 三叉/b 树/n ，/wd 即/v 树/n 中/f 只/d 有/vyou 度/ng 为/v 3/m 或/c 0/m 的/ude1 结点/n 。/wj 假若/c 只/d 有/vyou 8/m 个/q 初始/b 归并/vi 段/ng ，/wd 例如/v ，/wd 在/p 前面/f 例子/n 中/f 少/v 了/ule 一个/mq 长度/n 为/p 30/m 的/ude1 归并/vi 段/ng 。/wj 如果/c 在/p 设计/v 归并/vi 方案/n 时/ng ，/wd 缺额/n 的/ude1 归并/vi 段/ng 留/v 在/p 最后/f ，/wd 即/d 除了/p 最后/f 一/m 次/qv 作/v 2/m 一路/mq 归并/vi 外/f ，/wd 其它/rz 各/rz 次/qv 归并/vi 仍/d 都/d 是/vshi 3．/m 路/qv 归并/vi ，/wd 容易/ad 看/v 出/vf 此/rzs 归并/vi 方案/n 的/ude1 外存/n 读/v ／/w 写/v 次数/n 为/p 386/m 。/wj 显然/a ，/wd 这/rzv 不/d 是/vshi 最佳/z 方案/n 。/wj 正确/a 的/ude1 做法/n 是/vshi ，/wd 当/p 初始/t 归并/vi 段/ng 的/ude1 数目/n 不/d 足/a 时/ng ，/wd 需/v 附加/vn 长度/n 为/p 零/m 的/ude1 “/wyz 虚/a 段/ng ”/wyy ，/wd 按照/p 赫夫曼/nrf 树/v 构成/v 的/ude1 原则/n ./wj 权/n 为/p 零/m 的/ude1 叶子/n 应/v 离/v 树根/n 最/d 远/a ，/wd 因此/c ，/wd 这个/rz 只/d 有/vyou 8/m 个/q 初始/b 归并/vi 段/ng 的/ude1 归并/vi 树/v 应/v 如/v 图/n 11．10/m 所/usuo 示/vg 。/wj 
　　那末/c ，/wd 如何/ryv 判定/v 附加/v 虚/ag 段/ng 的/ude1 数目/n ?/ww 当/p 三叉/b 树/n 中/f 只/d 有/vyou 度/ng 为/v 3/m 和/cc 0/m 的/ude1 结点/n 时/ng ，/wd 必/d 有/vyou 礼/n ，/wd =/m (/wkz ，/wd z0―1/x )/wky ／2/m ，/wd 其中/rz ，/wd ”/wyy 3/m 是/vshi 度/qv 为/v 3/m 的/ude1 结/v 点数/n ，/wd no/x 是/vshi 度/qv 为/v 零/m 的/ude1 结/v 点数/n 。/wj 由于/c 扎/v 。/wj 必/d 为/v 整数/n ，/wd 则/d (/wkz n0―1/x )/wky MOD/x  2=0/m 。/wj 这就是说/c ，/wd 对/p 3．/m 路/qv 归并/vi 而言/uls ，/wd 只有/c 当/p 初始/t 归并/vi 段/ng 的/ude1 个/q 数/n 为/p 偶数/n 时/ng ，/wd 才/d 需/v 加/v 1/m 个/q 虚/a 段/q 。/wj 
　　 在/p 一般/a 情况/n 下/f ，/wd 对/p k/x 一路/d 归并/vi 而言/uls ，/wd 容易/ad 推算/v 得到/v ，/wd 若/c (/wkz m-1/x )/wky MC/x )/wky D/x (/wkz 忌/v -/wp 1/m )/wky =0/m ，/wd 则/c 不/d 需要/v 加/v 虚/ag 段/ng ，/wd 否则/c 需/v 附加/v 是/vshi 一/m (/wkz m-1/x )/wky MOD/x (/wkz 五-/m 1/m )/wky -/wp 1/m 个/q 虚/a 段/q 。/wj 换句话说/c ，/wd 第一/m 次/qv 归并/vi 为/v (/wkz 优/ag 1/m )/wky +1/m 路/qv 归并/vi 。/wj     ．/w 
    若/c 按/p 最佳/z 归并/vi 树/n 的/ude1 归并/vi 方案/n 进行/vx 磁盘/n 归并/vi 排序/vi ，/wd 需/v 在/p 内存/n 建立/v 一/m 张/q 载有/v 归并/vi 段/ng 的/ude1 长度/n 和/cc 它/rr 在/p 磁盘/n 上/f 的/ude1 物理/n 位置/n 的/ude1 索引/n 表/n 。/wj 
・/w 305・/m 

第12/m 章/q 文件/n 
    和/cc 表/n 类似/a ，/wd 文件/n 是/vshi 大量/m 记录/n 的/ude1 集合/n 。/wj 习惯/n 上/f 称/v 存储在主存储器/n (/wkz 内存储器/n )/wky 中/f 的/ude1 记录集合/n 为/p 表/n ，/wd 称/v 存储/v 在/p 二级/b 存储器/n (/wkz 外/f 存储器/n )/wky 中/f 的/ude1 记录集合/n 为/p 文件/n 。/wj 本章/nr2 讨论/v 文件/n 在/p 外/f 存储器/n 中/f 的/ude1 表示方法/n 及/cc 其/rz 各种/rz 运算/vn 的/ude1 实现/vn 方法/n 。/wj 
12．1/m 有关/vn 文件/n 的/ude1 基本/a 概念/n 
  ・/w 文件/n 及/cc 其/rz 类别/n 
  文件/n (/wkz file/x )/wky 是/vshi 由/p 大量/m 性质/n 相同/a 的/ude1 记录/n 组成/v 的/ude1 集合/n 。/wj 可/v 按/p 其/rz 记录/n 的/ude1 类型不同/n 而/cc 分成/vi 两/m 类/q ：/wp 操作系统/nl 的/ude1 文件/n 和/cc 数据库/n 文件/n 。/wj 
　　操作系统/nl 中/f 的/ude1 文件/n 仅/d 是/vshi 一/m 维/q 的/ude1 连续/a 的/ude1 字符/n 序列/n ，/wd 无/v 结构/n 、/wn 无/v 解释/vn 。/wj 它/rr 也/d 是/vshi 记录/v 的/ude1 集合/n ，/wd 这个/rz 记录/n 仅/d 是/vshi 一个/mq 字符/n 组/n ，/wd 用户/n 为了/p 存取/vn 、/wn 加工/v 方便/an ，/wd 把/pba 文件/n 中/f 的/ude1 信息/n 划分/v 成/v 若干/m 组/q ，/wd 每/rz 一/m 组/q 信息/n 称为/v 一个/mq 逻辑记录/n ，/wd 且/c 可/v 按/p 顺序/n 编号/vi 。/wj 
　　数据库/n 中/f 的/ude1 文件/n 是/vshi 带有/v 结构/n 的/ude1 记录/n 的/ude1 集合/n ；/wf 这/rzv 类/q 记录/n 是/vshi 由/p 一个/mq 或/c 多/m 个/q 数据项/n 组成/v 的/ude1 集合/n ，/wd 它/rr 也/d 是/vshi 文件/n 中/f 可/v 存取/v 的/ude1 数据/n 的/ude1 基本单位/n 。/wj 数据/n 项/q 是/vshi 最/d 基本/a 的/ude1 不可/v 分/qt 的/ude1 数据/n 单位/n ，/wd 也/d 是/vshi 文件/n 中/f 可/v 使用/v 的/ude1 数据/n 的/ude1 最/d 小/a 单位/n 。/wj 例如/v ，/wd 图/n 12．1/m 所/usuo 示/vg 为/v 一个/mq 数据库/n 文件/n ，/wd 每个/r 学生/n 的/ude1 情况/n 是/vshi 一个/mq 记录/n ，/wd 它/rr 由/p 10/m 个/q 数据项/n 组成/v 。/wj 
    文件/n 还/d 可/v 按/p 记录/n 的/ude1 另/rz 一/m 特性/n 分成/vi 定/v 长/a 记录文件/n 和/cc 不/d 定/v 长/a 记录文件/n 。/wj 若/c 文件/n 中/f 每个/r 记/v 
录/v 含有/v 的/ude1 信息/n 长度/n 相同/a ，/wd 则/c 称/v 这/rzv 类/q 记录/n 为/p 定/v 长/a 记录/n ，/wd 由/p 这/rzv 类/q 记录/n 组成/v 的/ude1 文件/n 称/v 做/v 定/v 长/a 记录/n 
文件/n ；/wf 若/c 文件/n 中/f 含有/v 信息/n 长度/n 不等/vi 的/ude1 不/d 定/v 长/a 记录/n ，/wd 则/c 称/v 不/d 定/v 长/a 记录文件/n 。/wj 
    数据库/n 文件/n 还/d 可/v 按/p 记录/v 中/b 关键/n 字/n 的/ude1 多少/ry 分成/vi 单/b 关键字/n 文件/n 和/cc 多/a 关键字/n 文件/n 。/wj 若/c 文件/n 中/f 的/ude1 记录/n 只/d 有/vyou 一个/mq 唯一/b 标识记录/n 的/ude1 主/ag 关键字/n ，/wd 则/c 称/v 单/b 关键字/n 文件/n ；/wf 若/c 文件/n 中/f 的/ude1 记录/n 除了/p 含有/v 一个/mq 主/n 关键字/n 外/f ，/wd 还/d 含有/v 若干/m 个/q 次关键字/n ，/wd 则/c 称为/v 多/a 关键字/n 文件/n ，/wd 记录/v 中/b 所有/b 非/b 关键字/n 的/ude1 数据项/n 称为/v 记录/v 的/ude1 属性/n 。/wj 
    ・/w 记录/v 的/ude1 逻辑/n 结构/n 和/cc 物理/n 结构/n 
    记录/v 的/ude1 逻辑/n 结构/n 是/vshi 指/v 记录/v 在/p 用户/n 或/c 应用/v 程序员/n 面前/f 呈现/v 的/ude1 方式/n ，/wd 是/vshi 用户/n 对/p 数据/n 的/ude1 表示/vn 和/cc 存取方式/n 。/wj 
    记录/v 的/ude1 物理/n 结构/n 是/vshi 数据/n 在/p 物理/n 存储器/n 上/f 存储/v 的/ude1 方式/n ，/wd 是/vshi 数据/n 的/ude1 物理/n 表示/v 和/cc 组织/n 。/wj 
    通常/d ，/wd 记录/v 的/ude1 逻辑/n 结构/n 着眼/vi 在/p 用户/n 使用/v 方便/an ，/wd 而/cc 记录/n 的/ude1 物理/n 结构/n 则/d 应/v 考虑/v 提高/v 存储空间/n 的/ude1 利用率/n 和/cc 减少/v 存取记录/n 的/ude1 时间/n ，/wd 它/rr 根据/p 不同/a 的/ude1 需要/n 及/cc 设备/n 本身/rz 的/ude1 特性/n 可以/v 有/vyou 多种/m 方式/n 。/wj 从/p 11．1/m 节/q 的/ude1 讨论/vn 中/f 已/d 得知/v ：/wp 一个/mq 物理/n 记录/v 指/v 的/ude1 是/vshi 计算机/n 用/p 一/m 条/q I／0/x 命令/n 进行/vx 读/v 写/v 的/ude1 基本/a 数据/n 单位/n ，/wd 对于/p 固定/a 的/ude1 设备/n 和/cc 操作系统/nl ，/wd 它/rr 的/ude1 大小/n 基本上/d 是/vshi 固定/a 不/d 变/v 的/ude1 ，/wd 而/cc 逻辑记录/n 的/ude1 大小/n 是/vshi 由/p 使用/v 要求/v 定/v 的/ude1 。/wj 在/p 物理/n 记录/n 和/cc 逻辑记录/n 之间/f 可能/v 存在/v 下列/b 三/m 种/q 关系/n ：/wp 
    (/wkz 1/m )/wky 一个/mq 物理/n 记录/v 存放/v 一个/mq 逻辑记录/n 。/wj 
    (/wkz 2/m )/wky 一个/mq 物理/n 记录/v 包含/v 多/m 个/q 逻辑记录/n 。/wj 
    (/wkz 3/m )/wky 多/m 个/q 物理/n 记录表示/n 一个/mq 逻辑记录/n 。/wj 
    总之/c ，/wd 用户/n 读/v ／/w 写/v 一个/mq 记录/n 是/vshi 指/v 逻辑记录/n ，/wd 查找对应/n 的/ude1 物理/n 记录/v 则/d 是/vshi 操作系统/nl 的/ude1 职责/n ．/w 图/n 12．2/m 简单/ad 表示/v 了/ule 这种/r 关系/n 。/wj 图/n 中/f 的/ude1 逻辑记录/n 和/cc 物理/n 记录/v 满足/v 上述/b 第一/m 种/q 关系/n ，/wd 物理/n 记录/n 之间/f 用/p 指针/n 相/d 链接/n 。/wj 
用户/n 
记录/v 的/ude1 逻辑/n 结构/n 
记录/v 的/ude1 物理/n 结构/n 
间隔/n 
    图/n 12．2/m 记录/n 的/ude1 逻辑/n 结构/n 与/cc 物理/n 结构/n 差别/n 示例/n 
    ・/w 文件/n 的/ude1 操作/vn (/wkz 运算/vn )/wky 
    文件/n 的/ude1 操作/vn 有/vyou 两/m 类/q ：/wp 检索/v 和/cc 修改/vn 。/wj 
    文件/n 的/ude1 检索/vn 有/vyou 下列/b 三/m 种/q 方式/n ：/wp 
    (/wkz 1/m )/wky 顺序/n 存取/v ：/wp 存取/v 下/vf 一个/mq 逻辑记录/n 。/wj 
    (/wkz 2/m )/wky 直接/ad 存取/v ：/wp 存取/v 第/m i/x 个/q 逻辑记录/n 。/wj 
    以上/f 两/m 种/q 存取方式/n 都/d 是/vshi 根据/p 记录/v 序号/n (/wkz 即/v 记录/v 存入/v 文件/n 时/ng 的/ude1 顺序/n 编号/n )/wky 或/c 记录/v 的/ude1 相对/b 位置/n 进行/vx 存取/vn 的/ude1 。/wj 
    (/wkz 3/m )/wky 按/p 关键字/n 存取/v ：/wp 给定/v 一个/mq 值/n ，/wd 查询/v 一个/mq 或/c 一/m 批/q 关键字/n 与/cc 给/p 定/v 值/n 相关/vi 的/ude1 记录/n 。/wj 对/p 数据库/n 文件/n 可以/v 有/vyou 如下/vi 四/m 种/q 查询方式/n ：/wp 
    (/wkz a/x )/wky 简单/ad 询问/v ：/wp 查询关键字/n 等于/v 给/p 定/v 值/n 的/ude1 记录/n 。/wj 例如/v ，/wd 在/p 图/n 12．1/m 的/ude1 文件/n 中/f ，/wd 给定/v 一个/mq 准考证/n 号码/n 或/c 学生/n 姓名/n ，/wd 查询/v 相关/vn 记录/n 。/wj 
    (/wkz b/x )/wky 区域/n 询问/v ：/wp 查询关键字/n 属/v 某个/rz 区域/n 内/f 的/ude1 记录/n 。/wj 例如/v ，/wd 在/p 图/n 12．1/m 的/ude1 文件/n 中/f 查询/v 某某/r 中学/n 的/ude1 学生/n 成绩/n ，/wd 则/c 给定/v 准考证/n 号/q 的/ude1 某个/rz 数值/n 范围/n 。/wj 
    (/wkz c/x )/wky 函数/n 询问/v ：/wp 给定/v 关键字/n 的/ude1 某个/rz 函数/n 。/wj 例如/v 查询/v 总分/n 在/p 全体/n 学生/n 的/ude1 平均/a 分/qt 以上/f 的/ude1 记录/n 或/c 处于/v 中/f 值/v 的/ude1 记录/n 。/wj 
    (/wkz d/x )/wky 布尔/n 询问/v ：/wp 以上/f 三/m 种/q 询问/v 用/p 布尔/n 运算/vn 组合/n 起来/vf 的/ude1 询问/vn 。/wj 例如/v ，/wd 查询/v 总分/n 在/p 600/m 分/qt 以上/f 且/c 数学/n 在/p 100/m 分/qt 以上/f ，/wd 或者/c 总分/n 在/p 平均/a 分/qt 以下/f 的/ude1 外语/n 在/p 98分/t 以上/f 的/ude1 全部/m 记录/n 。/wj 
    文件/n 的/ude1 修改/vn 包括/v 插入/v 一个/mq 记录/n 、/wn 删除/v 一个/mq 记录/n 和/cc 更新/v 一个/mq 记录/v 三/m 种/q 操作/vn 。/wj 
    文件/n 的/ude1 操作/vn 可以/v 有/vyou 实时/n 和/cc 批量/m 两/m 种/q 不同/a 方式/n 。/wj 通常/d 实时/ad 处理/v 对/p 应答/vi 时间/n 要求/v 严格/a ，/wd 应/v 在/p 接收询问/n 之后/f 几/m 秒/qt 钟/n 内/f 完成/v 检索/vn 和/cc 修改/vn ，/wd 而/cc 批量/d 处理/v 则/c 不然/v 。/wj 不同/a 的/ude1 文件/n 系统/n 其/rz 使用/v 有/vyou 不同/a 的/ude1 要求/n 。/wj 例如/v ，/wd 一个/mq 民航/n 自动/b 服务系统/n ，/wd 其/rz 检索/vn 和/cc 修改/v 都/d 应/v 实时/ad 处理/v ；/wf 而/cc 银行/n 的/ude1 账户/n 系统/ad 需/v 实时/n 检索/vn ，/wd 但/c 可/v 进行/vx 批量/d 修改/v ，/wd 即/d 可以/v 将/p 一/m 天/qt 的/ude1 存款/n 和/cc 提款/vn 记录/n 在/p 一个/mq 事务/n 文件/n 上/f ，/wd 在/p 一/m 天/qt 的/ude1 营业/vn 之后/f 再/d 进行/vx 批量/d 处理/v 。/wj 
    ・/w 文件/n 的/ude1 物理/n 结构/n 
    文件/n 在/p 存储介质/n (/wkz 磁盘/n 或/c 磁带/n )/wky 上/f 的/ude1 组织/n 方式/n 称为/v 文件/n 的/ude1 物理/n 结构/n 。/wj 文件/n 可以/v 有/vyou 各种各样/bl 的/ude1 组织/n 方式/n ，/wd 其/rz 基本/a 方式/n 有/vyou 三/m 种/q ：/wp 顺序/n 组织/n 、/wn 随机/b 组织/n 和/cc 链/ng 组织/v 。/wj 一个/mq 特定/b 的/ude1 文件/n 应/v 采用/v 何种/r 物理/n 结构/n 应/v 综合/vd 考虑/v 各种/rz 因素/n ，/wd 如/v ：/wp 存储介质/n 的/ude1 类型/n 、/wn 记录/n 的/ude1 类型/n 、/wn 大/a 小/a 和/cc 关键/n 字/n 的/ude1 数目/n 以及/cc 对/p 文件/n 作/v 何/ry 种/q 操作/vn 等等/udeng 。/wj 本章/nr2 将/d 介绍/v 几/m 种/q 常用/a 的/ude1 文件/n 的/ude1 物理/n 结构/n 。/wj 
12．2/m 顺序/n 文件/n 
    顺序/n 文件/n (/wkz sequential/x  File/x  J/x 是/vshi 记录/v 按/p 其/rz 在/p 文件/n 中/f 的/ude1 逻辑/n 顺序/n 依次/d 进入/v 存储介质/n 而/cc 建立/v 的/ude1 ，/wd 即/v 顺序/n 文件/n 中/b 物理/n 记录/v 的/ude1 顺序/n 和/cc 逻辑记录/n 的/ude1 顺序/n 是/vshi 一致/a 的/ude1 。/wj 若/c 次序/n 相继/d 的/ude1 两/m 个/q 物理/n 记录/v 在/p 存储介质/n 上/f 的/ude1 存储位置/n 是/vshi 相邻/vi 的/ude1 ，/wd 则/c 又/d 称/v 连续/a 文件/n ；/wf 若/c 物理/n 记录/n 之间/f 的/ude1 次序/n 由/p 指针/n 相/d 链/ng 表示/v ，/wd 则/c 称/v 串联/v 文件/n 。/wj 
    顺序/n 文件/n 是/vshi 根据/p 记录/n 的/ude1 序号/n 或/c 记录/v 的/ude1 相对/b 位置/n 来/f 进行/vx 存取/vn 的/ude1 文件/n 组织/v 方式/n 。/wj 它/rr 的/ude1 特点/n 是/vshi ：/wp 
    (/wkz 1/m )/wky 存取/v 第/m i/x 个/q 记录/n ，/wd 必须/d 先/d 搜索/v 在/p 它/rr 之前/f 的/ude1 i/x ～/ws 1/m 个/q 记录/n 。/wj 
    (/wkz 2/m )/wky 插入/v 新/a 的/ude1 记录/n 时/ng 只/d 能/v 加/v 在/p 文件/n 的/ude1 末尾/n 。/wj 
    (/wkz 3/m )/wky 若/c 要/v 更新/v 文件/n 中/f 的/ude1 某个/rz 记录/n ，/wd 则/c 必须/d 将/p 整个/b 文件/n 进行/vx 复制/vn 。/wj 
    由于/p 顺序/n 文件/n 的/ude1 优点/n 是/vshi 连续/ad 存取/v 的/ude1 速度/n 快/a ，/wd 因此/c 主要/d 用于/v 只/d 进行/vx 顺序/n 存取/vn 、/wn 批量/d 修改/v 的/ude1 情况/n 。/wj 若/c 对/p 应答/vi 时间/n 要求/v 不严/a 时/ng 亦/d 可/v 进行/vx 直接/a 存取/vn 。/wj 
    磁带/n 是/vshi 一/m 种/q 典型/a 的/ude1 顺序/n 存取设备/n ，/wd 因此/c 存储/v 在/p 磁带/n 上/f 的/ude1 文件/n 只能/v 是/vshi 顺序/n 文件/n 。/wj 磁带/n 文件/n 适合/v 于/p 文件/n 的/ude1 数据/n 量/n 甚/dg 大/a 、/wn 平时/t 记录/v 变化/vn 少/a 、/wn 只/d 作/v 批量/d 修改/v 的/ude1 情况/n 。/wj 在/p 对/p 磁带/n 文件/n 作/v 修改/v 时/ng ，/wd 一般/ad 需/v 用/p 另/rz 一/m 条/q 复制/v 带/v 将/d 原/d 带/v 上/f 不/d 变/v 的/ude1 记录/n 复制/v 一/m 遍/qv ，/wd 同时/c 在/p 复制/v 的/ude1 过程/n 中/f 插入/v 新/a 的/ude1 记录/n 和/cc 用/p 更改/v 后/f 的/ude1 新/a 记录/n 代替原/n 记录/n 写入/v 。/wj 为了/p 修改/v 方便/v 起见/u ，/wd 要求/v 待/vi 复制/v 的/ude1 顺序/n 文件/n 按/p 关键字/n 有序/a (/wkz 若非/c 数据库/n 文件/n ，/wd 则/c 可/v 将/p 逻辑记录/n 号/q 作为/v 关键字/n )/wky 。/wj 
    磁带/n 文件/n 的/ude1 批/q 处理过程/n 可/v 如/v 下/f 进行/vx ：/wp 
图/n 12．3/m 磁带/n 文件/n 批处理/v 示意图/n 
    待/vi 修改/v 的/ude1 原始/a 文件/n 称/v 做主/vi 文件/n ，/wd 存放/v 在/p 一/m 条/q 磁带/n 上/f ，/wd 所有/b 的/ude1 修改/vn 请求/n 集中/ad 构成/v 一个/mq 文件/n ，/wd 称/v 做/v 事务/n 文件/n ，/wd 存放/v 在/p 另/rz 一/m 台/q 磁带/n 上/f ，/wd 尚/d 需/v 第三/m 台/q 磁带/n 作为/v 新/a 的/ude1 主/ag 文件/n 的/ude1 存储介质/n 。/wj 主/ag 文件/n 按/p 关键字/n 自小/d 至/p 大/a (/wkz 或/c 自大/a 至/p 小/a )/wky 顺序/n 有序/a ，/wd 事务/n 文件/n 必须/d 和/cc 主/ag 文件/n 有/vyou 相同/a 的/ude1 有序/a 关系/n 。/wj 因此/c ，/wd 首先/c 对/p 事务/n 文件/n 进行/vx 排序/vn ，/wd 然后/c 将/d 主/ag 文件/n 和/cc 事务/n 文件/n 归并/vi 成/v 一个/mq 新/a 的/ude1 主/ag 文件/n 。/wj 图/n 12．3/m 为/p 这个/rz 过程/n 的/ude1 示意图/n 。/wj 在/p 归并/vi 的/ude1 过程/n 中/f ，/wd 顺序/n 读出/v 主文/n 件/q 与/p 事务/n 文件/n 中/f 的/ude1 记录/n ，/wd 比较/d 它们/rr 的/ude1 关键/n 字/n 并/cc 分别/d 进行/vx 处理/vn 。/wj 对于/p 关键字/n 不/d 匹配/vi 的/ude1 主/ag 文件/n 中/f 的/ude1 记录/n ，/wd 则/c 直接/ad 将/p 其/rz 写/v 入/v 新/a 主/ag 文件/n 中/f 。/wj “/wyz 更改/v ”/wyy 和/cc “/wyz 删/v 去/vf ”/wyy 记录/v 时/ng ，/wd 要求/v 其/rz 关键字/n 相/d 匹配/vi 。/wj “/wyz 删/v 去/vf ”/wyy 不/d 用/v 写入/v ，/wd 而/cc “/wyz 更改/v ”/wyy 则/d 要/v 将/d 更改/v 后/f 的/ude1 新/a 记录/n 写入/v 新/a 主/ag 文件/n 。/wj “/wyz 插入/v ”/wyy 时/ng 不/d 要求/v 关键字/n 相/d 匹配/vi ，/wd 可/v 直接/ad 将/p 事务/n 文件/n 上/f 要/v 插入/v 的/ude1 记录写/n 到/v 新/a 主/ag 文件/n 的/ude1 适当/a 位置/n 。/wj 
    例如/v 有/vyou 一个/mq 银行/n 的/ude1 帐/ng 目/ng 文件/n ：/wp 其/rz 主/n 文件/n 保存/v 着/uzhe 各/rz 储户/n 的/ude1 存款/n 余额/n ；/wf 每个/r 储户/n 作为/v 一个/mq 记录/n ，/wd 储户/n 帐/ng 号/n 为/p 关键/n 字/n ；/wf 记录/v 按/p 关键字/n 从/p 小/a 到/v 大/a 顺序/n 排列/v 。/wj 一/m 天/qt 的/ude1 存入/vn 和/cc 支出/n 集中/ad 在/p 一个/mq 事务/n 文件/n 中/f ，/wd 事务/n 文件/n 也/d 按/p 帐/ng 号/n 排序/vi ，/wd 成/v 批/q 地/ude2 更改/v 主文/n 件/q 并/cc 得到/v 一个/mq 新/a 的/ude1 主/ag 文件/n ，/wd 其/rz 过程/n 如/v 图/n 12．4/m 所/usuo 示/vg 。/wj 
事务/n 文件/n 
批/q 处理/v 的/ude1 示意/v 算法/n 如/v 算法/n 12．1/m 所/usuo 示/vg 。/wj 算法/n 中/f 用/v 到/v 的/ude1 各/rz 符号/n 的/ude1 含义/n 说明/v 如下/vi ：/wp 
    f――/x 主/n 文件/n ；/wf g/x 一/m 事务/n 文件/n ；/wf h――/x 新/a 主/ag 文件/n 。/wj 上述/b 三/m 者/k 都/d 按/p 关键字/n 递增/vi 排列/v 。/wj 事务/n 文件/n 的/ude1 每个/r 记录/n 中/f ，/wd 还/d 增设/v 一个/mq 代码/n 以/p 示/vg 修改/v 要求/n ，/wd 其中/rz ：/wp “/wyz I/x ”/wyy 表示/v 插入/v ；/wf “/wyz D/x ”/wyy 表示/v 删/v 去/vf ；/wf “/wyz U/x ”/wyy 表示/v 更改/v 。/wj void/x  Merge．File/x (/wkz F/x ~/n le/x */n f/x ，/wd File/x 。/wj g/x ，/wd File/x */n h/x )/wky {/n   ∥/w 由/p 按/p 关键字/n 递增/vi 有序/a 的/ude1 非空/n 顺序/n 文件/n f/x 和/cc g/x 归并/vi 得到/v 新/a 文件/n h/x ，/wd 三/m 个/q 文件/n 均/d 已/d 打开/v ，/wd 
  ∥/w 其中/rz ，/wd f/x 和/cc g/x 为/v 只/d 读文件/n ，/wd h/x 为/v 只/d 写/v 文件/n 
  fread/x (/wkz ＆/n fr/x ，/wd sizeof/x (/wkz struet/x  RcdType/x )/wky ，/wd l/x ，/wd f/x )/wky ；/wf 
  fr∞d/x (/wkz &/n gr/x ，/wd slzeof/x (/wkz struct/x  RcdType/x )/wky ，/wd l/x ，/wd g/x )/wky ；/wf 
  do/x  I/x 
  slq/x ~/n tcla/x {/n 
    ca8e/x  fr．key/x </n gr．key：/x     ∥/w 复制/v “/wyz 旧/a ”/wyy 主/ag 文件/n 中/f 记录/v 
    ~/n write/x (/wkz ＆/n fr/x ，/wd slzeof/x (/wkz struct/x  ac/x ~/n rype/x )/wky ，/wd 1/m ，/wd h/x )/wky ；/wf 
    if/x (/wkz !/wt eeoc/x (/wkz f/x )/wky )/wky fre/x |/n Id/x (/wkz ＆/n fr/x ，/wd sizeof/x (/wkz struct/x  l/x ~/n cdType/x )/wky ，/wd 1/m ，/wd f/x )/wky ；/wf break/x ；/wf 
    ca8e/x  gr．code==/x ’/wyy D/x ’/wyy &/n &/n fr．key==gr．key：/x     ∥/w 删除/v “/wyz 旧/a ”/wyy 主/ag 文件/n 中/f 记录/v ，/wd 即/d 不/d 复制/v 
    if/x (/wkz !/wt feof/x (/wkz f/x )/wky )/wky ￡read/x (/wkz &/n fr/x ，/wd sizq/x ~/n ff/x (/wkz struct/x  Rcd/x ~/n zoe/x )/wky ，/wd 1/m ，/wd f/x )/wky ；/wf 
    if/x (/wkz !/wt feof/x (/wkz g/x )/wky )/wky fread/x (/wkz &/n gr/x ，/wd siz/x ~/n ~/n (/wkz st/x ~/n ct/x  ttcd/x ~/n pe/x )/wky ，/wd 1/m ，/wd g/x )/wky ；/wf   break/x ；/wf 
    ca8e/x  gr．code==/x ’/wyy I/x ’/wyy ＆/n &/n fr．key/x >/n gr．key：/x     ∥/w 插入/v ，/wd 函数/n P/x 把/v gr/x 加工/v 为/v h/x 的/ude1 结构/n 
    ~/n ~/n rcite/x (/wkz &/n P/x (/wkz gr/x )/wky ，/wd slz/x ~/n (/wkz Btalct/x  Rcffrype/x )/wky ，/wd 1/m ，/wd h/x )/wky ；/wf 
    if/x (/wkz !/wt feaf/x (/wkz g/x )/wky )/wky fread/x (/wkz ＆/n gr/x ，/wd si/x ~/n f/x (/wkz struct/x  RcdType/x )/wky ，/wd 1/m ，/wd g/x )/wky ；/wf break/x ；/wf 
    caBQ/x  gr．code==/x ’/wyy u/x ’/wyy ＆/n ＆/n fr．key==gr．key：/x     ∥/w 更改/v “/wyz 旧/a ”/wyy 主/ag 文件/n 中/f 记录/v 
    f．．rite/x (/wkz ＆/n g/x (/wkz fr/x ，/wd gr/x )/wky ，/wd siz/x ~/n f/x (/wkz struct/x  Rcffl/x ~/n e/x )/wky ，/wd l/x ，/wd h/x )/wky ；/wf 
    ∥/w 函数/n Q/x 将/d fr/x 和/cc gr/x 归并/vi 成/v 一个/mq h/x 结构/n 的/ude1 记录/n 
    if/x (/wkz !/wt feo￡/x (/wkz f/x )/wky )/wky fread/x (/wkz ＆/n fr/x ，/wd siz/x ~/n ~/n (/wkz stzlIcRcffrype/x )/wky ，/wd 1/m ，/wd f/x )/wky ；/wf 
    if/x (/wkz !/wt feof/x (/wkz g/x )/wky )/wky fret/x (/wkz &/n gr/x ，/wd slz/x ~/n ~/n (/wkz stm/x ~/n ct/x  ttcd/x ~/n rpe/x )/wky ，/wd 1/m ，/wd g/x )/wky ；/wf break/x ；/wf 
    elsemolt/x ；/wf     ∥/w 其它/rz 均/d 为/v 出错/vi 情况/n 
    }/n ∥/w switch/x 
}/n le/x (/wkz !/wt feof/x (/wkz f/x )/wky ＆/n &/n !/wt feof/x (/wkz g/x )/wky )/wky ；/wf 
if/x (/wkz feo￡/x (/wkz g/x )/wky )/wky {/n     ∥/w 将/d f/x 中/b 剩余/vn 记录/n 复制/v 到/v h/x 
  else/x  I/x     ∥/w 将/d g/x 中/b 剩余/vn 记录/n 插入/v 到/v h/x 
    if/x (/wkz gr．code=/x ’/wyy I/x ’/wyy )/wky ~/n ~/n ite/x (/wkz &/n P/x (/wkz gr/x )/wky ，/wd 8izeof/x (/wkz s/x ~/n '/n uct/x  RcdT/x ~/n e/x )/wky ，/wd 1/m ，/wd h/x )/wky ；/wf 
    wl/x ~/n le/x (/wkz !/wt feof/x (/wkz g/x )/wky )/wky {/n 
    fread/x (/wkz &/n gr/x ，/wd simS/x (/wkz struct/x  Rcm/x ~/n e/x )/wky ，/wd 1/m ，/wd g/x )/wky ；/wf 
    if/x (/wkz gr．code=/x ’/wyy 1/m ’/wyy 1/m 
    f/x '/n ．/w rite/x (/wkz &/n P/x (/wkz gr/x )/wky ，/wd 8izeof/x (/wkz 8tnIct/x  ttcd/x ~/n e/x )/wky ，/wd 1/m ，/wd h/x )/wky ；/wf   ∥/w g/x 的/ude1 剩余/vn 段/ng 只能/v 属/v 插入/v 情况/n 
    l/x ∥/w while/x 
  ＼/m #/n f/x  else/x 
}/n ∥/w Merge/x ~/n ~/n le/x 
    算法/n 12．1/m 
    分析/v 批处理/v 算法/n 的/ude1 时间/n 。/wj 假设/v 主文/n 件/q 包含/v n/x 个/q 记录/n ，/wd 事务/n 文件/n 包含/v 优/ag 个/ng 记录/v 。/wj 一般/a 情况/n 下/f ，/wd 事务/n 文件/n 较/d 小/a ，/wd 可以/v 进行/vx 内部/f 排序/vi ，/wd 则/c 时间/n 复杂度/n 为/v 0/m (/wkz 优/ag 10g/x 优/ng )/wky 。/wj 内部/f 归并/vi 的/ude1 时间/n 复杂度/n 为/v (/wkz )/wky (/wkz m+/x 优/ng )/wky ，/wd 则/c 总/b 的/ude1 内部/f 处理/v 的/ude1 时间/n 为/p 0/m (/wkz 所/n log/x 优/ng +m/x )/wky 。/wj 假设/v 所有/b 的/ude1 输入/vn ／/w 输出/v 都/d 是/vshi 通过/p 缓冲区/n 进行/vx 的/ude1 ，/wd 并/cc 假设/v 缓冲区/n 大小/n 为/v s/x (/wkz 个/q 记录/n )/wky ，/wd 则/c 整个/m 批/q 处理过程/n 中/f 读/v ／/w 写/v 外存/n 的/ude1 次数/n 为/p 磁盘/n 上/f 的/ude1 顺序/n 文件/n 的/ude1 批/q 处理/vn 和/cc 磁带/n 文件/n 类似/a ，/wd 只/d 是/vshi 当/p 修改/v 项/q 中/f 没有/d 插入/v ，/wd 且/c 更新/v 时/ng 不/d 增加/v 记录/v 的/ude1 长度/n 时/ng ，/wd 可以/v 不/d 建立新/n 的/ude1 主/ag 文件/n ，/wd 而/cc 直接/ad 修改/v 原来/b 的/ude1 主/ag 文件/n 即可/v 。/wj 显然/a ，/wd 磁盘文件/n 的/ude1 批处理/v 可以/v 在/p 一/m 台/q 磁盘组/n 上/f 进行/vx 。/wj 
    对/p 顺序/n 文件/n 进行/vx 顺序/n 查找/v 类似/v 于/p 第9/m 章/q 讨论/vn 的/ude1 顺序/n 查找/v ，/wd 其/rz 平均/ad 查找/v 长度/n 为/v (/wkz n/x ’/wyy +/m 
1/m )/wky ／2/m ，/wd 其中/rz 佗/ng ’/wyy 为/p 文件/n 所/usuo 含/v 物理/n 记录/v 的/ude1 数目/n (/wkz 相对/b 外存/n 读/v ／/w 写/v 而言/uls ，/wd 内存/n 查找/v 的/ude1 时间/n 可以/v 忽略/v 不/d 计/vi )/wky 。/wj 对/p 磁盘文件/n 可以/v 进行/vx 分块/v 查找/v 或/c 折半/v 查找/v (/wkz 对/p 不/d 定/v 长/a 文件/n 不/d 能/v 进行/vx 折半/v 查找/v )/wky 。/wj 但是/c ，/wd 若/c 文件/n 很/d 大/a ，/wd 在/p 磁盘/n 上/f 占/v 多/m 个/q 柱/ng 面/n 时/ng ，/wd 折半/v 查找/v 将/d 引起/v 磁头/n 来回/vd 移动/v ，/wd 增加/v 寻/v 查/v 时间/n 。/wj 
    假若/c 某个/rz 顺序/n 文件/n ，/wd 其/rz 记录修改/n 的/ude1 频率/n 较/d 低/a ，/wd 则/c 用/p 批处理/v 并/cc 不/d 适宜/v ，/wd 此时/r 可/v 另/rz 建立/v 一个/mq 附加文件/n ，/wd 以/p 存储新/n 插入/v 和/cc 更新/vn 后/f 的/ude1 记录/n ，/wd 待/vi 附加文件/n 增大/v 到/v 一定/b 程度/n 时/ng 再/d 进行/vx 批/v 处理/vn 。/wj 在/p 检索/v 时/ng 可以/v 先/d 查/v 主/ag 文件/n ，/wd 若/c 不/d 成功/a 再/d 查/v 附加文件/n ，/wd 或/c 反之/c 。/wj 显然/a 这/rzv 将/d 增加/v 检索/vn 的/ude1 时间/n ，/wd 但/c 可以/v 采取/v 其它/rz 措施/n 弥补/v 之/uzhi ，/wd 详细/a 情况/n 可/v 参阅/v 参考书/n 目/ng [/wkz 13/m ]/wky 。/wj 
12．3/m 索引/n 文件/n 
    除了/p 文件/n 本身/rz (/wkz 称作/v 数据/n 区/n )/wky 之外/f ，/wd 另/d 建立/v 一/m 张/q 指示/n 逻辑记录/n 和/cc 物理/n 记录/n 之间/f --/wp 对/p 应/v 关系/n 的/ude1 表/n ――/wp 索引/n 表/n 。/wj 这/rzv 类/q 包括/v 文件/n 数据/n 区/n 和/cc 索引/n 表/vg 两/m 大/a 部分/n 的/ude1 文件/n 称作/v 索引/n 文件/n 。/wj     图/n 12．5/m 所/usuo 示/vg 为/p 两/m 个/q 索引/n 表/n 的/ude1 例子/n 。/wj 索引/n 表/n 中/f 的/ude1 每/rz 一/m 项/q 称作/v 索引/n 项/q 。/wj 不论/c 主/ag 文件/n 是否/v 按/p 关键字/n 有序/a ，/wd 索引/n 表/n 中/f 的/ude1 索引/n 项/q 总/d 是/vshi 按/p 关键字/n (/wkz 或/c 逻辑记录/n 号/q )/wky 顺序/n 排列/v 。/wj 若/c 数据/n 区/n 中/f 的/ude1 记录/n 也/d 按/p 关键字/n 顺序/n 排列/v ，/wd 则/c 称/v 索引/n 顺序/n 文件/n 。/wj 反之/c ，/wd 若/c 数据/n 区/n 中/f 记录/v 不/d 按/p 关键字/n 顺序/n 排列/v ，/wd 则/c 称/v 索引/n 非/b 顺序/n 文件/n 。/wj 
    图/n 12．5/m 索引/n 表示/v 例/n 
    索引/n 表/n 是/vshi 由/p 系统/n 程序自动/n 生成/v 的/ude1 。/wj 在/p 记录/v 输入/v 建立/v 数据/n 区/n 的/ude1 同时/c 建立/v 一个/mq 索引/n 表/n ，/wd 表/n 中/f 的/ude1 索引/n 项/q 按/p 记录/v 输入/v 的/ude1 先后/d 次序排列/n ，/wd 待/vi 全部/m 记录/n 输入/v 完毕/vi 后/f 再/d 对/p 索引/n 表/n 进行/vx 排序/vn 。/wj 例如/v ，/wd 对/p 应/v 于/p 图/n 12．6/m (/wkz a/x )/wky 的/ude1 数据/n 文件/n ，/wd 其/rz 索引/n 表/vg 如/v 图/n 12．6/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 而/cc 图/n 12．6/m (/wkz c/x )/wky 为/p 文件/n 记录/v 输入/vn 过程/n 中/f 建立/v 的/ude1 索引/n 表/n 。/wj 
①/m   此/rzs 数/v 为/p 考虑/v 全部/m 修改/v 项/q 为/v 插入/v 时/ng 的/ude1 上/f 界/n 。/wj 
②/m 标识/n 域/ng 指示/n 该/rz 逻辑记录/n 是否/v 存在/v ，/wd 若/c 存在/v ，/wd 则/c 标识符/n 为/v “/wyz 1/m ”/wyy ，/wd 否则/c 为/v “/wyz O/x ”/wyy 。/wj 
    图/n 12．6/m 累/a 引/v 非/b 顺序/n 文件/n 示例/n 
    (/wkz a/x )/wky 文件/n 数据/n 区/n ；/wf   (/wkz b/x )/wky 索引/n 表/n ；/wf   (/wkz c/x )/wky 输入/v 过程/n 中/f 建立/v 的/ude1 索引/n 表/n 。/wj 
    索引/n 文件/n 的/ude1 检索方式/n 为/v 直接/ad 存取/v 或/c 按/p 关键字/n (/wkz 进行/vx 简单/a 询问/v )/wky 存取/v ，/wd 检索/v 过程/n 和/cc 第9/m 章/q 讨论/vn 的/ude1 分块/v 查找/v 相/d 类似/a ，/wd 应/v 分两步/n 进行/vn ：/wp 首先/c ，/wd 查找/v 索引/n 表/n ，/wd 若/c 索引/n 表/n 上/f 存在/v 该/rz 记录/n ，/wd 则/c 根据/p 索引/n 项/q 的/ude1 指示/n 读取/vn 外存/n 上/f 该/rz 记录/n ；/wf 否则/c 说明/v 外存/n 上/f 不/d 存在/v 该/rz 记录/n ，/wd 也/d 就/d 不/d 需要/v 访问/vn 外存/n 。/wj 由于/p 索引/n 项/q 的/ude1 长度/n 比/p 记录/v 小/a 得/ude3 多/a ，/wd 则/c 通常/d 可/v 将/p 索引/n 表/vg 一/m 次/qv 读入/v 内存/n ，/wd 由此/d 在/p 索引/n 文件/n 中/f 进行/vx 检索/vn 只/d 访问/v 外存/n 两/m 次/qv ，/wd 即/v 一/m 次/qv 读/v 索引/n ，/wd 一/m 次/qv 读记录/n 。/wj 并且/c 由于/p 索引/n 表/n 是/vshi 有序/a 的/ude1 ，/wd 则/c 查找/v 索引/n 表/vg 时/ng 可用/v 折半/v 查找/v 法/n 。/wj 
    索引/n 文件/n 的/ude1 修改/vn 也/d 容易/ad 进行/vx 。/wj 删除/v 一个/mq 记录/n 时/ng ，/wd 仅/d 需/v 删去/v 相应/vi 的/ude1 索引/n 项/q ；/wf 插入/v 一个/mq 记录/n 时/ng ，/wd 应/v 将/d 记录/v 置于/v 数据/n 区/n 的/ude1 末尾/n ，/wd 同时/c 在/p 索引/n 表/n 中/f 插入/v 索引/n 项/q ；/wf 更新/v 记录/v 时/ng ，/wd 应/v 将/d 更/d 新/a 后/f 的/ude1 记录/n 置于/v 数据/n 区/n 的/ude1 末尾/n ，/wd 同时/c 修改/v 索引/n 表/n 中/f 相应/vi 的/ude1 索引/n 项/q 。/wj 
    当/p 记录/v 数目/n 很/d 大/a 时/ng ，/wd 索引/n 表/n 也/d 很/d 大/a ，/wd 以致/c 一个/mq 物理/n 块/q 容纳/v 不/d 下/vf 。/wj 在/p 这种/r 情况/n 下/f 查阅/v 索引/n 仍/d 要/v 多/m 次访问/n 外存/n 。/wj 为此/bl ，/wd 可以/v 对/p 索引/n 表/vg 建立/v 一个/mq 索引/n ，/wd 称为/v 查找表/n 。/wj 假设/v 图/n 12．6/m (/wkz b/x )/wky 的/ude1 索引/n 表/vg 需/v 占用/v 三/m 个/q 物理/n 块/q 的/ude1 外存/n ，/wd 每/rz 一个/mq 物理/n 块/q 容纳/v 三/m 个/q 索引/n ，/wd 则/c 建立/v 的/ude1 查找表/n 如/v 图/n 12．7/m 所/usuo 示/vg 。/wj 检索记录/n 时/ng ，/wd 先/d 查找/v 查找表/n ，/wd 再/d 查/v 索引/n 表/n ，/wd 然后/c 读取记录/n 。/wj 三/m 次访问/n 外存/n 即可/v 。/wj 若/c 查找表/n 中/b 项目/n 还/d 多/a ，/wd 则/c 可/v 建立/v 更/d 高/a 一级/b 的/ude1 索引/n 。/wj 通常/d 最高/a 可/v 有/vyou 四/m 级/q 索引/n ：/wp 数据/n 文件/n 一/m 索引/n 表/vg 一/m 查找表/n 一/m 第二/m 查找表/n 一/m 第三/m 查找表/n 。/wj 而/cc 检索/vn 过程/n 从/p 最高/a 一级/b 索引/n 即/v 第三/m 查找表/n 开始/v ，/wd 仅/d 需/v 5/m 次访问/n 外存/n 。/wj 
    上述/b 的/ude1 多级/b 索引/n 是/vshi 一/m 种/q 静态/n 索引/n ，/wd 各级/r 索引/n 均/d 为/v 顺序/n 表/vg 结构/n 。/wj 其/rz 结构简单/n ，/wd 但/c 修改/v 很/d 不/d 方便/a ，/wd 每/rz 次/qv 修改/v 都/d 要/v 重组/vn 索引/n 。/wj 因此/c ，/wd 当/p 数据/n 文件/n 在/p 使用/v 过程/n 中/f 记录/v 变动/vn 较/d 多/a 时/ng ，/wd 应/v 采用/v 动态/n 索引/n 。/wj 如/v 二/m 叉/n 排序/vn 树/n (/wkz 或/c 二/m 叉/n 平衡/a 树/n )/wky 、/wn B/x 一/m 树/n 以及/cc 键/n 树/n ，/wd 这些/rz 都/d 是/vshi 树/n 表/vg 结构/n ，/wd 插入/v 、/wn 删除/v 都/d 很/d 方便/a 。/wj 又/d 由于/p 它/rr 本身/rz 是/vshi 层次/n 结构/n ，/wd 则/c 无/v 需/v 建立/v 多级/b 索引/n ，/wd 而且/c 建立/v 索引/n 表/n 的/ude1 过程/n 即/d 排序/vi 的/ude1 过程/n 。/wj 通常/d ，/wd 当/p 数据/n 文件/n 的/ude1 记录/n 数/n 不/d 很/d 多/a ，/wd 内存/n 容量/n 足以/d 容纳/v 整个/b 索引/n 表/vg 时/ng 可/v 采用/v 二/m 叉/n 排序/vn 树/n (/wkz 或/c 平衡/a 树/n )/wky 作/v 索引/n ，/wd 其/rz 查找/v 性能/n 已/d 在/p 第9/m 章/q 中/f 进行/vx 了/ule 详细/a 讨论/vn 。/wj 反之/c ，/wd 当文件/n 很/d 大/a 时/ng ，/wd 索引/n 表/n (/wkz 树表/nr2 )/wky 本身/rz 也/d 在/p 外/f 存/v ，/wd 则/c 查找/v 索引/n 时/ng 尚/d 需/v 多次/mq 访问/vn 外存/n ，/wd 并且/c ，/wd 访问/v 外存/n 的/ude1 次数/n 恰/d 为/v 查找/v 路径/n 上/f 的/ude1 结/v 点数/n 。/wj 显然/a ，/wd 为/p 减少/v 访问/vn 外存/n 的/ude1 次数/n ，/wd 就/d 应/v 尽量/d 缩减/v 索引/n 表/n 的/ude1 深度/n 。/wj 因此/c ，/wd 此时/r 宜/ag 采用/v m/x 叉/n 的/ude1 B/x 一/m 树/n 作/v 索引/n 表/n 。/wj m/x 的/ude1 选择/vn 取决于/v 索引/n 项/q 的/ude1 多少/ry 和/cc 缓冲区/n 的/ude1 大小/n 。/wj 又/c ，/wd 从/p “/wyz 9．2．3／/m 键/n 树/n ”/wyy 的/ude1 讨论/vn 可见/c ，/wd 键/n 树/n 适用/vi 于/p 作/v 某些/rz 特殊/a 类型/n 的/ude1 关键/n 字/n 的/ude1 索引/n 表/n 。/wj 和/cc 上述/b 对/p 排序/vn 树/n 的/ude1 讨论/vn 类似/a ，/wd 当/p 索引/n 表/n 不/d 大/a 时/ng ，/wd 可/c 采用/v 双/m 链/ng 表/n 作/v 存储/vn 结构/n (/wkz 此时/r 索引/n 表/vg 在/p 内存/n )/wky ；/wf 反之/c ，/wd 则/c 采用/v Trie/x 树/n 。/wj 总之/c ，/wd 由于/c 访问/v 外存/n 的/ude1 时间/n 比/p 内存/n 查找/v 的/ude1 时间/n 大/a 得/ude3 多/a ，/wd 所以/c 对/p 外存/n 中/b 索引/n 表/n 的/ude1 查找/vn 效能/n 主要/d 取决于/v 访问/vn 外存/n 的/ude1 次数/n ，/wd 即/v 索引/n 表/n 的/ude1 深度/n 。/wj 
    显然/a ，/wd 索引/n 文件/n 只能/v 是/vshi 磁盘文件/n 。/wj 
    综上所述/c ，/wd 由于/c 数据/n 文件/n 中/f 记录/v 不/d 按/p 关键字/n 顺序/n 排列/v ，/wd 则/c 必须/d 对/p 每个/r 记录/v 建立/v 一个/mq 索引/n 项/q ，/wd 如此/rzv 建立/v 的/ude1 索引/n 表/vg 称之为/v 稠密/a 索引/n ，/wd 它/rr 的/ude1 特点/n 是/vshi 可以/v 在/p 索引/n 表/n 中/f 进行/vx “/wyz 预/d 查找/v ”/wyy ，/wd 即/d 从/p 索引/n 表/n 便/d 可/v 确定/v 待查/v 记录/v 是否/v 存在/v 或/c 作/v 某些/rz 逻辑运算/n 。/wj 如果/c 数据/n 文件/n 中/f 的/ude1 记录/n 按/p 关键字/n 顺序/n 有序/a ，/wd 则/c 可/v 对/p 一/m 组/q 记录/n 建立/v 一个/mq 索引/n 项/q ，/wd 这种/r 索引/n 表/vg 称之为/v 非/b 稠密/a 索引/n ，/wd 它/rr 不/d 能/v 进行/vx “/wyz 预/d 查找/v ”/wyy ，/wd 但/c 索引/n 表/vg 占用/v 的/ude1 存储空间/n 少/a ，/wd 管理要求/n 低/a 。/wj 下/vf 一/m 节/q 将/d 介绍/v 两/m 种/q 有用/a 的/ude1 索引/n 顺序/n 文件/n 。/wj 
12．4/m   ISAM/x 文件/n 和/cc VSAM/x 文件/n 
12．4．1/m  ISAM/x 文件/n 
　　索引/n 顺序/n 存取方法/n ISAM/x 为/v Indexed/x  Seguential/x  Access/x  Methed/x 的/ude1 缩写/n ，/wd 它/rr 是/vshi 一/m 种/q 专/d 为/v 磁盘存取/n 设计/vn 的/ude1 文件/n 组织/v 方式/n 。/wj 由于/p 磁盘/n 是以/c 盘/qv 组/n 、/wn 柱/ng 面/n 和/cc 磁道/n 三级/b 地址/n 存取/vn 的/ude1 设备/n ，/wd 则/c 可/v 对/p 磁盘/n 上/f 的/ude1 数据/n 文件/n 建立/v 盘/qv 组/n 、/wn 柱/ng 面/n 和/cc 磁道/n ①/m 三级/b 索引/n 。/wj 文件/n 的/ude1 记录/n 在/p 同/p 一/m 盘/qv 组/n 上/f 存放/v 时/ng ，/wd 应/v 先/d 集中/ad 放在/v 一个/mq 柱/n 面上/s ，/wd 然后/c 再/d 顺序/n 存放在/v 相邻/vi 的/ude1 柱/n 面上/s ，/wd 对/p 同一/b 柱/ng 面/n ，/wd 则/c 应/v 按/p 盘面/n 的/ude1 次序/n 顺序/n 存放/v 。/wj 例如/v 图/n 12．8/m 为/p 存放/v 在/p 一个/mq 磁盘组/n 上/f 的/ude1 ISAM/x 文件/n ，/wd 每个/r 柱/ng 面/n 建立/v 一个/mq 磁道/n 索引/n ，/wd 每个/r 磁道/n 索引/n 项/q 由/p 两/m 部分/n 组成/v ：/wp 基本/a 索引/n 项/q 和/cc 溢出/v 索引/n 项/q ，/wd 如/v 图/n 12．9/m 所/usuo 示/vg ，/wd 每/rz 一/m 部分/n 都/d 包括/v 关键字/n 和/cc 指针/n 两/m 项/q ，/wd 前者/rzv 表示/v 该/rz 磁道/n 中/f 最/d 末/f 一个/mq 记录/n 的/ude1 关键/n 字/n (/wkz 在/p 此/rzs 为/v 最/d 大/a 关键字/n )/wky ，/wd 后者/rzv 指示/n 该/rz 磁道/n 中/f 第一/m 个/q 记录/n 的/ude1 位置/n ，/wd 柱/ng 面/n 索引/n 的/ude1 每/rz 一个/mq 索引/n 项/q 也/d 由/p 关键字/n 和/cc 指针/n 两/m 部分/n 组成/v ，/wd 前者/rzv 表示/v 该/rz 柱/ng 面/n 中/f 最/d 末/f 一个/mq 记录/n 的/ude1 关键/n 字/n (/wkz 最/d 大/a 关键字/n )/wky ，/wd 后者/rzv 指示/n 该/rz 柱/ng 面上/s 的/ude1 磁道/n 索引/n 位置/n 。/wj 柱/ng 面/n 索引/n 存放/v 在/p 某个/rz 柱/ng 面上/s ，/wd 若柱/nr2 面/n 索引/n 较/d 大/a ，/wd 占/v 多/m 个/q 磁道/n 时/ng ，/wd 则/c 可/v 建立/v 柱/ng 面/n 索引/n 的/ude1 索引/n ～/ws 主/b 索引/n 。/wj 
　　在/p ISAM/x 文件/n 上/f 检索记录/n 时/ng ，/wd 先/d 从/p 主/ag 索引/n 出发/vi 找到/v 相应/vi 的/ude1 柱/n 面/q 索引/n ，/wd 再/d 从/p 柱/ng 面/n 索引/n 找到/v 记录/v 所在/n 柱/ng 面的/n 磁道/n 索引/n ，/wd 最后/f 从/p 磁道/n 索引/n 找到/v 记录/v 所在/n 磁道/n 的/ude1 第一/m 个/q 记录/n 的/ude1 位置/n ，/wd 由此/d 出发/vi 在/p 该/rz 磁道/n 上/f 进行/vx 顺序/n 查找/v 直至/v 找到/v 为止/u ；/wf 反之/c ，/wd 若/c 找/v 遍/v 该/rz 磁道/n 而/cc 不/d 存在/v 此记录/n ，/wd 则/c 表明/v 该/rz 文件/n 中/f 无/v 此记录/n 。/wj 例如/v ，/wd 查找/v 关键字/n 为/p 21/m 的/ude1 记录/n 时/ng 的/ude1 查找/vn 路径/n 如/v 图/n 12．8/m 中/f 的/ude1 粗/a 实线/n 所/usuo 示/vg 。/wj 
    从/p 图/n 12．8/m 中/b 读者/n 可/v 看到/v ，/wd 每个/r 柱/ng 面/n 上/f 还/d 开辟/v 有/vyou 一个/mq 溢出/v 区/n ；/wf 并且/c ，/wd 磁道/n 索引/n 项/q 中/f 有/vyou 溢出/v 索引/n 项/q ，/wd 这/rzv 是/vshi 为/p 插入/v 记录/v 所/usuo 设置/v 的/ude1 。/wj 由于/p ISAM/x 文件/n 中/f 记录/v 是/vshi 按/p 关键字/n 顺序/n 存放/v 的/ude1 ，/wd 则/c ①/m 这里/rzs 的/ude1 磁道/n 索引/n ，/wd 实际/ad 为/v 盘面/n 索引/n ，/wd 为/p 遵循/v 习惯/n 仍/d 称/v 磁道/n 索引/n 。/wj 
磁道/n {/n 
    图/n 12.8/m  sam/x 件/q 结构/n 示/vg 倒/vi 
广/a _/n 关键字/n _/n _/n |/n 指针/n 关键字/n 指针/n 
基本/a 索引/n 项/q 
12/m  9/m 磁道/n 索引/n 项/q 结构/n 
：/wp ^/n 记录/v 时/ng 需/v 移动/vn 记录/n ，/wd 并/cc 将/d 同/p 一/m 磁道/n I：/x 一个/mq 【/wkz 己/rr 录/v 移/v 至/p 溢/v f/x …/ws 嚣/vg ，/wd 同时/c 修改/v 磁道/n 索引/n 项/q 。/wj 通常/d 溢出/v 区/n 可/v 有/vyou =：/m 种/q 设置/vn 方法/n ：/wp (/wkz I/x )/wky 集中/ad 存放/v ――/wp 整个/b 文件/n |/n 盐/n 一个/mq 大/a 的/ude1 单一/a 的/ude1 溢出/v 区/n ；/wf (/wkz 2/m )/wky 分散/ad 存放/v ――/wp 每个/r 柱/ng 面/n 设/v ～/ws 个/q 溢出/v 区/n ；/wf (/wkz 3/m )/wky 集中/v 与/cc 分/v 敞/v 十/m H/x 结合/v ――/wp 溢出/v 时/ng lL/x 录/ng 先/d 移/v 至/p 每个/r 柱/n l/x 酊/ng 备/v 自/rr 的/ude1 溢/v }/n I/x {/n R/x ，/wd 待/vi 满/v 之后/f 再/d 使用/v 公共/b 。/wj 图/n 12/m  8/m 址/ng 笫/n 二/m 种/q 没/v 性/ng 法/n 。/wj 
    每个/r 桂/b m1/x 的/ude1 牡/n 本区/r 是/vshi 顺序/n 存/v 1i/x {/n i/x 结构/n ，/wd 而/cc 溢出/v 区/n 魁/ng 链/ng 表/vg 结构/n 。/wj 1/m 司/ng 一/m 磁道/n 溢出/v 的/ude1 记录/n 由/p 指针/n 十/m H/x 链/ng ，/wd 泼/v 磁道/n 索引/n 的/ude1 溢/v m/x 索引/n 项/q 中/f 的/ude1 关键字/n 指示/n 陵/ng 磁道/n 溢出/v 的/ude1 记录/n 的/ude1 姓/n 犬/ng 戈/ng 腱/n 字/n ；/wf 而/cc 指/v 钊/ng 则/d 指/v 小/a 在/p 溢出/v l/x ＆/n t/x {/n -/wp 的/ude1 第一/m 个/q 已/d 录/v 。/wj 蹦/v 12/m  10/m 所/usuo 示/vg 为/p 插入/v }/n 己/rr 求和/vi 溢出/v 处/n 删/v 的/ude1 具体/a 例/n 予/vg 扎/v rfl/x (/wkz “/wyz )/wky 为/p 插入/v 曲/ng 的/ude1 某/rz 一/m 柱/q 面上/s 的/ude1 状态/n ；/wf (/wkz b/x )/wky 为/p 捕/v 人心/n 5/m 叫/vi ，/wd 将/d  关键字/n 夫/Rg 于/p 65/m 的/ude1 Ie/x 录/v ㈣/m 救/v 厉穆/nr 。/wj 儿/ng 他/rr Itw/x ，/wd 溢/v m/x 至/p 溢/v 【/wkz ¨/n 区/n 的/ude1 情况/n ；/wf (/wkz c/x )/wky 为/p 插入/v I‰/x 之后/f 的/ude1 状态/n ，/wd 此时/r 2/m 道/qv 的/ude1 ，/wd 改/v 为/p 80/m ，/wd 川/b 溢/v …/ws 索/vg cjI/x 项/q 的/ude1 兑/v 键/n 。/wj r/x 政/ng 为/v 9/m 【/wkz 1/m ，/wd Je/x 指引/vn 指/v 阳/nr1 筇/n 4/m 道/qv 第一/m 个/q 使/v R145/x 溢出/v 。/wj 而/cc 由于/p 80/m </n 83/m </n 90/m ，/wd 则/d R83/x 被/pbei 直接/ad 插入/v 到/v 溢出/v 区/n ，/wd 作为/v 第2/m 道/qv 在/p 溢出/v 区/n 的/ude1 第一/m 个/q 记录/n ，/wd 并/cc 将/p 它/rr 的/ude1 指针/n 指向/v R9/x 。/wj 的/ude1 位置/n ，/wd 同时/c 修改/v 第2/m 道/qv 索引/n 的/ude1 溢出/v 索引/n 项/q 的/ude1 指针/n 指向/v 基本/a 索引/n 项/q 溢出/v 索引/n 项/q 基本/a 索引/n 项/q 溢出/v 索引/n 项/q  (/wkz a/x )/wky 
基本/a 区/n 
    ／／/m 
(/wkz b/x )/wky 
溢出/v 区/n 
}/n 基本/a 区/n 
溢出/v 区/n 
    图/n 12．10/m  ISAM/x 文件/n 的/ude1 插入/v 和/cc 溢出/v 处理/v 
    (/wkz a/x )/wky 插入/v 前/f ；/wf (/wkz b/x )/wky 插入/v 民/ng 5时/t 记录移动/n 的/ude1 情形/n ；/wf (/wkz c/x )/wky 插入/v R5/x 后/f ；/wf (/wkz d/x )/wky 先/d 插入/v 岛/n 5/m 再/d 插入/v R83/x 后/f 。/wj ISAM/x 文件/n 中/f 删除/v 记录/v 的/ude1 操作/vn 要/v 比/p 插入/v 简单/a 得/ude3 多/a ，/wd 只/d 需/v 找到/v 待/vi 删除/v 的/ude1 记录/n ，/wd 在/p 其/rz 存储位置/n 上/f 作/v 删除/v 标记/n 即可/v ，/wd 而/cc 不/d 需要/v 移动/vn 记录/n 或/c 改变/v 指针/n 。/wj 则/c 在/p 经过/p 多次/mq 的/ude1 增删/v 后/f ，/wd 文件/n 的/ude1 结构/n 可能/v 变/v 得/ude3 很/d 不/d 合理/a 。/wj 此时/r ，/wd 大量/m 的/ude1 记录/n 进入/v 溢出/v 区/n ，/wd 而/cc 基本/a 区/n 中/f 又/d 浪费/v 很多/m 空间/n 。/wj 因此/c ，/wd 通常/d 需要/v 周期/n 地/ude2 整理/v ISAM/x 文件/n 。/wj 把/pba 记录/v 读入/v 内存/n ，/wd 重新/d 排列/v ，/wd 复制/v 成/v 一个/mq 新/a 的/ude1 ISAM/x 文件/n ，/wd 填/v 满/a 基本/a 区/n 而/cc 空/v 出/vf 溢出/v 区/n 。/wj 
    最后/f ，/wd 我们/rr 简单/ad 讨论/v 一下/mq ISAM/x 文件/n 中/f 柱/ng 面/n 索引/n 的/ude1 位置/n 。/wj 
    通常/d ，/wd 磁道/n 索引/n 放/v 在/p 每个/r 柱/ng 面/n 的/ude1 第一/m 道/qv 上/f ，/wd 那末/c ，/wd 柱/ng 面/n 索引/n 是否/v 也/d 放/v 在/p 文件/n 的/ude1 第一/m 个/q 柱/n 面上/s 呢/y ?/ww 由于/p 每/rz 一/m 次检索/n 都/d 需/v 先/d 查找/v 柱/ng 面/n 索引/n ，/wd 则/c 磁头/n 需/v 在/p 各/rz 柱/ng 面/n 间/f 来回/vd 移动/v ，/wd 我们/rr 希望/v 磁头移动/n 距离/n 的/ude1 平均值/n 最/d 小/a 。/wj 假设/v 文件/n 占有/v n/x 个/q 柱/ng 面/n ，/wd 柱/ng 面/n 索引/n 在/p 第/m z/x 柱/n 面上/s 。/wj 则/c 磁头移动/n 距离/n 的/ude1 平均值/n 为/v ：/wp 这就是说/c ，/wd 柱/ng 面/n 索引/n 应/v 放在/v 数据/n 文件/n 的/ude1 中间/f 位置/n 的/ude1 柱/n 面上/s 。/wj 
    12．4．2/m  VSAM/x 文件/n 
    虚拟/vn 存储存取/n 方法/n VSAM/x 是/vshi Vistual/x  St/x (/wkz 3rage/x  Access/x  Method/x 的/ude1 缩写/n 。/wj 这种/r 存取方法/n 利用/v 了/ule 操作系统/nl 的/ude1 虚拟/vn 存储器/n 的/ude1 功能/n ，/wd 给/p 用户/n 提供/v 方便/an 。/wj 对/p 用户/n 来说/uls ，/wd 文件/n 只有/c 控制区/n 间/f 和/cc 控制区域/n 等/udeng 逻辑存储/n 单位/n ，/wd 与/p 外/f 存储器/n 中/f 柱/ng 面/n 、/wn 磁道/n 等/udeng 具体/a 存储单位/n 没有/v 必然/b 的/ude1 联系/vn 。/wj 用户/n 在/p 存取/vn 文件/n 中/f 的/ude1 记录/n 时/ng ，/wd 不/d 需要/v 考虑/v 这个/rz 记录/n 的/ude1 当前/t 位置/n 是否/v 在/p 内存/n ，/wd 也/d 不/d 需要/v 考虑/v 何时/ryt 执行/v 对/p 外存/n 进行/vx “/wyz 读/v ／/w 写/v ”/wyy 的/ude1 指令/n 。/wj 
    VSAM/x 文件/n 的/ude1 结构/n 如/v 图/n 12．11/m 所/usuo 示/vg 。/wj 它/rr 由/p 三/m 部分/n 组成/v ：/wp 索引/n 集/vg 、/wn 顺序/n 集/vg 和/cc 数据/n 集/vg 。/wj 控制区域/n     控制区/n 间/f 
索引/n 集/vg 、/wn 
顺序/n 集/vg ／/w 
数据/n 集/vg 
    例/n 12．1l/x   VSAM/x 文件/n 的/ude1 结构/n 示意图/n 
文件/n 的/ude1 记录/n 均/d 存放/v 在/p 数据/n 集中/v ，/wd 数据/n 集中/a 的/ude1 一个/mq 结点/n 称为/v 控制区/n 间/f (/wkz ContrOlInterval/x )/wky ，/wd 它/rr 是/vshi 一个/mq I／O/x 操作/vn 的/ude1 基本单位/n ，/wd 它/rr 由/p 一/m 组/q 连续/a 的/ude1 存储/vn 单元/n 组成/v 。/wj 控制区/n 间/f 的/ude1 大小/n 可/v 随/p 文件/n 不同/an 而/cc 不同/a ，/wd 但/c 同/p 一/m 文件/n 上/f 控制区/n 间/f 的/ude1 大小/n 相同/a 。/wj 每个/r 控制区/n 间/f 含有/v 一个/mq 或/c 多/m 个/q 按/p 关键字/n 递增/vi 有序/ad 排列/v 的/ude1 记录/n 。/wj 顺序/n 集/vg 和/cc 索引/n 集/vg 一起/s 构成/v 一/m 棵/q B/x ’/wyy 树/n ，/wd 为/p 文件/n 的/ude1 索引/n 部分/n 。/wj 顺序/n 集中/ad 存放/v 每个/r 控制区/n 间/f 的/ude1 索引/n 项/q 。/wj 每个/r 控制区/n 间/f 的/ude1 索引/n 项/q 由/p 两/m 部分/m 信息/n 组成/v ，/wd 即/v 该/rz 控制区/n 间/f 中/f 的/ude1 最/d 大/a 关键字/n 和/cc 指向/v 控制区/n 间/f 的/ude1 指针/n 。/wj 若干/m 相邻/vn 控制区/n 间/f 的/ude1 索引/n 项/q 形成/v 顺序/n 集中/a 的/ude1 一个/mq 结点/n ，/wd 结点/n 之间/f 用/p 指针/n 相/d 链/ng 结/v ，/wd 而/cc 每个/r 结点/n 又/d 在/p 其/rz 上/f 一/m 层/qv 的/ude1 结点/n 中/f 建/v 有/vyou 索引/n ，/wd 且/c 逐/v 层/qv 向/p 上/f 建立/v 索引/n ，/wd 所有/b 的/ude1 索引/n 项/q 都/d 由/p 最/d 大/a 关键字/n 和/cc 指针/n 两/m 部分/m 信息/n 组成/v ，/wd 这些/rz 高层/n 的/ude1 索引/n 项/q 形成/v B/x ’/wyy 树/n 的/ude1 非/b 终端/n 结点/n 。/wj 因此/c ，/wd vSAM/x 文件/n 既/c 可/v 在/p 顺序/n 集中/ad 进行/vx 顺序/n 存取/vn ，/wd 又/d 可/v 从/p 最高/a 层/qv 的/ude1 索引/n (/wkz B/x ’/wyy 树/n 的/ude1 根/n 结点/n )/wky 出发/vi 进行/vx 按/p 关键字/n 存取/vn 。/wj 顺序/n 集中/v 一个/mq 结点/n 连同/p 其/rz 对应/vi 的/ude1 所有/b 控制区/n 间/f 形成/v 一个/mq 整体/n ，/wd 称/v 做/v 控制区域/n (/wkz (/wkz ；/wf ontrOl/x  Range/x )/wky 。/wj 每个/r 控制区/n 间/f 可/v 视为/v 一个/mq 逻辑/n 磁道/n ，/wd 而/cc 每个/r 控制区域/n 可/v 视为/v 一个/mq 逻辑/n 柱/ng 面/n 。/wj 
    在/p VSAM/x 文件/n 中/f ，/wd 记录/v 可以/v 是/vshi 不/d 定/v 长/a 的/ude1 ，/wd 则/c 在/p 控制/v 区间/n 中/f 除了/p 存放/v 记录/v 本身/rz 以外/f ，/wd 还有/v 每个/r 记录/n 的/ude1 控制信息/n (/wkz 如/v 记录/v 的/ude1 长度/n 等/udeng )/wky 和/cc 整个/b 区间/n 的/ude1 控制信息/n (/wkz 如/v 区间/n 中/f 存/v 有/vyou 的/ude1 记录/n 数/n 等/udeng )/wky ，/wd 控制区/n 间/f 的/ude1 结构/n 如/v 图/n 12．12/m 所/usuo 示/vg 。/wj 在/p 控制/v 区间/n 上/f 存取/v 一个/mq 记录/n 时/ng 需/v 从/p 控制区/n 间/f 的/ude1 两端/n 出发/vi 同时/c 向/p 中间/f 扫描/v 。/wj 
图/n 12．12/m 控制区/n 间/f 的/ude1 结构/n 示意图/n 
    VSAM/x 文件/n 中/f 没有/d 溢出/v 区/n ，/wd 解决/v 插入/v 的/ude1 办法/n 是/vshi 在/p 初/f 建/v 文件/n 时/ng 留/v 有/vyou 空间/n 。/wj 一/m 是/vshi 每个/r 控制区/n 间/f 内/f 没有/d 填/v 满/a 记录/n ，/wd 而是/c 在/p 最/d 末/f 一个/mq 记录/n 和/cc 控制信息/n 之间/f 留/v 有/vyou 空隙/n ；/wf 二/m 是/vshi 在/p 每个/r 控制区域/n 中/f 有/vyou 一些/mq 完全/a 空/a 的/ude1 控制区/n 间/f ，/wd 并/cc 在/p 顺序/n 集/vg 的/ude1 索引/n 中/f 指明/v 这些/rz 空/ng 区间/n 。/wj 当/p 插入/v 新/a 记录/n 时/ng ，/wd 大多数/m 的/ude1 新/a 记录/n 能/v 插入/v 到/v 相应/vi 的/ude1 控制/vn 区间/n 内/f ，/wd 但/c 要/v 注意/v 为了/p 保持/v 区间/n 内/f 记录/v 的/ude1 关键字/n 自小/d 至/p 大/a 有序/a ，/wd 则/c 需/v 将/p 区间/n 内/f 关键字/n 大于/v 插入/v 记录/v 关键字/n 的/ude1 记录/n 向/p 控制信息/n 的/ude1 方向/n 移动/vn 。/wj 若/c 在/p 若干/m 记录/n 插入/v 之后/f 控/v 澍/ng 区间/n 已/d 满/a ，/wd 则/c 在/p 下/f 一个/mq 记录/n 插入/v 时/ng 要/v 进行/vx 控制区/n 间/f 的/ude1 分裂/vn ，/wd 即将/d 近乎/v 一半/m 的/ude1 记录/n 移/v 到/v 同/p 一/m 控制区域/n 中/f 全/d 空/a 的/ude1 控制/vn 区间/n 中/f ，/wd 并/cc 修改/vn 顺序/n 集中/ad 相应/vi 索引/n 。/wj 
倘若/c 控制区域/n 中/f 已经/d 没有/d 全/a 空/a 的/ude1 控制区/n 间/f ，/wd 则/c 要/v 进行/vx 控制区域/n 的/ude1 分裂/vn ，/wd 此时/r 顺序/n 集中/a 的/ude1 结点/n 亦/d 要/v 分裂/vi ，/wd 由此/d 尚/d 需/v 修改/v 索引/n 集中/a 的/ude1 结点/n 信息/n 。/wj 但/c 由于/c 控制区域/n 较/d 大/a ，/wd 很/d 少/ad 发生/v 分裂/vi 的/ude1 情况/n 。/wj 
    在/p VSAM/x 文件/n 中/f 删除/v 记录/v 时/ng ，/wd 需/v 将/d 同/p 一/m 控制区/n 间/f 中/f 较/d 删除/v 记录/v 关键字/n 大/a 的/ude1 记录/n 向前/vi 移动/vn ，/wd 把/pba 空间/n 留给/v 以后/f 插入/v 的/ude1 新/a 记录/n 。/wj 若/c 整个/b 控制区/n 间/f 变空/n ，/wd 则/c 需/v 修改/v 顺序/n 集中/ad 相应/vi 的/ude1 索引/n 项/q 。/wj 
    由此可见/c ，/wd VSAM/x 文件/n 占有/v 较/d 多/a 的/ude1 存储空间/n ，/wd 一般/ad 只/d 能/v 保持/v 约/d 75％/m 的/ude1 存储空间/n 利用率/n 。/wj 但/c 它/rr 的/ude1 优点/n 是/vshi ：/wp 动态/n 地/ude2 分配/v 和/cc 释放/v 存储/vn ，/wd 不/d 需要/v 对/p 文件/n 进行/vx 重组/vn ，/wd 并/cc 能/v 较/d 快/a 地/ude2 对/p 插入/v 的/ude1 记录/n 进行/vx 查找/vn ，/wd 查找/v 一个/mq 后/f 插入/v 记录/v 的/ude1 时间/n 与/cc 查找/v 一个/mq 原有/v 记录/v 的/ude1 时间/n 是/vshi 相同/a 的/ude1 。/wj 
    为了/p 作/v 性能/n 上/f 的/ude1 优化/vn ，/wd VSAM/x 用/v 了/ule 一些/mq 其它/rz 的/ude1 技术/n ，/wd 如/v 指针/n 和/cc 关键/n 字/n 的/ude1 压缩/vn 、/wn 索引/n 的/ude1 存放/vn 处理/vn 等/udeng 。/wj 其/rz 详情/n 读者/n 可/v 参阅/v 参考书/n 目/ng [/wkz 13/m ]/wky 。/wj 
12．5/m 直接/ad 存取/v 文件/n (/wkz 散/v 列/v 文件/n )/wky 
    直接/ad 存取/v 文件/n 指/v 的/ude1 是/vshi 利用/v 杂凑/v (/wkz }/n lash/x )/wky 法/n 进行/vx 组织/vn 的/ude1 文件/n 。/wj 它/rr 类似/v 于/p 哈希表/n ，/wd 即/d 根据文件/n 中/b 关键/n 字/n 的/ude1 特点/n 设计/v 一/m 种/q 哈希函数/n 和/cc 处理/vn 冲突/vn 的/ude1 方法/n 将/d 记录/v 散/ad 列/v 到/v 存储设备/n 上/f ，/wd 故/c 又/d 称/v 散/ad 列/v 文件/n 。/wj 
    与/p 哈希表/n 不同/a 的/ude1 是/vshi ，/wd 对于/p 文件/n 来说/uls ，/wd 磁盘/n 上/f 的/ude1 文件/n 记录/v 通常/d 是/vshi 成/v 组/n 存放/v 的/ude1 。/wj 若干/m 个/q 记录/n 组成/v 一个/mq 存储单位/n ，/wd 在/p 散/v 列/v 文件/n 中/f ，/wd 这个/rz 存储单位/n 叫作/v 桶/n (/wkz Bucket/x )/wky 。/wj 假若/c 一个/mq 桶/n 能/v 存放/v m/x 个/q 记录/n ，/wd 这就是说/c ，/wd m/x 个/q 同义词/n 的/ude1 记录/n 可以/v 存放/v 在/p 同一/b 地址/n 的/ude1 桶/n 中/f ，/wd 而/cc 当/v 第/m m+1/x 个/q 同义词/n 出现/v 时/ng 才/d 发生/v “/wyz 溢出/v ”/wyy 。/wj 处理/v 溢出/v 也/d 可/v 采用/v 哈希表/n 中/f 处理/v 冲突/vn 的/ude1 各种/rz 方法/n ，/wd 但/c 对/p 散/v 列/v 文件/n ，/wd 主要/d 采用/v 链/ng 地址/n 法/n 。/wj 
　　当/p 发生/v “/wyz 溢出/v ’/wyy ’/wyy 时/ng ，/wd 需要/v 将/p 第/m 优/ag +1/m 个/q 同义词/n 存放/v 到/v 另/rz 一个/mq 桶/n 中/f ，/wd 通常/d 称/v 此/rzs 桶/q 为/v “/wyz 溢出/v 桶/n ”/wyy ；/wf 相对/b 地/n ，/wd 称/v 前/f m/x 个/q 同义词/n 存放/v 的/ude1 桶/n 为/v “/wyz 基/ng 桶/n ”/wyy 。/wj 溢出/v 桶/n 和/cc 基/ng 桶/n 大小/n 相同/a ，/wd 相互之间/bl 用/v 指针/n 相/d 链接/n 。/wj 当/p 在/p 基/ng 桶/n 中/f 没有/d 找到/v 待查/v 记录/v 时/ng ，/wd 就/d 顺/a 指针/n 所/usuo 指/v 到/v 溢出/v 桶/n 中/f 进行/vx 查找/vn 。/wj 因此/c ，/wd 希望/v 同/p 一/m 散/ad 列/v 地址/n 的/ude1 溢出/v 桶/n 和/cc 基/ng 桶/n 在/p 磁盘/n 上/f 的/ude1 物理/n 位置/n 不要/d 相距/vi 太/d 远/a ，/wd 最/d 好/a 在/p 同一/b 柱/n 面上/s 。/wj 例如/v ，/wd 某/rz 一/m 文件/n 有/vyou 18/m 个/q 记录/n ，/wd 其/rz 关键字/n 分别/d 为/v 278/m ，/wd 109/m ，/wd 063/m ，/wd 930/m ，/wd 589/m ，/wd 184/m ，/wd 505/m ，/wd 269/m ，/wd 008/m ，/wd 083/m ，/wd 164/m ，/wd 215/m ，/wd 330/m ，/wd 810/m ，/wd 620/m ，/wd 110/m ，/wd 384/m ，/wd 355/m 。/wj 桶/n 的/ude1 容量/n m=3/x ，/wd 桶/q 数/n b：7/x 。/wj 用/p 除/p 留/v 余数/n 法/n 作/v 哈希函数/n H/x (/wkz key/x )/wky =key/x  MOD/x  7/m 。/wj 由此/d 得/ude3 到/v 的/ude1 直接/ad 存取/v 文件/n 如/v 图/n 12．13/m 所/usuo 示/vg 。/wj 
　　在/p 直接/a 文件/n 中/f 进行/vx 查找/vn 时/ng ，/wd 首先/c 根据/p 给/v 定/v 值/v 求得/v 哈希/n 地址/n (/wkz 即/v 基/ng 桶/n 号/q )/wky ，/wd 将/d 基/ng 桶/n 的/ude1 记录/n 读入/v 内存/n 进行/vx 顺序/n 查找/v ，/wd 若/c 找到/v 关键字/n 等于/v 给/p 定/v 值/n 的/ude1 记录/n ，/wd 则/c 检索/v 成功/an ；/wf 否则/c ，/wd 若/c 基/ng 桶/n 内/f 没有/d 填/v 满/a 记录/n 或/c 其/rz 指针/n 域/ng 为/v 空/ng ，/wd 则/c 文件/n 内/f 不/d 含有/v 待查/v 记录/v ；/wf 否则/c 根据/p 指针/n 域/ng 的/ude1 值/n 的/ude1 指示/n 将/d 溢出/v 桶/q 的/ude1 记录/n 读入/v 内存/n 继续/v 进行/vx 顺序/n 查找/v ，/wd 直至/v 检索/v 成功/a 或/c 不/d 成功/a 。/wj 因此/c ，/wd 总/b 的/ude1 查找时间/n 为/v ：/wp 
其中/rz ：/wp o/x 为/p 存取/v 桶/q 数/n 的/ude1 期望值/n (/wkz 相当/d 于/p 哈希表/n 中/f 的/ude1 平均/ad 查找/v 长度/n )/wky ，/wd 对/p 链/ng 地址/n 处理/v 溢出/v 来说/uls ，/wd ：/wp ；/wf te/x 为/p 存取/v 一个/mq 桶/n 所/usuo 需/v 的/ude1 时间/n ；/wf ti/x 为/v 在/p 内存/n 中/b 顺序/n 查找/v 一个/mq 记录所需/n 时间/n 。/wj 
        a/x 为/p 装载/v 因子/n ，/wd 在/p 散/v 列/v 文件/n 中/f 
    其中/rz ：/wp v/x 为/p 文件/n 的/ude1 记录/n 数/n ，/wd b/x 为/v 桶/q 数/n ，/wd m/x 为/p 桶/n 的/ude1 容量/n 。/wj 显然/a ，/wd 增加/v m/x 可/v 减少/v a/x ，/wd 也/d 就/d 使/v 12/m 减/v 小/a ，/wd 此时/r 虽则/c 使/v ti/x 增大/v ，/wd 但/c 由于/p te/x >/n >/n ti/x ，/wd 则/c 总/b 的/ude1 时间/n T/x 仍/d 可/v 减少/v 。/wj 图/n 12．14/m 展示/v 了/ule a/x 和/cc 的/ude1 关系/n 。/wj 
    在/p 直接/ad 存取/v 文件/n 中/f 删除/v 记录/v 时/ng ，/wd 和/cc 哈希表/n 一样/uyy ，/wd 仅/d 需/v 对/p 被/pbei 删/v 记录/v 作/v 一/m 标记/n 即可/v 。/wj 
图/n 12．13/m   直接/ad 存取/v 文件/n 示例/n     图/n 12．14/m 桶/q 的/ude1 容量/n 和/cc 查找/v 次数/n 的/ude1 关系/n 
    总之/c ，/wd 直接/ad 存取/v 文件/n 的/ude1 优点/n 是/vshi ：/wp 文件/n 随机/d 存放/v ，/wd 记录/v 不/d 需/v 进行/vx 排序/vn ；/wf 插入/v 、/wn 删除/v 方便/an ，/wd 存取速度/n 快/a ，/wd 不/d 需要/v 索引/n 区/n ，/wd 节省存储/n 空间/n 。/wj 其/rz 缺点/n 是/vshi ：/wp 不/d 能/v 进行/vx 顺序/n 存取/vn ，/wd 只/d 能/v 按/p 关键字/n 随机/d 存取/v ，/wd 且/c 询问/v 方式/n 限于/v 简单/ad 询问/v ，/wd 并且/c 在/p 经过/p 多次/mq 的/ude1 插入/v 、/wn 删除/v 之后/f ，/wd 也/d 可能/v 造成/v 文件/n 结构/n 不/d 合理/a ，/wd 即/d 溢出/v 桶/q 满/a 而/cc 基/ng 桶/n 内/f 多数/m 为/v 被/pbei 删除/v 的/ude1 记录/n 。/wj 此时/r 亦/d 需/v 重组/vn 文件/n 。/wj 
12．6/m 多/m 关键字/n 文件/n 
    多/m 关键字/n 文件/n 的/ude1 特点/n 是/vshi ，/wd 在/p 对/p 文件/n 进行/vx 检索/vn 操作/vn 时/ng ，/wd 不仅/c 对/p 主/ag 关键字/n 进行/vx 简单/a 询问/vn ，/wd 还/d 经常/d 需要/v 对/p 次关键字/n 进行/vx 其它/rz 类型/n 的/ude1 询问/vn 检索/vn 。/wj 
    例如/v ，/wd 图/n 12．1/m 的/ude1 高考/vn 成绩/n 文件/n 中/f ，/wd 准考证/n 号码/n 为主/vi 关键字/n ，/wd “/wyz 总分/n ”/wyy 和/cc 各/rz 单科/b 成绩/n 为/v 次关键字/n 。/wj 允许/v 对/p 此文件/n 作/v 如下/vi 询问/v ：/wp 总分/n 在/p 600/m 分/qt 以上/f 的/ude1 记录/n ；/wf 数学/n 的/ude1 平均/a 分数/n ，/wd 等等/udeng 。/wj 如果/c 文件/n 组织/n 中/f 只/d 有/vyou 主/n 关键字索引/n ，/wd 则/c 为/p 回答/v 这些/rz 对/p 次关键字/n 的/ude1 询问/vn ，/wd 只能/v 顺序/n 存取/vn 文件/n 中/f 的/ude1 每/rz 一个/mq 记录/n 进行/vx 比较/vn ，/wd 从而/c 效率/n 很/d 低/a 。/wj 为此/bl ，/wd 对/p 多/a 关键字/n 文件/n ，/wd 除了/p 按/p 以上/f 几/m 节/q 讨论/vn 的/ude1 方法/n 组织/v 文件/n 之外/f ，/wd 尚/d 需/v 建立/v 一/m 系列/q 的/ude1 次关键字/n 索引/n 。/wj 次关键字/n 索引/n 可以/v 是/vshi 稠密/a 的/ude1 ，/wd 也/d 可以/v 是非/n 稠密/a 的/ude1 ；/wf 索引/n 表/vg 可以/v 是/vshi 顺序/n 表/n ，/wd 也/d 可以/v 是/vshi 树/n 表/n 。/wj 和/cc 主/ag 关键字索引/n 表/vg 不同/a ，/wd 每个/r 索引/n 项/q 应/v 包含/v 次关键字/n 、/wn 具有/v 同/p 一/m 次关键字/n 的/ude1 多/m 个/q 记录/n 的/ude1 主/ag 关键字/n 或/c 物理/n 记录号/n 。/wj 下面/f 讨论/v 两/m 种/q 多/a 关键字/n 文件/n 的/ude1 组织/n 方法/n 。/wj 
12．6．1/m 多/m 重/q 表文件/n 
    多/m 重/q 表文件/n (/wkz Multilist/x  File/x )/wky 的/ude1 特点/n 是/vshi ：/wp 记录/v 按/p 主/ag 关键字/n 的/ude1 顺序/n 构成/v 一个/mq 串联/v 文件/n ，/wd 并/cc 建立/v 主/ag 关键字/n 的/ude1 索引/n (/wkz 称/v 为主/vi 索引/n )/wky ；/wf 对/p 每/rz 一个/mq 次关键字/n 项/q 建立/v 次关键字/n 索引/n (/wkz 称为/v 次索引/n )/wky ，/wd 所有/b 具有/v 同/p 一/m 次关键字/n 的/ude1 记录/n 构成/v 一个/mq 链/ng 表/n 。/wj 主/ag 索引/n 为/p 非/b 稠密/a 索引/n ，/wd 次索引/n 为/p 稠密/a 索引/n 。/wj 每个/r 索引/n 项/q 包括/v 次关键字/n 、/wn 头/n 指针/n 和/cc 链/ng 表/vg 长度/n 。/wj 
    例如/v ，/wd 图/n 12．15/m 所/usuo 示/vg 为/v 一个/mq 多/a 重/a 链/ng 表文件/n 。/wj 其中/rz ，/wd 学/v 号/q 为主/vi 关键字/n ，/wd 记录/v 按/p 学/v 号/q 顺序/n 链接/n ，/wd 为了/p 查找方便/n ，/wd 分成/vi 3/m 个子/n 链/ng 表/n ，/wd 其/rz 索引/n 如/v 图/n 12．15/m (/wkz b/x )/wky 所/usuo 示/vg ，/wd 索引/n 项/q 中/f 的/ude1 主/ag 关键字/n 为/p 各/rz 子/ng 表/n 中/f 的/ude1 最/d 大值/n 。/wj 专业/n ，/wd 已/d 修/v 学分/n 和/cc 选修课/n 目/ng 为/v 三/m 个/q 次关键字/n 项/q ，/wd 它们/rr 的/ude1 索引/n 如/v 图/n 12．15/m (/wkz c/x )/wky ～/ws (/wkz e/x )/wky 所/usuo 示/vg ，/wd 具有/v 相同/a 次关键字/n 的/ude1 记录/n 链接/n 在/p 同一/b 链/ng 表/n 中/f 。/wj 有/vyou 了/ule 这些/rz 次关键字/n 索引/n ，/wd 便/d 容易/ad 处理/v 各种/rz 次关键字/n 的/ude1 询问/vn 。/wj 例如/v ，/wd 若/c 要/v 查询/v 已/d 修/v 学分/n 在/p 400/m 分/qt 以上/f 的/ude1 学生/n ，/wd 只要/c 在/p 索引/n 表/n 上/f 查找/v 400/m ～/ws 449/m 这/rzv 一/m 项/q ，/wd 然后/c 从/p 它/rr 的/ude1 链/ng 表头/n 指针/n 出发/vi ，/wd 列出/v 该/rz 链/ng 表/n 中/f 所/usuo 有/vyou 记录/n 即可/v 。/wj 又/d 如/v ，/wd 若/c 要/v 查询/v 是否/v 有/vyou 同时/d 选修/v 甲/Mg 和/n 乙/Mg 课程/n 的/ude1 学生/n ，/wd 则/c 或/c 从/p 索引/n 表/vg 上/vf “/wyz 甲/Mg ”/wyy 的/ude1 头/n 指针/n 出发/vi ，/wd 或/c 从/p “/wyz 乙/Mg ”/wyy 的/ude1 头/n 指针/n 出发/vi ，/wd 读出/v 每个/r 记录/n ，/wd 察看/v 是否/v 同时/c 选修/v 这/rzv 两/m 门/q 课程/n 。/wj 此时/r 可/v 先/d 比较/d 两/m 个/q 链/ng 表/n 的/ude1 长度/n ，/wd 显然/ad 应/v 读出/v 长度较/n 短/a 的/ude1 链/ng 表/n 中/f 的/ude1 记录/n 。/wj 
    多重/b 链/ng 表文件/n 易于/vd 编程/vi ，/wd 也/d 易于/v 修改/vn 。/wj 如果/c 不/d 要求/v 保持/v 链/ng 表/n 的/ude1 某种/rz 次序/n ，/wd 则/c 插入/v 一个/mq 新/a 记录/n 是/vshi 容易/a 的/ude1 ，/wd 此时/r 可/v 将/d 记录/v 插/v 在/p 链/ng 表/n 的/ude1 头/n 指针/n 之后/f 。/wj 但是/c ，/wd 要/v 删/v 去/vf 一个/mq 记录/n 却/d 很/d 繁琐/a ，/wd 需/v 在/p 每个/r 次关键字/n 的/ude1 链/ng 表/n 中/f 删/v 去/vf 该/rz 记录/n 。/wj 
记录号/n 
物理/n 
    图/n 12．15/m 多/m 重/q 表文件/n 示例/n 
  (/wkz a/x )/wky 数据/n 文件/n ；/wf (/wkz b/x )/wky 主/ag 关键字索引/n ；/wf   (/wkz c/x )/wky “/wyz 专业/n ”/wyy 索引/n ；/wf (/wkz d/x )/wky “/wyz 已/d 修/v 学分/n ”/wyy 索引/n ；/wf (/wkz e/x )/wky “/wyz 选修课/n 目/ng ”/wyy 索引/n 。/wj 
12．6．2/m 倒排/n 文件/n 
    倒排/n 文件/n 和/cc 多/m 重/q 表文件/n 的/ude1 区别/vd 在于/v 次关键字/n 索引/n 的/ude1 结构/n 不同/a 。/wj 通常/d ，/wd 称/v 倒排/n 文件/n 中/f 的/ude1 次关键字/n 索引/n 为/v 倒排/n 表/n ，/wd 具有/v 相同/a 次关键字/n 的/ude1 记录/n 之间/f 不/d 设/v 指针/n 相/d 链/ng ，/wd 而/cc 在/p 倒排/n 表/n 中/f 该/v 次关键字/n 的/ude1 一/m 项/q 中/f 存放/v 这些/rz 记录/n 的/ude1 物理/n 记录号/n 。/wj 例如/v ，/wd 上/vf 例/n 文件/n 的/ude1 倒排/n 表/vg 如/v 图/n 12．16/m 所/usuo 示/vg 。/wj 
    倒排/n 表/vg 作/v 索引/n 的/ude1 好处/n 在于/v 检索记录/n 较/d 快/a 。/wj 特别/d 是/vshi 对/p 某些/rz 询问/v ，/wd 不用/d 读取记录/n ，/wd 就/d 可/v 得到/v 解答/v ，/wd 如/c 询问/v “/wyz 软件/n ”/wyy 专业/n 的/ude1 学生/n 中/f 有/vyou 否/vg 选/v 课程/n “/wyz 乙/Mg ’/wyy ’/wyy 的/ude1 ，/wd 则/c 只/d 要/v 将/p “/wyz 软件/n ”/wyy 索引/n 中/f 的/ude1 记录号/n 和/cc “/wyz 乙/Mg ”/wyy 索引/n 中/f 的/ude1 记录号/n 作/v 求/v “/wyz 交/ng ”/wyy 的/ude1 集合/n 运算/vn 即可/v 。/wj 
    在/p 插入/v 和/cc 删除/v 记录/v 时/ng ，/wd 倒排/n 表/n 也/d 要/v 作/v 相应/vi 的/ude1 修改/vn ，/wd 值得/v 注意/v 的/ude1 是/vshi 倒排/n 表/n 中/f 具有/v 同/p 一/m 次关键字/n 的/ude1 记录号/n 是/vshi 有序/ad 排列/v 的/ude1 ，/wd 则/c 修改/v 时/ng 要/v 作/v 相应/vd 移动/v 。/wj 
 (/wkz a/x )/wky 专业/n 倒排/n 表/n 
(/wkz b/x )/wky 已/d 修/v 学分/n 倒排/n 表/n 
    (/wkz c/x )/wky 选修/v 课目/n 倒排/n 表/n 
    图/n 12．16/m 倒排/n 文件/n 索引/n 示例/n 
    若/c 数据/n 文件/n 非/b 串/n 链/ng 文件/n ，/wd 而是/c 索引/n 顺序/n 文件/n (/wkz 如/v ISAM/x 文件/n )/wky ，/wd 则/c 倒排/n 表/n 中/f 应/v 存放/v 记录/v 的/ude1 主/ag 关键字/n 而/cc 不/d 是/vshi 物理/n 记录号/n 。/wj 
　　倒排/n 文件/n 的/ude1 缺点/n 是/vshi 维护/v 困难/an 。/wj 在/p 同一/b 索引/n 表/n 中/f ，/wd 不同/a 的/ude1 关键/n 字/n 其/rz 记录/n 数/n 不/d 同/v ，/wd 各/rz 倒排/n 表/n 的/ude1 长度/n 不等/vi ，/wd 同一/b 倒排/n 表/n 中/f 各项/r 长度/n 也/d 不/d 等/v 。/wj 
